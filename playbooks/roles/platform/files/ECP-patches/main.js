!function(e){function t(t){for(var r,i,s=t[0],c=t[1],l=t[2],p=0,d=[];p<s.length;p++)i=s[p],Object.prototype.hasOwnProperty.call(n,i)&&n[i]&&d.push(n[i][0]),n[i]=0;for(r in c)Object.prototype.hasOwnProperty.call(c,r)&&(e[r]=c[r]);for(u&&u(t);d.length;)d.shift()();return o.push.apply(o,l||[]),a()}function a(){for(var e,t=0;t<o.length;t++){for(var a=o[t],r=!0,s=1;s<a.length;s++){var c=a[s];0!==n[c]&&(r=!1)}r&&(o.splice(t--,1),e=i(i.s=a[0]))}return e}var r={},n={0:0},o=[];function i(t){if(r[t])return r[t].exports;var a=r[t]={i:t,l:!1,exports:{}};return e[t].call(a.exports,a,a.exports,i),a.l=!0,a.exports}i.m=e,i.c=r,i.d=function(e,t,a){i.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:a})},i.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},i.t=function(e,t){if(1&t&&(e=i(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var a=Object.create(null);if(i.r(a),Object.defineProperty(a,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)i.d(a,r,function(t){return e[t]}.bind(null,r));return a},i.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return i.d(t,"a",t),t},i.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},i.p="/bdswebui/static/bdswebui/bluedata/bundle/";var s=window.webpackJsonp=window.webpackJsonp||[],c=s.push.bind(s);s.push=t,s=s.slice();for(var l=0;l<s.length;l++)t(s[l]);var u=c;o.push([1458,1]),a()}({126:function(e,t,a){"use strict";(function(e){var r=a(2),n="/bdswebui/",o="".concat(window.STATIC_URL||"","bluedata");e&&Object({NODE_ENV:"production",WEBPACK:!0});var i="".concat(n,"epic/"),s="".concat(n,"aiml/"),c="".concat(n,"k8s/"),l="".concat(n,"k8stenant/");t.a={staticUrl:o,dashboard:{url:"".concat(n,"dashboard"),roles:["Site Admin"],tenant_types:["Site Admin"],viewName:"dashboard",viewLabel:"Dashboard"},manageTenants:{url:"".concat(n,"managetenant/"),roles:["Site Admin"],tenant_types:["Site Admin"],viewName:"manageTenants",viewLabel:"Tenants"},hosts:{url:"".concat(i,"hosts"),roles:["Site Admin"],tenant_types:["Site Admin"],viewName:"hosts",viewLabel:"Hosts"},extHosts:{url:"".concat(n,"manageexthosts/"),roles:["Site Admin"],tenant_types:["Site Admin"],viewName:"extHosts",viewLabel:"External Hosts"},manageVnodes:{url:"".concat(n,"managevnode/"),roles:["Site Admin"],tenant_types:["Site Admin"],viewName:"manageVnodes",viewLabel:"Nodes"},apps:{url:"".concat(n,"configuration/image-settings"),roles:["Site Admin"],tenant_types:["Site Admin"],viewName:"apps",viewLabel:"Applications"},manageControllers:{url:"".concat(n,"managecontroller/"),roles:["Site Admin"],tenant_types:["Site Admin"],viewName:"manageControllers",viewLabel:"Controllers"},gatewayLoadBalancers:{url:"".concat(n,"gatewaylb/"),roles:["Site Admin"],tenant_types:["Site Admin"],viewName:"gatewayLoadBalancers",viewLabel:"Gateway LB"},authentication:{url:"".concat(n,"authsettings/"),roles:["Site Admin"],tenant_types:["Site Admin"],viewName:"authentication",viewLabel:"Authentication"},notifications:{url:"".concat(n,"notificationsettings/"),roles:["Site Admin"],tenant_types:["Site Admin"],viewName:"notifications",viewLabel:"Notifications"},infosight:{url:"".concat(n,"infosight/"),roles:["Site Admin"],tenant_types:["Site Admin"],viewName:"infosight",viewLabel:"InfoSight"},manageUsers:{url:"".concat(n,"manageuser/"),roles:["Site Admin"],tenant_types:["Site Admin"],viewName:"manageUsers",viewLabel:"Users"},settings:{url:"".concat(n,"gensettings/"),roles:["Site Admin"],tenant_types:["Site Admin"],viewName:"settings",viewLabel:"Settings"},aimlDashboard:{url:s,roles:["Admin","Member"],tenant_types:["docker"]},notebooks:{url:"".concat(s,"notebooks"),roles:["Admin","Member"],tenant_types:["docker"]},createEditNotebook:{url:"".concat(s,"create-edit-notebook"),roles:["Admin","Member"],editUrl:function(e){var t=e.id;return"".concat(s,"create-edit-notebook?id=").concat(t,"&op=edit_cluster")},createTemplateUrl:"".concat(s,"create-edit-notebook?op=create_template"),editTemplateUrl:function(e){var t=e.id;return"".concat(s,"create-edit-notebook?id=").concat(t,"&op=edit_template")},tenant_types:["docker"]},trainings:{url:"".concat(s,"training"),roles:["Admin","Member"],tenant_types:["docker"]},createEditTraining:{url:"".concat(s,"create-edit-training"),roles:["Admin","Member"],editUrl:function(e){var t=e.id;return"".concat(s,"create-edit-training?id=").concat(t,"&op=edit_cluster")},createTemplateUrl:"".concat(s,"create-edit-training?op=create_template"),editTemplateUrl:function(e){var t=e.id;return"".concat(s,"create-edit-training?id=").concat(t,"&op=edit_template")},tenant_types:["docker"]},deployments:{url:"".concat(s,"deployments"),roles:["Admin","Member"],tenant_types:["docker"]},createEditDeployment:{url:"".concat(s,"create-edit-deployment"),roles:["Admin","Member"],editUrl:function(e){var t=e.id;return"".concat(s,"create-edit-deployment?id=").concat(t,"&op=edit_cluster")},deployFromModelUrl:function(e){var t=e.model_id;return"".concat(s,"create-edit-deployment?model_id=").concat(t)},createTemplateUrl:"".concat(s,"create-edit-deployment?op=create_template"),editTemplateUrl:function(e){var t=e.id;return"".concat(s,"create-edit-deployment?id=").concat(t,"&op=edit_template")},tenant_types:["docker"]},aimlClusterDashboard:{url:"".concat(s,"cluster"),roles:["Admin","Member"],makeUrl:function(e){var t=e.id;return"".concat(s,"cluster?id=").concat(t)},tenant_types:["docker"]},clusterHostData:{url:"".concat(s,"cluster-host-data"),roles:["Admin","Member"],makeUrl:function(e){var t=e.id;return"".concat(s,"cluster-host-data?id=").concat(t)},tenant_types:["docker"]},clusterLog:{url:"".concat(s,"cluster-log"),roles:["Admin","Member"],makeUrl:function(e){var t=e.id;return"".concat(s,"cluster-log?id=").concat(t)},tenant_types:["docker"]},models:{url:"".concat(s,"models"),roles:["Admin","Member"],tenant_types:["docker"]},createEditModel:{url:"".concat(s,"create-edit-model"),roles:["Admin","Member"],editUrl:function(e){var t=e.id;return"".concat(s,"create-edit-model?id=").concat(t)},tenant_types:["docker"]},project:{url:"".concat(s,"project"),roles:["Admin"],tenant_types:["docker"]},projectUsers:{url:"".concat(s,"users"),roles:["Admin"],tenant_types:["docker"]},assignAimlUser:{url:"".concat(s,"assign-user"),roles:["Admin"],tenant_types:["docker"]},logout:{url:"".concat(n,"logout"),roles:["Admin","Member"],tenant_types:["docker"]},flavors:{url:"".concat(s,"flavors"),roles:["Admin","Member"],tenant_types:["docker"]},aimlApps:{url:"".concat(s,"apps"),roles:["Admin","Member"],tenant_types:["docker"]},manageDataSources:{url:"".concat(s,"datasources"),roles:["Admin","Member"],tenant_types:["docker"]},dataSource:{url:"".concat(s,"datasource"),roles:["Admin","Member"],makeUrl:function(e){var t=e.id,a=e.source_type;return"".concat(s,"datasource?id=").concat(t,"&source_type=").concat(a)},tenant_types:["docker"]},createEditDataSource:{url:"".concat(s,"create-edit-datasource"),roles:["Admin"],editUrl:function(e){var t=e.id,a=e.source_type;return"".concat(s,"create-edit-datasource?id=").concat(t,"&source_type=").concat(a)},tenant_types:["docker"]},projectRepo:{url:"".concat(s,"project-repo"),roles:["Admin","Member"],tenant_types:["docker"]},sourceControl:{url:"".concat(n,"source-control"),roles:["Admin","Member"],tenant_types:["docker"]},download:{url:"".concat(n,"download")},switchToSiteAdmin:{url:"".concat(n,"tenant")},helpdoc:{url:"http://docs.bluedata.com/51_epic-51"},privacy:{url:"https://www.hpe.com/privacy"},support:{url:"".concat(n,"support/")},assignUser:{url:"".concat(n,"assignusers/"),roles:["Site Admin"],tenant_types:["Site Admin"]},k8sDashboard:{url:"".concat(c,"dashboard"),roles:["Site Admin"],tenant_types:["Site Admin"]},k8sHosts:{url:"".concat(c,"hosts"),roles:["Site Admin"],tenant_types:["Site Admin"]},managek8sClusters:{url:"".concat(c,"clusters"),roles:["Site Admin"],tenant_types:["Site Admin"],viewName:"managek8sClusters",viewLabel:"Kubernetes Cluster"},k8sTenants:{url:"".concat(c,"tenants"),roles:["Site Admin"],tenant_types:["Site Admin"]},k8sCreateCluster:{url:"".concat(c,"create-edit-cluster"),roles:["Site Admin"],makeEditUrl:function(e){var t=e.id;return"".concat(c,"create-edit-cluster?id=").concat(t,"&op=edit_cluster")},tenant_types:["Site Admin"]},k8sClusterDashboard:{url:"".concat(c,"cluster-dashboard"),roles:["Site Admin"],makeUrl:function(e){var t=e.id;return"".concat(c,"cluster-dashboard?id=").concat(t)},tenant_types:["Site Admin"]},k8sImportCluster:{url:"".concat(c,"import-edit-cluster"),roles:["Site Admin"],makeEditUrl:function(e){var t=e.id;return"".concat(c,"import-edit-cluster?id=").concat(t,"&op=edit_cluster")},tenant_types:["Site Admin"]},createTenant:{url:"".concat(n,"createtenant/?tenant_type=k8s"),roles:["Site Admin"],makeEditUrl:function(e){var t=e.id;return"".concat(n,"createtenant/?tenant_type=k8s&tenant_id=").concat(t)},tenant_types:["Site Admin"]},addUser:{url:"".concat(n,"createuser/"),roles:["Site Admin"],tenant_types:["Site Admin"]},tenantUserList:{makeUserListUrl:function(e){var t=e.id;return"".concat(n,"tenantextras/?tenant_id=").concat(t,"&op=extras")},tenant_types:["Site Admin"]},tags:{url:"".concat(n,"tags"),roles:["Site Admin"],tenant_types:["Site Admin"]},k8sTenantDashboard:{url:"".concat(l,"dashboard"),roles:["Member","Admin","K8S Admin"],tenant_types:["k8s","k8s_admin"]},k8sActingTenant:{makeUrl:function(e){var t=e.id;return"".concat(n,"set_acting_tenant/?tenant=").concat(t,"&siteadmin_view=managetenant_view&redirect_view=k8stenant_view")}},k8sApps:{url:"".concat(l,"applications"),roles:["Member","Admin"],tenant_types:["k8s"],viewName:"k8sApps",viewLable:"Applications",makeUrl:function(e){var t=e.hash;return"".concat(l,"applications/#").concat(t)}},k8sLaunchApp:{url:"".concat(l,"launch-applications"),roles:["Member","Admin"],makeLaunchUrl:function(e){return r.a.buildQueryParamsString({baseUrl:"".concat(l,"launch-applications"),params:e})},tenant_types:["k8s"]},k8sAppsService:{url:"".concat(l,"application-services"),roles:["Member","Admin"],tenant_types:["k8s"]},k8sAdminClusterDashboard:{url:"".concat(l,"cluster-dashboard"),roles:["K8S Admin"],tenant_types:["k8s_admin"]},k8sClusterAdminUsers:{url:"".concat(l,"users"),roles:["K8S Admin"],tenant_types:["k8s_admin"]},k8sTenantUsers:{url:"".concat(l,"tenant-users"),roles:["Admin","K8S Admin"],makeTenantUserUrl:function(e){var t=e.tenant_id,a=e.tenant_name;return"".concat(l,"tenant-users?tenant_id=").concat(t,"&tenant_name=").concat(a)},tenant_types:["k8s","k8s_admin"]},k8sTenantList:{url:"".concat(l,"tenants"),roles:["K8S Admin"],tenant_types:["k8s_admin"]},managek8sDataTaps:{url:"".concat(l,"datataps"),roles:["Admin","Member"],tenant_types:["k8s"]},managek8sFsMounts:{url:"".concat(l,"fsmounts"),roles:["Admin","Member"],tenant_types:["k8s"]},k8sDataSource:{url:"".concat(l,"datasource"),roles:["Admin","Member"],makeUrl:function(e){var t=e.id,a=e.source_type;return"".concat(l,"datasource?id=").concat(t,"&source_type=").concat(a)},tenant_types:["k8s"]},k8sCreateEditDataSource:{url:"".concat(l,"create-edit-datasource"),roles:["Admin"],editUrl:function(e){var t=e.id,a=e.source_type;return"".concat(l,"create-edit-datasource?id=").concat(t,"&source_type=").concat(a)},makeUrl:function(e){var t=e.source_type;return"".concat(l,"create-edit-datasource?source_type=").concat(t)},tenant_types:["k8s"]},assignK8sUser:{url:"".concat(l,"assign-user"),roles:["Admin","K8S Admin"],tenant_types:["k8s","k8s_admin"]},k8sProjectRepo:{url:"".concat(l,"project-repo"),roles:["Admin","Member"],tenant_types:["k8s"]},managek8sSourceControl:{url:"".concat(l,"manage-source-control"),roles:["Admin","Member"],tenant_types:["k8s"]},k8sCreateEditSourceControl:{url:"".concat(l,"create-edit-source-control"),roles:["Admin","Member"],editUrl:function(e){return"".concat(l,"create-edit-source-control?name=").concat(e)},tenant_types:["k8s"]},k8sModels:{url:"".concat(l,"models"),roles:["Admin","Member"],tenant_types:["k8s"]},k8sCreateEditModel:{url:"".concat(l,"create-edit-model"),roles:["Admin","Member"],editUrl:function(e){var t=e.id;return"".concat(l,"create-edit-model?id=").concat(t)},tenant_types:["k8s"]},k8sTrainings:{url:"".concat(l,"training"),roles:["Admin","Member"],tenant_types:["k8s"],viewName:"k8sTrainings",viewLabel:"Trainings",makeUrl:function(e){var t=e.hash;return"".concat(l,"training/#").concat(t)}},k8sDeployments:{url:"".concat(l,"deployments"),roles:["Admin","Member"],tenant_types:["k8s"],viewName:"k8sDeployments",viewLabel:"Deployments",makeUrl:function(e){var t=e.hash;return"".concat(l,"deployments/#").concat(t)}},k8sNotebooks:{url:"".concat(l,"notebooks"),roles:["Admin","Member"],tenant_types:["k8s"],viewName:"k8sNotebooks",viewLabel:"Notebook",makeUrl:function(e){var t=e.hash;return"".concat(l,"notebooks/#").concat(t)}},epicWorkerSetupLog:{makeUrl:function(e){var t=e.id;return"".concat(n,"logworker/?id=").concat(t)},test:"test"},manageDataFabricClusters:{url:"".concat(n,"manage-datafabric-cluster"),roles:["Site Admin"],tenant_types:["Site Admin"],viewName:"manageDataFabricCluster",viewLabel:"DataFabric Clusters"},createDataFabricCluster:{url:"".concat(n,"create-edit-datafabric-cluster"),roles:["Site Admin"],tenant_types:["Site Admin"],viewName:"createDataFabricCluster",viewLabel:"Create/Edit DataFabric Cluster"}}}).call(this,a(39))},1297:function(e,t,a){var r={"./af":499,"./af.js":499,"./ar":500,"./ar-dz":501,"./ar-dz.js":501,"./ar-kw":502,"./ar-kw.js":502,"./ar-ly":503,"./ar-ly.js":503,"./ar-ma":504,"./ar-ma.js":504,"./ar-sa":505,"./ar-sa.js":505,"./ar-tn":506,"./ar-tn.js":506,"./ar.js":500,"./az":507,"./az.js":507,"./be":508,"./be.js":508,"./bg":509,"./bg.js":509,"./bm":510,"./bm.js":510,"./bn":511,"./bn.js":511,"./bo":512,"./bo.js":512,"./br":513,"./br.js":513,"./bs":514,"./bs.js":514,"./ca":515,"./ca.js":515,"./cs":516,"./cs.js":516,"./cv":517,"./cv.js":517,"./cy":518,"./cy.js":518,"./da":519,"./da.js":519,"./de":520,"./de-at":521,"./de-at.js":521,"./de-ch":522,"./de-ch.js":522,"./de.js":520,"./dv":523,"./dv.js":523,"./el":524,"./el.js":524,"./en-au":525,"./en-au.js":525,"./en-ca":526,"./en-ca.js":526,"./en-gb":527,"./en-gb.js":527,"./en-ie":528,"./en-ie.js":528,"./en-il":529,"./en-il.js":529,"./en-in":530,"./en-in.js":530,"./en-nz":531,"./en-nz.js":531,"./en-sg":532,"./en-sg.js":532,"./eo":533,"./eo.js":533,"./es":534,"./es-do":535,"./es-do.js":535,"./es-us":536,"./es-us.js":536,"./es.js":534,"./et":537,"./et.js":537,"./eu":538,"./eu.js":538,"./fa":539,"./fa.js":539,"./fi":540,"./fi.js":540,"./fil":541,"./fil.js":541,"./fo":542,"./fo.js":542,"./fr":543,"./fr-ca":544,"./fr-ca.js":544,"./fr-ch":545,"./fr-ch.js":545,"./fr.js":543,"./fy":546,"./fy.js":546,"./ga":547,"./ga.js":547,"./gd":548,"./gd.js":548,"./gl":549,"./gl.js":549,"./gom-deva":550,"./gom-deva.js":550,"./gom-latn":551,"./gom-latn.js":551,"./gu":552,"./gu.js":552,"./he":553,"./he.js":553,"./hi":554,"./hi.js":554,"./hr":555,"./hr.js":555,"./hu":556,"./hu.js":556,"./hy-am":557,"./hy-am.js":557,"./id":558,"./id.js":558,"./is":559,"./is.js":559,"./it":560,"./it-ch":561,"./it-ch.js":561,"./it.js":560,"./ja":562,"./ja.js":562,"./jv":563,"./jv.js":563,"./ka":564,"./ka.js":564,"./kk":565,"./kk.js":565,"./km":566,"./km.js":566,"./kn":567,"./kn.js":567,"./ko":568,"./ko.js":568,"./ku":569,"./ku.js":569,"./ky":570,"./ky.js":570,"./lb":571,"./lb.js":571,"./lo":572,"./lo.js":572,"./lt":573,"./lt.js":573,"./lv":574,"./lv.js":574,"./me":575,"./me.js":575,"./mi":576,"./mi.js":576,"./mk":577,"./mk.js":577,"./ml":578,"./ml.js":578,"./mn":579,"./mn.js":579,"./mr":580,"./mr.js":580,"./ms":581,"./ms-my":582,"./ms-my.js":582,"./ms.js":581,"./mt":583,"./mt.js":583,"./my":584,"./my.js":584,"./nb":585,"./nb.js":585,"./ne":586,"./ne.js":586,"./nl":587,"./nl-be":588,"./nl-be.js":588,"./nl.js":587,"./nn":589,"./nn.js":589,"./oc-lnc":590,"./oc-lnc.js":590,"./pa-in":591,"./pa-in.js":591,"./pl":592,"./pl.js":592,"./pt":593,"./pt-br":594,"./pt-br.js":594,"./pt.js":593,"./ro":595,"./ro.js":595,"./ru":596,"./ru.js":596,"./sd":597,"./sd.js":597,"./se":598,"./se.js":598,"./si":599,"./si.js":599,"./sk":600,"./sk.js":600,"./sl":601,"./sl.js":601,"./sq":602,"./sq.js":602,"./sr":603,"./sr-cyrl":604,"./sr-cyrl.js":604,"./sr.js":603,"./ss":605,"./ss.js":605,"./sv":606,"./sv.js":606,"./sw":607,"./sw.js":607,"./ta":608,"./ta.js":608,"./te":609,"./te.js":609,"./tet":610,"./tet.js":610,"./tg":611,"./tg.js":611,"./th":612,"./th.js":612,"./tk":613,"./tk.js":613,"./tl-ph":614,"./tl-ph.js":614,"./tlh":615,"./tlh.js":615,"./tr":616,"./tr.js":616,"./tzl":617,"./tzl.js":617,"./tzm":618,"./tzm-latn":619,"./tzm-latn.js":619,"./tzm.js":618,"./ug-cn":620,"./ug-cn.js":620,"./uk":621,"./uk.js":621,"./ur":622,"./ur.js":622,"./uz":623,"./uz-latn":624,"./uz-latn.js":624,"./uz.js":623,"./vi":625,"./vi.js":625,"./x-pseudo":626,"./x-pseudo.js":626,"./yo":627,"./yo.js":627,"./zh-cn":628,"./zh-cn.js":628,"./zh-hk":629,"./zh-hk.js":629,"./zh-mo":630,"./zh-mo.js":630,"./zh-tw":631,"./zh-tw.js":631};function n(e){var t=o(e);return a(t)}function o(e){if(!a.o(r,e)){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}return r[e]}n.keys=function(){return Object.keys(r)},n.resolve=o,e.exports=n,n.id=1297},1305:function(e,t){},1307:function(e,t){},1318:function(e,t){},1320:function(e,t){},1345:function(e,t){},1347:function(e,t){},1348:function(e,t){},1353:function(e,t){},1355:function(e,t){},1362:function(e,t){},1364:function(e,t){},1382:function(e,t){},1385:function(e,t){},1401:function(e,t){},1404:function(e,t){},1458:function(e,t,a){"use strict";a.r(t);var r=a(0),n=a.n(r),o=a(45),i=a(1462),s=a(12),c=a(1463),l=a(1),u=a.n(l),p=a(16),d=a.n(p),f=a(2);function m(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function h(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?m(Object(a),!0).forEach((function(t){b(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):m(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function b(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}var v={API:"/bdswebui/api/",STATS:"/api/v1/stats/",INSTALL:"/api/v1/install/",LOCK:"/api/v1/lock/",CONFIG_V2:"/api/v2/config/",CONFIG_V1:"/api/v1/config/",TENANT:"/api/v2/tenant/",TENANT_V1:"/api/v1/tenant/",TENANT_STORAGE_DATA:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return"/api/v1/tenant/".concat(e.split("/").pop(),"?tenantstorage").concat(t?"&refresh":"")},TENANT_ACLS:function(e){return"/api/v2/tenant/".concat(e.split("/").pop(),"/acls")},NODE:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return"/api/v2/node/".concat(e.length?"?".concat(e.join("&")):"")},USERS:"/api/v1/user/",ROLES:"/api/v1/role/",CLUSTER:"/api/v2/cluster/",CLUSTER_CHANGE_TASK:function(e){var t=e.split("/").pop();return"/api/v2/cluster/".concat(t,"/change_task")},CLUSTER_NODES:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],a=e.split("/").pop();return"/api/v2/cluster/".concat(a,"/node").concat(t.length?"?".concat(t.join("&")):"")},CLUSTER_NAGIOS:function(e){var t=e.split("/").pop();return"/api/v1/cluster/".concat(t,"?nagios")},CLUSTER_HISTORIES:function(e){var t=e.split("/").pop();return"/api/v2/cluster/".concat(t,"/change_history")},ACTION_SCRIPTS:function(e){var t=e.split("/").pop();return"/api/v2/cluster/".concat(t,"/action_history")},CREATE_ACTION_SCRIPT:function(e){var t=e.split("/").pop();return"/api/v2/cluster/".concat(t,"/action_task")},DRYRUN:"/api/v2/cluster?dryrun",CATALOG:"/api/v1/catalog?filter_acl",DCO:"/api/v1/dataconn/",FILESYSTEMS:"/api/v2/tenant_filesystem",TENANT_USERS:function(e){return"".concat(e,"/?user")},USER_TENANTS:function(e){var t=e.split("/").pop();return"/api/v1/user/".concat(t,"?tenant")},FLAVORS:"/api/v1/flavor/",MODEL:"/api/v2/model/",LICENSE:"/api/v2/hpelicense/",LICENSE_LEGACY:"/api/v1/license/",PROJECT_REPO:function(e){var t=e.split("/").pop();return"/api/v2/tenant/".concat(t,"/project_repo")},SOURCE_CONTROL:function(e){var t=e.split("/").pop();return"/api/v2/tenant/".concat(t,"/source_control")},PRIVATEKEY:function(e){var t=e.split("/").pop();return"/api/v1/tenant/".concat(t,"/?privatekey")},K8SHOST:"/api/v2/worker/k8shost/",EPICHOST:"/api/v1/workers/",PNODE_LIST:"/api/v1/phynode",K8SCLUSTER:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return"/api/v2/k8scluster".concat(e.length?"?".concat(e.join("&")):"")},METRICS_PARAMS:"/api/v2/metrics",K8S_CLUSTER_CHANGE_TASK:function(e){return"".concat(e,"/change_task")},K8SCLUSTER_IMPORT:"/api/v2/k8scluster/import",WEBTERMS:"/api/v2/webterm",CURRENT_WEBTERM:function(e){var t=e.split("/").pop();return"/api/v2/webterm/?userid=".concat(t)},HOST_TAGS:"/api/v2/tag/",K8S_KUBECONFIG:"/api/v2/k8skubeconfig/",K8S_MANIFEST:"/api/v2/k8smanifest/",K8S_MANIFEST_LOG:"/api/v2/k8smanifest/log/",K8SCLUSTER_SETUP_LOG:function(e){var t=e.split("/").pop();return"/api/v2/k8scluster/".concat(t,"/?setup_log")},K8S:"/api/v1",K8S_NAMESPACES:"/api/v1/namespaces",K8S_NODES:"/api/v1/nodes",K8S_PODS:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},a="/api/v1/namespaces/".concat(e,"/pods");return f.a.buildQueryParamsString({baseUrl:a,params:h(h({},t),{},{limit:500})})},K8S_POD:function(e,t){return"/api/v1/namespaces/".concat(e,"/pods/").concat(t)},K8S_PVS:"/api/v1/persistentvolumes",K8S_STATEFULSETS:function(e){return"/apis/apps/v1/namespaces/".concat(e,"/statefulsets")},K8S_STATEFULSET:function(e,t){return"/apis/apps/v1/namespaces/".concat(e,"/statefulsets/").concat(t)},K8S_SERVICES:function(e){return"/api/v1/namespaces/".concat(e,"/services")},K8S_SERVICE:function(e,t){return"/api/v1/namespaces/".concat(e,"/services/").concat(t)},K8S_KD_APPS:function(e){return"/apis/kubedirector.hpe.com/v1beta1/namespaces/".concat(e,"/kubedirectorapps")},K8S_KD_CLUSTERS:function(e){return"/apis/kubedirector.hpe.com/v1beta1/namespaces/".concat(e,"/kubedirectorclusters")},EXTERNAL_USER_GROUPS:function(e){return"/api/v1/tenant/".concat(e.split("/").pop(),"?external_user_groups")},K8S_VERSION:"/version",INSTALL_EPIC_WORKERS:"/api/v1/install/?install_alter",K8S_CONFIG_MAP:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},a="/api/v1/namespaces/".concat(e,"/configmaps/");return f.a.isEmptyObject(t)?a:f.a.buildQueryParamsString({baseUrl:a,params:t})}},y=a(702),g=a(126),_={short_timeout:5e3,timeout:3e4,long_timeout:24e4,time_format:"ddd MMM DD YYYY HH:mm:ss",webapp:{sidebar:{width:192,expanded:{width:192},collapsed:{width:128}},navbar:{height:72}},MB_to_GB:1024,B_to_MB:1048576,B_to_GB:1073741824},S=Object({NODE_ENV:"production",WEBPACK:!0}),k="https://bluedata-releases.s3.amazonaws.com/kubectl-epic",O="https://storage.googleapis.com/kubernetes-release/release",E=window.location.protocol||"http:",j=S.PORT||8080,D=S.HOST||"127.0.0.1",w={APP_TITLE:{CP:"HPE Ezmeral Container Platform",ML_OPS:"HPE Ezmeral ML Ops"},apiurl:v,sourcepaths:y.a,views:g.a,settings:_,serverUrl:function(e){return""===e?"".concat(E,"//").concat(D,":").concat(j):"https://".concat(D,":").concat(e)},bdSchemas:{label:{title:"Label",type:"object",properties:{name:{type:"string",title:"Name",default:""},description:{type:"string",title:"Description",default:""}}}},method:{GET:"get",POST:"post",PUT:"put",PATCH:"patch",DELETE:"delete",APPLY:"apply",CREATE:"create"},pathToID:["_links","self","href"],op:{SESSION:"current_session_data",MONITORING:"get_monitoring_data",K8S_MONITORING:"get_k8s_monitoring_data",MSEARCH_MONITORING:"get_msearch_monitoring_data",DATA_SOURCE_ACTION:"data_source_action",KEYTAB_ACTION_CREATE:"keytab_action_create",KEYTAB_ACTION_DELETE:"keytab_action_delete",BOOTSTRAP_ACTION_SCRIPT:"bootstrap_action_script",GET_CLUSTER_LOG_DATA:"get_cluster_log_data",NAGIOS_DATA:"get_nagios_data",NAGIOS_ALERTS:"get_nagios_alerts",DNS_LOOKUP:"dns_lookup"},clusterTypes:{training:"AIML/Training",notebook:"AIML/Notebook",deployment:"AIML/Deployment"},autoScaleCategories:["AIML/Training","AIML/Deployment"],applicable_cluster_ops:["create_cluster","edit_cluster","create_template","edit_template"],applicable_graphs:function(e){var t=e.graph,a=e.gpu_usage_supported,r=void 0!==a&&a,n=[];return"tenant"===t?n.push("cpu","memory","network_in","disk_write"):"system"===t?n.push("system_cpu","system_memory","system_swap","system_load","system_network_in","system_network_out"):"k8s-tenant"===t&&n.push("cpu_usage_node_pct_per_pod","cpu_usage_nanocores_per_pod","cpu_pod_usage_limit_pct","mem_usage_node_pct","mem_usage_pod_bytes","mem_usage_limit_pct","network_rx_pod_bytes","network_tx_pod_bytes"),r&&n.push("gpu","gpu_memory_used"),n},kubectlPluginsDownload:function(e){switch(e){case"MacOS":window.location.href="".concat(k,"/").concat("3.2","/").concat("162","/darwin/kubectl-hpecp");break;case"Linux":window.location.href="".concat(k,"/").concat("3.2","/").concat("162","/linux/kubectl-hpecp");break;default:window.location.href="".concat(k,"/").concat("3.2","/").concat("162","/windows/kubectl-hpecp.exe")}},kubectlDownload:function(e,t){switch(e){case"MacOS":window.location.href="".concat(O,"/").concat(t,"/bin/darwin/amd64/kubectl");break;case"Linux":window.location.href="".concat(O,"/").concat(t,"/bin/linux/amd64/kubectl");break;default:window.location.href="".concat(O,"/").concat(t,"/bin/windows/amd64/kubectl.exe")}},TIME_RANGES:[{val:"hour",title:"Last Hour"},{val:"6hr",title:"6 Hour"},{val:"day",title:"Day"},{val:"week",title:"Week"}],TIME_DURATIONS:{hour:"1h","6hr":"6h",day:"1d",week:"1w"},ROLE_NAME:{MEMBER:"Member",ADMIN:"Admin",K8S_ADMIN:"K8S Admin",SITE_ADMIN:"Site Admin"},TENANT_TYPES:{K8S:"k8s",EPIC:"docker"},RESOURCE_TYPES:{CPU:{ID:"cores",TITLE:"Cores",UNIT:"",CONVERT_TO_GB:!1},MEMORY:{ID:"memory",TITLE:"Memory",UNIT:"GB",CONVERT_TO_GB:_.MB_to_GB},GPU:{ID:"gpus",TITLE:"GPU Devices",UNIT:"",CONVERT_TO_GB:!1},EPHEMERAL:{ID:"ephemeral_storage",TITLE:"Ephemeral Storage",UNIT:"GB",CONVERT_TO_GB:_.MB_to_GB},PERSISTENT:{ID:"persistent_storage",TITLE:"Persistent Storage",UNIT:"GB",CONVERT_TO_GB:_.MB_to_GB},TENANT_STORAGE:{ID:"tenant_storage",TITLE:"Tenant Storage",UNIT:"GB",CONVERT_TO_GB:_.MB_to_GB}}},C=a(17),T=a.n(C),P=a(251),A=a.n(P),R=function(e){return T()(N(e))},N=function(e){var t=e.data,a=void 0===t?null:t,r=e.apiurl,n=void 0===r?"":r,o=e.method,i=void 0===o?"get":o,s=e.op,c=void 0===s?"":s,l=e.port,u=void 0===l?"":l,p=e.timeout,d=void 0===p?w.settings.timeout:p,f=e.params,m=void 0===f?"":f,h=e.cancelToken,b=void 0===h?"":h;return{url:w.apiurl.API,method:"post",params:m,data:{method:i,apiurl:w.serverUrl(u)+n,timeout:d>=3e4?(d-1e3)/1e3:d/1e3,data:a,op:c},mimeType:"multipart/form-data",timeout:d,csrfmiddlewaretoken:"csrftoken",xsrfHeaderName:"X-CSRFToken",headers:{"X-CSRFToken":A.a.get("csrftoken")},validateStatus:function(e){return e>=200&&e<270},cancelToken:b}},F=function(){return function(e){return function(t){return"CHAIN"===t.type&&Array.isArray(t.actions)?t.actions.forEach((function(t){return e(t)})):e(t)}}},x=function(){for(var e=arguments.length,t=new Array(e),a=0;a<e;a++)t[a]=arguments[a];return{type:"CHAIN",actions:t}},M=function(e,t){return{type:"".concat("RECEIVE_STATS_DATA",":").concat(e),propVal:e,payload:t||{},receivedAt:Date.now()}},I=function e(t){var a=t.apiUrl,r=void 0===a?"":a,n=t.propVal,o=t.periodic,i=void 0!==o&&o,s=t.op,c=void 0===s?"":s,l=t.cancelToken,u=void 0===l?"":l;return function(t){return R({method:"get",apiurl:r,op:c,cancelToken:u}).then((function(a){var o=a.data;f.a.isHttpStatusOk(o.status_code)||o.redirect&&(window.location.href=o.redirect),t(M(n,f.a.fetchSafeFromObject({path:["data"],obj:a,default_value:{}}))),i&&setTimeout((function(){t(e({apiUrl:r,propVal:n,periodic:i}))}),3e4)})).catch((function(a){f.a.bdLog(a),i?setTimeout((function(){t(e({apiUrl:r,propVal:n,periodic:i}))}),3e4):t(M(n,{}))}))}},U={apiUrl:w.apiurl.INSTALL,propVal:"g_install"},L={op:w.op.SESSION,propVal:"session_data"},B={apiUrl:w.apiurl.STATS,propVal:"g_stats",periodic:!0},H={apiUrl:w.apiurl.LOCK,propVal:"lock_data",periodic:!0},K={apiUrl:w.apiurl.CONFIG_V2,propVal:"g_config_data"},q={apiUrl:w.apiurl.LICENSE,propVal:"license_data"},V={apiUrl:w.apiurl.LICENSE_LEGACY,propVal:"license_legacy_data"},G={apiUrl:w.apiurl.CONFIG_V1,propVal:"g_config_data_v1"};function z(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function W(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?z(Object(a),!0).forEach((function(t){J(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):z(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function J(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}var Y=function(e,t,a){return{type:"".concat("RECEIVE_PAGE_DATA",":").concat(e),propVal:e,payload:t||{},receivedAt:Date.now(),updateProps:a}},$=function(e){return{type:"".concat("DELETE_PAGE_DATA",":").concat(e),propVal:e}},Q=function e(t){var a=t.method,r=void 0===a?"get":a,n=t.apiUrl,o=t.propVal,i=t.op,s=t.data,c=t.periodic,l=void 0!==c&&c,u=t.retry,p=void 0===u?0:u,d=t.port,m=void 0===d?"":d,h=t.cancelToken,b=void 0===h?"":h,v=t.updateProps;return function(t){return R({method:r,apiurl:n,op:i,data:s,port:m,cancelToken:b}).then((function(a){var c=a.data,u=void 0===c?{}:c;f.a.isHttpStatusOk(u.status)||u.redirect&&(window.location.href=u.redirect),t(Y(o,u,v)),l&&setTimeout((function(){t(e({method:r,apiUrl:n,propVal:o,op:i,data:s,periodic:l,retry:p,port:m,cancelToken:b}))}),3e4)})).catch((function(a){T.a.isCancel(a)?f.a.bdLog(a):l||p?setTimeout((function(){t(e({method:r,apiUrl:n,propVal:o,op:i,data:s,periodic:l,retry:p,port:m,cancelToken:b}))}),p||3e4):t(Y(o,{}))}))}},Z=function e(t){var a=t.method,r=void 0===a?"get":a,n=t.apiUrl,o=t.propVal,i=t.op,s=t.data,c=t.periodic,l=void 0!==c&&c,u=t.retry,p=void 0===u?0:u,d=t.port,m=void 0===d?"":d,h=t.cancelToken,b=void 0===h?"":h,v=t.updateProps;return function(t){return R({method:r,apiurl:n,op:i,data:s,port:m,cancelToken:b}).then((function(a){var c=a.data,u=void 0===c?{}:c;f.a.isHttpStatusOk(u.status)||u.redirect&&(window.location.href=u.redirect),t(function(e,t,a){return{type:"".concat("UPDATE_PAGE_DATA_ITEM",":").concat(e,":").concat(a.id),propVal:e,payload:t||{},updateProps:a||{},receivedAt:Date.now()}}(o,u,v)),l&&setTimeout((function(){t(e({method:r,apiUrl:n,propVal:o,op:i,data:s,periodic:l,retry:p,port:m,cancelToken:b,updateProps:v}))}),3e4)})).catch((function(a){T.a.isCancel(a)?f.a.bdLog(a):l||p?setTimeout((function(){t(e({method:r,apiUrl:n,propVal:o,op:i,data:s,periodic:l,retry:p,port:m,cancelToken:b,updateProps:v}))}),p||3e4):t(function(e,t){return{type:"".concat("DELETE_PAGE_DATA_ITEM",":").concat(e),propVal:e,updateProps:t}}(o,v))}))}},X=function e(t){var a=t.method,r=void 0===a?"get":a,n=t.apiUrl,o=t.propVal,i=t.op,s=t.data,c=t.respDataParser,l=t.nextToken,u=void 0===l?"":l,p=t.retry,d=void 0===p?0:p,m=t.port,h=void 0===m?"":m,b=t.cancelToken,v=void 0===b?"":b,y=t.updateProps,g=void 0===y?{}:y;return function(t){return R({method:r,apiurl:"".concat(n).concat(u),op:i,data:s,port:h,cancelToken:v}).then((function(a){var l=a.data,u=void 0===l?{}:l;f.a.isHttpStatusOk(u.status)||u.redirect&&(window.location.href=u.redirect);var p=c(u),m=p.data,b=void 0===m?[]:m,y=p.nextToken,_=void 0===y?"":y,S=W(W({},g),{},{composite:!0});if(t(Y(o,b,S)),_){var k={method:r,apiUrl:n,propVal:o,op:i,data:s,respDataParser:c,retry:d,port:h,cancelToken:v,updateProps:g,nextToken:_};k.updateProps.reset=!1,t(e(k))}})).catch((function(a){if(T.a.isCancel(a))f.a.bdLog(a);else if(d){setTimeout((function(){t(e(r))}),d||3e4)}else{var n=W(W({},g),{},{composite:!0});t(Y(o,[],n))}}))}};function ee(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var a=[],r=!0,n=!1,o=void 0;try{for(var i,s=e[Symbol.iterator]();!(r=(i=s.next()).done)&&(a.push(i.value),!t||a.length!==t);r=!0);}catch(c){n=!0,o=c}finally{try{r||null==s.return||s.return()}finally{if(n)throw o}}return a}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return te(e,t);var a=Object.prototype.toString.call(e).slice(8,-1);"Object"===a&&e.constructor&&(a=e.constructor.name);if("Map"===a||"Set"===a)return Array.from(e);if("Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a))return te(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function te(e,t){(null==t||t>e.length)&&(t=e.length);for(var a=0,r=new Array(t);a<t;a++)r[a]=e[a];return r}function ae(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function re(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?ae(Object(a),!0).forEach((function(t){ne(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):ae(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function ne(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}var oe={ROLE_DATA:{apiUrl:w.apiurl.ROLES,propVal:"role_list"},USER_DATA:{apiUrl:w.apiurl.USERS,propVal:"user_list"},CLUSTER_DATA:{apiUrl:w.apiurl.CLUSTER,propVal:"cluster_list"},CURRENT_CLUSTER_DATA:function(e){return{apiUrl:e,propVal:"current_cluster"}},CLUSTER_NODE_DATA:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];return{apiUrl:w.apiurl.CLUSTER_NODES(e,t),propVal:"cluster_nodes"}},CLUSTER_NAGIOS_DATA:function(e){return{apiUrl:w.apiurl.CLUSTER_NAGIOS(e),propVal:"cluster_nagios"}},CLUSTER_HISTORY_DATA:function(e){return{apiUrl:w.apiurl.CLUSTER_HISTORIES(e),propVal:"cluster_histories"}},ACTION_SCRIPT_DATA:function(e){return{apiUrl:w.apiurl.ACTION_SCRIPTS(e),propVal:"action_scripts"}},CATALOG_DATA:{apiUrl:w.apiurl.CATALOG,propVal:"catalog_list"},FLAVOR_DATA:{apiUrl:w.apiurl.FLAVORS,propVal:"flavor_list"},DATATAP_DATA:{apiUrl:w.apiurl.DCO,propVal:"dataTap_list"},FSMOUNT_DATA:{apiUrl:w.apiurl.FILESYSTEMS,propVal:"fsMount_list"},MODEL_DATA:{apiUrl:w.apiurl.MODEL,propVal:"model_list"},TENANT_DATA:{apiUrl:w.apiurl.TENANT,propVal:"tenant_list"},TENANT_DATA_V1:{apiUrl:w.apiurl.TENANT_V1,propVal:"tenant_list_v1"},USER_TENANT_DATA:function(e){return{apiUrl:w.apiurl.USER_TENANTS(e),propVal:"user_tenants_list"}},CURRENT_TENANT_DATA:function(e){return{apiUrl:e,propVal:"current_tenant_data"}},TENANT_USER_DATA:function(e){return{apiUrl:w.apiurl.TENANT_USERS(e),propVal:"tenant_users"}},NODE_DATA:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return{apiUrl:w.apiurl.NODE(e),propVal:"node_list"}},PROJECT_REPO_DATA:function(e){return{apiUrl:w.apiurl.PROJECT_REPO(e),propVal:"project_repo"}},SOURCE_CONTROL_DATA:function(e){return{apiUrl:w.apiurl.SOURCE_CONTROL(e),propVal:"source_control"}},TENANT_ACLS_DATA:function(e){return{apiUrl:w.apiurl.TENANT_ACLS(e),propVal:"tenant_acls"}},K8SHOST_DATA:{apiUrl:w.apiurl.K8SHOST,propVal:"k8shost_list",updateProps:{pathToItems:["_embedded","k8shosts"],pathToID:w.pathToID}},UPDATE_K8SHOST_DATA_ITEM:function(e,t){return{apiUrl:e,propVal:"k8shost_list",timeout:12e4,updateProps:{id:e,pathToItems:["_embedded","k8shosts"],pathToID:w.pathToID,cancelToken:t}}},UPDATE_CLUSTER_HOST:function(e,t){return{apiUrl:e,propVal:"k8scluster_host_list",updateProps:{id:e,pathToID:w.pathToID,cancelToken:t}}},EPICHOST_DATA:{apiUrl:w.apiurl.EPICHOST,propVal:"epichost_list"},PNODE_LIST_DATA:{apiUrl:w.apiurl.PNODE_LIST,propVal:"pnode_list"},NAGIOS_DATA:function(e){var t=e.filter,a=e.host_type,r=e.fresh,n=e.cluster,o=void 0===n?"":n;return{op:w.op.NAGIOS_DATA,data:re(re({},t.length?[{filter:t}]:[]),{},{host_type:a,fresh:r,cluster:o}),propVal:"nagios_data".concat(o?"_".concat(o):""),updateProps:{pathToItems:["k8s_hosts"],pathToID:["host_name"]}}},NAGIOS_ALERTS:function(e){var t=e.filter;return{op:w.op.NAGIOS_ALERTS,data:{filter:t},propVal:"nagios_alerts"}},K8SCLUSTER_DATA:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return{apiUrl:w.apiurl.K8SCLUSTER(e),propVal:"k8scluster_list"}},CURRENT_K8SCLUSTER_DATA:function(e){return{apiUrl:e,propVal:"current_k8scluster_data"}},METRICS_PARAM_DATA:{apiUrl:w.apiurl.METRICS_PARAMS,propVal:"metrics_params"},HOSTSTAGS:{apiUrl:w.apiurl.HOST_TAGS,propVal:"hosts_tags"},WEBTERM_DATA:{apiUrl:w.apiurl.WEBTERMS,propVal:"webterm_list"},CURRENT_WEBTERM:function(e){return{apiUrl:w.apiurl.CURRENT_WEBTERM(e),propVal:"current_webterm"}},INFOSIGHT_DATA:{apiUrl:w.apiurl.CONFIG_V2,propVal:"infosight_data"},K8S_KD_APPS_DATA:function(e){var t=e.namespace,a=e.port;return{apiUrl:w.apiurl.K8S_KD_APPS(t),propVal:"k8s_kd_apps_list",port:a}},K8S_KD_APP_DATA:function(e){return{apiUrl:e.apiUrl,propVal:"k8s_kd_app_data",port:e.port}},K8S_KD_CLUSTERS_DATA:function(e){var t=e.namespace,a=e.port;return{apiUrl:w.apiurl.K8S_KD_CLUSTERS(t),propVal:"k8s_kd_clusters_list",port:a}},K8S_PODS_DATA:function(e){var t=e.namespace,a=e.port,r=e.params,n=e.propVal,o=e.cancelToken,i=e.respDataParser,s=e.updateProps;return{apiUrl:w.apiurl.K8S_PODS(t,r),propVal:n||"k8s_pods_list",port:a,cancelToken:o,respDataParser:i,updateProps:s}},K8S_POD_DATA:function(e){var t=e.namespace,a=e.port,r=e.podName;return{apiUrl:w.apiurl.K8S_POD(t,r),propVal:"k8s_pod_data",port:a}},K8S_SERVICES:function(e){var t=e.namespace,a=e.port;return{apiUrl:w.apiurl.K8S_SERVICES(t),propVal:"k8s_services_list",port:a}},K8S_SERVICE:function(e){var t=e.namespace,a=e.port,r=e.podName;return{apiUrl:w.apiurl.K8S_SERVICE(t,r),propVal:"k8s_service_data",port:a}},K8S_STATEFULSETS_DATA:function(e){var t=e.namespace,a=e.port;return{apiUrl:w.apiurl.K8S_STATEFULSETS(t),propVal:"k8s_statefulset_list",port:a}},K8S_STATEFULSET_DATA:function(e){var t=e.namespace,a=e.port,r=e.podName;return{apiUrl:w.apiurl.K8S_STATEFULSET(t,r),propVal:"k8s_statefulset_data",port:a}},K8S_MANIFEST:{apiUrl:w.apiurl.K8S_MANIFEST,propVal:"k8s_manifest"},K8S_CONFIG_MAP:function(e){var t=e.namespace,a=e.port,r=e.params,n=e.propVal,o=Object.entries(r).map((function(e){var t=ee(e,2),a=t[0],r=t[1];return"".concat(a,"=").concat(r)})).join(",");return{apiUrl:w.apiurl.K8S_CONFIG_MAP(t,{labelSelector:o}),propVal:n,port:a}},CURRENT_K8S_CONFIG_MAP:function(e){var t=e.namespace,a=e.port,r=e.name,n=e.propVal,o=void 0===n?"current_config_map":n;return{apiUrl:"".concat(w.apiurl.K8S_CONFIG_MAP(t)).concat(r),propVal:o,port:a}}},ie=a(5),se=a.n(ie),ce=a(243),le=a.n(ce),ue=a(349),pe=a.n(ue),de=a(185),fe=a.n(de),me=a(6),he=a.n(me),be=a(241),ve=a.n(be),ye=a(244),ge=a.n(ye),_e=a(50),Se=a.n(_e),ke=a(28),Oe=a(47),Ee=a.n(Oe);function je(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}var De=w.settings.webapp.sidebar,we=w.settings.webapp.navbar.height,Ce=function(e){return{sidebarDrawer:{maxWidth:De.expanded.width,flexShrink:0,height:"100vh",paddingTop:we},drawerPaper:je({position:"relative",whiteSpace:"nowrap",width:De.expanded.width,paddingTop:4*e.spacing.unit,borderRight:"none",transition:e.transitions.create("width",{easing:e.transitions.easing.sharp,duration:e.transitions.duration.enteringScreen}),overflow:"visible"},e.breakpoints.down("sm"),{width:De.collapsed.width}),drawerPaperClose:je({},e.breakpoints.down("sm"),{display:"none"}),list:je({padding:"0 ".concat(.5*e.spacing.unit,"px ")},e.breakpoints.down("sm"),{padding:0}),listItem:{padding:0},titleItem:{padding:e.spacing.unit},link:je({width:"100%",display:"flex",alignItems:"center",justifyContent:"start",textDecoration:"none",color:e.typography.fontColor,fontSize:e.typography.fontSizeMedium,fontFamily:e.typography.fontFamilySemiBold,padding:"0 ".concat(e.spacing.unit,"px"),height:5*e.spacing.unit,"&:hover":{background:e.palette.gray200}},e.breakpoints.down("sm"),{padding:"".concat(.5*e.spacing.unit,"px ").concat(.5*e.spacing.unit,"px")}),activeLink:{color:e.palette.primary.main},sidebarTitle:{fontFamily:e.typography.fontFamilyLight,fontSize:e.typography.fontSizeMLarge,whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"},title:{display:"inline-block",overflow:"hidden",padding:0,color:"inherit",transition:e.transitions.create("width",{easing:e.transitions.easing.sharp,duration:e.transitions.duration.enteringScreen}),fontSize:e.typography.fontSizeMedium},badge:je({background:e.palette.gray200,color:e.typography.fontColor,borderRadius:"10%",height:3*e.spacing.unit,minWidth:3*e.spacing.unit,fontSize:e.typography.fontSizeSmall,fontFamily:e.typography.fontFamily,textAlign:"center",padding:"".concat(.5*e.spacing.unit,"px ").concat(.8*e.spacing.unit,"px"),lineHeight:1,position:"absolute",right:.5*e.spacing.unit,".sidebarLink:hover &":{background:e.palette.gray400}},e.breakpoints.down("sm"),{display:"none"}),miniSwitch:je({display:"none",position:"absolute",top:we,width:De.collapsed.width,padding:"0 ".concat(2.5*e.spacing.unit,"px"),height:2*e.spacing.unit,lineHeight:"".concat(2*e.spacing.unit,"px"),cursor:"pointer",zIndex:1201,"& .icon":{background:e.palette.primary.main,color:e.palette.white,transform:"scale(2.25, 1)",padding:"0 ".concat(.5*e.spacing.unit,"px ").concat(.75*e.spacing.unit,"px"),borderBottomRightRadius:.25*e.spacing.unit,borderBottomLeftRadius:.25*e.spacing.unit}},e.breakpoints.down("sm"),{display:"block"})}},Te=a(1460),Pe=function(e){var t=e.title,a=e.to,r=e.badge,o=e.redirect,i=void 0!==o&&o,s=Object(ke.withStyles)(Ce)((function(e){return n.a.createElement(Ee.a,{key:a,className:e.classes.listItem,button:!0},i?n.a.createElement("a",{href:a,className:se()(e.classes.link,"sidebarLink")},n.a.createElement("span",{className:se()(e.classes.title,"sidebarTitle")},t),"number"==typeof r?n.a.createElement("span",{className:se()(e.classes.badge,"sidebarBadge")},r):""):n.a.createElement(Te.a,{to:a,exact:!0,activeClassName:e.classes.activeLink,className:se()(e.classes.link,"sidebarLink")},n.a.createElement("span",{className:se()(e.classes.title,"sidebarTitle")},t),"number"==typeof r?n.a.createElement("span",{className:se()(e.classes.badge,"sidebarBadge")},r):""))}));return n.a.createElement(s,null)};Pe.propTypes={classes:u.a.object,title:u.a.string.isRequired,to:u.a.string.isRequired,badge:u.a.number,redirect:u.a.bool};var Ae=Pe,Re=a(46),Ne=a.n(Re),Fe=function(e){var t,a,r;switch(e.type){case"brand_logo":t=80,a=24,r="0 0 200 60";break;case"nav_icon":t=32,a=32,r="0 0 32 32";break;default:t=24,a=24,r="0 0 24 24"}var o=Object(ke.withStyles)((function(){return{bdsIcons:{width:t,height:a,fill:"inherit"}}}))((function(e){return n.a.createElement(Ne.a,{className:se()(e.classes.bdsIcons,"bdsIcons"),viewBox:r},e.children)})),i=Me(e.name);return n.a.createElement(o,null,i)};Fe.propTypes={children:u.a.node,classes:u.a.object,name:u.a.string.isRequired,type:u.a.string};var xe=Fe,Me=function(e){var t;switch(e){case"hpe":t=n.a.createElement("g",null,n.a.createElement("title",null,"HPE logo"),n.a.createElement("path",{fill:"#00B388",d:"m1.654497,1.999997l0,56.49608l0.001715,0l196.689295,0l0,-56.49608l-196.69101,0zm184.398143,44.204929l-172.101847,0l0,-31.912062l172.103562,0l0,31.912062l-0.001715,0z"}));break;case"moreInfo":t=n.a.createElement("g",null,n.a.createElement("title",null,"More info"),n.a.createElement("rect",{height:"2.36818",width:"2.18601",y:"3.87646",x:"11.07398",fill:"inherit"}),n.a.createElement("rect",{height:"12.47849",width:"2.24674",y:"8.40029",x:"11.04362",fill:"inherit"}),n.a.createElement("path",{d:"m0.81857,11.98736l0,0c0,-6.1958 5.02269,-11.2185 11.2185,-11.2185l0,0c2.97533,0 5.8288,1.18195 7.93268,3.28583c2.10387,2.10387 3.28582,4.95734 3.28582,7.93267l0,0c0,6.19581 -5.02269,11.2185 -11.2185,11.2185l0,0c-6.1958,0 -11.2185,-5.02269 -11.2185,-11.2185zm1.44965,0.06077c-0.0306,6.1949 4.84942,9.98134 9.85994,9.82948c5.01052,-0.15186 9.82951,-4.30223 9.76877,-9.89026c-0.06073,-5.58804 -5.18309,-9.8296 -9.79936,-9.8296c-4.61627,0 -9.79875,3.69548 -9.82935,9.89038z",fill:"inherit"}));break;case"caretDown":t=n.a.createElement("g",null,n.a.createElement("path",{d:"M7 10l5 5 5-5z"}));break;default:t=n.a.createElement("g",null)}return t},Ie=a(8),Ue=a.n(Ie),Le=a(94),Be=a.n(Le),He=a(73),Ke=a.n(He),qe=a(37),Ve=a.n(qe),Ge=a(93),ze=a.n(Ge),We=a(95),Je=a.n(We);function Ye(e){return(Ye="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function $e(){return($e=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var r in a)Object.prototype.hasOwnProperty.call(a,r)&&(e[r]=a[r])}return e}).apply(this,arguments)}function Qe(e,t){for(var a=0;a<t.length;a++){var r=t[a];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Ze(e,t){return(Ze=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Xe(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=at(e);if(t){var n=at(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return et(this,a)}}function et(e,t){return!t||"object"!==Ye(t)&&"function"!=typeof t?tt(e):t}function tt(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function at(e){return(at=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function rt(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}var nt=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Ze(e,t)}(i,e);var t,a,r,o=Xe(i);function i(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),rt(tt(t=o.call(this,e)),"onClick",(function(e){"BUTTON"!==e.target.nodeName?t.handleClose():t.setState({open:!t.state.open})})),rt(tt(t),"onMouseEnter",(function(e){"BUTTON"!==e.target.nodeName&&t.setState({insideMenu:!0}),t.setState({open:!0})})),rt(tt(t),"onMouseLeave",(function(e){"BUTTON"!==e.target.nodeName?t.handleClose():setTimeout((function(){!t.state.insideMenu&&t.handleClose()}),200)})),rt(tt(t),"handleClose",(function(){t.setState({open:!1,insideMenu:!1})})),t.state={open:!1,insideMenu:!1},t}return t=i,(a=[{key:"render",value:function(){var e=this,t=this.props,a=t.title,r=t.classes,o=t.children,i=t.noTop,s=void 0!==i&&i,c=t.noBottom,l=void 0!==c&&c,u=this.state.open;return n.a.createElement("div",null,n.a.createElement(Ue.a,{buttonRef:function(t){e.anchorEl=t},"aria-owns":u?"menu-list-grow":void 0,"aria-haspopup":"true",onMouseEnter:this.onMouseEnter,onMouseLeave:this.onMouseLeave,onClick:this.onClick,className:r.menuButton},a),n.a.createElement(ze.a,{open:u,anchorEl:this.anchorEl,placement:"bottom-end",transition:!0,disablePortal:!0},(function(t){var a,i=t.TransitionProps;return n.a.createElement(Ke.a,$e({},i,{id:"menu-list-grow",className:r.transformCenter}),n.a.createElement(Ve.a,null,n.a.createElement(Be.a,{onClickAway:e.handleClose},n.a.createElement(Je.a,{onMouseEnter:e.onMouseEnter,onMouseLeave:e.onMouseLeave,onClick:e.onClick,className:se()(r.MenuList,(a={},rt(a,r.noTop,s),rt(a,r.noBottom,l),a))},o))))})))}}])&&Qe(t.prototype,a),r&&Qe(t,r),i}(r.Component);rt(nt,"propTypes",{classes:u.a.object.isRequired,children:u.a.node,title:u.a.node,noTop:u.a.bool,noBottom:u.a.bool});var ot=Object(ke.withStyles)((function(e){return{paper:{marginRight:2*e.spacing.unit},MenuList:{border:"1px solid ".concat(e.palette.gray300),"& hr":{color:e.palette.gray300}},noTop:{paddingTop:0},noBottom:{paddingBottom:0},transformCenter:{transformOrigin:"center top"},menuButton:{color:e.palette.white,minWidth:"auto",minHeight:"auto",padding:0}}}))(nt),it=a(3),st=a.n(it),ct=a(29),lt=a.n(ct);function ut(e){return(ut="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function pt(){return(pt=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var r in a)Object.prototype.hasOwnProperty.call(a,r)&&(e[r]=a[r])}return e}).apply(this,arguments)}function dt(e,t){for(var a=0;a<t.length;a++){var r=t[a];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function ft(e,t){return(ft=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function mt(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=vt(e);if(t){var n=vt(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return ht(this,a)}}function ht(e,t){return!t||"object"!==ut(t)&&"function"!=typeof t?bt(e):t}function bt(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function vt(e){return(vt=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function yt(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}var gt=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&ft(e,t)}(i,e);var t,a,r,o=mt(i);function i(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),yt(bt(t=o.call(this,e)),"handleToggle",(function(){t.setState((function(e){return{open:!e.open}}))})),yt(bt(t),"handleClose",(function(){t.setState({open:!1})})),yt(bt(t),"handleClickAway",(function(e){var a=e.target;a!==t.anchorEl&&a.parentNode!==t.anchorEl&&a.parentNode.parentNode!==t.anchorEl&&t.handleClose()})),t.state={open:!1},t}return t=i,(a=[{key:"render",value:function(){var e=this,t=this.props,a=t.title,r=t.classes,o=t.variant,i=t.color,s=t.menuList,c=t.operation,l=void 0===c?"":c,u=t.disabled,p=void 0!==u&&u,d=this.state.open,f="clusterOp"===l,m="clusterActions"===l;return n.a.createElement("div",{className:f?r.bdMenu:m?r.clusterActionMenu:""},n.a.createElement(Ue.a,{buttonRef:function(t){e.anchorEl=t},"aria-owns":d?"menu-list-grow":void 0,"aria-haspopup":"true",onClick:this.handleToggle,className:r.menuButton,variant:o,color:i,disabled:p},a," ",n.a.createElement("span",{className:se()("icon icon-chevron-down",r.btnIcon)})),n.a.createElement(ze.a,{className:r.tooltip,open:d,anchorEl:this.anchorEl,placement:"bottom-end",transition:!0,disablePortal:!0},(function(t){var a=t.TransitionProps;return n.a.createElement(Ke.a,pt({},a,{id:"menu-list-grow",className:r.transformCenter}),n.a.createElement(Ve.a,null,n.a.createElement(Be.a,{onClickAway:e.handleClickAway},n.a.createElement(Je.a,{onClick:e.onClick,className:r.MenuList},s.map((function(t,a){return n.a.createElement(lt.a,{key:a,onClick:function(){e.handleClose(),"function"==typeof t.onClick&&t.onClick()}},n.a.createElement(st.a,null,t.icon?n.a.createElement("span",{className:se()("icon",t.icon,r.icon)}):"",t.label))}))))))})))}}])&&dt(t.prototype,a),r&&dt(t,r),i}(r.Component);yt(gt,"propTypes",{classes:u.a.object.isRequired,title:u.a.string.isRequired,variant:u.a.string.isRequired,color:u.a.string.isRequired,menuList:u.a.array.isRequired,disabled:u.a.bool,operation:u.a.string});var _t=he()((function(e){return{tooltip:{zIndex:1001,minWidth:20*e.spacing.unit},paper:{marginRight:2*e.spacing.unit},MenuList:{border:"1px solid ".concat(e.palette.gray200)},transformCenter:{transformOrigin:"center top"},btnIcon:{paddingLeft:e.spacing.unit},icon:{paddingRight:.5*e.spacing.unit},bdMenu:{position:"absolute",right:3*e.spacing.unit,zIndex:1e3},clusterActionMenu:{marginLeft:e.spacing.unit}}}))(gt),St=a(11);function kt(e){return(kt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Ot(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Et(e,t){for(var a=0;a<t.length;a++){var r=t[a];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function jt(e,t){return(jt=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Dt(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=Ct(e);if(t){var n=Ct(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return wt(this,a)}}function wt(e,t){return!t||"object"!==kt(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Ct(e){return(Ct=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var Tt,Pt,At,Rt=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&jt(e,t)}(i,e);var t,a,r,o=Dt(i);function i(){return Ot(this,i),o.apply(this,arguments)}return t=i,(a=[{key:"render",value:function(){var e=this.props,t=e.title,a=e.subComponent,r=void 0===a?null:a,o=e.subTitle,i=void 0===o?"":o,s=e.classes,c=e.variant,l=void 0===c?"default":c,u=e.icon;return n.a.createElement("div",{className:se()(s.pageTitle,s[l])},n.a.createElement(St.Typography,{className:se()(s.title,s["".concat(l,"Title")]),variant:"h1",gutterBottom:!0},!!u&&u,t),r||"",i?n.a.createElement("div",{className:s.subTitle},n.a.createElement(St.Typography,{className:s.subTitleText},i)):"")}}])&&Et(t.prototype,a),r&&Et(t,r),i}(r.Component);Tt=Rt,Pt="propTypes",At={classes:u.a.object,title:u.a.string.isRequired,subComponent:u.a.node,subTitle:u.a.string,variant:u.a.oneOf(["default","secondary"]),icon:u.a.node},Pt in Tt?Object.defineProperty(Tt,Pt,{value:At,enumerable:!0,configurable:!0,writable:!0}):Tt[Pt]=At;var Nt=Object(ke.withStyles)((function(e){return{pageTitle:{display:"flex",marginBottom:2*e.spacing.unit,flexWrap:"wrap","& [class^='BdStatusLabel']":{position:"relative",paddingTop:e.spacing.unit,paddingLeft:e.spacing.unit},justifyContent:"space-between"},title:{margin:0,paddingRight:.5*e.spacing.unit,fontSize:2.25*e.typography.fontSize,fontFamily:e.typography.fontFamilyLight},subTitle:{flex:"0 0 100%"},secondary:{margin:"".concat(4*e.spacing.unit,"px 0 ").concat(2*e.spacing.unit,"px")},secondaryTitle:{fontSize:e.typography.fontSizeXLarge}}}))(Rt),Ft=a(245),xt=a.n(Ft),Mt=a(127);function It(e){return(It="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Ut(e,t){for(var a=0;a<t.length;a++){var r=t[a];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Lt(e,t){return(Lt=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Bt(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=qt(e);if(t){var n=qt(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return Ht(this,a)}}function Ht(e,t){return!t||"object"!==It(t)&&"function"!=typeof t?Kt(e):t}function Kt(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function qt(e){return(qt=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var Vt=Mt.c().sort(null),Gt=Mt.a().innerRadius(52.5).outerRadius(36.75),zt=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Lt(e,t)}(i,e);var t,a,r,o=Bt(i);function i(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),(t=o.call(this,e)).getUsed=t.getUsed.bind(Kt(t)),t}return t=i,(a=[{key:"componentDidMount",value:function(){this.createChart()}},{key:"componentDidUpdate",value:function(e){var t=this.props,a=t.used,r=t.total;e.used===a&&e.total===r||this.updateChart()}},{key:"calcPercent",value:function(e){return[e,100-e]}},{key:"getUsed",value:function(){var e=this.props,t=e.used,a=e.convert_gb,r=void 0!==a&&a;return t?r?f.a.roundNumber(t/r):t:0}},{key:"createChart",value:function(){var e=this.props,t=e.color,a=e.total,r=e.used,n=[t,"#F1F1F1"],o=a?f.a.roundNumber(100*r/a):0,i={lower:this.calcPercent(0),upper:this.calcPercent(o)},s=Mt.d(this.node).append("svg").attr("width",105).attr("height",105).append("g").attr("transform","translate(52.5,52.5)");s.selectAll("path").data(Vt(i.lower)).enter().append("path").attr("fill",(function(e,t){return n[t]})).attr("d",Gt).each((function(e){this._current=e})),s.append("svg:text").attr("dy",10).attr("text-anchor","middle").style("fill","#333").style("font-size","24px").style("font-family","MetricHPE-Web-Light"),this.updateChart()}},{key:"updateChart",value:function(){var e=this,t=this.props,a=t.total,r=t.used,n=a?f.a.roundNumber(100*r/a):0;Mt.d(this.node).selectAll("text").text("".concat(n,"%"));var o=this.calcPercent(n),i=setTimeout((function(){clearTimeout(i),Mt.d(e.node).selectAll("path").data(Vt(o)).transition().duration(500).attrTween("d",(function(e){var t=Mt.b(this._current,e);return this._current=t(0),function(e){return Gt(t(e))}}))}),200)}},{key:"render",value:function(){var e=this,t=this.props,a=t.classes,r=t.title,o=t.total,i=t.unit,s=t.used,c=t.convert_gb,l=void 0!==c&&c,u=t.applicable,p=void 0===u||u,d=o?l?f.a.roundNumber(o/l):o:0,m=s?l?f.a.roundNumber(s/l):s:0;return n.a.createElement(xt.a,{className:a.widget},n.a.createElement("div",{className:a.donut,ref:function(t){e.node=t}}),n.a.createElement(St.Typography,{className:a.title},r),n.a.createElement(St.Typography,{className:a.subtitle},p?"".concat(m," of ").concat(d," ").concat(i?"(".concat(i,")"):""):"N/A"))}}])&&Ut(t.prototype,a),r&&Ut(t,r),i}(r.Component);!function(e,t,a){t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a}(zt,"propTypes",{classes:u.a.object.isRequired,color:u.a.string.isRequired,used:u.a.oneOfType([u.a.number,u.a.string]).isRequired,total:u.a.oneOfType([u.a.number,u.a.string]).isRequired,title:u.a.string.isRequired,unit:u.a.string,convert_gb:u.a.oneOfType([u.a.number,u.a.bool]),applicable:u.a.bool});var Wt=he()((function(e){return{widget:{width:150,height:150,padding:0,textAlign:"center",margin:"".concat(3*e.spacing.unit,"px ").concat(1.25*e.spacing.unit,"px 0"),display:"flex",justifyContent:"center","& >div":{overflow:"visible"}},donut:{display:"inline-block",width:105,height:105},title:{color:e.typography.fontColor,whiteSpace:"nowrap"},subtitle:{color:e.palette.gray700,whiteSpace:"nowrap"}}}))(zt),Jt=a(705),Yt=a.n(Jt);function $t(e){return($t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Qt(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function Zt(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?Qt(Object(a),!0).forEach((function(t){oa(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):Qt(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function Xt(e,t){for(var a=0;a<t.length;a++){var r=t[a];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function ea(e,t){return(ea=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function ta(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=na(e);if(t){var n=na(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return aa(this,a)}}function aa(e,t){return!t||"object"!==$t(t)&&"function"!=typeof t?ra(e):t}function ra(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function na(e){return(na=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function oa(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}var ia=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&ea(e,t)}(i,e);var t,a,r,o=ta(i);function i(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),(t=o.call(this,e)).state={tableState:{}},t.customToolbarSelect=t.customToolbarSelect.bind(ra(t)),t.isRowSelectable=t.isRowSelectable.bind(ra(t)),t.customSort=t.customSort.bind(ra(t)),t}return t=i,(a=[{key:"customToolbarSelect",value:function(e){var t=this.props,a=t.data,r=t.options,n=e.data.map((function(e){return Zt(Zt({},e),{},{rowData:a[e.dataIndex]})}));return r.customToolbarSelect(Zt(Zt({},e),{},{data:n}))}},{key:"isRowSelectable",value:function(e){var t=this.props,a=t.data;return t.options.isRowSelectable(e,a[e])}},{key:"customSort",value:function(e,t,a){if(!e.length)return e;var r=this.props.options,n=r.customSort,o=void 0===n?{}:n;return"function"==typeof o?r.customSort(e,t,a):!f.a.isEmptyObject(o)&&o[t]?o[t](e,a):f.a.bdSort(e,["data",t],a)}},{key:"render",value:function(){var e=this,t=this.props,a=t.columns,r=t.data,o=t.title,i=t.options,s=this.state.tableState,c=void 0===s?{}:s,l=i.count||r.length,u=l<1?"none":"multiple",p={responsive:"scrollFullHeight",rowsPerPageOptions:[5,10,15,25,50],print:!1,download:!1,viewColumns:!1,filter:!1,rowsPerPage:f.a.fetchSafeFromObject({path:["rowsPerPage"],obj:c,default_value:10}),search:l>10,pagination:l>10},d=Zt(Zt(Zt(Zt(Zt({},i),i.customToolbarSelect&&{customToolbarSelect:this.customToolbarSelect}),i.isRowSelectable&&{isRowSelectable:this.isRowSelectable}),{},{customSort:this.customSort},i.serverSide&&{rowsSelected:i.rowsSelected}),{},{selectableRows:l>0&&i.selectableRows||u,onTableChange:function(t,a){"propsUpdate"!==t&&(e.setState({tableState:a}),i.onTableChange&&i.onTableChange(t,a))}});return n.a.createElement(Yt.a,{title:o,data:r,columns:a,options:Zt(Zt({},p),d)})}}])&&Xt(t.prototype,a),r&&Xt(t,r),i}(r.Component);oa(ia,"propTypes",{children:u.a.node,columns:u.a.array,data:u.a.array,title:u.a.string,options:u.a.object});var sa=ia,ca=a(188),la=function(e){var t=e.closeToast;return n.a.createElement("span",{className:"icon icon-cross",onClick:t})};la.propTypes={closeToast:u.a.func};var ua=function(){return n.a.createElement(ca.ToastContainer,{position:"top-right",closeOnClick:!0,draggable:!0,pauseOnHover:!0,closeButton:n.a.createElement(la,null)})},pa=a(187),da=a.n(pa);function fa(e){return(fa="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function ma(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function ha(e,t){for(var a=0;a<t.length;a++){var r=t[a];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function ba(e,t){return(ba=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function va(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=ga(e);if(t){var n=ga(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return ya(this,a)}}function ya(e,t){return!t||"object"!==fa(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function ga(e){return(ga=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function _a(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}var Sa=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&ba(e,t)}(s,e);var t,a,o,i=va(s);function s(){return ma(this,s),i.apply(this,arguments)}return t=s,(a=[{key:"render",value:function(){var e=this.props,t=e.title,a=void 0===t?"":t,o=e.variant,i=e.children,s=e.placement,c=void 0===s?"top":s,l=e.disableHoverListener,u=void 0!==l&&l,p=e.classes,d=e.fit,f=void 0===d?"default":d;return n.a.createElement(r.Fragment,null,a?n.a.createElement(da.a,{title:n.a.createElement("div",null,a.split("\n").map((function(e,t){return n.a.createElement(st.a,{variant:"caption",key:t},e)}))),disableFocusListener:!0,disableHoverListener:u,placement:c,PopperProps:{variant:o},TransitionProps:{timeout:{enter:0,exit:0}}},n.a.createElement("span",{className:se()(p.tip,"tip-".concat(o),"tip-".concat(c),_a({},p.full,"full"===f))},i)):i)}}])&&ha(t.prototype,a),o&&ha(t,o),s}(r.Component);_a(Sa,"propTypes",{classes:u.a.object,variant:u.a.oneOf(["primary","info","success","warning","error"]),title:u.a.string,children:u.a.node,placement:u.a.string,disableHoverListener:u.a.bool,fit:u.a.oneOf(["default","full"])});var ka=he()((function(e){return{tip:{position:"relative",display:"inline-block","&:hover":{"&::before":{display:"block"}},"&::before":{display:"none",content:"''",position:"absolute",borderStyle:"solid"},"&.tip-top":{"&::before":{top:"-".concat(e.spacing.unit,"px"),left:"50%",transform:"translateX(-50%)",width:2*e.spacing.unit,height:e.spacing.unit,borderWidth:"".concat(e.spacing.unit,"px ").concat(e.spacing.unit,"px 0 ").concat(e.spacing.unit,"px"),borderColor:"transparent"},"&.tip-primary::before":{borderTopColor:e.palette.primary.main},"&.tip-secondary::before":{borderTopColor:e.palette.secondary.main},"&.tip-info::before":{borderTopColor:e.palette.info.main},"&.tip-success::before":{borderTopColor:e.palette.success.main},"&.tip-warning::before":{borderTopColor:e.palette.warning.main},"&.tip-error::before":{borderTopColor:e.palette.error.main},"&.tip-default::before":{borderTopColor:e.palette.gray600}},"&.tip-bottom":{"&::before":{bottom:"-".concat(e.spacing.unit,"px"),left:"50%",transform:"translateX(-50%)",width:2*e.spacing.unit,height:e.spacing.unit,borderWidth:"0 ".concat(e.spacing.unit,"px ").concat(e.spacing.unit,"px ").concat(e.spacing.unit,"px"),borderColor:"transparent"},"&.tip-primary::before":{borderBottomColor:e.palette.primary.main},"&.tip-secondary::before":{borderBottomColor:e.palette.secondary.main},"&.tip-info::before":{borderBottomColor:e.palette.info.main},"&.tip-success::before":{borderBottomColor:e.palette.success.main},"&.tip-warning::before":{borderBottomColor:e.palette.warning.main},"&.tip-error::before":{borderBottomColor:e.palette.error.main},"&.tip-default::before":{borderBottomColor:e.palette.gray600}},"&.tip-right":{"&::before":{right:"-".concat(1.75*e.spacing.unit,"px"),top:"50%",transform:"translateY(-50%)",width:e.spacing.unit,height:2*e.spacing.unit,borderWidth:"".concat(e.spacing.unit,"px ").concat(e.spacing.unit,"px ").concat(e.spacing.unit,"px 0"),borderColor:"transparent"},"&.tip-primary::before":{borderRightColor:e.palette.primary.main},"&.tip-secondary::before":{borderRightColor:e.palette.secondary.main},"&.tip-info::before":{borderRightColor:e.palette.info.main},"&.tip-success::before":{borderRightColor:e.palette.success.main},"&.tip-warning::before":{borderRightColor:e.palette.warning.main},"&.tip-error::before":{borderRightColor:e.palette.error.main},"&.tip-default::before":{borderRightColor:e.palette.gray600}},"&.tip-left":{"&::before":{left:"-".concat(e.spacing.unit,"px"),top:"50%",transform:"translateY(-50%)",width:e.spacing.unit,height:2*e.spacing.unit,borderWidth:"".concat(e.spacing.unit,"px 0 ").concat(e.spacing.unit,"px ").concat(e.spacing.unit,"px"),borderColor:"transparent"},"&.tip-primary::before":{borderLeftColor:e.palette.primary.main},"&.tip-secondary::before":{borderLeftColor:e.palette.secondary.main},"&.tip-info::before":{borderLeftColor:e.palette.info.main},"&.tip-success::before":{borderLeftColor:e.palette.success.main},"&.tip-warning::before":{borderLeftColor:e.palette.warning.main},"&.tip-error::before":{borderLeftColor:e.palette.error.main},"&.tip-default::before":{borderLeftColor:e.palette.gray600}}},full:{width:"100%"}}}))(Sa),Oa=a(65),Ea=a.n(Oa);function ja(e){return(ja="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Da(){return(Da=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var r in a)Object.prototype.hasOwnProperty.call(a,r)&&(e[r]=a[r])}return e}).apply(this,arguments)}function wa(e,t){for(var a=0;a<t.length;a++){var r=t[a];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Ca(e,t){return(Ca=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Ta(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=Ra(e);if(t){var n=Ra(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return Pa(this,a)}}function Pa(e,t){return!t||"object"!==ja(t)&&"function"!=typeof t?Aa(e):t}function Aa(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Ra(e){return(Ra=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Na(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}var Fa=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Ca(e,t)}(i,e);var t,a,r,o=Ta(i);function i(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),Na(Aa(t=o.call(this,e)),"handlePopoverOpen",(function(e){t.setState({anchorEl:e.currentTarget})})),Na(Aa(t),"handlePopoverClose",(function(){t.setState({anchorEl:null})})),Na(Aa(t),"getPosition",(function(e){var t={};switch(e){case"top":t={anchorOrigin:{vertical:"top",horizontal:"center"},transformOrigin:{vertical:"bottom",horizontal:"center"}};break;case"bottom":t={anchorOrigin:{vertical:"bottom",horizontal:"center"},transformOrigin:{vertical:"top",horizontal:"center"}};break;case"left":t={anchorOrigin:{vertical:"center",horizontal:"left"},transformOrigin:{vertical:"center",horizontal:"right"}};break;case"right":t={anchorOrigin:{vertical:"center",horizontal:"right"},transformOrigin:{vertical:"center",horizontal:"left"}}}return t})),t.state={anchorEl:null},t}return t=i,(a=[{key:"render",value:function(){var e=this.state.anchorEl,t=Boolean(e),a=this.props,r=a.title,o=a.classes,i=a.children,s=a.direction,c=void 0===s?"right":s,l=this.getPosition(c);return n.a.createElement("span",null,n.a.createElement("div",{"aria-owns":t?"mouse-over-popover":void 0,"aria-haspopup":"true",onMouseEnter:this.handlePopoverOpen,onMouseLeave:this.handlePopoverClose,className:o.title},r),n.a.createElement(Ea.a,Da({id:"mouse-over-popover",className:o.popover,classes:{paper:o.paper},open:t,anchorEl:e,anchorOrigin:{vertical:"bottom",horizontal:"left"},transformOrigin:{vertical:"top",horizontal:"left"},onClose:this.handlePopoverClose,disableRestoreFocus:!0},l),i))}}])&&wa(t.prototype,a),r&&wa(t,r),i}(r.Component);Na(Fa,"propTypes",{classes:u.a.object,variant:u.a.oneOf(["info","success","warning","error"]),title:u.a.node,children:u.a.node,direction:u.a.oneOf(["top","right","bottom","left"])});var xa=Object(ke.withStyles)((function(e){return{title:{cursor:"pointer",display:"inline-block"},popover:{pointerEvents:"none"},paper:{padding:0,"& .header, & .content":{padding:e.spacing.unit},"& .header":{backgroundColor:e.palette.gray150},"& .content":{border:"1px solid ".concat(e.palette.gray150)}}}}))(Fa),Ma=function(e){return e.children};Ma.propTypes={props:u.a.node};var Ia=Ma;function Ua(e){return(Ua="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function La(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Ba(e,t){for(var a=0;a<t.length;a++){var r=t[a];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Ha(e,t){return(Ha=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Ka(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=Ga(e);if(t){var n=Ga(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return qa(this,a)}}function qa(e,t){return!t||"object"!==Ua(t)&&"function"!=typeof t?Va(e):t}function Va(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Ga(e){return(Ga=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function za(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function Wa(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?za(Object(a),!0).forEach((function(t){Ja(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):za(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function Ja(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}var Ya=["starting","updating","rebooting","restarting","stopping","updating_services","delete_in_progress","migrating","uploading","mounting","unmounting","loading","running","updating_attachments","sysinfo","configuring","unconfiguring","installing","uninstalling","bundle","deleting","storage_configuring","creating","Fetching HDFS Status","Decommissioning","nagios_mon_pending","nagios_mon","upgrading","connecting","install_scheduled","decommission_in_progress","ha_setup","update_in_progress","vacating"],$a=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Ha(e,t)}(i,e);var t,a,r,o=Ka(i);function i(){var e;La(this,i);for(var t=arguments.length,a=new Array(t),r=0;r<t;r++)a[r]=arguments[r];return Ja(Va(e=o.call.apply(o,[this].concat(a))),"getVariant",(function(e){switch(e){case"success":case"ready":case"completed":case"mounted":return"success";case"warning":case"service_down":case"cancelled":case"unconfiguring":case"upgrade_error":case"unlicensed":return"warning";case"error":case"errors":case"delete_in_progress":case"deleting":case"storage_error":case"access_restricted":case"keys_error":case"config_error":case"prechecks_error":case"decommission_in_progress":return"error";case"info":case"migrating":return"info";case"unknown":case"disabled":return"disabled";default:return"primary"}})),e}return t=i,(a=[{key:"render",value:function(){var e=this.props,t=e.classes,a=e.title,r=e.status,o=e.tooltip,i=e.alert_title,s=e.alert_message,c=e.size,l=void 0===c?"default":c,u=this.getVariant(r),p=Ya.includes(r),d=n.a.createElement("div",{className:t.statusLabel},n.a.createElement("span",{className:se()(t.label,t[u],t[l],Ja({},t.animated,p))}),n.a.createElement(St.Typography,{variant:"caption",className:t.title},a));return n.a.createElement(Ia,null,o?n.a.createElement(ka,{variant:u,title:o},d):i&&s?n.a.createElement(xa,{title:d},n.a.createElement("div",{className:"header"},n.a.createElement(St.Typography,{variant:"h5"},i)),n.a.createElement("div",{className:"content"},n.a.createElement(St.Typography,{variant:"body1"},s))):d)}}])&&Ba(t.prototype,a),r&&Ba(t,r),i}(r.Component);Ja($a,"propTypes",{classes:u.a.object,status:u.a.string,title:u.a.string,tooltip:u.a.string,alert_title:u.a.string,alert_message:u.a.string,animationType:u.a.string,size:u.a.string});var Qa=Object(ke.withStyles)((function(e){return Wa(Wa({statusLabel:{display:"flex",alignItems:"center"},label:{display:"inline-block",height:2*e.spacing.unit,width:2*e.spacing.unit,borderRadius:"50%",marginRight:e.spacing.unit,marginLeft:e.spacing.unit,marginTop:.25*e.spacing.unit}},e.variants),{},{title:{display:"inline-block",whiteSpace:"nowrap",lineHeight:1},animated:{animation:"pulse 2s infinite linear"},"@keyframes pulse":{"0%":{opacity:0},"25%":{opacity:1},"55%":{opacity:1},"80%":{opacity:0},"100%":{opacity:0}},small:{height:1.5*e.spacing.unit,width:1.5*e.spacing.unit}})}))($a),Za=a(350),Xa=a.n(Za),er=function(e){var t=e.path,a=void 0===t?[]:t;return a.length?a.reduce((function(e,t){return e&&void 0!==e[t]?e[t]:""}),tr):""},tr={formSubmitSuccessDefault:"Form submitted successfully",formSubmitFailureDefault:"Error occured during form submission",flavor:{success_msg:"Flavor created successfully",failure_msg:"Failed to create flavor",name:{required:"Please provide a unique flavor name",duplicate:"Flavor name must be unique"},description:{required:"Please provide the flavor description."},cores:{required:"Please enter valid integer number of cores"},memory:{required:"Please enter valid float number of memory in gb"},gpus:{required:"Please enter valid integer number of GPU devices"}},modelForm:{name:{required:"Please provide a unique model name",duplicate:"Model name combined with version must be unique.",regExCheck:"Model name must consist of lower case alphanumeric characters, ' - ', or ' . ', and must start and end with an alphanumeric character."},description:{required:"Please provide the model description."},version:{required:"Please provide a unique model version for the given name.",duplicate:"Model name combined with version must be unique."},location:{required:"Enter the location of model/version directory in your project repository."},modelNameDescription:"Enter a short name for the model.",modelDescripttion:"Enter detail about the model",versionDescription:"Enter version of the model.",modelPathDescription:"File path where the model is stored.",scoringPathDescription:"File path for an optional wrapper script used for model scoring.",inputParamFilePathDescription:"Enter a path for input parameter file.",inferenceScriptPathDescription:"Additional libraries and commands for setting up model scoring environment.",trainingDataDescription:"Enter a path for training data.",trainingEnvironmentDescription:"Training environment description including environment and modules used"},datasource:{success_msg:"DataSource created successfully",failure_msg:"Failed to create datasource",nameRequired:function(e){return"Please provide a unique ".concat(e," name")},invalidNameChars:"Characters permitted in this field are letters, numbers, underscores, and hyphens",nameDuplicate:function(e){return"".concat(e," name must be unique")},nameDescription:function(e){return"Enter a unique name for the ".concat(e,".")},datasourceDescription:"Provide a description",sourceTypeDescription:function(e){return"Select filesystem type of the ".concat(e)},fileSystemTypeDescription:"Select the protocol for accessing the remote storage.",hostNFSDescription:"Enter the hostname or IP address of the remote storage service.",hostHDFSDescription:"Enter the hostname or IP address of the remote storage service. Remote kerberized HDFS requires a fully qualified Hostname.",hostErrMsg:function(e){return"Please provide a valid FQDN or IP address for the ".concat(e)},shareDescription:function(e){return"Enter a valid export path in the NFS server for the ".concat(e)},shareErrMsg:function(e){return"Please provide a valid export path in the NFS Server for the ".concat(e)},readOnlyDescription:function(e){return"Make the ".concat(e," read only by checking this option.")},standbyHostDescription:"Enter the hostname for the standby NameNode of the remote storage service. Leave blank if no standby.",portDescription:"Enter the port for the remote storage service. Leave blank for default.",pathDescription:function(e){return"Enter a path within the remote storage that will serve as the starting point for this ".concat(e,". If unspecified, defaults to the top directory available within the exported share or service.")},pathErrMsg:"Please provide a valid path",kerberosDescription:"Select to specify whether Kerberos authentication is required to access the storage.",usernameDescription:"Enter username for accessing the HDFS",usernameErrMsg:"Please provide a valid username",KDCHostDescription:"Comma-separated list of KDC hostnames or IP addresses as supported by application startscript.",KDCHostErrMsg:"Please provide a valid FQDN or IP address for the kdc server",KDCPortDescription:"Enter the KDC Port",serviceIdDescription:"Enter Service ID",serviceIdErrMsg:"Please provide a valid service id",realmDescription:"Enter the Realm",realmErrMsg:"Please provide a valid realm",accessMethodDescription:"'Proxy' method requires a keytab, to provide credentials for both UI browsing and application access. 'Passthrough' method employs user-specific credentials for application access (where supported); a keytab for UI browsing support is optional.",keytabSourceDescription:"Choose whether to upload a new keytab file or use one that was previously uploaded.",keytabUploadDescription:"Upload keytab file to EPIC controller",keytabUploadErrMsg:"Please upload a valid keytab",keytabExistingDescription:"Enter the name of previously uploaded keytab file",keytabExistingErrMsg:"Please provide a valid keytab file name",clientPrincipleDescription:"Enter Client principal",clientPrincipleErrMsg:"Please provide a valid client principal",keytabFileBrowsingDescription:"Select 'Yes' to use keytab for browsing.",clusterNameErrMsg:"Please provide a valid cluster name.",cldbHostErrMsg:"Please provide a valid cldb host.",cldbPortErrMsg:"Please provide a valid cldb port.",ticketErrMsg:"Please provide a valid MapR ticket name.",ticketTypeErrMsg:"Please provide a valid MapR ticket type.",ticketUserErrMsg:"Please provide a valid MapR ticket user.",maprClusterNameDesc:"Specify MapR cluster name.",cldbHostDesc:"Enter comma separated list of CLDB host IPs/FQDNs.",cldbPortDesc:"Specify port number of CLDB. All hosts must be listening on the same port.",maprSecureDesc:"Specify whether MapR cluster is running in secure mode.",maprTicketDesc:"Enter the name of previously uploaded ticket file.",maprTicketTypeDesc:"Select the ticket type. Impersonation result depends on the ticket type if impersonation is enabled.",maprTicketUserDesc:"Specify the user.",maprTenantVolDesc:"Check to enable access to MapR tenant volume. A MapR tenant volume must be accessed via a matched MapR tenant ticket. When the tenant ticket is used to access the matched MapR tenant volume, it can impersonate anybody.",userImpersonationDesc:"Check to enable impersonation of root/mapr user. Impersonation result depends on the ticket type. If user/service doesn't support impersonation, dtap will connect with the ticket user directly.",ticketSourceDescription:"Choose whether to upload a new ticket file or use one that was previously uploaded.",ticketUploadDescription:"Upload ticket file to EPIC controller",ticketExistingDescription:"Enter the name of previously uploaded ticket file",ticketUploadErrMsg:"Please upload a valid MapR ticket file."},datasourceTooltipMsg:{},project_repo:{success_msg:"Project Repository created/updated successfully",failure_msg:"Failed to create/update project repository",mount_name:{required:"Please provide a unique name for the project repository"},host:{required:"Please provide a valid FQDN or IP address of the nfs server"},export_path:{required:"Please provide a valid export path in the NFS Server for project repository"}},projectRepoTooltipMsg:{mountNameDescription:"Enter a unique name for the project repository",typeDescription:"Select filesystem type.",hostDescription:"Enter the hostname or IP address of the nfs server.",exportPathDescription:"Enter share path name of the project repository",forceDescription:"Force is required when modifying an existing project repo"},dataSource:{create:{title:function(e){return"Create new directory under ".concat(e)},name:{error:"File/Folder with same name exist under selected directory. Please provide another name.",required:"Please provide a valid name"},success:function(e){return"Successfully created new directory under ".concat(e)},error:function(e){return"Failed to create new directory under ".concat(e)}},rename:{title:function(e){return"Rename ".concat(e)},name:{error:"File/Folder with same name exist under selected directory. Please provide another name.",required:"Please provide a valid name"},success:function(e,t){return"Successfully renamed ".concat(t?"folder":"file"," ").concat(e)},error:function(e,t){return"Failed to rename ".concat(t?"folder":"file"," ").concat(e)}},delete:{title:function(e){return"Confirm deleting selected ".concat(e?"folder":"file","(s)")},success:function(e,t){return"Successfully deleted ".concat(t?"folder":"file","(s) ").concat(e)},error:function(e,t){return"Failed to delet ".concat(t?"folder":"file","(s) ").concat(e)}},upload:{error:function(e,t){return"Failed to upload ".concat(t," under ").concat(e)}}},licenseAlert:{expired:"License has expired",expires_today:"License expires today",will_expire:function(e){return"License expires in ".concat(e," day(s)")}},gatewayHostAlert:{alert_msg:"EPIC Gateway host is not configured",site_admin_msg:"EPIC Gateway Host must be added to enable user access to cluster services. This deployment uses a non-routable, private network for virtual nodes.",non_site_admin_msg:"Contact your System Administrator."},sourceControl:{invalid_name:"Please provide a valid user name.",invalid_email:"Please provide a valid email address.",invalid_url:"Please provide a valid GitHub URL.",invalid_branch_name:"Please provide a valid branch name.",invalid_access_token:"Please provide a valid access token.",update_success:"Source control updated successfully.",update_failure:"Failed to update GitHub Repository."},sourceControlTooltipMsg:{sourceControlServiceDescription:"Select repository hosting service.",repoUrlDescription:"Enter URL for the github repository. Only http repositories are allowed.",accessTokenDescription:"Enter common access token to authenticate to github.",branchNameDescription:"Enter the name of the project github branch.",userNameDescription:"Enter the shared username for github.",userEmailDescription:"Enter the shared user email for github.",workingDirDescription:"Enter the name of the directory relative to the root of the source control repository that will be used as the working directory for the spawned notebooks for this project."},passwordUpdate:{password_empty:"Please provide the current password",password_invalid:"Please provide a valid password. Length must be at least 4 characters",password_mismatch:"Passwords do not match"},clusterNodeService:{add_service:{title:"Add Cluster Service",name:"Add service form",description:"Form to add new cluster service",success_msg:"Successfully add new service",error_msg:"Failed to add new service"},update_service:{title:"Edit Cluster Service",name:"Update service form",description:"Form to update cluster service",success_msg:"Successfully updated selected cluster service",error_msg:"Failed to update selected service"},delete_service:{title:"Remove Cluster Service",name:"Delete service form",description:"Form to delete cluster service",success_msg:"Successfully deleted selected service",error_msg:"Failed to delete selected service"},nodes:{required:"Please select atleast one node"},id:{required:"Please provide valid Service ID",validName:"Service ID must contain only letters, numbers, spaces or dashes and no trailing spaces.",maxLength:"Service ID must not exceed 72 characters"},exported_service:{validName:"Exported service must contain only letters, numbers, spaces or dashes and no trailing spaces."},name:{required:"Please provide valid Service name",validName:"Service name must contain only letters, numbers, spaces or dashes and no trailing spaces.",maxLength:"Service name must not exceed 72 characters"},port:"Please provide valid port number within the range of 1 and 65535"},clusterNodeTooltipMsg:{serviceIdDescription:"Service identifier string, must be unique within the node group.",exportedServiceDescription:"Optional well-known service identifier (e.g. 'hadoop') used to advertise capabilities to consumers.",serviceNameDescription:"Enter human-readable name for the service that will appear in the UI.",serviceDescription:"Enter some details about service.",portDescription:"Enter a valid port that maps to service",loadbalancedDescription:"Check if service is a loadbalanced service",authTokenDescription:"Check to generate auth token for service",dashboardDescription:"Check if service has access dashboard",nodesDescription:"Select one or multiple nodes that you want to apply the service changes.",pathDescription:"Enter valid path to service dashboard if applicable.",protocolDescription:"Select correct url protocol to access service dashboard.",gatewayHostWarning:"gateway hosts not present"},createEditCluster:{labelNameDescription:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"cluster";return"Enter a unique name for the ".concat(e,".")},labelDescriptionDescription:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"cluster";return"Enter details about ".concat(e,".")},attachmentModelDescription:"Select model versions to deploy.",attachmentClusterDescription:"Select training cluster(s) to attach.",categoryDescription:"Select intended cluster category.",distributionDescription:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"cluster";return"Select runtime image for  ".concat(e," cluster")},roleDescription:function(e){return"Select flavor and node count for ".concat(e,".")},configChoiceDescription:function(e,t){switch(t){case"boolean":return"Check to add ".concat(e," on cluster.");case"multi":return"Select ".concat(e," for cluster.");case"string":case"password":return"Enter ".concat(e," for cluster.")}},constraintsDesription:"Optionally define rules for the placement of nodes in selected roles, limiting them to hosts that have certain tag values.",dependentDescription:function(e){return"Select to install ".concat(e," on the cluster.")},debugDescription:"Select to enable Debug Mode on the cluster. In debug mode nodes that fail to be configured will not be deleted.",isolatedDescription:"Network access from outside the cluster will be prevented; the only exception is for ssh/scp connections by the ".concat(w.APP_TITLE.CP," account or by AD/LDAP accounts with the cluster superuser privilege. Cluster actions such as delete, reconfigure, action scripts, and power ops will also be prevented for EPIC users that do not have the cluster superuser privilege."),twoPhaseDeleteDescription:"If deletion is requested for this cluster while it is not in isolated mode, the cluster will instead be placed into isolated mode.",bootstrapActionDescription:"Check to add action script to be executed as the last step in cluster creation.",scalePolicyDescription:"Upload a valid scaling policy file. Must be in JSON format. \nSee User Guide: 'Creating a Scaling Policy' for an example."},updateAttachments:{title:function(e){return"Update attachment ".concat(e,".")},name:function(e){return"Update attachment ".concat(e," form.")},description:function(e){return"Form to update ".concat(e," of the cluster.")},success_msg:"Successfully started updating the attachments of the cluster.",error_msg:"Failed to update the attchment of the cluster."},actionScript:{title:"Run ActionScripts",subTitle:"This feature assumes that the user has appropriate privileges to run scripts on the cluster.",ariaName:"Create ActionScript Form",ariaDescription:"Modal form to run new ActionScript",successMessage:"Action started successfully",failureMessage:"Failed to create action",labelNameDescription:"Enter a unique name for action.",sourceDescription:"Select source for action scripts.",scriptDescription:"Upload a file with valid action scripts.",dependentScriptsDescription:"Upload dependent files for action script if needed.",cmdDescription:"Enter valid action commands.",argsDescription:"Enter any arguments required by the action.",nodegroupIdDescription:"Select node group to run the action.",rolesDescription:"Select node roles to run the action. ActionScript will apply to nogegroup if no role is selected",asRootDescription:"Select checkbox if action scripts needs to run as root.",runAsRoot_selected:"User needs to have sudo privilege to run scripts as root on the cluster.",runAsRoot_deselected:"Submitting an action as non-root will fail unless an account with your username exists on the nodes, either as a local account or through AD/LDAP integration."},HostAddValidation:{success_msg:"Host(s) addition process started successfully.",failure_msg:"Failed to add host(s).",worker_ip:{required:"Please provide valid worker ip(s).",valid:"Invalid IP address list format. Refer to the acceptable formats below.",duplicate:"Host already exists.",spaceNotAllowed:"No space allowed"},password:{required:"Please provide a valid password."},ssh_key_data:{required:"Please upload a valid ssh private key file."},tags:{duplicate:"Duplicate tags provided",invalid_character:"Please enter valid tag value. Tag value may include alphanumeric characters and special characters '-', '.' and '_'",value_required:"Tag value cannot be empty"}},k8sCreateEditCluster:{labelNameDescription:"Enter a unique name for the Kubernetes cluster.",labelDescriptionDescription:"Enter details about the Kubernetes cluster.",masterDescription:"Select host(s) for master.",workerDescription:"Select host(s) for worker.",k8sVersionDescription:function(e){return e?"Please use upgrade icon button in cluster list page to upgrade Kubernetes Version":"Select Kubernetes version."},podNetworkRangeDescription:"Enter network range to be used for kubernetes pods. Defaults to 10.192.0.0/12",serviceNetworkRangeDescription:"Enter network range to be used for kubernetes services that are exposed with Cluster IP. Defaults to 10.96.0.0/12",podDnsDomainDescription:"Enter valid DNS domain to be used for kubernetes pods. Defaults to cluster.local",rootCaCertTitle:"Kubernetes Root CA Certificate",rootCaCertEditPlaceholder:"Kubernetes Root CA Certificate is set",rootCaCertDescription:"This is the certificate authority that kubernetes will use to generate certificates required for different Kubernetes components including etcd and auth proxy/front-proxy",rootCaCertError:"Kubernetes Root CA Certificate is required if Private Key is provided",rootCaKeyTitle:"Kubernetes Root CA Private Key",rootCaKeyEditPlaceholder:"Kubernetes Root CA Private Key is set",rootCaKeyDescription:"This is the private portion of the above certificate",rootCaKeyError:"Kubernetes Root CA Private Key is required if Certificate is provided",applicationAddonsTitle:"Select from the list of applications"},k8sImportEditCluster:{clusterConfiguration:{updateNotSupported:"Updating this field is not supported.",nameDescription:"Enter a unique name for the Kubernetes cluster.",descriptionDescription:"Enter details about the Kubernetes cluster.",typeDescription:"Select the type of Kubernetes cluster",pod_dns_domainDescription:"Enter a valid DNS domain to be used for Kubernetes pods.",server_urlDescription:"Enter the URL of the Kubernetes server.",caDescription:"Enter the CA certificate for the Kubernetes cluster as it appears in the kubectl config file. It must be Base64-encoded.",bearer_tokenDescription:"Enter the bearer token for the Kubernetes cluster as it appears in the kubectl config file. It must be Base64-encoded.",validation:{fieldRequired:"This field is required.",name:{length:"Kubernetes cluster name should not be more than 32 characters long.",invalid:"Please provide a valid name for Kubernetes cluster.",alreadyUsed:"This name is already in use."},description:{invalid:"Please provide a valid description for the Kubernetes cluster."},pod_dns_domain:{invalid:"Please provide a valid DNS domain name."},server_url:{http:"The Server URL must begin with http:// or https://.",invalid:"Please provide a valid Server URL."}}}},HostTable:{deleteDescription:"Confirm Deletion. This action cannot be undone",installationConfirmation:"Confirm installation. This action cannot be undone",decommssionDescription:"Confirm Decommission. Once decommission has started, it cannot be cancelled.",recommssionDescription:"Confirm Recommission. Once recommission has started, it cannot be cancelled.",vacateHostDescription:"Confirm Host Vacating. Once vacating has started, it cannot be cancelled.",workerRebootMsg:"Worker nodes will be automatically rebooted after installation. Do you want to continue?",diskMismatchMsg:"One or more worker's disk configurations don't match with the controller. Do you want to continue?"},hostAddTooltipMsg:{workerIp:"Specify one or more comma separated list of IPs for host(s).",credentialType:"Specify credentials type to access host(s).",userName:"Username that will be used to access host(s).",workerPassword:"Enter a valid password.",workerSshKeyPath:"Upload private SSH key file.",workerSshPassphrase:"Specify passphrase (if non-empty) for SSH key.",tags:function(e){return"Add tags for selected ".concat(e," host(s).")}},dashboardTooltipMsg:{resourceAllocation:"Usage graph against current total available resources for tenant. If tenant quota or constraints are updated once resources are consumed, graph may show more than 100% utilization.",cpu:"Cluster CPU utilization graph. Y value represents CPU used out of total allocated CPU in percent.",memory:"Cluster Memory utilization graph. Y value represents the total aggregate bytes of memory used.",network_in:"Cluster network utilization graph. Y value represents network traffic from container.",disk_write:"Cluster disk utilization graph. Y value represents the disk writes to container's device.",gpu:"Cluster GPU utilization graph. Y value represents GPU used out of total allocated GPU in percent.",gpu_memory_used:"Cluster GPU Memory utilization graph. Y value represents the total aggregate bytes of memory used.",cpu_usage_node_pct_per_pod:"Node CPU utilization graph. Y value represents CPU usage as a percentage of the total available node CPU.",cpu_usage_nanocores_per_pod:"Pod CPU usage graph. Y value represents the used CPU nanocores.",cpu_pod_usage_limit_pct:"Pod CPU limit utilization graph. Y value represents the CPU usage as a percentage of the defined limit for the pod containers (or total node CPU if unlimited).",mem_usage_node_pct:"Node Memory utilization graph. Y value represents memory usage as a percentage of the total allocatable node memory.",mem_usage_pod_bytes:"Pod Memory utilization graph. Y value represents the total pod containers memory usage.",mem_usage_limit_pct:"Pod Memory limit utilization graph. Y value represents the memory usage as a percentage of the defined limit for the pod containers (or total node memory if unlimited).",network_rx_pod_bytes:"Pod Network In utilization graph. Y value represents the pods network traffic received.",network_tx_pod_bytes:"Pod Network Out utilization graph. Y value represents the pods network traffic sent.",system_cpu:"System CPU chart. Y value represents aggregate CPU utilization in percent.",system_memory:"System Memory chart. Y value represents aggregate bytes of Memory used.",system_swap:"System Swap chart. Y value represents aggregate bytes of Memory Swapped.",system_load:"System Load chart. Y value represents aggregate system Load in percent.",system_network_in:"System Network In chart. Y value represents aggregate bytes of inbound Network.",system_network_out:"System Network Out chart. Y value represents aggregate bytes of outbound Network.",system_gpu:"System GPU chart. Y value represents aggregate GPU utilization in percent.",system_gpu_memory_used:"System GPU Memory chart. Y value represents aggregate bytes of GPU Memory used."},kubeCtl:{deleteTitle:"Confirm KubeCtl delete operation for selected application."},k8sClusterUpgrade:{title:"Kubernetes Upgrade",name:"Upgrade Kubernetes",description:"Modal form to upgrade Kubernetes",successMessage:"Kubernetes upgrade process started successfully",failureMessage:"Failed to start Kubernetes upgrade process",k8sVersionDescription:"Select the Kubernetes version to upgrade to",subTitle:"Kubernetes version is up-to-date. No upgrade required.",upgradePercentileDescription:"Percentage of Kubernetes worker nodes to upgrade at once. If not specified, defaults to 20.",retryUpgradePercentileDescription:"Percentage of Kubernetes worker nodes to retry upgrade at once. If not specified, defaults to 20.",retryUpgradeHostsPaths:"List of Kubernetes worker host paths to retry."},k8sClusterAdminUserGroupForm:{title:"Update Cluster Admin User Groups",name:"Usergroup update form",description:"Form to update user groups for selected cluster admin",successMessage:"Successfully updated user groups",failureMessage:"Failed to update user groups",externalGroupTitle:"External User Groups",externalGroupAddItemTitle:"User Group",externalGroupDescription:"Enter LDAP/AD group(s) to associate with selected Cluster Admin tenant."},updateTagFormMsg:{name:"Host tags update form",description:"Form to update tags for selected host",successMessage:"Host tags updated successfully",failureMessage:"Failed to update host tags",tagsFieldDescription:function(e){return"Add tags for selected ".concat(e," host(s)")}},hostsTags:{success_msg:"Tag created successfully.",failure_msg:"Failed to create Tag.",delete_description:"Confirm deletion. This action cannot be undone.",isDuplicateTag:"Tag with the same name already exists. Please specify a different one.",nameRequired:"Please provide a valid name.",maxLengthName:function(e){return"Name must not exceed ".concat(e," characters")},maxLengthDesc:function(e){return"Description must not exceed ".concat(e," characters")}},k8sCreateEditSourceControl:{globalSourceControlsMissing:"Global source control configurations are not available to create new source control at this moment. Please, ask tenant admin to add global source control configuration first",metadataParentConfigurationTitle:"Global Configuration",metadataParentConfigurationDescription:"Global source control configuration to adopt repository's global information",metadataNameTitle:"Configuration Name",metadataNameDescription:"Name for the source control configuration",metadataNameError:"Enter a valid subdomain qualified name for configuration, must consist of lower case alphanumeric characters, '-' or '.', and must start and end with an alphanumeric character.",metadataDescriptionTitle:"Description",metadataDescriptionDescription:"A short info about source control configuration",dataTypeTitle:"Source Control Type",dataTypeDescription:"Source control repository type",dataAuthTypeTitle:"Authentication Type",dataAuthTypeDescription:"Authentication type for the source control",dataRepoUrlTitle:"Repository URL",dataRepoUrlDescripton:"Full url of the source control repository",dataRepoUrlError:"Enter valid url for git repository.",dataBranchTitle:"Branch",dataBranchDescription:"A branch name from the provided repository",dataBranchError:"Repository branch name needs to be specified.",dataWorkingDirectoryTitle:"Working Directory",dataWorkingDirectoryDescription:"A working directory in the provided repository",dataUsernameTitle:"Username",dataUsernameDescription:"Username to access repository",dataUsernameError:"A valid username is required to access repository.",dataEmailTitle:"Email",dataEmailDescription:"Email address to access repository",dataEmailError:"Enter a valid email address to access repository.",dataTokenTitle:"Token",dataTokenDescription:"Token to access repository",dataTokenError:"A valid token is required to access repository.",dataPasswordTitle:"Password",dataPasswordDescription:"Password to access repository",dataPasswordError:"A valid password is required to access repository.",dataProxyProtocolTitle:"Proxy Protocol",dataProxyProtocolDescription:"Protocol for proxy host",dataProxyHostnameTitle:"Proxy Host",dataProxyHostnameDescription:"Hostname or IP address for proxy host",dataProxyHostnameError:"Proxy host must be a valid hostname or ip if provided.",dataProxyPortTitle:"Proxy Port",dataProxyPortDescription:"Port to access proxy host",dataProxyPortError:"Proxy port must be valid port number if provided."},infosightConfigureValidation:{noToken:"Token must be supplied when enabling HPE InfoSight"},infosightConfigureTooltipMsg:{collect:"Enable data collection for HPE InfoSight",token:"HPE-supplied InfoSight claim token",privacyDiagnostics:"Allow private data to be sent to HPE InfoSight for diagnostic purposes"},AuthenticationForm:{typeTitle:"Directory Server",typeDescription:"Type of the enterprise user authentication service to link with",securityProtocolTitle:"Security Protocol",securityProtocolDescription:"Security protocol to be used when connecting to the auth server",authServiceLocationsTitle:"Service Locations",authServiceLocationsDescription:"A fully qualified hostname or IP address and port of the remote authentication service",authServiceLocationsError:"Service location fields cannot be empty.",authServiceLocationsHostPlaceholder:"example.net or 0.0.0.0",authServiceLocationsHostRequiredError:"Auth service location host is required field.",authServiceLocationsHostError:"A valid hostname or IP address is required for authentication service location.",authServiceLocationsPortPlaceholder:"389",authServiceLocationsPortError:"A valid port number is required for auth service location.",addServiceLocation:"Service Location",bindTypeTitle:"Bind Type",bindTypeDescription:"Bind Type of the authentication service",userAttributeTitle:"User Attribute",userAttributeDescription:"User attribute to associate with the login name",userAttributePlaceholder:"cn",userAttributeError:"Provide the user attribute used for login (cn/uid).",baseDnTitle:"Base DN",baseDnDescription:"Enter Base DN",baseDnPlaceholder:"dc=abc,dc=example,dc=net",baseDnError:"Provide a valid Base DN",bindDnTitle:"Bind DN",bindDnDescription:"Enter Bind DN",bindDnPlaceholder:"cn=admin,dc=abc,dc=example,dc=net",bindPwdTitle:"Bind Password",bindPwdDescription:"Enter Bind Password",bindPwdError:"Bind password is required when Bind DN is provided.",userSubtreeTitle:"User Subtree DN",userSubtreeDescription:"Subtree DN to be used for connecting to LDAP/AD service",userSubtreePlaceholder:"ou=People,dc=example,dc=com",ntDomainEnabledTitle:"NT Domain Enabled",ntDomainEnabledDescription:"Check if NT domain is enabled for the identity server",ntDomainTitle:"NT Domain",ntDomainDescription:"NT Domain for the identity server",ntDomainError:"Provide a valid NT Domain",verifyPeerTitle:"Verify Peer",verifyPeerDescription:"Check to verify the auth service certificate",caCertTitle:"CA Certificate File",caCertDescription:"Certificate Authority for SSL/TLS based authentication",caCertError:"Provide a Certificate Authority for SSL/TLS based authentication.",externalGroupsTitle:"External Groups",externalGroupsDescription:"LDAP/AD group(s) to associate with this cluster",externalGroupPlaceholder:"cn=Eng,ou=Group,dc=abc,dc=example,dc=net",addExternalGroup:"External Group"}},ar=a(30),rr=function(e){var t=e.title,a=e.id,r=e.required,o=void 0!==r&&r,i=e.classes;return n.a.createElement(st.a,{htmlFor:a,className:i.label,variant:"body1"},t,o?"*":"")};rr.propTypes={title:u.a.string,id:u.a.string,required:u.a.bool,classes:u.a.object};var nr=he()(ar.a)(rr);function or(e){return(or="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var ir=function(e){var t,a=e.more,r=e.classes,o=a.icon,i=void 0===o?"icon-menu2":o,s=a.data,c=a.title,l=void 0===c?"":c;switch(or(s)){case"string":t=n.a.createElement(st.a,{variant:"caption"},s);break;case"object":Array.isArray(s)&&(t=n.a.createElement(Ia,null,s.map((function(e,t){return n.a.createElement(st.a,{variant:"caption",key:t},e)}))))}return n.a.createElement(xa,{title:n.a.createElement("span",{className:se()("icon",i,r.labelIcon,r.moreIcon)}),direction:"top"},l?n.a.createElement("div",{className:"header"},n.a.createElement(st.a,{variant:"caption"},l)):"",t?n.a.createElement("div",{className:"content"},t):"")};ir.propTypes={more:u.a.object,classes:u.a.object};var sr=he()(ar.a)(ir),cr=function(e){var t=e.title,a=e.placement,r=void 0===a?"top":a,o=e.classes;return n.a.createElement(ka,{title:t,variant:"primary",placement:r},n.a.createElement("span",{className:se()("icon","icon-question-circle",o.labelIcon)}))};cr.propTypes={title:u.a.string,classes:u.a.object,placement:u.a.string};var lr=he()(ar.a)(cr),ur=function(e){var t=e.title,a=e.classes,r=e.obj,o=void 0!==r&&r,i=e.helpVariant,s=void 0===i?"helpDefault":i;return o?n.a.createElement("div",{className:a.inputGroup},n.a.createElement("span",{className:a.labelGroup}),n.a.createElement(st.a,{variant:"caption",className:a.help},t)):n.a.createElement(st.a,{variant:"caption",className:se()(a.help,a[s])},t)};ur.propTypes={title:u.a.oneOfType([u.a.string,u.a.node]),classes:u.a.object,obj:u.a.bool,helpVariant:u.a.oneOf(["helpDefault","helpWarning","helpError","helpInfo"])};var pr=he()(ar.a)(ur),dr=function(e){var t=e.errors,a=void 0===t?[]:t,r=e.classes;return n.a.createElement("div",{className:(r.formControl,r.errorsContainer)},a.map((function(e,t){return n.a.createElement(st.a,{variant:"caption",color:"error",key:t},e)})))};dr.propTypes={errors:u.a.array,classes:u.a.object};var fr=he()(ar.a)(dr);function mr(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}var hr=function(e){var t=e.id,a=e.classNames,r=e.children,o=e.errors,i=e.schema,s=e.classes,c=f.a.fetchSafeFromObject({path:["props","errors"],obj:o,default_value:[]}),l=i.type,u=i.title,p=i.description,d=void 0===p?"":p,m=i.help,h=void 0===m?"":m,b=i.uniqueItems,v=void 0!==b&&b,y=i.hidden,g=void 0!==y&&y,_=i.singleRow,S=void 0!==_&&_,k=i.bd_required,O=void 0!==k&&k,E=i.more,j=void 0===E?null:E,D=i.newRow,w=void 0!==D&&D,C=i.helpVariant,T=void 0===C?"helpDefault":C,P=i.fullWidth,A=void 0!==P&&P,R=i.width,N=void 0===R?"":R,F=a.replace("form-group ",""),x=N?{width:N}:{};return"object"===l?S?n.a.createElement("div",{className:se()(s.objectBlock,F,mr({},s.hidden,g),mr({},s.hasErrors,c.length))},u?n.a.createElement("div",{className:s.labelGroup},n.a.createElement(nr,{id:t,title:u,required:O}),j?n.a.createElement(sr,{more:j}):"",d?n.a.createElement(lr,{title:d}):""):"",n.a.createElement("div",{className:s.controlGroup},r,c.length?n.a.createElement(fr,{errors:c}):"",h?n.a.createElement(pr,{title:h}):"")):n.a.createElement("div",{className:s.objectGroup},r,c.length?n.a.createElement(fr,{errors:c}):"",h?n.a.createElement(pr,{title:h,obj:!0}):""):"array"===l?v?n.a.createElement("div",{className:se()(s.inputGroup,s.multiSelect,F,mr({},s.hidden,g),mr({},s.hasErrors,c.length),mr({},s.newRow,w),mr({},s.fullWidth,A))},u?n.a.createElement("div",{className:s.labelGroup},n.a.createElement(nr,{id:t,title:u,required:O}),j?n.a.createElement(sr,{more:j}):"",d?n.a.createElement(lr,{title:d}):""):"",n.a.createElement("div",{className:s.controlGroup},r,c.length?n.a.createElement(fr,{errors:c}):"",h?n.a.createElement(pr,{title:h}):"")):n.a.createElement(Ia,null,r):n.a.createElement("div",{style:x,className:se()(s.inputGroup,F,mr({},s.hidden,g),mr({},s.hasErrors,c.length),mr({},s.newRow,w),mr({},s.fullWidth,A))},u?n.a.createElement("div",{className:s.labelGroup},n.a.createElement(nr,{id:t,title:u,required:O}),j?n.a.createElement(sr,{more:j}):"",d?n.a.createElement(lr,{title:d}):""):"",n.a.createElement("div",{className:s.controlGroup},r,c.length?n.a.createElement(fr,{errors:c}):"",h?n.a.createElement(pr,{title:h,helpVariant:T}):""))};hr.propTypes={classes:u.a.object,id:u.a.string,classNames:u.a.string,label:u.a.string,required:u.a.bool,errors:u.a.node,children:u.a.node,schema:u.a.object};var br=he()(ar.a)(hr);function vr(e){return(vr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function yr(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function gr(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?yr(Object(a),!0).forEach((function(t){jr(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):yr(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function _r(e,t){for(var a=0;a<t.length;a++){var r=t[a];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Sr(e,t){return(Sr=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function kr(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=Er(e);if(t){var n=Er(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return Or(this,a)}}function Or(e,t){return!t||"object"!==vr(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Er(e){return(Er=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function jr(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}var Dr=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Sr(e,t)}(i,e);var t,a,r,o=kr(i);function i(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),(t=o.call(this,e)).state={collapsed:!1},t}return t=i,(a=[{key:"componentDidMount",value:function(){var e=this.props,t=e.title,a=e.collapsed,r=void 0!==a&&a,n=t&&window.localStorage.getItem("collapsed_states")||"{}",o=JSON.parse(n),i=f.a.fetchSafeFromObject({path:[t],obj:o,default_value:r});this.setState({collapsed:i})}},{key:"render",value:function(){var e=this,t=this.props,a=t.children,r=t.title,o=t.classes,i=this.state.collapsed,s=void 0!==i&&i;return n.a.createElement(Ia,null,n.a.createElement("span",{variant:"caption",className:se()(o.collapseBtn,"icon",s?"icon-expand4":"icon-contract3"),onClick:function(){var t=window.localStorage.getItem("collapsed_states")||"{}",a=JSON.parse(t);window.localStorage.setItem("collapsed_states",JSON.stringify(gr(gr({},a),{},jr({},r,!s)))),e.setState({collapsed:!s})}}),n.a.createElement("div",{className:se()(o.collapsible,s?o.collapsed:"")},a))}}])&&_r(t.prototype,a),r&&_r(t,r),i}(r.Component);jr(Dr,"propTypes",{title:u.a.string,collapsed:u.a.bool,children:u.a.node,classes:u.a.object});var wr=he()(ar.a)(Dr),Cr=function(e){var t=e.properties,a=e.schema,r=e.classes,o=a.title,i=a.singleRow,s=void 0!==i&&i,c=a.canCollapse,l=void 0!==c&&c,u=a.collapsed,p=void 0!==u&&u;return s?n.a.createElement("div",{className:r.groupBlock},t.map((function(e){return e.content}))):n.a.createElement("div",{className:se()(r.formBlock,o?r.hasTitle:"")},o?n.a.createElement(st.a,{variant:"caption",className:r.formBlockTitle},o):"",o&&l?n.a.createElement(wr,{title:o,collapsed:p},t.map((function(e){return e.content}))):n.a.createElement(Ia,null,t.map((function(e){return e.content}))))};Cr.propTypes={title:u.a.string,properties:u.a.array,required:u.a.bool,classes:u.a.object,singleRow:u.a.bool,canCollapse:u.a.bool,collapsed:u.a.bool};var Tr=he()(ar.a)(Cr),Pr=function(){return""};function Ar(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}var Rr=function(e){var t=e.items,a=e.schema,o=e.rawErrors,i=void 0===o?[]:o,s=e.classes,c=e.readonly,l=e.disabled,u=a.title,p=a.canCollapse,d=void 0!==p&&p,f=a.collapseLabel,m=void 0!==f&&f,h=a.collapsed,b=void 0!==h&&h,v=a.id,y=void 0===v?"":v,g=a.required,_=void 0!==g&&g,S=a.bd_required,k=void 0!==S&&S,O=a.hidden,E=void 0!==O&&O,j=a.bd_disabled,D=void 0!==j&&j,w=a.more,C=void 0===w?"":w,T=a.description,P=void 0===T?"":T,A=a.addItemTitle,R=void 0===A?"item":A,N=a.canAdd,F=void 0!==N&&N,x=a.onAddClick,M=void 0===x?null:x,I=a.onDropClick,U=void 0===I?null:I,L=a.help,B=void 0===L?"":L,H=n.a.createElement(r.Fragment,null,t.map((function(e,a){return n.a.createElement("div",{className:s.arrayItem,key:a},e.children,F&&U&&t.length>1&&n.a.createElement(ki,{title:"Remove",variant:"error",icon:"icon-trash2",disabled:l||c||D,callback:U,params:a,classes:{btn:s.addOnBtnOutlined}}))})),n.a.createElement("div",null,i.length?n.a.createElement(fr,{errors:i}):"",B?n.a.createElement(pr,{title:B,obj:!1}):"",F&&M&&n.a.createElement(st.a,{className:s.link,variant:"caption",color:"primary",onClick:M},n.a.createElement("span",{className:"icon icon-plus"})," Add "," ".concat(t.length?"Another ":"").concat(R)," ")));return n.a.createElement(r.Fragment,null,t.length>0&&n.a.createElement("div",{className:se()(Ar({},s.formBlock,d),Ar({},s.arrayBlock,!d),Ar({},s.hasTitle,u&&d),Ar({},s.hidden,E))},u&&n.a.createElement(r.Fragment,null,d?n.a.createElement(st.a,{variant:"caption",className:s.formBlockTitle},u):n.a.createElement("div",{className:s.labelGroup},n.a.createElement(nr,{id:y,title:u,required:_||k}),C?n.a.createElement(sr,{more:C}):"",P?n.a.createElement(lr,{title:P}):"")),d?n.a.createElement(wr,{title:u,collapsed:b},n.a.createElement(r.Fragment,null,m?n.a.createElement("div",{className:s.inputGroup},n.a.createElement("div",{className:s.labelGroup},n.a.createElement(nr,{id:y,title:m,required:_||k}),C?n.a.createElement(sr,{more:C}):"",P?n.a.createElement(lr,{title:P}):""),n.a.createElement("div",{className:s.controlGroup},H)):H)):n.a.createElement("div",{className:s.controlGroup},H)))};Rr.propTypes={title:u.a.string,items:u.a.array,schema:u.a.object,classes:u.a.object,rawErrors:u.a.array,readonly:u.a.bool,disabled:u.a.bool};var Nr=he()(ar.a)(Rr),Fr=a(186),xr=a.n(Fr),Mr=a(124),Ir=a.n(Mr),Ur=function(e){var t=e.id,a=e.value,r=e.disabled,o=e.readonly,i=e.autofocus,s=e.onChange,c=e.schema,l=c.bd_disabled,u=void 0!==l&&l,p=c.checkbox_label,d=void 0===p?"":p,f=n.a.createElement(xr.a,{id:t,disabled:r||o||u,checked:void 0!==a&&a,onChange:function(e){return e.target.focus(),s(e.target.checked)},value:"checked",color:"primary",autoFocus:i});return d?n.a.createElement(Ir.a,{control:f,label:d}):f};Ur.defaultProps={autofocus:!1},Ur.propTypes={schema:u.a.object.isRequired,id:u.a.string.isRequired,value:u.a.bool,disabled:u.a.bool,readonly:u.a.bool,autofocus:u.a.bool,onChange:u.a.func};var Lr=Ur,Br=a(36),Hr=a.n(Br),Kr=a(60),qr=a.n(Kr),Vr=new Set(["number","integer"]),Gr=function(e,t){var a=e.type,r=e.items;if(""!==t){if("array"===a&&r&&Vr.has(r.type))return t.map(Jr);if("boolean"===a)return"true"===t;if("number"===a)return Jr(t);if(e.enum){if(e.enum.every((function(e){return"number"===f.a.guessType(e)})))return Jr(t);if(e.enum.every((function(e){return"boolean"===f.a.guessType(e)})))return"true"===t}return t}},zr=function(e){var t=e.schema,a=e.id,r=e.options,o=e.value,i=e.required,s=e.disabled,c=e.readonly,l=e.multiple,u=e.autofocus,p=e.onChange,d=e.onBlur,m=e.onFocus,h=e.classes,b=r.enumOptions,v=t.sort,y=void 0===v||v,g=t.items,_=(g=void 0===g?{}:g).enumDisabled,S=void 0===_?[]:_,k=l?[]:"",O=y?f.a.bdSort(b,["label"]):b;return n.a.createElement("div",{className:h.formControl},n.a.createElement(Hr.a,{variant:"outlined",className:h.selectGroup},n.a.createElement(qr.a,{id:a,multiple:l,value:void 0===o?k:o,required:i,disabled:s||c||t.bd_disabled,autoFocus:u,MenuProps:{classes:{paper:h.selectMenuList}},onBlur:d&&function(e){d(a,Gr(t,e.target.value))},onFocus:m&&function(e){m(a,Gr(t,e.target.value))},onChange:function(e){p(Gr(t,e.target.value))}},O.map((function(e,t){var r=e.value,o=e.label,i=S&&-1!==S.indexOf(r);return n.a.createElement(lt.a,{key:t,value:r,disabled:i,htmlFor:a,className:h.select},o)})))))};zr.defaultProps={autofocus:!1},zr.propTypes={schema:u.a.object.isRequired,id:u.a.string.isRequired,options:u.a.shape({enumOptions:u.a.array}).isRequired,value:u.a.any,required:u.a.bool,disabled:u.a.bool,readonly:u.a.bool,multiple:u.a.bool,autofocus:u.a.bool,onChange:u.a.func,onBlur:u.a.func,onFocus:u.a.func,placeholder:u.a.string,classes:u.a.object};var Wr=he()(ar.a)(zr),Jr=function(e){if(""!==e){if(/\.$/.test(e))return e;if(/\.0$/.test(e))return e;var t=Number(e),a="number"==typeof t&&!Number.isNaN(t);return/\.\d*0$/.test(e)?e:a?t:e}},Yr=a(706),$r=a(96),Qr=a.n($r);function Zr(e){return(Zr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Xr(){return(Xr=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var r in a)Object.prototype.hasOwnProperty.call(a,r)&&(e[r]=a[r])}return e}).apply(this,arguments)}function en(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function tn(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?en(Object(a),!0).forEach((function(t){ln(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):en(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function an(e,t){for(var a=0;a<t.length;a++){var r=t[a];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function rn(e,t){return(rn=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function nn(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=cn(e);if(t){var n=cn(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return on(this,a)}}function on(e,t){return!t||"object"!==Zr(t)&&"function"!=typeof t?sn(e):t}function sn(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function cn(e){return(cn=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function ln(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}var un=Object(ar.a)(),pn="number",dn="integer",fn="text",mn="password",hn="file-tree",bn=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&rn(e,t)}(i,e);var t,a,r,o=nn(i);function i(e){var t;if(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),t=o.call(this,e),!e.id)throw new Error("no id for props ".concat(JSON.stringify(e)));var a=e.value,r=e.options,s=e.schema,c=e.id,l=void 0===c?"":c,u=e.registry,p=void 0===u?{}:u,d=e.required,f=void 0!==d&&d,m=e.placeholder,h=void 0===m?"":m,b=e.type,v=void 0===b?"":b;t._handlePopoverOpen=t._handlePopoverOpen.bind(sn(t)),t._handlePopoverClose=t._handlePopoverClose.bind(sn(t)),t._clearSelectedFileTree=t._clearSelectedFileTree.bind(sn(t)),t._setSelectedFileTree=t._setSelectedFileTree.bind(sn(t)),t._isValidExtension=t._isValidExtension.bind(sn(t)),t._onChange=t._onChange.bind(sn(t)),t._onBlur=t._onBlur.bind(sn(t)),t._onFocus=t._onFocus.bind(sn(t)),t.textInput=n.a.createRef(),t.updateValue=t.updateValue.bind(sn(t)),t.onBtnClick=t.onBtnClick.bind(sn(t)),t.timeout=null,t.mounted=!1;var y={id:l,registry:p,required:f,placeholder:h,type:v};if(r.inputType?y.type=r.inputType:y.type||(s.type===pn||s.type===dn?(y.type=pn,y.step=1):s.bd_widget===mn?y.type=mn:s.bd_widget===hn?y.type=hn:y.type=fn),s.multipleOf&&(y.step=s.multipleOf),y.type===pn){var g=s.minimum,_=void 0===g?0:g,S=s.maximum,k=s.step;y.minimum=_,S&&(y.maximum=S),k&&(y.step=k)}return t.state={value:a,inputProps:y,focused:!1,anchorlEl:null,popoverOpen:!1,anchorRect:{}},t}return t=i,(a=[{key:"componentDidMount",value:function(){this.mounted=!0}},{key:"componentWillUnmount",value:function(){this.mounted=!1,clearTimeout(this.timeout)}},{key:"updateValue",value:function(e){if(this.mounted){var t=this.props.onChange;this.setState({value:e}),t(e)}}},{key:"_onChange",value:function(e){var t=e.target;if(this.mounted){var a=this.props,r=a.onChange,n=a.options,o=t.value,i=void 0===o?"":o;return this.setState({value:i}),t&&t.focus(),r(""===i?n.emptyValue:i)}}},{key:"_onBlur",value:function(e){var t=this,a=e.target;if(this.mounted){var r=this.props,n=r.onBlur,o=r.id;n&&n(o,a.value),this.timeout=setTimeout((function(){t.setState({focused:!1})}),250)}}},{key:"_onFocus",value:function(e){var t=e.target;if(this.mounted){var a=this.props,r=a.onFocus,n=a.id;this.setState({focused:!0}),r&&r(n,t.value)}}},{key:"onBtnClick",value:function(e){var t=e.target.getAttribute("dataaction");if(t){var a=this.state,r=a.value,n=void 0===r?0:r,o=a.inputProps,i=n,s=o.minimum,c=o.maximum,l=o.step,u=void 0===l?1:l;"up"===t?((!c||n<c)&&(i+=u),i>c&&(i=c)):"down"===t&&(n>s&&(i-=u),i<s&&(i=s)),this.updateValue(i),event.target.closest("button").focus()}}},{key:"_isValidExtension",value:function(e){var t=e.path,a=this.props.schema.accept,r=void 0===a?"*":a;if("*"===r)return!0;if(r&&r.length){var n=r,o=t.split(".").pop();return n&&n.includes(o)}}},{key:"_setSelectedFileTree",value:function(e){var t=e.name,a=e.path,r=this.props.schema.bd_widget_data,n=(r=void 0===r?{}:r).path_prefix,o=void 0===n?"":n;if(a&&"/"!==a){var i=this._isValidExtension({path:a}),s="".concat(o).concat(t).concat(a);i&&this.updateValue(s)}}},{key:"_clearSelectedFileTree",value:function(){this.state.value&&this.updateValue("")}},{key:"_handlePopoverOpen",value:function(e){e.preventDefault();var t=e.currentTarget,a=t.getBoundingClientRect();this.setState({popoverOpen:!this.state.popoverOpen,anchorEl:t,anchorRect:{x:a.x,y:a.y,width:a.width,height:a.height}})}},{key:"_handlePopoverClose",value:function(){this.setState({popoverOpen:!1})}},{key:"render",value:function(){var e=this,t=this.state,a=t.value,r=t.inputProps,o=t.focused,i=this.props,s=i.id,c=i.readonly,l=void 0!==c&&c,u=i.disabled,p=void 0!==u&&u,d=i.autofocus,f=void 0!==d&&d,m=i.schema,h=m.bd_disabled,b=void 0!==h&&h,v=m.bd_widget,y=void 0===v?"input":v,g=m.bd_widget_data,_=void 0===g?{}:g,S=m.placeholder,k=void 0===S?"":S,O=m.suggestions,E=void 0===O?[]:O,j=r.minimum,D=r.maximum,w=a||0,C="textarea"===y?{multiline:!0,rowsMax:10}:{},T=a&&a.length?E.filter((function(e){return e.includes(a)})):E;return n.a.createElement("div",{style:tn({},un.formControl)},n.a.createElement(Qr.a,Xr({style:tn({},un.control),variant:"outlined",disabled:p||l||b,autoFocus:f,value:null==a?"":a},r,C,{onChange:this._onChange,onBlur:this._onBlur,onFocus:this._onFocus,ref:this.textInput,placeholder:k,multiline:"textarea"===y,rows:"textarea"===y?2:1})),r.type===pn?n.a.createElement("div",{style:tn({},un.append)},n.a.createElement(Ue.a,{variant:"contained",color:"primary",size:"small",onClick:this.onBtnClick,style:tn({},b||D&&a>=D?un.btnDisabled:{}),htmlFor:s},n.a.createElement("span",{dataaction:"up",className:"icon icon-chevron-up"})),n.a.createElement(Ue.a,{variant:"contained",color:"primary",size:"small",onClick:this.onBtnClick,style:tn({},b||w<=j?un.btnDisabled:{}),htmlFor:s},n.a.createElement("span",{dataaction:"down",className:"icon icon-chevron-down"}))):"",r.type===hn&&n.a.createElement(n.a.Fragment,null,n.a.createElement(Ue.a,{htmlFor:s,type:"button",variant:"contained",color:"secondary",onClick:this._clearSelectedFileTree,style:tn({},this.state.value?{}:un.btnDisabled)},"Clear"),n.a.createElement(Ue.a,{htmlFor:s,type:"button",variant:"contained",color:"primary",onClick:this._handlePopoverOpen},"Browse"),n.a.createElement(Ea.a,{className:this.props.classes.browser,classes:{paper:this.props.classes.fileBrowser},open:this.state.popoverOpen,onClose:this._handlePopoverClose,anchorOrigin:{vertical:"center",horizontal:"right"},transformOrigin:{vertical:"center",horizontal:"left"},style:{top:this.state.anchorRect.y||0,left:this.state.anchorRect.x+this.state.anchorRect.width},animation:Oa.PopoverAnimationVertical},n.a.createElement(pi,{key:_.key,source:_.source,source_type:_.source_type,path:_.path,name:_.name,type:_.type,onClick:this._setSelectedFileTree}))),o&&T.length?n.a.createElement(Se.a,{style:tn({},un.suggestions)},T.map((function(t){return n.a.createElement(Ee.a,{key:t,style:tn({},un.suggestionItemWrapper),className:"hoverable"},n.a.createElement("div",{style:tn({},un.suggestionItem),onClick:function(){e.updateValue(t)}},n.a.createElement(St.Typography,null,t)))}))):"")}}])&&an(t.prototype,a),r&&an(t,r),i}(r.Component);ln(bn,"propTypes",{classes:u.a.object,schema:u.a.object,options:u.a.object,id:u.a.string.isRequired,placeholder:u.a.string,value:u.a.any,required:u.a.bool,disabled:u.a.bool,readonly:u.a.bool,autofocus:u.a.bool,onChange:u.a.func,onBlur:u.a.func,onFocus:u.a.func,registry:u.a.object,type:u.a.string});var vn=he()(ar.a)(bn),yn={widgets:{CheckboxWidget:Lr,SelectWidget:Wr,FileWidget:Yr.a,TextWidget:vn},FieldTemplate:br,ObjectFieldTemplate:Tr,ArrayFieldTemplate:Nr,ErrorList:Pr,autocomplete:"off",noHtml5Validate:!0},gn=ca.toast.POSITION.TOP_RIGHT,_n=function(e){var t=e.msg,a=e.variant,r=void 0===a?"info":a,n=e.timeout;if(t&&["success","error","warn","info"].includes(r)){var o={position:gn,autoClose:n||"error"!==r&&5e3};return ca.toast[r](t,o)}};function Sn(){return(Sn=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var r in a)Object.prototype.hasOwnProperty.call(a,r)&&(e[r]=a[r])}return e}).apply(this,arguments)}function kn(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}var On=function(e){var t=e.form_schema,a=e.ui_schema,o=e.form_id,i=e.formData,s=e.action,c=e.method,l=void 0===c?w.method.POST:c,u=e.submitter,p=e.preProcessData,d=e.children,m=e.validate,h=e.nodeRef,b=e.onChange,v=e.readOnly,y=e.submitDisabled,g=e.variant,_=void 0===g?"default":g,S=function(t){var a=t.formData,r=t.errors;if(u)u({formData:a,errors:r,method:l,action:s});else{var n=p?p(a):a;R({method:l,apiurl:s,data:n}).then((function(t){var a=e.success_msg,r=e.callBack;r&&r({result:t,variant:"success"}),a&&_n({msg:a,variant:"success"}),!r&&!a&&_n({msg:er({path:["formSubmitSuccessDefault"]}),variant:"success"})})).catch((function(t){var a=e.failure_msg,r=e.callBack,n=f.a.parseAxiosError({error:t});r&&r({error:t,variant:"error"}),a&&_n({msg:"".concat(a,"<br/>").concat(n),variant:"error"}),!r&&!a&&_n({msg:"".concat(er({path:["formSubmitFailureDefault"]}),"<br/>").concat(n),variant:"error"})}))}},k=he()(ar.a)((function(e){return n.a.createElement(Xa.a,Sn({schema:t,uiSchema:a,formData:i,onSubmit:S,idPrefix:o,className:se()(e.classes.root,"default"!==_?e.classes[_]:""),action:s,validate:v?null:m,onChange:b,ref:h},yn,{disabled:v}),n.a.createElement("div",{className:se()(kn({},e.classes.footer,"vanilla"!==_),kn({},e.classes.hidden,v),kn({},e.classes.modalFooter,"modal"===_))},d||n.a.createElement(r.Fragment,null,n.a.createElement("div",{className:e.classes.formAction},n.a.createElement(Ue.a,{type:"submit",variant:"contained",color:"primary",disabled:v||y},"Submit")))))}));return n.a.createElement(k,null)};On.propTypes={children:u.a.node,classes:u.a.object,form_schema:u.a.object,ui_schema:u.a.object,formData:u.a.object,form_id:u.a.string,action:u.a.string,callBack:u.a.func,success_msg:u.a.string,failure_msg:u.a.string,method:u.a.string,preProcessData:u.a.func,submitter:u.a.func,validate:u.a.func,onChange:u.a.func,nodeRef:u.a.object,readOnly:u.a.bool,submitDisabled:u.a.bool,variant:u.a.oneOf(["default","full","modal","vanilla"])};var En=On,jn=a(110),Dn=a.n(jn);function wn(e){return(wn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Cn(e,t){for(var a=0;a<t.length;a++){var r=t[a];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Tn(e,t){return(Tn=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Pn(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=Nn(e);if(t){var n=Nn(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return An(this,a)}}function An(e,t){return!t||"object"!==wn(t)&&"function"!=typeof t?Rn(e):t}function Rn(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Nn(e){return(Nn=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Fn(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}var xn=function(e){return{modal:{position:"absolute",height:"max-content",width:102*e.spacing.unit,minWidth:"30%",maxWidth:"80%",maxHeight:"80%",top:"10%",left:"50%",transform:"translateX(-50%)",backgroundColor:e.palette.white,boxShadow:"none",padding:"0 ".concat(e.spacing.unit,"px"),overflow:"scroll",outline:"none","& .bdModal-header":{position:"sticky",background:e.palette.white,display:"flex",justifyContent:"space-between",width:"100%",left:0,top:0,fontFamily:e.typography.fontFamily,padding:2*e.spacing.unit,marginBottom:2*e.spacing.unit,borderBottom:e.border,zIndex:1},"& .bdModal-footer":{position:"sticky",display:"flex",width:"100%",left:0,bottom:0,padding:2*e.spacing.unit,marginTop:1.5*e.spacing.unit},"& .bdModal-actionButtons":{display:"flex",width:"100%",justifyContent:"space-between"}},trim:{padding:0},header:{position:"sticky",background:e.palette.white,display:"flex",justifyContent:"space-between",width:"100%",left:0,top:0,fontFamily:e.typography.fontFamily,padding:2*e.spacing.unit,marginBottom:2*e.spacing.unit,borderBottom:e.border,zIndex:1},header_trim:{marginBottom:0},footer:{position:"sticky",background:e.palette.white,display:"flex",width:"100%",left:0,bottom:0,padding:2*e.spacing.unit,marginTop:1.5*e.spacing.unit,borderTop:e.border},footer_trim:{marginTop:0},actionButtons:{display:"flex",width:"100%",justifyContent:"space-between"}}},Mn=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Tn(e,t)}(i,e);var t,a,r,o=Pn(i);function i(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),(t=o.call(this,e)).state={open:!1},t.handleOpen=t.handleOpen.bind(Rn(t)),t.handleClose=t.handleClose.bind(Rn(t)),t}return t=i,(a=[{key:"handleOpen",value:function(){var e=this.props.onModalOpen;this.setState({open:!0}),e&&e()}},{key:"handleClose",value:function(e){var t=this.props.onModalClose;this.setState({open:!1}),t&&t(e)}},{key:"render",value:function(){var e=this,t=this.props,a=t.children,r=t.name,o=t.description,i=t.Title,s=t.footerCloseBtn,c=void 0!==s&&s,l=t.actionButton,u=t.variant,p=he()(xn)((function(t){var s=t.classes;return n.a.createElement(Dn.a,{"aria-labelledby":r,"aria-describedby":o,open:e.state.open,onClose:e.handleClose},n.a.createElement("div",{className:se()(s.modal,s[u])},n.a.createElement("div",{className:se()(s.header,s["header_"+u])},i),a,c?n.a.createElement("div",{className:se()(s.footer,s["footer_"+u])},n.a.createElement("div",{className:s.actionButtons},l?"":n.a.createElement("span",null)," ",n.a.createElement(Ue.a,{variant:"contained",color:"default",onClick:function(){e.handleClose("close")}},"Close"),l||"")):""))}));return n.a.createElement(p,null)}}])&&Cn(t.prototype,a),r&&Cn(t,r),i}(r.Component);Fn(Mn,"defaultProps",{name:"",description:"",Title:"",variant:"default"}),Fn(Mn,"propTypes",{children:u.a.node,Title:u.a.oneOfType([u.a.string,u.a.node]),name:u.a.string,description:u.a.string,footerCloseBtn:u.a.bool,onModalOpen:u.a.func,onModalClose:u.a.func,classes:u.a.object,actionButton:u.a.node,variant:u.a.oneOf(["default","trim"])});var In=Mn;function Un(e){return(Un="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Ln(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function Bn(e,t){for(var a=0;a<t.length;a++){var r=t[a];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Hn(e,t){return(Hn=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Kn(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=Gn(e);if(t){var n=Gn(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return qn(this,a)}}function qn(e,t){return!t||"object"!==Un(t)&&"function"!=typeof t?Vn(e):t}function Vn(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Gn(e){return(Gn=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function zn(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}var Wn=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Hn(e,t)}(i,e);var t,a,r,o=Kn(i);function i(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),(t=o.call(this,e)).state={progress_variant:!1,progress_title:"",progress_info:"",formData:{}},t.submitForm=t.submitForm.bind(Vn(t)),t.closeModal=t.closeModal.bind(Vn(t)),t.openModal=t.openModal.bind(Vn(t)),t.onModalClose=t.onModalClose.bind(Vn(t)),t.updateStateFormData=t.updateStateFormData.bind(Vn(t)),t.submitApi=t.submitApi.bind(Vn(t)),t.modalSubmitCallback=t.modalSubmitCallback.bind(Vn(t)),t.bdModalChild=n.a.createRef(),t}return t=i,(a=[{key:"componentDidMount",value:function(){var e=this.props.formData,t=void 0===e?{}:e;this.updateStateFormData({formData:t})}},{key:"updateStateFormData",value:function(e){var t=e.formData;this.setState({formData:t})}},{key:"closeModal",value:function(){this.bdModalChild.current.handleClose()}},{key:"openModal",value:function(){this.bdModalChild.current.handleOpen()}},{key:"onModalClose",value:function(){this.setState({formData:{},progress_variant:!1,progress_title:"",progress_info:"",submitted:!1})}},{key:"showCloseButton",value:function(){this.setState({submitted:!0})}},{key:"submitApi",value:function(e){var t=this,a=e.method_actions,r=e.data,n=e.index,o=void 0===n?0:n;R({method:a[o].method,apiurl:a[o].action,data:"FORM_DATA"===a[o].data&&r}).then((function(e){o+1===a.length?t.modalSubmitCallback("success",e):t.submitApi({method_actions:a,data:r,index:o+1})})).catch((function(e){t.modalSubmitCallback("error",e)}))}},{key:"modalSubmitCallback",value:function(e,t){var a="error"===e,r=this.props,n=r.success_msg,o=void 0===n?er({path:["formSubmitSuccessDefault"]}):n,i=r.failure_msg,s=void 0===i?er({path:["formSubmitFailureDefault"]}):i,c=r.callBack;this.updateProgress(function(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?Ln(Object(a),!0).forEach((function(t){zn(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):Ln(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}({variant:e,title:a?s:o},a&&{error:t})),a||(this.setState({validate:{}}),this.showCloseButton()),c&&c({resp:t,variant:e})}},{key:"submitForm",value:function(e){var t=this.props.modalFormSubmitter,a=void 0===t?null:t,r=e.formData;if(!e.errors.length){this.setState({formData:r}),this.updateProgress({variant:"success",title:"... Please Wait"});var n=this.props,o=n.preProcessData,i=n.method_actions,s=o?o(r):r;a?a({method_actions:i,data:s,modalSubmitCallback:this.modalSubmitCallback}):this.submitApi({method_actions:i,data:s})}}},{key:"updateProgress",value:function(e){var t=e.variant,a=e.title,r=e.error,n=void 0===r?null:r,o=t,i=a||t,s=n?f.a.parseAxiosError({error:n}):"";this.setState({progress_variant:o,progress_title:i,progress_info:s})}},{key:"render",value:function(){var e=this,t=this.props,a=t.form_id,r=t.method_actions,o=t.form_schema,i=t.validate,s=t.onChange,c=t.ui_schema,l=void 0===c?{}:c,u=t.name,p=void 0===u?"":u,d=t.description,f=void 0===d?"":d,m=t.Title,h=void 0===m?"":m,b=t.submitDisabled,v=this.state,y=v.progress_variant,g=v.progress_title,_=void 0===g?"":g,S=v.progress_info,k=void 0===S?"":S,O=v.formData,E=v.submitted,j=r.find((function(e){return e.default}))||r[0];return n.a.createElement(In,{name:p,description:f,Title:h,ref:this.bdModalChild,onModalClose:this.onModalClose,variant:"trim"},n.a.createElement(En,{form_schema:o,ui_schema:l,action:j.action||"",method:j.method||"",formData:O,form_id:a,onChange:s,submitter:this.submitForm,validate:E?null:i,variant:"modal"},y?n.a.createElement(Oo,{variant:y,title:_,info:k,fit:"full"}):"",n.a.createElement("div",{className:"bdModal-actionButtons"},n.a.createElement(Ue.a,{type:"button",variant:"contained",color:"default",onClick:function(){e.closeModal()}},E?"Close":"Cancel"),n.a.createElement(Ue.a,{type:"submit",variant:"contained",color:"primary",disabled:b||E},"Submit"))))}}])&&Bn(t.prototype,a),r&&Bn(t,r),i}(r.Component);zn(Wn,"propTypes",{btnOpen:u.a.node,form_id:u.a.string,name:u.a.string,description:u.a.string,Title:u.a.oneOfType([u.a.number,u.a.node]),formData:u.a.object,form_schema:u.a.object,ui_schema:u.a.object,method_actions:u.a.array,success_msg:u.a.string,failure_msg:u.a.string,preProcessData:u.a.func,onChange:u.a.func,callBack:u.a.func,validate:u.a.func,modalFormSubmitter:u.a.func,submitDisabled:u.a.bool});var Jn=Wn;function Yn(e){return(Yn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function $n(e,t){for(var a=0;a<t.length;a++){var r=t[a];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Qn(e,t){return(Qn=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Zn(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=to(e);if(t){var n=to(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return Xn(this,a)}}function Xn(e,t){return!t||"object"!==Yn(t)&&"function"!=typeof t?eo(e):t}function eo(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function to(e){return(to=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function ao(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}var ro=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Qn(e,t)}(i,e);var t,a,r,o=Zn(i);function i(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),ao(eo(t=o.call(this,e)),"handleOpen",(function(e){var a=e.title,r=e.description,n=e.callback,o=e.context,i=e.btnCancel,s=void 0===i?"Cancel":i,c=e.btnSubmit,l=void 0===c?"Ok":c;t.setState({open:!0,title:a,description:r,callback:n,context:o,btnCancel:s,btnSubmit:l})})),ao(eo(t),"handleClick",(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"cancel",a=t.state,r=a.callback,n=a.context;t.setState({open:!1}),"submit"===e&&r&&r(n),t.setState({callback:null,context:void 0,title:"",description:"",btnCancel:"",btnSubmit:""})})),t.state={open:!1,callback:null,context:void 0,title:"",description:"",btnCancel:"",btnSubmit:""},t.handleOpen=t.handleOpen.bind(eo(t)),t.handleClick=t.handleClick.bind(eo(t)),t}return t=i,(a=[{key:"render",value:function(){var e=this,t=this.state,a=t.title,r=t.description,o=t.btnCancel,i=t.btnSubmit,s=t.callback,c=this.props.maxWidth,l=void 0===c?"lg":c;return n.a.createElement(St.Dialog,{maxWidth:l,open:this.state.open,onClose:this.handleClick},a?n.a.createElement(St.DialogTitle,{id:"bddialog-title"},a):"",r?n.a.createElement(St.DialogContent,{id:"bddialog-content"},r):"",n.a.createElement(St.DialogActions,null,n.a.createElement("span",{style:{visibility:null===s?"hidden":"visible"}},n.a.createElement(St.Button,{variant:"contained",onClick:function(){e.handleClick("cancel")}},o)),n.a.createElement(St.Button,{variant:"contained",color:"primary",onClick:function(){e.handleClick("submit")}},i)))}}])&&$n(t.prototype,a),r&&$n(t,r),i}(r.Component);ao(ro,"propTypes",{maxWidth:u.a.string});var no=ro,oo=a(156),io=a.n(oo),so=a(98),co=a.n(so),lo=a(351);function uo(e){return(uo="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function po(e,t){for(var a=0;a<t.length;a++){var r=t[a];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function fo(e,t){return(fo=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function mo(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=vo(e);if(t){var n=vo(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return ho(this,a)}}function ho(e,t){return!t||"object"!==uo(t)&&"function"!=typeof t?bo(e):t}function bo(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function vo(e){return(vo=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function yo(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}var go=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&fo(e,t)}(i,e);var t,a,r,o=mo(i);function i(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),yo(bo(t=o.call(this,e)),"handleChange",(function(e,a){t.setState({value:a})})),t.state={value:0},t.handleChange=t.handleChange.bind(bo(t)),t}return t=i,(a=[{key:"componentDidUpdate",value:function(e){e.location.pathname!==this.props.location.pathname&&this.updateTab()}},{key:"componentDidMount",value:function(){this.updateTab()}},{key:"updateTab",value:function(){var e=this.props,t=e.tabs,a=e.location,r=(void 0===a?{}:a).hash,n=void 0===r?"":r,o=0;n&&t.some((function(e,t){return!!n.includes(e.key)&&(o=t,!0)})),this.setState({value:o})}},{key:"render",value:function(){var e=this.state.value,t=this.props,a=t.tabs,r=t.tabContents,o=t.location,i=void 0===o?{}:o;return n.a.createElement("div",null,n.a.createElement(io.a,{value:e,onChange:this.handleChange,indicatorColor:"primary"},a.map((function(e,t){return n.a.createElement(co.a,{label:e.label,key:t,value:t,component:lo.a,to:"".concat(i.search,"#").concat(e.key)})}))),r[e])}}])&&po(t.prototype,a),r&&po(t,r),i}(r.Component);yo(go,"propTypes",{tabs:u.a.array,tabContents:u.a.array,location:u.a.object});var _o=go,So=function(e){return{root:{display:"block",width:"100%",height:"1rem",lineHeight:"1rem",fontFamily:e.typography.fontFamily,fontSize:".8rem",fontWeight:300,textAlign:"center",color:e.palette.white,marginBottom:e.spacing.unit},success:{backgroundColor:e.palette.success.main},warning:{backgroundColor:e.palette.warning.main},error:{backgroundColor:e.palette.error.main},info:{backgroundColor:e.palette.secondary.main}}},ko=function(e){var t=e.variant,a=e.title,r=e.info,o=e.fit,i=void 0===o?"default":o,s=he()(So)((function(e){var o=n.a.createElement("span",{className:se()(e.classes.root,e.classes[t])},a);return r?n.a.createElement(ka,{title:r,variant:t,fit:i},o):o}));return n.a.createElement(s,null)};ko.propTypes={classes:u.a.object,title:u.a.string,variant:u.a.string,info:u.a.string,fit:u.a.oneOf(["default","full"])};var Oo=ko,Eo=function(e){return{tree:{},branch:{},children:{paddingLeft:18,display:"none"},expanded:{display:"block"},disabled:{cursor:"initial !important"},root:{padding:e.spacing.unit},selectedPathContainer:{display:"flex",alignItems:"center",justifyContent:"space-between",height:54},selectedPath:{padding:e.spacing.unit,marginTop:e.spacing.unit,marginBottom:e.spacing.unit,background:e.palette.gray200,border:"1px solid ".concat(e.palette.gray400),width:"100%"},selectedPathAction:{height:"100%",padding:"".concat(e.spacing.unit,"px 0")},node:{display:"flex",paddingBottom:e.spacing.unit,cursor:"pointer","& .icon":{color:e.palette.gray700,paddingRight:.5*e.spacing.unit},"&:hover":{"&:not($disabled) .icon":{color:e.palette.primary.main},"&:not($disabled) p":{background:e.palette.primary.main,color:e.palette.white}}},selected:{"&:not($disabled) .icon":{color:e.palette.primary.main},"&:not($disabled) p":{background:e.palette.primary.main,color:e.palette.white}},gap:{width:18,paddingRight:.5*e.spacing.unit},info:{display:"flex","& p":{padding:"0 ".concat(.5*e.spacing.unit,"px")}},input:{width:"100%",border:"1px solid ".concat(e.palette.gray500),fontFamily:e.typography.fontFamily,fontSize:"1rem",height:"2rem",color:e.palette.gray900,padding:"0 ".concat(e.spacing.unit,"px")}}};function jo(e){return(jo="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Do(e,t){for(var a=0;a<t.length;a++){var r=t[a];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function wo(e,t){return(wo=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Co(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=Ao(e);if(t){var n=Ao(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return To(this,a)}}function To(e,t){return!t||"object"!==jo(t)&&"function"!=typeof t?Po(e):t}function Po(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Ao(e){return(Ao=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Ro(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}var No=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&wo(e,t)}(i,e);var t,a,r,o=Co(i);function i(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),(t=o.call(this,e)).state={selected:!1},t.handleClick=t.handleClick.bind(Po(t)),t}return t=i,(a=[{key:"handleClick",value:function(e){var t=e.event,a=e.action,r=this.props,n=r.node,o=r.updateSelectedPath,i=r.handleExpand,s=r.selected_path,c=n.path,l=void 0===c?"":c,u=this.state.selected;if("select"===a){var p=l!==s||!u;o({event:t,path:p?l:"/"}),this.setState({selected:p})}else"expand"===a&&i()}},{key:"render",value:function(){var e=this,t=this.props,a=t.classes,r=t.node,o=t.selected_path,i=t.expanded,s=t.source_type,c=t.name,l=void 0===c?"":c,u=t.disabled,p=r.path,d=void 0===p?"":p,f=r.is_folder,m=void 0!==f&&f,h=r.isRoot,b=void 0!==h&&h,v=r.childNodes;return n.a.createElement("div",{className:se()(a.node,Ro({},a.selected,d===o),Ro({},a.disabled,u)),onClick:function(t){e.handleClick({event:t,action:"select"})}},m?n.a.createElement("span",{className:se()("icon",{"icon-border-outer":!v},{"icon-minus-square":v&&i},{"icon-plus-square":v&&!i}),onClick:function(t){e.handleClick({action:"expand"}),t.stopPropagation()}}):n.a.createElement("span",{className:a.gap}),n.a.createElement("div",{className:a.info},n.a.createElement("span",{className:se()("icon",m?"icon-folder":"icon-file-empty")}),n.a.createElement(st.a,{variant:"body2"},b?"fsMount"===s?l:d:d.split("/").pop())))}}])&&Do(t.prototype,a),r&&Do(t,r),i}(r.Component);Ro(No,"propTypes",{classes:u.a.object,node:u.a.object,expanded:u.a.bool,updateSelectedPath:u.a.func,handleExpand:u.a.func,selected_path:u.a.string,source_type:u.a.string,name:u.a.string,disabled:u.a.bool});var Fo=Object(ke.withStyles)(Eo)(No);function xo(e){return(xo="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Mo(){return(Mo=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var r in a)Object.prototype.hasOwnProperty.call(a,r)&&(e[r]=a[r])}return e}).apply(this,arguments)}function Io(e,t){for(var a=0;a<t.length;a++){var r=t[a];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Uo(e,t){return(Uo=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Lo(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=Ko(e);if(t){var n=Ko(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return Bo(this,a)}}function Bo(e,t){return!t||"object"!==xo(t)&&"function"!=typeof t?Ho(e):t}function Ho(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Ko(e){return(Ko=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var qo=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Uo(e,t)}(i,e);var t,a,r,o=Lo(i);function i(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),(t=o.call(this,e)).state={expanded:!1},t.expandRoot=t.expandRoot.bind(Ho(t)),t.handleExpand=t.handleExpand.bind(Ho(t)),t}return t=i,(a=[{key:"componentDidMount",value:function(){var e=this.props,t=e.node,a=void 0===t?{}:t,r=e.fetchChildData,n=e.useFolderActions,o=void 0!==n&&n,i=a.isRoot;void 0!==i&&i&&o&&r({node:a,expandRoot:this.expandRoot})}},{key:"expandRoot",value:function(){this.setState({expanded:!0})}},{key:"handleExpand",value:function(){var e=this.state.expanded,t=this.props,a=t.node,r=t.fetchChildData,n=a.childNodes;this.setState({expanded:!n||!e}),!n&&r({node:a,expandRoot:this.expandRoot})}},{key:"render",value:function(){var e=this.props,t=e.classes,a=e.updateSelectedPath,r=e.fetchChildData,o=e.selected_path,s=e.source_type,c=e.node,l=e.name,u=e.disabled,p=c.isRoot,d=c.childNodes,f=void 0===d?[]:d,m=this.state.expanded,h=this.handleExpand;return n.a.createElement("div",{className:se()(t.branch,p?t.root:"")},n.a.createElement(Fo,{node:c,selected_path:o,updateSelectedPath:a,expanded:m,handleExpand:h,source_type:s,name:l,disabled:u}),!u&&f&&f.length?n.a.createElement("div",{className:se()(t.children,m?t.expanded:"")},f.map((function(e,s){return e.is_folder?n.a.createElement(i,Mo({updateSelectedPath:a,fetchChildData:r,selected_path:o,node:e,classes:t},{key:s})):n.a.createElement(Fo,Mo({updateSelectedPath:a,selected_path:o,node:e},{key:s}))}))):"")}}])&&Io(t.prototype,a),r&&Io(t,r),i}(r.Component);!function(e,t,a){t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a}(qo,"propTypes",{classes:u.a.object,node:u.a.object,selected_path:u.a.string,updateSelectedPath:u.a.func,fetchChildData:u.a.func,source_type:u.a.string,useFolderActions:u.a.bool,name:u.a.string,disabled:u.a.bool});var Vo=Object(ke.withStyles)(Eo)(qo);function Go(e){return(Go="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function zo(e,t){for(var a=0;a<t.length;a++){var r=t[a];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Wo(e,t){return(Wo=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Jo(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=$o(e);if(t){var n=$o(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return Yo(this,a)}}function Yo(e,t){return!t||"object"!==Go(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function $o(e){return($o=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var Qo=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Wo(e,t)}(i,e);var t,a,r,o=Jo(i);function i(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),(t=o.call(this,e)).state={name:""},t}return t=i,(a=[{key:"componentDidMount",value:function(){var e=this.props.newName,t=void 0===e?"":e;this.setState({name:t})}},{key:"render",value:function(){var e=this,t=this.props,a=t.newNameError,r=t.classes,o=this.state.name;return n.a.createElement("div",{className:r.inputGroup},n.a.createElement("input",{className:r.input,onChange:function(t){e.setState({name:t.target.value})},id:"new_name",name:"new_name",type:"text",value:o}),a?n.a.createElement(st.a,{className:r.error,variant:"caption",color:"error"},a):"")}}])&&zo(t.prototype,a),r&&zo(t,r),i}(r.Component);!function(e,t,a){t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a}(Qo,"propTypes",{classes:u.a.object,newName:u.a.string,newNameError:u.a.string});var Zo=Object(ke.withStyles)(Eo)(Qo),Xo=function(e){var t=e.op,a=e.opts,r=e.formData,n=e.events,o=void 0===n?{}:n,i=o.onProgress,s=void 0===i?null:i,c=o.onReadyStateChange,l=void 0===c?null:c,u=o.onAbort,p=void 0===u?null:u,d=o.onError,m=void 0===d?null:d,h=new XMLHttpRequest;s&&h.upload.addEventListener("progress",(function(e){return s(e)})),l&&h.addEventListener("readystatechange",(function(e){return l(e)})),p&&h.addEventListener("abort",(function(e){h.removeEventListener("readystatechange",(function(e){return l(e)})),p(e)})),m&&h.addEventListener("error",(function(e){return m(e)})),h.open("POST",w.apiurl.API),h.setRequestHeader("X-CSRFToken",A.a.get("csrftoken")),h.setRequestHeader("Cache-Control","no-cache"),h.setRequestHeader("X-OP",t),a&&!f.a.isEmptyObject(a)&&h.setRequestHeader("X-DATA",JSON.stringify(a)),h.send(r)};function ei(e){return(ei="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function ti(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function ai(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?ti(Object(a),!0).forEach((function(t){li(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):ti(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function ri(e,t){for(var a=0;a<t.length;a++){var r=t[a];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function ni(e,t){return(ni=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function oi(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=ci(e);if(t){var n=ci(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return ii(this,a)}}function ii(e,t){return!t||"object"!==ei(t)&&"function"!=typeof t?si(e):t}function si(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function ci(e){return(ci=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function li(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}var ui=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&ni(e,t)}(i,e);var t,a,r,o=oi(i);function i(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),(t=o.call(this,e)).state={tree:{},selected_path:"",fileUploads:{}},t.fetchChildData=t.fetchChildData.bind(si(t)),t.updateSelectedPath=t.updateSelectedPath.bind(si(t)),t.updateChildNodes=t.updateChildNodes.bind(si(t)),t.folderAction=t.folderAction.bind(si(t)),t.selectNode=t.selectNode.bind(si(t)),t.postApi=t.postApi.bind(si(t)),t.validateName=t.validateName.bind(si(t)),t.checkAnUploadFile=t.checkAnUploadFile.bind(si(t)),t.onFileUploadProgress=t.onFileUploadProgress.bind(si(t)),t.onFileReadyStateChange=t.onFileReadyStateChange.bind(si(t)),t.onFileUploadAbort=t.onFileUploadAbort.bind(si(t)),t.removeCompletedUploads=t.removeCompletedUploads.bind(si(t)),t.getUploadTableSettings=t.getUploadTableSettings.bind(si(t)),t.getCurrentUpload=t.getCurrentUpload.bind(si(t)),t.bdDialogChildRef=n.a.createRef(),t.fileInputRef=n.a.createRef(),t.bdModalChildRef=n.a.createRef(),t}return t=i,(a=[{key:"componentDidMount",value:function(){var e=this.props,t=e.source,a=e.source_type,r=e.path,n=this.state.tree;n=ai(ai({},n),{},{source:t,source_type:a,path:r,is_folder:!0,isRoot:!0}),this.setState({tree:n}),this.updateSelectedPath({path:r})}},{key:"componentWillUnmount",value:function(){this.fileInputRef.current&&this.fileInputRef.current.removeEventListener("change",this.checkAnUploadFile,!1)}},{key:"fetchChildData",value:function(e){var t=this,a=e.node,r=e.expandRoot,n=void 0===r?null:r,o=e.refresh,i=void 0!==o&&o,s=e.callback,c=void 0===s?null:s,l=this.props,u=l.source,p=l.source_type,d=l.name,m=a.path,h=a.isRoot,b=a.childNodes,v=f.a.encodeSpecialCharacters(m);i||!b?R({op:w.op.DATA_SOURCE_ACTION,data:{path:h?v:v+"/",source:u,source_type:p,name:d,action:"browse"}}).then((function(e){var a=f.a.fetchSafeFromObject({path:["data","_embedded","query_results","matching_objects"],obj:e,default_value:[]});if(a.length){var r=a.map((function(e){return{is_folder:e.is_folder,path:"".concat(m).concat("/"===m?"":"/").concat(e.path_from_dataconn.split("/").filter((function(e){return""!==e})).pop()),isRoot:!1}}));t.updateChildNodes({childNodes:r,path:m,callback:c})}else t.updateChildNodes({childNodes:[],path:m,callback:c});h&&n&&n()})).catch((function(e){f.a.bdLog(e)})):c&&c()}},{key:"updateChildNodes",value:function(e){var t=e.childNodes,a=e.path,r=e.callback,n=this.state.tree,o=this.selectNode({path:a,tree:n});o&&(o.childNodes=t),this.setState({tree:n},r)}},{key:"selectNode",value:function(e){var t,a=e.path,r=e.tree;return a&&(t=a.split("/").filter((function(e){return""!==e})).reduce((function(e,t){var a=e.childNodes,r=void 0===a?[]:a;return r.length?r.find((function(e){return e.path.split("/").filter((function(e){return""!==e})).pop()===t})):e}),r)),t}},{key:"updateSelectedPath",value:function(e){var t=e.event,a=e.path,r=this.props,n=r.onClick,o=void 0===n?null:n,i=r.source,s=r.name;this.setState({selected_path:a}),o&&o({name:s,source:i,event:t,path:a})}},{key:"folderAction",value:function(e){var t=this,a=e.action,r=e.newNameError,o=void 0===r?"":r,i=e.prevName,s=void 0===i?"":i,c=this.props,l=c.name,u=void 0===l?"":l,p=c.source_type,d=this.state,f=d.selected_path,m=d.tree,h=this.selectNode({path:f,tree:m}),b=o?s:"rename"===a?h.path.split("/").filter((function(e){return""!==e})).pop():"";switch(a){case"create":this.fetchChildData({node:h,callback:function(){t.bdDialogChildRef.current.handleOpen({callback:t.validateName,context:{action:a,node:h},title:er({path:["dataSource",a,"title"]})(h.path),description:n.a.createElement(Zo,{newName:b,newNameError:o})})}});break;case"rename":this.bdDialogChildRef.current.handleOpen({callback:this.validateName,context:{action:a,node:h},title:er({path:["dataSource",a,"title"]})(h.path),description:n.a.createElement(Zo,{newName:b,newNameError:o})});break;case"delete":this.bdDialogChildRef.current.handleOpen({callback:this.postApi,context:{action:a},title:er({path:["dataSource","delete","title"]})(h.is_folder),description:n.a.createElement(st.a,{variant:"caption"},"dataTap"===p?"dtap://":"/bd-fs-mnt/",u,h.path)});break;case"download":this.postApi({action:a});break;case"upload":this.fileInputRef.current.addEventListener("change",this.checkAnUploadFile,!1),this.fileInputRef.current.click()}}},{key:"validateName",value:function(e){var t=this,a=e.action,r=e.node,n=document.querySelector("#new_name").value,o=n?"":er({path:["dataSource",a,"name","required"]});if(!o){var i,s,c=this.state.tree;switch(a){case"create":s=this.selectNode({path:r.path,tree:c});break;case"rename":i=this.getParentPath({path:r.path}),s=this.selectNode({path:i,tree:c})}var l=s.childNodes;(void 0===l?[]:l).some((function(e){if((e.is_folder?e.path.split("/").filter((function(e){return""!==e})).pop():"")===n)return o=er({path:["dataSource",a,"name","error"]}),!0}))}o?this.timeout=setTimeout((function(){t.folderAction({action:a,newNameError:o,prevName:n})}),10):this.postApi({action:a,newName:n})}},{key:"postApi",value:function(e){var t=this,a=e.action,r=e.newName,n=void 0===r?"":r,o=this.state,i=o.selected_path,s=o.tree,c=this.selectNode({path:i,tree:s}),l=f.a.encodeSpecialCharacters(i),u=this.props,p=u.name,d=u.type,m=void 0===d?"":d,h=u.source,b=u.source_type,v=u.isKerberized;if("download"===a){var y="".concat(window.location.protocol,"//").concat(window.location.host).concat(w.views.download.url,"?content=data_source&path=").concat(l,"&source_type=").concat(b);y+="dataTap"===b?"&type=".concat(m,"&isKerberized=").concat(v):"&name=".concat(p),window.open(y)}else{var g={op:w.op.DATA_SOURCE_ACTION,data:{path:l,source:h,source_type:b,action:a}};"dataTap"===b?(g.data.isKerberized=v,g.data.type=m):g.data.name=p,n&&(g.data.newName=encodeURIComponent(n)),R(g).then((function(){_n({msg:er({path:["dataSource",a,"success"]})(i,c.is_folder),variant:"success"}),t.updateDataOnAction({action:a})})).catch((function(e){var t=f.a.parseAxiosError({error:e});_n({msg:er({path:["dataSource",a,"error"]})(i,c.is_folder)+t,variant:"error"})}))}}},{key:"updateDataOnAction",value:function(e){var t,a=e.action,r=this.state,n=r.selected_path,o=r.tree;["delete","rename"].includes(a)&&(t=this.getParentPath({path:n}),this.setState({selected_path:t}));var i=this.selectNode({path:t||n,tree:o});this.fetchChildData({node:i,refresh:!0})}},{key:"getParentPath",value:function(e){var t=e.path;return(void 0===t?"":t).split("/").filter((function(e){return""!==e})).slice(0,-1).join("/")||"/"}},{key:"getCurrentUpload",value:function(e){var t=this.state.fileUploads;return(void 0===t?{}:t)[e]}},{key:"getUploadTableSettings",value:function(){var e=this,t=this.state.fileUploads,a=void 0===t?{}:t;return{columns:[{name:"FILE",options:{filter:!0}},{name:"PROGRESS",options:{filter:!0,customBodyRender:function(e){var t=JSON.parse(e),a=t.status,r=t.percent,o=t.msg,i=void 0===o?"":o;return n.a.createElement(Qa,{status:a,tooltip:i,title:"uploading"===a?"uploading(".concat(r,"%)"):a})}}},{name:"ACTIONS",options:{filter:!0,customBodyRender:function(t){var a=e.getCurrentUpload(t);return n.a.createElement("div",{className:"row-action-btns"},"uploading"===a.status?n.a.createElement(ka,{title:"Cancel file upload",variant:"error"},n.a.createElement("span",{className:se()("icon","icon-rect-link","icon-cross"),onClick:function(){a.xhr.abort()}})):"")}}}],data:Object.keys(a).reduce((function(e,t){var r=a[t],n=r.fileName,o=r.status,i=r.msg,s=r.percent;return e.push([n,JSON.stringify({percent:s,status:o,msg:i}),t]),e}),[]),title:"",options:{pagination:!1,selectableRows:"none",sort:!1,filter:!1,search:!1}}}},{key:"checkAnUploadFile",value:function(){var e=this,t=this.state.selected_path,a=f.a.encodeSpecialCharacters(t),r=this.props,n=r.name,o=r.type,i=void 0===o?"":o,s=r.source,c=r.source_type,l=r.isKerberized,u=this.fileInputRef.current.files;Array.from(u).forEach((function(t){var r=new Date,o=t.name,u="fileId_"+o.split(".")[0].split(" ").join("_")+"_"+r.getTime(),p={action:"upload",path:"".concat("/"===a?"":a,"/").concat(f.a.encodeSpecialCharacters(o)),source:s,source_type:c};"dataTap"===c?(p.isKerberized=l,p.type=i):p.name=n;var d=new FormData;d.append("user_file",t),Xo({op:w.op.DATA_SOURCE_ACTION,opts:p,formData:d,events:{onProgress:e.onFileUploadProgress({fileId:u}),onReadyStateChange:e.onFileReadyStateChange({fileId:u,fileName:o}),onAbort:e.onFileUploadAbort({fileId:u,fileName:o})}})}))}},{key:"onFileUploadProgress",value:function(e){var t=this,a=e.fileId;return function(e){var r=t.state.fileUploads,n=r[a],o=n.xhr,i=void 0===o?null:o;!i||0===i.status&&"abort"===i.statusText||t.setState({fileUploads:ai(ai({},r),{},li({},a,ai(ai({},n),{},{status:"uploading",percent:Math.ceil(e.loaded/e.total*100)})))})}}},{key:"onFileReadyStateChange",value:function(e){var t=this,a=e.fileId,r=e.fileName;return function(e){var n=t.state.fileUploads,o=null;try{o=e.target.readyState}catch(l){return}if(1===o&&(t.setState({fileUploads:ai(ai({},n),{},li({},a,{xhr:e.target,fileName:r,status:"started",percent:0}))}),t.bdModalChildRef.current.handleOpen()),4===o){var i=n[a],s=e.target.status;if(s>=200&&s<=207)t.setState({fileUploads:ai(ai({},n),{},li({},a,ai(ai({},i),{},{status:"completed",percent:100})))}),t.updateDataOnAction({action:"upload"});else{var c=f.a.parseAxiosError({error:e.target.response})||"";t.setState({fileUploads:ai(ai({},n),{},li({},a,ai(ai({},i),{},{status:"error",percent:0,msg:c})))})}}}}},{key:"onFileUploadAbort",value:function(e){var t=this,a=e.fileId,r=e.fileName;return function(){var e=t.state.fileUploads;t.setState({fileUploads:ai(ai({},e),{},li({},a,{fileName:r,status:"cancelled",percent:0}))})}}},{key:"removeCompletedUploads",value:function(){var e=this.state.fileUploads,t=Object.keys(e).reduce((function(t,a){var r=e[a];return"completed"!==r.status&&r.xhr&&(t[a]=r),t}),{});this.setState({fileUploads:t})}},{key:"render",value:function(){var e=this.props,t=e.classes,a=e.source_type,r=e.name,o=e.useFolderActions,i=void 0!==o&&o,s=e.is_local,c=void 0!==s&&s,l=e.isReadOnly,u=e.selectedPathActionElement,p=void 0===u?null:u,d=e.browseDisabled,m=void 0!==d&&d,h=this.state,b=h.selected_path,v=h.tree,y=this.selectNode({path:b,tree:v}),g=this.getUploadTableSettings();return n.a.createElement("div",{className:t.tree},i&&y?n.a.createElement("div",{className:t.actions},"fsMount"!==a&&!c||l||m?"":n.a.createElement("div",{className:t.actionList},n.a.createElement(ki,{title:"Create Directory",icon:"icon-plus",disabled:!y.is_folder,callback:this.folderAction,params:{action:"create"}}),n.a.createElement(ki,{title:"Rename",icon:"icon-pencil3",disabled:y.isRoot,callback:this.folderAction,params:{action:"rename"}}),n.a.createElement(ki,{title:"File Upload",icon:"icon-upload2",disabled:!y.is_folder,callback:this.folderAction,params:{action:"upload"}}),n.a.createElement(ki,{title:"File Download",icon:"icon-download2",disabled:y.is_folder,callback:this.folderAction,params:{action:"download"}}),n.a.createElement(ki,{title:"Delete",icon:"icon-trash2",variant:"error",disabled:y.isRoot,callback:this.folderAction,params:{action:"delete"}}),n.a.createElement("input",{type:"file",multiple:!0,id:"file_upload",name:"file_upload",style:{display:"none"},ref:this.fileInputRef})),n.a.createElement("div",{className:t.selectedPathContainer},n.a.createElement("div",{className:t.selectedPath},n.a.createElement(st.a,{variant:"body2"},"dataTap"===a?"dtap://":"/bd-fs-mnt/",r,y.path)),p&&!m&&n.a.createElement("div",{className:t.selectedPathAction},p))):"",f.a.isEmptyObject(v)?"":n.a.createElement(Vo,{updateSelectedPath:this.updateSelectedPath,fetchChildData:this.fetchChildData,selected_path:b,node:v,name:r,source_type:a,useFolderActions:i,disabled:m}),i?n.a.createElement("div",{className:t.actionForms},n.a.createElement(no,{ref:this.bdDialogChildRef}),n.a.createElement(In,{ref:this.bdModalChildRef,Title:"Upload status",name:"File upload status modal",description:"Displays the list of ongoing file uploads and its status",onModalClose:this.removeCompletedUploads,footerCloseBtn:!0},n.a.createElement(sa,g))):"")}}])&&ri(t.prototype,a),r&&ri(t,r),i}(r.Component);li(ui,"propTypes",{classes:u.a.object,source:u.a.string.isRequired,source_type:u.a.string.isRequired,name:u.a.string.isRequired,type:u.a.string,path:u.a.string.isRequired,useFolderActions:u.a.bool,onClick:u.a.func,isKerberized:u.a.bool,selectedPathActionElement:u.a.node,is_local:u.a.bool,isReadOnly:u.a.bool,browseDisabled:u.a.bool});var pi=Object(ke.withStyles)(Eo)(ui),di=a(109),fi=a.n(di);function mi(e){return(mi="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function hi(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function bi(e,t){for(var a=0;a<t.length;a++){var r=t[a];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function vi(e,t){return(vi=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function yi(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=_i(e);if(t){var n=_i(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return gi(this,a)}}function gi(e,t){return!t||"object"!==mi(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function _i(e){return(_i=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var Si=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&vi(e,t)}(i,e);var t,a,r,o=yi(i);function i(){return hi(this,i),o.apply(this,arguments)}return t=i,(a=[{key:"render",value:function(){var e=this.props,t=e.title,a=e.variant,r=void 0===a?"primary":a,o=e.icon,i=e.disabled,s=void 0!==i&&i,c=e.callback,l=void 0===c?null:c,u=e.params,p=void 0===u?null:u,d=e.classes,f=(void 0===d?{}:d).btn,m=void 0===f?{}:f;return n.a.createElement(ka,{title:t,variant:r},n.a.createElement(fi.a,{className:se()(m,r,"action-btn"),disableRipple:!0,disabled:s,onClick:function(){l&&l(p)}},n.a.createElement("span",{className:se()("icon",o)})))}}])&&bi(t.prototype,a),r&&bi(t,r),i}(r.Component);!function(e,t,a){t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a}(Si,"propTypes",{classes:u.a.object,variant:u.a.oneOf(["primary","info","success","warning","error"]),title:u.a.string,icon:u.a.string,disabled:u.a.bool,callback:u.a.func,params:u.a.any});var ki=Si;function Oi(e){return(Oi="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Ei(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function ji(e,t){for(var a=0;a<t.length;a++){var r=t[a];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Di(e,t){return(Di=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function wi(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=Ti(e);if(t){var n=Ti(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return Ci(this,a)}}function Ci(e,t){return!t||"object"!==Oi(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Ti(e){return(Ti=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Pi(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function Ai(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}var Ri=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Di(e,t)}(i,e);var t,a,r,o=wi(i);function i(){return Ei(this,i),o.apply(this,arguments)}return t=i,(a=[{key:"render",value:function(){var e=this.props,t=e.classes,a=e.variant;return n.a.createElement("span",{className:se()(t.badge,t[a])})}}])&&ji(t.prototype,a),r&&ji(t,r),i}(r.Component);Ai(Ri,"propTypes",{classes:u.a.object,variant:u.a.oneOf(["primary","success","warning","error","info","disabled"])});var Ni=Object(ke.withStyles)((function(e){return function(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?Pi(Object(a),!0).forEach((function(t){Ai(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):Pi(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}({badge:{display:"inline-block",height:2*e.spacing.unit,width:2*e.spacing.unit,borderRadius:"50%",padding:0,margin:0,verticalAlign:"middle"}},e.variants)}))(Ri),Fi=a(150),xi=a.n(Fi),Mi=a(152),Ii=a.n(Mi),Ui=a(151),Li=a.n(Ui);function Bi(e){return(Bi="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Hi(e,t){for(var a=0;a<t.length;a++){var r=t[a];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Ki(e,t){return(Ki=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function qi(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=zi(e);if(t){var n=zi(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return Vi(this,a)}}function Vi(e,t){return!t||"object"!==Bi(t)&&"function"!=typeof t?Gi(e):t}function Gi(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function zi(e){return(zi=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Wi(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}var Ji=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Ki(e,t)}(i,e);var t,a,r,o=qi(i);function i(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),(t=o.call(this,e)).state={expanded:!1},t.onChangeAccordion=t.onChangeAccordion.bind(Gi(t)),t}return t=i,(a=[{key:"componentDidMount",value:function(){var e=this.props.expanded;this.setState({expanded:e})}},{key:"onChangeAccordion",value:function(){var e=this.props.onChange,t=void 0===e?null:e,a=this.state.expanded;this.setState({expanded:!a}),t&&t()}},{key:"render",value:function(){var e=this.props,t=e.header,a=e.classes,r=e.children,o=e.icon,i=void 0===o?"":o,s=e.direction,c=void 0===s?"default":s,l=e.placement,u=void 0===l?"start":l,p=e.noBackground,d=void 0!==p&&p,f=e.iconPlacement,m=void 0===f?"start":f,h=e.noPad,b=void 0!==h&&h,v=e.iconSize,y=void 0===v?"default":v,g=this.state.expanded,_=i?n.a.createElement("span",{className:"icon ".concat(i)}):"";return n.a.createElement(xi.a,{className:se()(a.accordion,"reverse"===c?a.reverse:""),onChange:this.onChangeAccordion,expanded:g},n.a.createElement(Ii.a,{expandIcon:_,classes:{expandIcon:se()(a.expandIcon,Wi({},a.iconEnd,"end"===m),Wi({},a[y],"default"!==y)),expanded:a.expanded,content:se()(a.content,Wi({},a.contentEnd,"end"===u),Wi({},a.contentStart,"end"!==u),Wi({},a.contentWithIconEnd,"end"===m))},className:se()(a.summary,d?a.noBg:"",Wi({},a.noPad,b))},t),n.a.createElement(Li.a,{className:se()(a.container,Wi({},a.noPad,b))},r))}}])&&Hi(t.prototype,a),r&&Hi(t,r),i}(r.Component);Wi(Ji,"propTypes",{classes:u.a.object.isRequired,header:u.a.node.isRequired,children:u.a.node.isRequired,icon:u.a.string.isRequired,direction:u.a.oneOf(["default","reverse"]),placement:u.a.oneOf(["start","end"]),iconPlacement:u.a.oneOf(["start","end"]),iconSize:u.a.oneOf(["lg","md","default","sm"]),onChange:u.a.func,expanded:u.a.bool,noBackground:u.a.bool,noPad:u.a.bool});var Yi=Object(ke.withStyles)((function(e){return{accordion:{display:"flex",flexDirection:"column"},reverse:{flexDirection:"column-reverse"},summary:{width:"100%",margin:"0 0 ".concat(e.spacing.unit,"px"),background:e.palette.gray200},noBg:{background:"transparent !important"},content:{padding:"0 ".concat(e.spacing.unit,"px 0 ").concat(3*e.spacing.unit,"px"),justifyContent:"space-between","& > :last-child":{paddingRight:0}},contentEnd:{justifyContent:"flex-end"},contentWithIconEnd:{padding:"0 ".concat(e.spacing.unit,"px !important")},expandIcon:{left:0,padding:0,width:3*e.spacing.unit},iconEnd:{left:"initial !important"},lg:{fontSize:e.typography.fontSizeXLarge},md:{fontSize:e.typography.fontSizeMLarge},sm:{fontSize:e.typography.fontSizeSmall},container:{padding:"0 ".concat(e.spacing.unit,"px ").concat(2*e.spacing.unit,"px")},noPad:{padding:"0 !important"}}}))(Ji);function $i(e){return($i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Qi(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Zi(e,t){for(var a=0;a<t.length;a++){var r=t[a];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Xi(e,t){return(Xi=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function es(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=as(e);if(t){var n=as(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return ts(this,a)}}function ts(e,t){return!t||"object"!==$i(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function as(e){return(as=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var rs=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Xi(e,t)}(i,e);var t,a,r,o=es(i);function i(){return Qi(this,i),o.apply(this,arguments)}return t=i,(a=[{key:"render",value:function(){var e=this.props,t=e.errors,a=e.classes;return n.a.createElement(Ia,null,t.map((function(e,t){return n.a.createElement(st.a,{variant:"caption",className:a.preserveWhitespace,key:t},e)})))}}])&&Zi(t.prototype,a),r&&Zi(t,r),i}(r.Component);!function(e,t,a){t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a}(rs,"propTypes",{errors:u.a.array,classes:u.a.object});var ns=he()((function(e){return{preserveWhitespace:e.bdMixins.PreserveWhitespace}}))(rs),os=a(242),is=a.n(os);function ss(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}var cs=function(e){var t=e.size,a=void 0===t?"28px":t,r=e.status,o=e.center,i=void 0!==o&&o,s=e.classes;return n.a.createElement("div",{className:se()(s.bdLoading,ss({},s.center,i))},n.a.createElement(is.a,{size:a}),!!r&&n.a.createElement(st.a,null,r))},ls=he()((function(){return{bdLoading:{position:"absolute",top:"50%",left:"50%",transfrom:"translate(-50%)",display:"flex",flexDirection:"column",alignItems:"center",justifyContents:"center"},center:{position:"fixed"}}}))(cs);cs.propTypes={classes:u.a.object,size:u.a.string,status:u.a.string,center:u.a.bool};var us=a(707),ps=a.n(us);function ds(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}var fs=function(e){var t=e.classes,a=e.onPageChange,r=e.onItemsCountPerPageChange,o=e.activePage,i=void 0===o?1:o,s=e.itemsCountPerPage,c=void 0===s?10:s,l=e.totalItemCount,u=void 0===l?0:l,p=e.disabled,d=void 0!==p&&p,f=e.size,m=void 0===f?"default":f,h=e.fit,b=void 0!==h&&h,v=(i-1)*c+1,y=v+c-1,g=y<=u?y:u,_="small"===m;return n.a.createElement("div",{className:se()(t.bdPagination,ds({},t.sm,_),ds({},t.fit,b))},n.a.createElement("span",{className:t.pageSize},n.a.createElement("span",null,"Rows per page:"),n.a.createElement(qr.a,{id:"itemsCountPerPage",value:c,onChange:function(e){var t=e.target.value?parseInt(e.target.value,10):"";r(t)},name:"Count per page",className:se()(t.select,ds({},t.selectSm,_)),disabled:d||!u,MenuProps:{classes:{paper:t.selectMenuList}},SelectDisplayProps:{selectsize:m}},n.a.createElement(lt.a,{className:"itemsCountPerPageOption",value:"5"},"5"),n.a.createElement(lt.a,{className:"itemsCountPerPageOption",value:"10"},"10"),n.a.createElement(lt.a,{className:"itemsCountPerPageOption",value:"25"},"25"),n.a.createElement(lt.a,{className:"itemsCountPerPageOption",value:"50"},"50"),n.a.createElement(lt.a,{className:"itemsCountPerPageOption",value:"100"},"100"))),u?n.a.createElement("span",{className:t.countInfo},"".concat(v," - ").concat(g," of ").concat(u)):"",n.a.createElement("div",{className:se()(t.pagination,ds({},t.paginationSm,_))},n.a.createElement(ps.a,{prevPageText:n.a.createElement("span",{className:"icon icon-chevron-left"}),nextPageText:n.a.createElement("span",{className:"icon icon-chevron-right"}),itemClassFirst:"hidden",itemClassLast:"hidden",innerClass:"ezm-pagination".concat(_?" sm":""),activePage:i,itemsCountPerPage:c,totalItemsCount:u,pageRangeDisplayed:1,onChange:function(e){a(parseInt(e,10))}})))};fs.propTypes={classes:u.a.object.isRequired,onPageChange:u.a.func.isRequired,onItemsCountPerPageChange:u.a.func.isRequired,activePage:u.a.number,itemsCountPerPage:u.a.number,totalItemCount:u.a.number,disabled:u.a.bool,size:u.a.string,fit:u.a.bool};var ms=he()((function(e){return{bdPagination:{display:"flex",justifyContent:"flex-end",alignItems:"center"},fit:{justifyContent:"space-between !important"},sm:{fontSize:e.typography.fontSizeSmall,flexWrap:"wrap-reverse",justifyContent:"space-around"},select:{marginLeft:.5*e.spacing.unit,minWidth:8*e.spacing.unit,color:e.palette.gray700,fontWeight:300,fontSize:e.typography.fontSize,textAlign:"left","&:first-child":{marginLeft:0},"&:last-child":{marginRight:0}},selectSm:{minWidth:"".concat(6*e.spacing.unit,"px !important"),"& [selectsize='small']":{fontSize:e.typography.fontSizeSmall,height:2*e.spacing.unit,lineHeight:1,paddingLeft:.5*e.spacing.unit,paddingRight:e.spacing.unit},"& svg":{right:0}},selectMenuList:{border:e.border,transformOrigin:"0 !important",transform:"scale(1, 1) translateZ(0px) translateY(40px) !important"},countInfo:{marginLeft:e.spacing.unit},pagination:{width:10*e.spacing.unit,marginLeft:e.spacing.unit},paginationSm:{width:8*e.spacing.unit}}}))(fs);function hs(e){return(hs="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function bs(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function vs(e,t){for(var a=0;a<t.length;a++){var r=t[a];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function ys(e,t){return(ys=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function gs(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=ks(e);if(t){var n=ks(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return _s(this,a)}}function _s(e,t){return!t||"object"!==hs(t)&&"function"!=typeof t?Ss(e):t}function Ss(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function ks(e){return(ks=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Os(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}var Es=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&ys(e,t)}(i,e);var t,a,r,o=gs(i);function i(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),(t=o.call(this,e)).state={filteredData:[],pageData:[],selectedArr:null,selectedIdx:null,search:"",activePage:1},t.onSearch=t.onSearch.bind(Ss(t)),t.filterItem=t.filterItem.bind(Ss(t)),t.handlePageChange=t.handlePageChange.bind(Ss(t)),t}return t=i,(a=[{key:"componentDidMount",value:function(){var e=this,t=this.props.data,a=void 0===t?[]:t;this.setState({filteredData:f.a.deepClone(a)},(function(){e.handlePageChange()}))}},{key:"componentDidUpdate",value:function(e){e.itemsCountPerPage!==this.props.itemsCountPerPage&&this.handlePageChange()}},{key:"handlePageChange",value:function(){var e=this.props.itemsCountPerPage,t=this.state,a=t.activePage,r=t.filteredData;if(r.length){var n=(a-1)*e,o=r.slice(n,n+e);this.setState({pageData:o})}else this.setState({pageData:[]})}},{key:"onSearch",value:function(){var e=this,t=this.state.search,a=this.props.data,r=[];t?a.map((function(a){e.filterItem(a,t)&&r.push(function(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?bs(Object(a),!0).forEach((function(t){Os(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):bs(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}({},a))})):r=f.a.deepClone(a),this.setState({filteredData:r,activePage:1},this.handlePageChange)}},{key:"filterItem",value:function(e,t){if(!t.startsWith("@")){if(t.startsWith("!")){var a=t.split("!")[1];return!e.title.includes(a)}return e.title.includes(t)}var r=t.substring(1).split(":"),n=r[0],o=r[1],i=f.a.guessType(e[n]);if(e.filterBy&&e.filterBy.length&&!e.filterBy.includes(n))return!1;if(!o)return!1;if("string"===i){if(o.startsWith("!")){var s=o.split("!")[1];return!e[n].includes(s)}return e[n].includes(o)}if("array"===i){if(o.startsWith("!")){var c=o.split("!")[1];return e[n].find((function(e){return!e.includes(c)}))}return e[n].find((function(e){return e.includes(o)}))}if("object"===i){if(o.includes("!=")){var l=o.split("!="),u=l[0],p=l[1]||"";return e[n][u]&&!e[n][u].includes(p)}var d=o.split("="),m=d[0],h=d[1]||"";return e[n][m]&&e[n][m].includes(h)}}},{key:"render",value:function(){var e=this,t=this.props,a=t.dense,r=t.idx,o=t.title,i=t.data,s=t.placeholder,c=t.totalArrayCount,l=t.onMoveItems,u=t.itemsCountPerPage,p=t.onChangeCountPerPage,d=t.searchQuerySuggestions,m=this.state,h=m.pageData,b=m.filteredData,v=m.search,y=void 0===v?"":v,g=m.activePage,_=r<c-1,S=r>0,k=b.length,O=b.length>10;return n.a.createElement(Se.a,{key:r,className:se()("listSelectorArray","listSelectorArray".concat(c)),subheader:n.a.createElement("div",{className:"listSelectorArrayHeader"},n.a.createElement(St.Typography,{variant:"caption"},o," (",i.length,")"),n.a.createElement("div",{className:"search"},y?n.a.createElement("span",{className:"icon icon-cross",onClick:function(){e.setState({search:""},e.onSearch)}}):n.a.createElement("span",{className:"icon icon-magnifier",onClick:function(e){e.target.nextElementSibling.focus()}}),n.a.createElement("input",{className:se()({active:!!y}),placeholder:s,name:"search",value:y,onChange:function(t){e.setState({search:t.target.value},e.onSearch)}})))},!!d.length&&n.a.createElement("div",{className:se()("searchSuggestionContainer",{hide:!!y})},n.a.createElement(St.Typography,{variant:"caption",className:"searchSuggestionHeader"},"Accepted search formats"),d.map((function(e,t){return n.a.createElement("div",{key:f.a.uniqueKey(t),className:"searchQueryPill"},n.a.createElement(St.Typography,{variant:"caption",className:"searchQueryPillText"},e))}))),O&&n.a.createElement(Ds,{idx:r,title:"Move all items in page",disabled:h.length?"none":"both",items:h,canMoveLeft:S,canMoveRight:_,onMoveItems:l,className:"subHeader",dense:!0}),!!h.length&&n.a.createElement(Ds,{idx:r,title:"Move all ".concat(y?"filtered ":"","items ").concat(y?"(".concat(b.length,")"):""),disabled:"none",items:b,canMoveLeft:S,canMoveRight:_,onMoveItems:l,className:"subHeader",dense:!0}),n.a.createElement("div",{className:"listContainer ".concat(O?"withPagination":"")},h.map((function(e,t){return n.a.createElement(Ds,{key:t,idx:r,title:e.title,subTitle:e.subTitle,disabled:e.disabled,status:e.status,items:[e],canMoveLeft:S,canMoveRight:_,onMoveItems:l,dense:a})}))),O&&n.a.createElement(Ee.a,{dense:!0,className:"listSelectorArrayItem subFooter"},n.a.createElement(ms,{activePage:g,itemsCountPerPage:u,totalItemCount:k,onPageChange:function(t){e.setState({activePage:t},e.handlePageChange)},onItemsCountPerPageChange:p,size:"small"})))}}])&&vs(t.prototype,a),r&&vs(t,r),i}(r.Component);Os(Es,"propTypes",{title:u.a.string,data:u.a.array.isRequired,onMoveItems:u.a.func.isRequired,idx:u.a.number.isRequired,totalArrayCount:u.a.number.isRequired,placeholder:u.a.string,dense:u.a.bool,itemsCountPerPage:u.a.number,onChangeCountPerPage:u.a.func,searchQuerySuggestions:u.a.arrayOf(u.a.string)});var js=Es,Ds=function(e){var t=e.title,a=void 0===t?"":t,r=e.subTitle,o=void 0===r?"":r,i=e.disabled,s=void 0===i?"none":i,c=e.status,l=void 0===c?"":c,u=e.canMoveLeft,p=void 0!==u&&u,d=e.canMoveRight,f=void 0!==d&&d,m=e.onMoveItems,h=void 0===m?null:m,b=e.items,v=e.idx,y=e.className,g=void 0===y?"":y,_=e.dense;return n.a.createElement(Ee.a,{dense:_,className:se()("listSelectorArrayItem","".concat(g),{disabled:"none"!==s})},!["both","left"].includes(s)&&p&&n.a.createElement("div",{className:"icon-wrapper icon-wrapper--right",onClick:function(e){e.preventDefault(),h({items:b,from:v,to:v-1})}},n.a.createElement("span",{className:"action-icon icon icon-arrow-left"})),n.a.createElement("div",{className:"listItemTextGroup"},n.a.createElement(St.Typography,{variant:"body1",color:{config_error:"error"}[l],className:"listItemTitle"},a),o&&n.a.createElement(St.Typography,{variant:"body1",className:"listItemSubTitle"},o)),!["both","right"].includes(s)&&f&&n.a.createElement("div",{className:"icon-wrapper icon-wrapper--left",onClick:function(e){e.preventDefault(),h({items:b,from:v,to:v+1})}},n.a.createElement("span",{className:"action-icon icon icon-arrow-right"})))};function ws(e){return(ws="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Cs(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function Ts(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?Cs(Object(a),!0).forEach((function(t){Ms(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):Cs(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function Ps(e,t){for(var a=0;a<t.length;a++){var r=t[a];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function As(e,t){return(As=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Rs(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=xs(e);if(t){var n=xs(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return Ns(this,a)}}function Ns(e,t){return!t||"object"!==ws(t)&&"function"!=typeof t?Fs(e):t}function Fs(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function xs(e){return(xs=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Ms(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}Ds.propTypes={title:u.a.string,subTitle:u.a.string,disabled:u.a.string,status:u.a.string,canMoveLeft:u.a.bool,canMoveRight:u.a.bool,onMoveItems:u.a.func,items:u.a.array,idx:u.a.number,className:u.a.string,dense:u.a.bool};var Is=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&As(e,t)}(i,e);var t,a,r,o=Rs(i);function i(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),(t=o.call(this,e)).state={arrayData:[],itemsCountPerPage:10},t.onMoveItems=t.onMoveItems.bind(Fs(t)),t.onChangeCountPerPage=t.onChangeCountPerPage.bind(Fs(t)),t}return t=i,(a=[{key:"componentDidMount",value:function(){var e=this.props.arrayData,t=void 0===e?[]:e;this.setState({arrayData:t})}},{key:"onChangeCountPerPage",value:function(e){this.setState({itemsCountPerPage:e||0,activePage:1},this.handlePageChange)}},{key:"onMoveItems",value:function(e){var t=e.from,a=e.to,r=e.items,n=this.props.onMoveItem,o=this.state.arrayData,i=f.a.deepClone(o);if(1===r.length){var s=Ts({},r[0]);i[a].data.push(s);var c=o[t].data.findIndex((function(e){return e.value===s.value}));i[t].data.splice(c,1)}else{i[t].data=[];var l=r.map((function(e){return e.value}));o[t].data.map((function(e){var r=l.findIndex((function(t){return t===e.value}));return"none"===e.disabled&&r>-1?(l.splice(r,1),i[a].data.push(Ts({},e))):i[t].data.push(Ts({},e))}))}this.setState({arrayData:i},(function(){n&&n({arrayData:i})}))}},{key:"render",value:function(){var e=this,t=this.props,a=t.dense,r=t.searchQuerySuggestions,o=void 0===r?[]:r,i=this.state,s=i.arrayData,c=i.itemsCountPerPage;return n.a.createElement("div",{className:"listSelectorWrapper"},s.map((function(t,r){return n.a.createElement(js,{key:r,idx:r,data:t.data,title:t.title,placeholder:t.placeholder,onMoveItems:e.onMoveItems,totalArrayCount:s.length,itemsCountPerPage:c,onChangeCountPerPage:e.onChangeCountPerPage,dense:a,searchQuerySuggestions:o})})))}}])&&Ps(t.prototype,a),r&&Ps(t,r),i}(r.Component);Ms(Is,"propTypes",{arrayData:u.a.array,onMoveItem:u.a.func,dense:u.a.bool,searchQuerySuggestions:u.a.arrayOf(u.a.string)});var Us=Is,Ls=a(34),Bs=function(e){var t=e.rowData,a=e.borderBottom,r={row:{display:"flex",flexDirection:"row"},borderBottom:{borderBottom:"1px solid ".concat(Ls.a.palette.gray300)},defaultpad:{padding:"2px ".concat(Ls.a.spacing.unit,"px")}};return n.a.createElement("div",{style:Object.assign({},r.row,a&&r.borderBottom)},t.map((function(e,t){return n.a.createElement("div",{key:f.a.uniqueKey("".concat(e.value,"-").concat(t)),style:{flexGrow:1,width:"".concat(e.width),padding:"".concat(r.defaultpad.padding)}},e.value)})))};Bs.propTypes={rowData:u.a.arrayOf(u.a.shape({value:u.a.oneOfType([u.a.string,u.a.number,u.a.node]),width:u.a.string})),borderBottom:u.a.bool};var Hs=Bs,Ks=function(e){var t=e.headerData,a=void 0===t?[]:t,r=e.data,o=void 0===r?[]:r,i=a.map((function(e,t){return n.a.createElement(Hs,{key:f.a.uniqueKey(t),bold:!0,rowData:e,borderBottom:t!==a.length-1})})),s=o.map((function(e,t){return n.a.createElement(Hs,{key:f.a.uniqueKey(t),rowData:e,borderBottom:t!==o.length-1})}));return n.a.createElement("div",{style:Object.assign({},{display:"flex",flexDirection:"column"})},i,s)};Ks.propTypes={headerData:u.a.arrayOf(u.a.arrayOf(u.a.shape({value:u.a.oneOfType([u.a.string,u.a.number,u.a.node]),width:u.a.string}))),data:u.a.arrayOf(u.a.arrayOf(u.a.shape({value:u.a.oneOfType([u.a.string,u.a.number,u.a.node]),width:u.a.string})))};var qs=Ks,Vs=a(61),Gs={badge:{display:"inline-block",width:"".concat(2.25*Ls.a.spacing.unit,"px"),height:"".concat(2.25*Ls.a.spacing.unit,"px"),lineHeight:"".concat(2.25*Ls.a.spacing.unit,"px"),textAlign:"center",fontSize:"".concat(Vs.a.fontSize-2,"px"),padding:0,margin:"0 6px",borderRadius:"10px"},default:{backgroundColor:"".concat(Ls.a.palette.gray300)},primary:{color:"".concat(Ls.a.palette.primary.main),backgroundColor:"".concat(Ls.a.palette.white)},cube:{borderRadius:"10%",width:"".concat(3*Ls.a.spacing.unit,"px"),height:"".concat(3*Ls.a.spacing.unit,"px"),lineHeight:1,padding:"4px"}},zs=function(e){var t=e.value,a=e.color,r=e.variant;return t?n.a.createElement("div",{style:Object.assign({},Gs.badge,a&&Gs["".concat(a)],!a&&Gs.default,r&&Gs["".concat(r)])},t):null};zs.propTypes={value:Object(l.oneOfType)([l.number,l.string]),color:Object(l.oneOf)(["default","primary"]),variant:Object(l.oneOf)(["cube"])};var Ws=zs;function Js(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}var Ys=function(e){return{root:{display:"flex",width:"100%",height:"1rem"},progress:{height:"1rem",lineHeight:"1rem",fontFamily:e.typography.fontFamily,fontSize:".8rem",fontWeight:300,textAlign:"center",color:e.palette.white},less:{color:e.palette.gray800},success:{backgroundColor:e.palette.primary.xLight,"& $progress":{backgroundColor:e.palette.success.main}},warning:{backgroundColor:e.palette.warning.light,"& $progress":{backgroundColor:e.palette.warning.main}},error:{backgroundColor:e.palette.error.light,"& $progress":{backgroundColor:e.palette.error.main}},info:{backgroundColor:e.palette.info.light,"& $progress":{backgroundColor:e.palette.info.main}},default:{backgroundColor:e.palette.gray400,"& $progress":{backgroundColor:e.palette.success.main}}}},$s=function(e){var t=e.variant,a=void 0===t?"default":t,r=e.label,o=void 0===r?"":r,i=e.info,s=e.progress,c=void 0===s?0:s,l=he()(Ys)((function(e){var t=n.a.createElement("div",{className:se()(e.classes.root,e.classes[a])},n.a.createElement("div",{className:se()(e.classes.progress,Js({},e.classes.less,c<25)),style:{width:"".concat(c,"%")}},o||""));return i?n.a.createElement(ka,{title:i,variant:a},t):t}));return n.a.createElement(l,null)};$s.propTypes={classes:u.a.object,label:u.a.string,variant:u.a.string,info:u.a.string,progress:u.a.oneOfType([u.a.string,u.a.number])};var Qs=$s;function Zs(){return(Zs=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var r in a)Object.prototype.hasOwnProperty.call(a,r)&&(e[r]=a[r])}return e}).apply(this,arguments)}function Xs(e){return function(e){if(Array.isArray(e))return ac(e)}(e)||function(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||tc(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function ec(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var a=[],r=!0,n=!1,o=void 0;try{for(var i,s=e[Symbol.iterator]();!(r=(i=s.next()).done)&&(a.push(i.value),!t||a.length!==t);r=!0);}catch(c){n=!0,o=c}finally{try{r||null==s.return||s.return()}finally{if(n)throw o}}return a}(e,t)||tc(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function tc(e,t){if(e){if("string"==typeof e)return ac(e,t);var a=Object.prototype.toString.call(e).slice(8,-1);return"Object"===a&&e.constructor&&(a=e.constructor.name),"Map"===a||"Set"===a?Array.from(e):"Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a)?ac(e,t):void 0}}function ac(e,t){(null==t||t>e.length)&&(t=e.length);for(var a=0,r=new Array(t);a<t;a++)r[a]=e[a];return r}var rc=function(e){var t=e.items,a=void 0===t?[]:t,o=e.onChange,i=void 0===o?null:o,s=e.value,c=void 0===s?"":s,l=e.name,u=void 0===l?"":l,p=e.className,d=void 0===p?"":p,m=e.classes,h=void 0===m?{}:m,b=a.length,v=ec(Object(r.useState)({}),2),y=v[0],g=v[1],_=ec(Object(r.useState)(!1),2),S=_[0],k=_[1],O=ec(Object(r.useState)(""),2),E=O[0],j=O[1],D=ec(Object(r.useState)(1),2),w=D[0],C=D[1],T=ec(Object(r.useState)(10),2),P=T[0],A=T[1],R=ec(Object(r.useState)([]),2),N=R[0],F=R[1],x=ec(Object(r.useState)([]),2),M=x[0],I=x[1],U=Object(r.createRef)();Object(r.useEffect)((function(){if(c&&f.a.isEmptyObject(y)){var e=a.length?c?a.find((function(e){return e.val===c})):a[0]:{};g(e)}}),[c,a]),Object(r.useEffect)((function(){if(E){var e=f.a.deepClone(a).filter((function(e){return e.title.includes(E)||e.val.includes(E)}));F(e)}else F(Xs(a))}),[E,a]),Object(r.useEffect)((function(){if(N.length){var e=(w-1)*P,t=N.slice(e,e+P);I(t)}else I([])}),[w,P,N]);var L=function(e){U.current.contains(e.target)||e.target.classList.contains("itemsCountPerPageOption")||k(!1)},B=y.title,H=void 0===B?"":B,K=y.val,q=void 0===K?"":K;return n.a.createElement("div",{className:se()(h.select,d)},n.a.createElement("input",{readOnly:!0,className:h.selectInput,name:u,value:H,onClick:function(){k(!S)},ref:U}),n.a.createElement(xe,{name:"caretDown"}),n.a.createElement(ze.a,{className:h.dropdown,open:S,anchorEl:U.current,transition:!0,disablePortal:!0},(function(e){var t=e.TransitionProps;return n.a.createElement(Ke.a,Zs({},t,{id:"menuListGrow",style:{transformOrigin:"center top"}}),n.a.createElement(Ve.a,null,n.a.createElement(Be.a,{onClickAway:function(e){return L(e)}},n.a.createElement("div",null,b>P&&n.a.createElement("div",{className:se()(h.padX,h.searchBar)},n.a.createElement("input",{className:h.searchInput,value:E,onChange:function(e){return j(e.target.value)}}),E?n.a.createElement("span",{className:"icon icon-cross",onClick:function(){return j("")},role:"button","aria-label":"cancel serch"}):n.a.createElement("span",{className:"icon icon-magnifier",role:"presentation"})),n.a.createElement(Je.a,null,M.map((function(e){return n.a.createElement(lt.a,{selected:e.val===q,value:e.val,key:e.title,onClick:function(t){L(t),g(e),i(e.val,u)},className:h.option},e.title)}))),b>P&&n.a.createElement("div",{className:h.padX},n.a.createElement(ms,{activePage:w,itemsCountPerPage:P,totalItemCount:b,onPageChange:function(e){C(e)},onItemsCountPerPageChange:function(e){C(1),A(e)},fit:!0}))))))})))},nc=he()((function(e){return{select:{width:"100%",cursor:"pointer",position:"relative","& .bdsIcons":{fill:e.palette.gray600,position:"absolute",right:.5*e.spacing.unit,top:.5*e.spacing.unit,pointerEvents:"none"}},selectInput:{width:"100%",height:4*e.spacing.unit,lineHeight:"".concat(4*e.spacing.unit,"px"),border:"1px solid ".concat(e.palette.gray500),padding:"0 ".concat(4*e.spacing.unit,"px 0 ").concat(e.spacing.unit,"px"),cursor:"pointer","&:active, &:focus, &:hover":{outline:"none",border:"1px solid ".concat(e.palette.gray500)}},dropdown:{zIndex:1e3,border:"1px solid ".concat(e.palette.gray300),width:"100%",paddingTop:e.spacing.unit,paddingBottom:e.spacing.unit,background:e.palette.white},padX:{padding:"0 ".concat(e.spacing.unit,"px")},searchBar:{position:"relative","& .icon":{color:e.palette.gray600,position:"absolute",right:1.5*e.spacing.unit,top:e.spacing.unit}},searchInput:{width:"100%",height:4*e.spacing.unit,lineHeight:"".concat(4*e.spacing.unit,"px"),border:"1px solid ".concat(e.palette.gray500),padding:"0 ".concat(4*e.spacing.unit,"px 0 ").concat(e.spacing.unit,"px"),borderRadius:.5*e.spacing.unit,"&:active, &:focus, &:hover":{outline:"none",border:"1px solid ".concat(e.palette.gray500)}},option:{textOverflow:"ellipsis",display:"block"}}}))(rc);function oc(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function ic(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var a=[],r=!0,n=!1,o=void 0;try{for(var i,s=e[Symbol.iterator]();!(r=(i=s.next()).done)&&(a.push(i.value),!t||a.length!==t);r=!0);}catch(c){n=!0,o=c}finally{try{r||null==s.return||s.return()}finally{if(n)throw o}}return a}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return sc(e,t);var a=Object.prototype.toString.call(e).slice(8,-1);"Object"===a&&e.constructor&&(a=e.constructor.name);if("Map"===a||"Set"===a)return Array.from(e);if("Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a))return sc(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function sc(e,t){(null==t||t>e.length)&&(t=e.length);for(var a=0,r=new Array(t);a<t;a++)r[a]=e[a];return r}rc.propTypes={items:u.a.arrayOf(u.a.shape({val:u.a.oneOfType([u.a.string,u.a.number,u.a.bool]),title:u.a.string.isRequired})),onChange:u.a.func,value:u.a.oneOfType([u.a.string,u.a.number,u.a.bool]),name:u.a.string,classes:u.a.object,className:u.a.oneOfType([u.a.string,u.a.array])};var cc=w.views,lc=function(e){var t=e.classes,a=e.role_name,o=e.tenant,i=e.kubernetes_access,s=e.ml_project,c=e.statsNumbers,l=void 0===c?{}:c,u=e.support_exthosts,p=e.location,d=ic(Object(r.useState)(dc(o,a)),2),f=d[0],m=d[1],h=ic(Object(r.useState)(mc(p)),2),b=h[0],v=h[1],y=ic(Object(r.useState)(pc(l,a)),2),g=y[0],_=y[1];Object(r.useEffect)((function(){var e=pc(l,a);_(e)}),[l,a]),Object(r.useEffect)((function(){if("Site Admin"===a){var e=pc(p);v(e)}}),[p]);var S="Site Admin"===a;return n.a.createElement("div",null,n.a.createElement("div",{className:t.miniSwitch,onClick:function(){var e=!f;m(e),fc(o,a,e)}},n.a.createElement("span",{className:"icon icon-menu"})),n.a.createElement(ge.a,{className:t.sidebarDrawer,variant:"permanent",classes:{paper:se()(t.drawerPaper,oc({},t.drawerPaperClose,f),oc({},"sidebarCollapsed",f))}},n.a.createElement(Se.a,{className:t.list},!S&&s&&!i&&n.a.createElement(n.a.Fragment,null,["Admin","Member"].includes(a)?n.a.createElement(Ae,{to:cc.aimlDashboard.url,title:"Dashboard"}):"","Admin"===a?n.a.createElement(Ae,{to:cc.projectUsers.url,title:"Users",badge:g.num_users}):"",["Admin","Member"].includes(a)?n.a.createElement(Ae,{to:cc.projectRepo.url,title:"Project Repository"}):"",["Admin","Member"].includes(a)?n.a.createElement(Ae,{to:cc.sourceControl.url,title:"Source Control"}):"",["Admin","Member"].includes(a)?n.a.createElement(Ae,{to:cc.models.url,title:"Model Registry"}):"",["Admin","Member"].includes(a)?n.a.createElement(Ae,{to:cc.trainings.url,title:"Training",badge:g["AIML/Training"]||0}):"",["Admin","Member"].includes(a)?n.a.createElement(Ae,{to:cc.deployments.url,title:"Deployments",badge:g["AIML/Deployment"]||0}):"",["Admin","Member"].includes(a)?n.a.createElement(Ae,{to:cc.manageDataSources.url,title:"Data Sources",badge:g.num_dcos+g.num_filesystems}):"","Admin"===a?n.a.createElement(Ae,{to:cc.flavors.url,title:"Flavors"}):"",["Admin","Member"].includes(a)?n.a.createElement(Ae,{to:cc.aimlApps.url,title:"App Store"}):"",["Admin","Member"].includes(a)?n.a.createElement(Ae,{to:cc.notebooks.url,title:"Notebooks",badge:g["AIML/Notebook"]||0}):""),!S&&i&&n.a.createElement(n.a.Fragment,null,["Member","Admin","K8S Admin"].includes(a)?n.a.createElement(Ae,{to:cc.k8sTenantDashboard.url,title:"Dashboard"}):"","K8S Admin"===a?n.a.createElement(Ae,{to:cc.k8sAdminClusterDashboard.url,title:"Cluster"}):"","K8S Admin"===a?n.a.createElement(Ae,{to:cc.k8sTenantList.url,title:"Tenants"}):"",["K8S Admin"].includes(a)?n.a.createElement(Ae,{to:cc.k8sClusterAdminUsers.url,title:"Users"}):"",["Admin"].includes(a)?n.a.createElement(Ae,{to:cc.k8sTenantUsers.url,title:"Users",badge:g.num_users}):"",s&&n.a.createElement(n.a.Fragment,null,["Admin","Member"].includes(a)?n.a.createElement(Ae,{to:cc.k8sProjectRepo.url,title:"Project Repository"}):"",["Admin","Member"].includes(a)?n.a.createElement(Ae,{to:cc.managek8sSourceControl.url,title:"Source Control"}):"",["Admin","Member"].includes(a)?n.a.createElement(Ae,{to:cc.k8sModels.url,title:"Model Registry"}):"",["Admin","Member"].includes(a)?n.a.createElement(Ae,{to:cc.k8sTrainings.makeUrl({hash:"kubedirector"}),title:"Training"}):"",["Admin","Member"].includes(a)?n.a.createElement(Ae,{to:cc.k8sDeployments.makeUrl({hash:"kubedirector"}),title:"Deployments"}):""),["Member","Admin"].includes(a)?n.a.createElement(Ae,{to:cc.managek8sDataTaps.url,title:"DataTaps",badge:g.num_dcos}):"",["Member","Admin"].includes(a)?n.a.createElement(Ae,{to:cc.managek8sFsMounts.url,title:"FsMounts",badge:g.num_filesystems}):"",["Member","Admin"].includes(a)?n.a.createElement(Ae,{to:cc.k8sApps.makeUrl({hash:"kubedirector"}),title:"Applications"}):"",s&&n.a.createElement(n.a.Fragment,null,["Admin","Member"].includes(a)?n.a.createElement(Ae,{to:cc.k8sNotebooks.makeUrl({hash:"kubedirector"}),title:"Notebooks"}):"")),S&&n.a.createElement(n.a.Fragment,null,n.a.createElement(Yi,{header:n.a.createElement(St.Typography,{className:t.sidebarTitle,variant:"h4"},"KUBERNETES"),icon:"icon-chevron-down",placement:"start",iconPlacement:"end",expanded:"k8s"===b,iconSize:"md",noBackground:!0,noPad:!0},n.a.createElement(Ae,{to:cc.k8sDashboard.url,title:"Dashboard"}),n.a.createElement(Ae,{to:cc.k8sTenants.url,title:"Tenants",badge:g.num_k8s_tenants}),n.a.createElement(Ae,{to:cc.managek8sClusters.url,title:"Clusters",badge:g.num_k8s_clusters}),n.a.createElement(Ae,{to:cc.k8sHosts.url,title:"Hosts",badge:g.num_k8s_hosts})),n.a.createElement(Yi,{header:n.a.createElement(St.Typography,{className:t.sidebarTitle,variant:"h4"},"EPIC"),icon:"icon-chevron-down",placement:"start",iconPlacement:"end",expanded:"epic"===b,noBackground:!0,noPad:!0},n.a.createElement(Ae,{to:cc.dashboard.url,title:cc.dashboard.viewLabel,redirect:!0}),n.a.createElement(Ae,{to:cc.manageTenants.url,title:cc.manageTenants.viewLabel,badge:g.num_epic_tenants,redirect:!0}),n.a.createElement(Ae,{to:cc.hosts.url,title:cc.hosts.viewLabel,badge:g.num_worker_hosts}),u&&n.a.createElement(Ae,{to:cc.extHosts.url,title:cc.extHosts.viewLabel,redirect:!0}),n.a.createElement(Ae,{to:cc.manageVnodes.url,title:cc.manageVnodes.viewLabel,badge:g.num_docker_vnodes,redirect:!0}),n.a.createElement(Ae,{to:cc.apps.url,title:cc.apps.viewLabel,redirect:!0})),n.a.createElement(Ee.a,{className:t.titleItem},n.a.createElement(St.Typography,{className:t.sidebarTitle,variant:"h4"},"GLOBAL SETTINGS")),n.a.createElement("div",null,n.a.createElement(Ae,{to:cc.manageControllers.url,title:cc.manageControllers.viewLabel,badge:g.num_controller_hosts,redirect:!0}),n.a.createElement(Ae,{to:cc.gatewayLoadBalancers.url,title:cc.gatewayLoadBalancers.viewLabel,badge:g.num_proxy_hosts,redirect:!0}),n.a.createElement(Ae,{to:cc.authentication.url,title:cc.authentication.viewLabel,redirect:!0}),n.a.createElement(Ae,{to:cc.notifications.url,title:cc.notifications.viewLabel,redirect:!0}),n.a.createElement(Ae,{to:cc.manageUsers.url,title:cc.manageUsers.viewLabel,badge:g.num_users,redirect:!0}),n.a.createElement(Ae,{to:cc.settings.url,title:cc.settings.viewLabel,redirect:!0}))))))};lc.propTypes={classes:u.a.object.isRequired,role_name:u.a.string,tenant:u.a.string,tenant_type:u.a.string,statsNumber:u.a.object,ml_project:u.a.bool,kubernetes_access:u.a.bool,statsNumbers:u.a.object,support_exthosts:u.a.bool,location:u.a.object};var uc=Object(ke.withStyles)(Ce)(lc),pc=function(e,t){var a=e.num_active_clusters_by_category,r=void 0===a?[]:a,n=e.num_dcos,o=void 0===n?0:n,i=e.num_filesystems,s=void 0===i?0:i,c=e.num_users,l=void 0===c?0:c,u=e.num_all_tenants_by_tenant_type,p=void 0===u?[]:u,d=e.num_workers_by_purpose,f=void 0===d?[]:d,m=e.num_all_vnodes_by_tenant_type,h=void 0===m?[]:m,b=e.num_tenant_vnodes,v=void 0===b?0:b,y=e.num_all_vnodes,g=void 0===y?0:y,_=e.num_k8s_clusters,S=void 0===_?0:_,k={num_dcos:o,num_filesystems:s,num_users:l,num_tenant_vnodes:v,num_all_vnodes:g};if(r.length&&r.map((function(e){var a="num_clusters";"AIML/Notebook"===e.category&&"Member"===t&&(a="num_clusters_current_user"),k[e.category]=e[a]})),"Site Admin"===t){k.num_k8s_clusters=S,p.map((function(e){var t=e.tenant_type,a=e.num_tenants,r=void 0===a?0:a;k["num_".concat(t,"_tenants")]=r}));var O=k.num_site_admin_tenants,E=void 0===O?0:O,j=k.num_docker_tenants,D=void 0===j?0:j;k.num_epic_tenants=E+D,f.map((function(e){var t=e.purpose,a=e.total,r=void 0===a?0:a;k["num_".concat(t,"_hosts")]=r}));var w=k.num_primary_hosts,C=void 0===w?0:w,T=k.num_shadow_hosts,P=void 0===T?0:T,A=k.num_arbiter_hosts,R=void 0===A?0:A;k.num_controller_hosts=C+P+R,h.map((function(e){var t=e.tenant_type,a=e.num_vnodes,r=void 0===a?0:a;k["num_".concat(t,"_vnodes")]=r}))}return k},dc=function(e,t){if("localStorage"in window&&null!==window.localStorage&&e&&t)try{var a="".concat(e,"|").concat(t);return localStorage.getItem(a)||localStorage.setItem(a,"expanded"),"collapsed"===localStorage.getItem(a)}catch(r){return f.a.bdLog(r),!1}return!1},fc=function(e,t,a){if("localStorage"in window&&null!==window.localStorage&&e&&t){var r="".concat(e,"|").concat(t);localStorage.setItem(r,a?"collapsed":"expanded")}},mc=function(e){var t=e.pathname,a=void 0===t?"":t;return a.includes("k8s")?"k8s":a.includes("epic")?"epic":"none"},hc=a(31),bc=a.n(hc),vc=a(157),yc=a.n(vc);function gc(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function _c(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?gc(Object(a),!0).forEach((function(t){Sc(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):gc(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function Sc(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}var kc=w.settings.webapp.navbar.height,Oc=function(e){return{brand:{display:"flex",alignItems:"center",position:"absolute",top:"50%",transform:"translateY(-50%)"},brandLogo:{marginRight:"0.75rem",height:3*e.spacing.unit},brandName:{fontFamily:e.typography.fontFamilyBold,fontSize:e.typography.fontSizeLarge,margin:"0 ".concat(e.spacing.unit,"px")},appName:{fontSize:e.typography.fontSizeLarge},navbar:{width:"100%",boxSizing:"content-box",height:kc,padding:0,margin:0},navbarItem:Sc({padding:"0 ".concat(2*e.spacing.unit,"px !important")},e.breakpoints.down("sm"),{padding:"0 ".concat(.5*e.spacing.unit,"px !important")}),userActions:{display:"flex",alignItems:"center",justifyContent:"flex-end"},userInfoRole:{padding:0,margin:0,lineHeight:1,textTransform:"none",verticalAlign:"bottom",fontFamily:e.typography.fontFamilySemiBold,"& .icon":{margin:"0 ".concat(2*e.spacing.unit,"px"),verticalAlign:"inherit"}},userBasedAlerts:{},userBasedAlertItem:{padding:"".concat(e.spacing.unit,"px ").concat(2*e.spacing.unit,"px"),background:e.palette.error.main,color:e.palette.white,"& + div":{borderTop:"2px solid ".concat(e.palette.white)}},alertWarning:{background:e.palette.warning.main,color:e.typography.fontColor},alertTitle:{fontFamily:e.typography.fontFamilyBold},NavMenuItem:{minWidth:"8rem","&:hover .nav-link":{color:e.palette.primary.main},"& >*":{display:"block",width:"100%"}},NavLink:{color:e.typography.fontColor,textDecoration:"none","& .icon":{paddingRight:.5*e.spacing.unit}},activeLink:{color:e.palette.primary.main},hidden:{display:"none !important"},menuIcon:{display:"flex",justifyContent:"center",alignItems:"center",width:4*e.spacing.unit,height:4*e.spacing.unit,border:"1px solid ".concat(e.palette.primary.main),borderRadius:"50%",background:e.bdMixins.rgba(e.palette.primary.main,.2)},menuIconDot:{display:"inline-block",width:"3px",height:"3px",background:e.palette.primary.main,borderRadius:"50%",margin:"2px"},alertToggle:_c(_c({},e.bdMixins.Pointer),{},{position:"relative",width:4*e.spacing.unit,height:4*e.spacing.unit,background:e.palette.error.main,borderRadius:"50%",marginLeft:2*e.spacing.unit,display:"flex",alignItems:"center",justifyContent:"center","& .icon":{color:"inherit"}}),hasAlert:{width:2.5*e.spacing.unit,height:2.5*e.spacing.unit,background:e.palette.white,color:e.palette.error.main,borderRadius:"50%",textAlign:"center",display:"block",position:"absolute",top:.75*-e.spacing.unit,right:.25*-e.spacing.unit,border:"1px solid ".concat(e.palette.error.main)},userInfoModal:{padding:"".concat(e.spacing.unit,"px ").concat(2*e.spacing.unit,"px")},appInfo:Sc({background:e.palette.gray200,padding:"0 ".concat(2*e.spacing.unit,"px !important")},e.breakpoints.down("sm"),{padding:"0 ".concat(.5*e.spacing.unit,"px !important")})}};function Ec(e){return(Ec="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function jc(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Dc(e,t){for(var a=0;a<t.length;a++){var r=t[a];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function wc(e,t){return(wc=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Cc(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=Pc(e);if(t){var n=Pc(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return Tc(this,a)}}function Tc(e,t){return!t||"object"!==Ec(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Pc(e){return(Pc=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var Ac=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&wc(e,t)}(i,e);var t,a,r,o=Cc(i);function i(){return jc(this,i),o.apply(this,arguments)}return t=i,(a=[{key:"render",value:function(){var e=this.props,t=e.lock_data,a=void 0===t?{}:t,r=e.session_data,o=void 0===r?{}:r,i=e.classes,s=f.a.fetchSafeFromObject({path:["_embedded","internal_locks"],obj:a,default_value:[]}),c=f.a.fetchSafeFromObject({path:["_embedded","external_locks"],obj:a,default_value:[]});return n.a.createElement("div",{className:i.userBasedAlertItem},n.a.createElement(st.a,{className:i.alertTitle,color:"inherit"},a.quiesced?"Site lockdown":"Site lockdown in progress",s.length?": protected tasks active":""),n.a.createElement(st.a,{color:"inherit"},"Site was put in lockdown mode."),"Site Admin"===o.role_name&&n.a.createElement(st.a,{color:"inherit"},"User: ",c[0].source),n.a.createElement(st.a,{color:"inherit"},"Reason: ",c[0].reason),!a.quiesced&&n.a.createElement(st.a,{color:"inherit"},"Waiting on pre-lockdown tasks to complete."),"Site Admin"===o.role_name&&s.length?n.a.createElement("div",null,n.a.createElement(st.a,{color:"inherit"},"Protected Task(s)"),s.map((function(e){st.a,e.reason}))):"")}}])&&Dc(t.prototype,a),r&&Dc(t,r),i}(r.Component);!function(e,t,a){t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a}(Ac,"propTypes",{classes:u.a.object.isRequired,lock_data:u.a.object.isRequired,session_data:u.a.object});var Rc=he()(Oc)(Ac),Nc=a(7),Fc=a.n(Nc);function xc(e){return(xc="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Mc(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Ic(e,t){for(var a=0;a<t.length;a++){var r=t[a];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Uc(e,t){return(Uc=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Lc(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=Hc(e);if(t){var n=Hc(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return Bc(this,a)}}function Bc(e,t){return!t||"object"!==xc(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Hc(e){return(Hc=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var Kc=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Uc(e,t)}(i,e);var t,a,r,o=Lc(i);function i(){return Mc(this,i),o.apply(this,arguments)}return t=i,(a=[{key:"render",value:function(){var e=this.props,t=e.license_alerts,a=e.classes;return n.a.createElement(bc.a,{item:!0,xs:!0,className:a.userBasedAlertItem},n.a.createElement(st.a,{color:"inherit",className:a.alertTitle},"License Alert"),t.map((function(e,t){return n.a.createElement(st.a,{color:"inherit",key:t,className:a.userBasedAlertItemText},e)})))}}])&&Ic(t.prototype,a),r&&Ic(t,r),i}(r.Component);!function(e,t,a){t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a}(Kc,"propTypes",{license_alerts:u.a.array,classes:u.a.object.isRequired});var qc=he()(Oc)(Kc);function Vc(e){return(Vc="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Gc(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function zc(e,t){for(var a=0;a<t.length;a++){var r=t[a];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Wc(e,t){return(Wc=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Jc(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=$c(e);if(t){var n=$c(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return Yc(this,a)}}function Yc(e,t){return!t||"object"!==Vc(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function $c(e){return($c=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var Qc=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Wc(e,t)}(i,e);var t,a,r,o=Jc(i);function i(){return Gc(this,i),o.apply(this,arguments)}return t=i,(a=[{key:"render",value:function(){var e=this.props,t=e.session_data,a=e.classes;return n.a.createElement(bc.a,{item:!0,xs:!0,className:se()(a.userBasedAlertItem,a.alertWarning)},n.a.createElement(st.a,{color:"inherit",className:a.alertTitle},"Gateway Host Warning"),n.a.createElement(st.a,{color:"inherit"},er({path:["gatewayHostAlert","alert_msg"]})),n.a.createElement(st.a,{color:"inherit"},"".concat(er({path:["gatewayHostAlert","site_admin_msg"]})," ").concat("Site Admin"!==t.role_name?er({path:["gatewayHostAlert","non_site_admin_msg"]}):"")))}}])&&zc(t.prototype,a),r&&zc(t,r),i}(r.Component);!function(e,t,a){t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a}(Qc,"propTypes",{session_data:u.a.object,classes:u.a.object.isRequired});var Zc=he()(Oc)(Qc);function Xc(e){return(Xc="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function el(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function tl(e,t){for(var a=0;a<t.length;a++){var r=t[a];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function al(e,t){return(al=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function rl(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=ol(e);if(t){var n=ol(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return nl(this,a)}}function nl(e,t){return!t||"object"!==Xc(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function ol(e){return(ol=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var il=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&al(e,t)}(i,e);var t,a,r,o=rl(i);function i(){return el(this,i),o.apply(this,arguments)}return t=i,(a=[{key:"render",value:function(){var e=this.props,t=e.status_info,a=e.classes;return n.a.createElement("div",{className:se()(a.userBasedAlertItem,a.alertWarning)},n.a.createElement(st.a,{className:a.alertTitle},"Project Repository Warning"),n.a.createElement(st.a,{color:"inherit"},t))}}])&&tl(t.prototype,a),r&&tl(t,r),i}(r.Component);!function(e,t,a){t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a}(il,"propTypes",{status_info:u.a.string,classes:u.a.object.isRequired});var sl=he()(Oc)(il);function cl(e){return(cl="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function ll(){return(ll=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var r in a)Object.prototype.hasOwnProperty.call(a,r)&&(e[r]=a[r])}return e}).apply(this,arguments)}function ul(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function pl(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?ul(Object(a),!0).forEach((function(t){_l(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):ul(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function dl(e){return function(e){if(Array.isArray(e))return fl(e)}(e)||function(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||function(e,t){if(!e)return;if("string"==typeof e)return fl(e,t);var a=Object.prototype.toString.call(e).slice(8,-1);"Object"===a&&e.constructor&&(a=e.constructor.name);if("Map"===a||"Set"===a)return Array.from(e);if("Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a))return fl(e,t)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function fl(e,t){(null==t||t>e.length)&&(t=e.length);for(var a=0,r=new Array(t);a<t;a++)r[a]=e[a];return r}function ml(e,t){for(var a=0;a<t.length;a++){var r=t[a];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function hl(e,t){return(hl=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function bl(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=gl(e);if(t){var n=gl(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return vl(this,a)}}function vl(e,t){return!t||"object"!==cl(t)&&"function"!=typeof t?yl(e):t}function yl(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function gl(e){return(gl=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function _l(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}var Sl=w.views,kl={type:"object",properties:{password:{type:"string",title:"Current Password",bd_widget:"password"},new_password:{type:"string",title:"New Password",bd_widget:"password"},confirm_password:{type:"string",title:"Confirm Password",bd_widget:"password"}}},Ol={password:{"ui:autofocus":!0}},El=function(e){var t=JSON.parse(JSON.stringify(e));return delete t.confirm_password,t},jl=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&hl(e,t)}(i,e);var t,a,r,o=bl(i);function i(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),_l(yl(t=o.call(this,e)),"licenseExpirationCalc",(function(e){var t=Fc()(new Date).format("M/D/YYYY");return Fc()(e,"M/D/YYYY").diff(Fc()(t,"M/D/YYYY"),"days")})),_l(yl(t),"validatePwUpdateField",(function(e,t){var a=e.password,r=e.new_password,n=e.confirm_password;return a||t.password.addError(er({path:["passwordUpdate","password_empty"]})),r&&r.length<4&&t.new_password.addError(er({path:["passwordUpdate","password_invalid"]})),n&&r!==n&&t.confirm_password.addError(er({path:["passwordUpdate","password_mismatch"]})),t})),t.licenseExpirationCalc=t.licenseExpirationCalc.bind(yl(t)),t.validatePwUpdateField=t.validatePwUpdateField.bind(yl(t)),t.invokeUpdatePasswordModal=t.invokeUpdatePasswordModal.bind(yl(t)),t.invokeEnterLockDownModal=t.invokeEnterLockDownModal.bind(yl(t)),t.callBack=t.callBack.bind(yl(t)),t.invokeModal=t.invokeModal.bind(yl(t)),t.getLicenseAlerts=t.getLicenseAlerts.bind(yl(t)),t.switchTenant=t.switchTenant.bind(yl(t)),t.exitLockdown=t.exitLockdown.bind(yl(t)),t.beModalFormRef=n.a.createRef(),t.bdModalChildRef=n.a.createRef(),t.state={modalData:{},modalForm:{}},t}return t=i,(a=[{key:"invokeUpdatePasswordModal",value:function(){var e=this,t=this.props.session_data,a=(t=void 0===t?{}:t).user,r=t.user_name,n={action:"password",form_id:"updatePasswordForm",title:"Update User Password (".concat(r,")"),name:"update password form",description:"form to update password",form_schema:kl,ui_schema:Ol,method_actions:[{method:w.method.PUT,action:"".concat(a,"?password"),data:"FORM_DATA"}],success_msg:"Password successfully updated",failure_msg:"Failed to update password",preProcessData:El,validate:this.validatePwUpdateField};this.setState({modalForm:n},(function(){e.beModalFormRef.current.openModal()}))}},{key:"invokeEnterLockDownModal",value:function(){var e=this,t={action:"lockdown",form_id:"siteLockDownForm",title:"Lockdown the system",name:"Lockdown form",description:"form to put system in lockdown mode.",form_schema:{type:"object",properties:{reason:{type:"string",title:"Enter Reason"}}},ui_schema:{reason:{"ui:autofocus":!0}},method_actions:[{method:w.method.POST,action:w.apiurl.LOCK,data:"FORM_DATA"}],success_msg:"System lockdown initiated successfully.",failure_msg:"Failed to put system in lockdown.",preProcessData:null,validate:null};this.setState({modalForm:t},(function(){e.beModalFormRef.current.openModal()}))}},{key:"exitLockdown",value:function(){var e=this,t=this.props.lock_data,a=(t=void 0===t?{}:t)._embedded,r=(a=void 0===a?{}:a).internal_locks,o=void 0===r?[]:r,i=a.external_locks,s=void 0===i?[]:i;if(o.length){var c=n.a.createElement(ns,{errors:["Management Service is performing operations that require site to be in lockdown mode.","Details."].concat(dl(o.map((function(e){return e.reason}))))});_n({msg:c,variant:"error"})}else if(s.length){var l=f.a.fetchSafeFromObject({path:w.pathToID,obj:s[0],default_value:""});R({method:w.method.DELETE,apiurl:l}).then((function(){_n({msg:"Succesfully exited system lockdown",variant:"success"}),e.reFetchLockData()})).catch((function(e){var t=f.a.parseAxiosError({error:e});_n({msg:n.a.createElement(ns,{errors:["Failed to exit system lockdown",t]}),variant:"error"})}))}else _n({msg:"No locks found.",variant:"success"})}},{key:"switchTenant",value:function(e){(0,this.props.resetStore)(),window.location.href=e}},{key:"callBack",value:function(e){var t=e.variant;"lockdown"===e.action?(this.reFetchLockData(),this.beModalFormRef.current.closeModal(),"success"===t&&_n({msg:"Succesfully started system lockdown",variant:"success"}),this.setState({modalForm:{}})):"success"===t&&(this.beModalFormRef.current.closeModal(),window.location.href=Sl.logout.url)}},{key:"reFetchLockData",value:function(){(0,this.props.dispatch)(I({apiUrl:w.apiurl.LOCK,propVal:"lock_data"}))}},{key:"getLicenseAlerts",value:function(){var e=[],t=this.props,a=t.license_data,r=void 0===a?{}:a,n=t.license_legacy_data,o=void 0===n?{}:n;if(f.a.isEmptyObject(r)){var i=o.end_date||"",s=this.licenseExpirationCalc(i);("demo"===o.state||s<=7)&&(0===s?e.push(er({path:["licenseAlert","expires_today"]})):s<0?e.push(er({path:["licenseAlert","expired"]})):e.push(er({path:["licenseAlert","will_expire"]})(s)))}else r.Messages&&r.Messages.length&&r.Messages.map((function(t){e.push(t.Content)}));return e}},{key:"invokeModal",value:function(e){var t=this,a=e.type,r=void 0===a?"alert":a,o={},i=this.props,s=i.classes,c=i.session_data,l=void 0===c?{}:c;if("alert"===r){var u=this.props,p=u.lock_data,d=void 0===p?{}:p,m=u.location,h=void 0===m?{}:m,b=u.g_install,v=void 0===b?{}:b,y=l.current_tenant_data,g=void 0===y?{}:y,_=g.status,S=void 0===_?"":_,k=g.status_info,O=void 0===k?"":k,E=g.features,j=(E=void 0===E?{}:E).ml_project,D=void 0!==j&&j&&"initialized"===S,w=h.pathname,C=[Sl.aimlClusterDashboard.url,Sl.deployments.url,Sl.createEditDeployment.url,Sl.notebooks.url,Sl.createEditNotebook.url,Sl.trainings.url,Sl.createEditTraining.url].includes(w)&&!v.routable_network&&!v.proxy_present,T=this.getLicenseAlerts();o={title:n.a.createElement(st.a,{variant:"h2"},"Alerts"),name:"Alerts list",description:"Modal to display alerts",content:n.a.createElement("div",{className:s.userBasedAlerts},d.locked?n.a.createElement(Rc,{lock_data:d,session_data:l}):"",C?n.a.createElement(Zc,{session_data:l}):"",T.length?n.a.createElement(qc,{license_alerts:T}):"",D?n.a.createElement(sl,{status_info:O}):"")}}else{var P=l.role_name,A=void 0===P?"":P,R=l.user_name,N=void 0===R?"":R,F=l.tenant_name,x=void 0===F?"":F,M=l.current_tenant_data,I=void 0===M?"":M,U="K8S Admin"===A,L=f.a.fetchSafeFromObject({path:["features","ml_project"],obj:I,default_value:!1}),B=f.a.fetchSafeFromObject({path:["features","kubernetes_access"],obj:I,default_value:!1}),H=L?"Project":B&&U?"Cluster":"Tenant";o={title:n.a.createElement(st.a,{variant:"h2"},"Current User Information"),name:"Current User Info",description:"Modal to display current user info",content:n.a.createElement("div",{className:s.userInfoModal},n.a.createElement(st.a,{variant:"caption"},"Role: ",A),n.a.createElement(st.a,{variant:"caption"},H,": ",x),n.a.createElement(st.a,{variant:"caption"},"User: ",N))}}this.setState({modalData:o},(function(){t.bdModalChildRef.current.handleOpen()}))}},{key:"render",value:function(){var e=this,t=this.props,a=t.session_data,r=void 0===a?{}:a,o=t.lock_data,i=void 0===o?{}:o,s=t.g_config_data,c=void 0===s?{}:s,l=t.location,u=void 0===l?{}:l,p=t.g_install,d=void 0===p?{}:p,m=t.classes,h=this.state,b=h.modalData,v=h.modalForm,y=r.is_site_admin_view,g=void 0!==y&&y,_=r.siteadmin_tenant_id,S=void 0===_?"":_,k=r.current_tenant_data,O=void 0===k?{}:k,E=r.current_user_data,j=void 0===E?{}:E,D=r.user_tenant_list,C=void 0===D?[]:D,T=r.role_name,P=void 0===T?"":T,A=r.tenant_name,R=void 0===A?"...":A,N=r.user_name,F=void 0===N?"...":N,x=r.tenant,M=void 0===x?"":x,I="Site Admin"===P,U=O.status,L=void 0===U?"":U,B=O.features,H=(B=void 0===B?{}:B).ml_project,K=void 0!==H&&H,q=B.kubernetes_access,V=void 0!==q&&q,G=O.tenant_type,z=void 0===G?"Site Admin":G,W={userInfo:n.a.createElement(st.a,{className:m.userInfoRole},g?"(Acting as Tenant Admin) ":"",n.a.createElement("span",{className:m.b},R," / ",F),n.a.createElement("span",{className:"icon icon-chevron-down"})),actionMenu:n.a.createElement("div",{className:m.menuIcon},n.a.createElement("i",{className:m.menuIconDot}),n.a.createElement("i",{className:m.menuIconDot}),n.a.createElement("i",{className:m.menuIconDot}))},J=(I?[{key:"createTenant",name:"Create Tenant",external:!0},{key:"addUser",name:"Add User",external:!0},{key:"assignUser",name:"Assign User",external:!0}]:[].concat(dl(L&&"ready"===L?[{key:"createEditTraining",name:"Create Training Cluster",external:!1},{key:"createEditDeployment",name:"Create Deployment Cluster",external:!1}]:[]),[{key:"createEditNotebook",name:"Create Notebook",external:!1},{key:"createEditDataSource",name:"Create DataSource",external:!1}],dl(K&&!V?[{key:"assignAimlUser",name:"Assign User",external:!1}]:[]),dl(V?[{key:"assignK8sUser",name:"Assign User",external:!1}]:[]))).reduce((function(e,t){var a=Sl[t.key];return a.roles.includes(P)&&a.tenant_types.includes(z)&&e.push(pl(pl({},t),{},{url:a.url})),e}),[]),Y=[Sl.aimlClusterDashboard.url,Sl.deployments.url,Sl.createEditDeployment.url,Sl.notebooks.url,Sl.createEditNotebook.url,Sl.trainings.url,Sl.createEditTraining.url],$=u.pathname,Q=Y.includes($)&&!d.routable_network&&!d.proxy_present,Z=K&&"initialized"===status,X=this.getLicenseAlerts(),ee=(i.locked?1:0)+(Q?1:0)+(X.length?1:0)+(Z?1:0),te=f.a.bdSort(C,["name"]),ae=d.bds_global_version,re=void 0===ae?"":ae,ne=d.bds_global_buildnumber,oe=void 0===ne?"":ne,ie=v.action,ce=void 0===ie?"":ie,le=v.form_id,ue=void 0===le?"form":le,pe=v.title,de=void 0===pe?"":pe,fe=v.name,me=void 0===fe?"":fe,he=v.description,be=void 0===he?"":he,ve=v.form_schema,ye=void 0===ve?{}:ve,ge=v.ui_schema,_e=void 0===ge?{}:ge,Se=v.method_actions,ke=void 0===Se?[{method:w.method.POST,action:"#",data:"FORM_DATA"}]:Se,Oe=v.success_msg,Ee=void 0===Oe?"":Oe,je=v.failure_msg,De=void 0===je?"":je,we=v.preProcessData,Ce=void 0===we?null:we,Pe=v.validate,Ae=void 0===Pe?null:Pe;return n.a.createElement(bc.a,{className:se()(m.navbar,g?m.siteAdminView:""),container:!0,spacing:16},n.a.createElement(bc.a,{item:!0,xs:4,className:m.navbarItem},n.a.createElement("div",{className:m.brand},n.a.createElement("div",{className:m.brandLogo},n.a.createElement(xe,{id:"brand",name:"hpe",type:"brand_logo"})),n.a.createElement(st.a,{className:m.brandName},"HPE"),n.a.createElement(st.a,{className:m.appName},c.custom_install_name?c.custom_install_name:K&&!V?"Ezmeral ML Ops":"Ezmeral Container Platform"))),n.a.createElement(bc.a,{item:!0,xs:8,className:se()(m.userActions,m.navbarItem)},f.a.isEmptyObject(O)?"":n.a.createElement(ot,{title:W.userInfo,noTop:!0},g?n.a.createElement(Ia,null,n.a.createElement(lt.a,{className:m.NavMenuItem,onClick:function(){e.switchTenant("".concat(w.views.switchToSiteAdmin.url,"?tenant=").concat(S))}},"Switch to Site Admin")):"",!g&&te.length>1?te.map((function(t,a){return n.a.createElement("div",{key:a},t.id!==M?n.a.createElement(lt.a,{className:m.NavMenuItem,onClick:function(){e.switchTenant("".concat(w.views.switchToSiteAdmin.url,"?tenant=").concat(t.id))}},n.a.createElement(Te.a,{to:"#",className:se()(m.tenantText,m.NavLink,"nav-link")},t.name)):"")})):"",g||te.length>1?n.a.createElement(yc.a,null):"",g||j.is_external?"":n.a.createElement(lt.a,{className:m.NavMenuItem,onClick:this.invokeUpdatePasswordModal},n.a.createElement(Te.a,{to:"#",className:se()(m.NavLink,"nav-link")},"Change Password")),n.a.createElement(lt.a,{className:m.NavMenuItem,onClick:function(){window.location.href=Sl.logout.url}},n.a.createElement(Te.a,{to:"#",className:se()(m.NavLink,"nav-link")},"Logout"))),n.a.createElement(ot,{title:W.actionMenu,noBottom:!0},J.map((function(e){return n.a.createElement(lt.a,{className:m.NavMenuItem,key:e.key},e.external?n.a.createElement("a",{href:e.url,className:se()(m.NavLink,"nav-link")},e.name):n.a.createElement(Te.a,{to:e.url,activeClassName:m.activeLink,className:se()(m.NavLink,"nav-link")},e.name))})),I&&i.locked&&n.a.createElement(lt.a,{className:m.NavMenuItem},n.a.createElement("span",{className:se()(m.NavLink,"nav-link"),onClick:this.exitLockdown},"Exit site lockdown")),I&&!i.locked&&n.a.createElement(lt.a,{className:m.NavMenuItem},n.a.createElement("span",{className:se()(m.NavLink,"nav-link"),onClick:this.invokeEnterLockDownModal},"Enter site lockdown")),J.length&&n.a.createElement(yc.a,null),n.a.createElement(lt.a,{className:m.NavMenuItem},n.a.createElement("span",{className:se()(m.NavLink,"nav-link"),onClick:function(){e.invokeModal({type:"userInfo"})}},"User Info")),n.a.createElement(lt.a,{className:m.NavMenuItem},n.a.createElement("a",{href:Sl.helpdoc.url,target:"blank",className:se()(m.NavLink,"nav-link")},"User Guide")),I&&n.a.createElement(lt.a,{className:m.NavMenuItem},n.a.createElement("a",{href:Sl.support.url,target:"blank",className:se()(m.NavLink,"nav-link")},"Support")),n.a.createElement(lt.a,{className:m.NavMenuItem},n.a.createElement("a",{href:Sl.privacy.url,target:"blank",className:se()(m.NavLink,"nav-link")},"Privacy")),n.a.createElement(yc.a,null),n.a.createElement("div",{className:m.appInfo},n.a.createElement(st.a,{variant:"caption",className:m.textSm},"Version: ",re,n.a.createElement("br",null),"Build Number : ",oe))),ee?n.a.createElement("div",{className:m.alertToggle,onClick:function(){e.invokeModal({type:"alert"})}},n.a.createElement("span",{className:"icon icon-warning"}),n.a.createElement("span",{className:m.hasAlert},ee)):""),n.a.createElement(Jn,{form_id:ue,Title:n.a.createElement(st.a,{variant:"h2"},de),name:me,description:be,form_schema:ye,ui_schema:_e,method_actions:ke,formData:{},callBack:function(t){var a=t.variant;return e.callBack({variant:a,action:ce})},success_msg:Ee,failure_msg:De,preProcessData:Ce,validate:Ae,ref:this.beModalFormRef}),n.a.createElement(In,ll({},b,{ref:this.bdModalChildRef,footerCloseBtn:!0,variant:"trim"}),b.content))}}])&&ml(t.prototype,a),r&&ml(t,r),i}(r.Component);_l(jl,"propTypes",{classes:u.a.object.isRequired,session_data:u.a.object,license_data:u.a.object,license_legacy_data:u.a.object,g_install:u.a.object,lock_data:u.a.object,g_config_data:u.a.object,resetStore:u.a.func,location:u.a.object,dispatch:u.a.func});var Dl=he()(Oc)(jl),wl=a(1464),Cl=a(1461),Tl=a(704),Pl=a(14),Al=a.n(Pl),Rl=a(255),Nl=a.n(Rl),Fl={name:/^[a-zA-Z\d]([\w \-\.\_]*[a-zA-Z\d])?$/,user_name:/^[a-z0-9\-\.\s\_]+[a-z0-9]$/i,ip:/^(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)$/,fqdn:/^(?=^.{4,253}$)(^((?!-)[a-zA-Z0-9-]{0,62}[a-zA-Z0-9]\.)+[a-zA-Z-]{2,63}$)$/,fs_mount_name:/^((.)|(..)|(.*[^\d\w._-].*))$/,path_name:/^[a-zA-Z\d\/]([\w\/\-\.]*[a-zA-Z\d])?$/,port:/^[1-9][0-9]{0,4}$/,bd_prefix:/^(?![0-9])(?![-\.])(?!(epic))[a-z0-9-]*[-a-z]$/,bd_custom_install_name:/^[ a-zA-Z0-9@_-]*$/,valid_domain_name:/^([a-zA-Z0-9]+[.-])*[a-zA-Z0-9]+$/,SNMPInvalidCharacters:/^[^;|&]*$/,email_address:/^(([^<>()\[\]\\.,;:\s@"]+(\.[^<>()\[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/,url:/^(?:http(s)?:\/\/)?[\w.-]+(?:\.[\w\.-]+)+[\w\-\._~:/?#[\]@!\$&'\(\)\*\+,;=.]+$/,version_strict:/^(\d+\.)(\d+\.)(\d+)$/,network_range:/^(\d+\.)(\d+\.)(\d+\.)(\d+\/)(\d+)$/,exported_service:/^[a-zA-Z\d]([\w \-\.\_\/]*[a-zA-Z\d])?$/,tag_value:/^[a-zA-Z\d]([\w\-\.\_]*[a-zA-Z\d])?$/,git_repo:/(?:git|ssh|https?|git@[-\w.]+):(\/\/)?(.*?)(\.git)(\/?|\#[-\d\w._]+?)$/,k8s_label:/^[a-z0-9]([a-z0-9\-\.]*[a-z0-9])?$/,http:/^https?:\/\/(.*)/},xl=function(e){if("BODY"===e.nodeName)return"";if("INPUT"===e.nodeName)return e.getAttribute("id");if("SPAN"===e.nodeName&&e.hasAttribute("for"))return e.getAttribute("for");if("LI"===e.nodeName&&e.hasAttribute("for"))return e.getAttribute("for");if("BUTTON"===e.nodeName&&e.hasAttribute("for"))return e.getAttribute("for");var t=e.nextSibling;return t&&"INPUT"===t.nodeName?t.getAttribute("id"):""},Ml=function(e){if(!e)return!0;var t=/^(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)$/,a=/^(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)-(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)$/,r=/^(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)$/,n=/^(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)-(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)$/,o=e.split(",");if(!(o.length>1))return!(!e.match(t)&&!e.match(a));for(var i=0;i<o.length;i++)return!!(o[i].match(t)||o[i].match(a)||o[i].match(r)||o[i].match(n))},Il=function(e){var t=[],a=!1;return e.length&&e.some((function(e){var r=e.tag_id;if(""!==e.tag_value){if(t.includes(r))return a=!0,!0;t.push(r)}})),a},Ul=function(e){return e.length?e.reduce((function(e,t){var a=f.a.fetchSafeFromObject({path:["label","name"],obj:t,default_value:""}),r=f.a.fetchSafeFromObject({path:["_links","self","href"],obj:t,default_value:""});return e.push({type:"string",enum:[r],title:a}),e}),[]):[]},Ll=function(e){return e.length?e.reduce((function(e,t){var a=f.a.fetchSafeFromObject({path:["_links","self","href"],obj:t,default_value:""});return a&&(e[a]=t.values),e}),{}):{}},Bl=function(e){return e.length?e.reduce((function(e,t){return e.push({type:"string",enum:[t]}),e}),[]):[]},Hl=function(e,t,a){return{type:"object",singleRow:!0,properties:{tag_id:{type:"string",oneOf:e},tag_value:{type:"string",suggestions:a[t]}}}};function Kl(e){return function(e){if(Array.isArray(e))return ql(e)}(e)||function(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||function(e,t){if(!e)return;if("string"==typeof e)return ql(e,t);var a=Object.prototype.toString.call(e).slice(8,-1);"Object"===a&&e.constructor&&(a=e.constructor.name);if("Map"===a||"Set"===a)return Array.from(e);if("Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a))return ql(e,t)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function ql(e,t){(null==t||t>e.length)&&(t=e.length);for(var a=0,r=new Array(t);a<t;a++)r[a]=e[a];return r}var Vl=er({path:["hostAddTooltipMsg"]}),Gl=["bundle","installing","storage_configuring","nagios_mon_pending","nagios_mon_configuring","nagios_mon","configuring","install_scheduled","unconfiguring","sysinfo","deleting","delete_in_progress","upgrading","vacating","connecting","decommission_in_progress","update_in_progress"],zl=["Fetching HDFS Status","Decommissioning","Decommission in progress"],Wl=["ready","storage_pending","storage_error","keys_error"],Jl=[].concat(Wl,["error","prechecks_error","unlicensed","installed"]),Yl=function(e,t){return Gl.includes(e)||zl.includes(t)},$l={processHostDisks:function(e,t){var a=[],r=[];return e.map((function(e){var n=e.info,o=(n=void 0===n?{}:n).HasFilesystem,i=void 0!==o&&o,s=n.Name,c=void 0===s?"":s,l=n.IsDisk,u=void 0!==l&&l,p=n.SizeBytes,d=void 0===p?0:p;u&&!i&&d>150*t?a.push({Name:c,SizeBytes:d}):r.push({Name:c,SizeBytes:d})})),{available_disks:a,unselected_disks:r}},getHostFormSchema:function(){return{type:"object",properties:{worker_ip:{type:"string",title:"IP List",description:Vl.workerIp,help:n.a.createElement(Yi,{key:"ipListHelp",header:"Acceptable formats for IP address lists:",icon:"icon-chevron-down",placement:"start",expanded:!1,noBackground:!0},n.a.createElement(st.a,null,"192.168.162.1"),n.a.createElement(st.a,null,"192.168.162.1,12,76,192.162.168.12"),n.a.createElement(st.a,null,"192.168.162.1-12"),n.a.createElement(st.a,null,"10.1.10.1-12,15,192.162.168.12-15")),bd_required:!0},username:{type:"string",title:"Username",default:"",description:Vl.userName,bd_required:!0,readOnly:!0},cred_type:{type:"string",title:"Credentials",enum:["Password Access","SSH Key Based Access"],default:"Password Access",description:Vl.credentialType},ssh_cred_type:{type:"object",properties:{password:{type:"string",bd_widget:"password",title:"Password",description:Vl.workerPassword,bd_required:!0}}}}}},getHostCredentialSchema:function(e,t,a){var r=f.a.deepClone(t);return"SSH Key Based Access"===e.cred_type?r.properties.ssh_cred_type={type:"object",properties:{ssh_key_data:{type:"string",format:"data-url",title:"Upload Private Key",description:Vl.workerSshKeyPath,bd_required:!0,read:!0,bdOnChange:a},ssh_key_passphrase:{type:"string",bd_widget:"password",title:"Passphrase",description:Vl.workerSshPassphrase,bd_required:!1}}}:r.properties.ssh_cred_type={type:"object",properties:{password:{type:"string",bd_widget:"password",title:"Password",description:Vl.workerPassword,bd_required:!0}}},r},isDublicateHost:function(e,t){return e.some((function(e){var a=e.ipaddr,r=void 0===a?"":a,n=e.ip;return t===((void 0===n?"":n)||r)}))},isTransientStatus:Yl,makeDefaultDiskSelection:function(e,t){var a=[],r=[],n=e.length;if(n>1&&t){var o=[],i=[],s=Math.floor(n/2);e.map((function(e){(function(e,t){return e<t*w.settings.B_to_GB})(e.SizeBytes,500)?o.push(e):i.push(e),i.length?i.length<=s?(a=o,r=i):(r=i.slice(0,s),a=o.concat(i.slice(s))):a=o}))}else{var c;(c=a).push.apply(c,Kl(e))}return{ephemeral_disks:a,persistent_disks:r}},getDisksDataEditModal:function(e){var t=e.host_id,a=e.currentDiskSelection,r=e.isMaprInstallation,n=a.ephemeral_disks,o=void 0===n?[]:n,i=a.persistent_disks,s=void 0===i?[]:i,c=a.unselected_disks,l=void 0===c?[]:c,u=a.available_disks,p=void 0===u?[]:u,d=function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],a=e.reduce((function(e,a){var r=f.a.roundNumber(a.SizeBytes/w.settings.B_to_GB);return e.push({title:"".concat(a.Name," ").concat(r," GB"),value:a.Name,diskSize:a.SizeBytes,disabled:t&&!p.includes(a)?"both":"none"}),e}),[]);return a},m=[{title:"Ephemeral",node:t,data:d(o)},{title:"Unselected Disks",node:t,data:d(l,!0)}];if(r){var h={title:"Persistent",node:t,data:d(s)};m.push(h)}return m},getIpListFromIpRange:function(e){for(var t,a=[],r=e.split(","),n=function(e,t){for(var a=[],r=t.split("-"),n=function(){for(var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e,a=[],r=e;r<=t;r++)a.push(r);return a}(parseInt(r[0]),r[1]?parseInt(r[1]):void 0),o=0;o<n.length;o++)a.push(e+"."+n[o]);return a},o=0;o<r.length;o++){var i=r[o].split(".");4===i.length?(t=i[0]+"."+i[1]+"."+i[2],Array.prototype.push.apply(a,n(t,i[3]))):Array.prototype.push.apply(a,n(t,i[0]))}return a},liveUpdateHostInterval:function(e,t){var a=e.status,r=void 0===a?"":a,n=e.state,o=void 0===n?"":n,i=e.storage_commission_status,s=void 0===i?"":i,c=e.hdfs_commission_status,l="k8s"===t?r:o,u="k8s"===t?s:void 0===c?"":c,p=["connecting","decommission_in_progress","update_in_progress"].includes(l)||"Fetching HDFS Status"===u;return!!Yl(l,u)&&(p?5:30)},liveUpdateHostsInterval:function(e,t){var a="";return e.find((function(e){var r=e.status,n=void 0===r?"":r,o=e.state,i=void 0===o?"":o,s=e.storage_commission_status,c=void 0===s?"":s,l=e.hdfs_commission_status,u="k8s"===t?n:i,p="k8s"===t?c:void 0===l?"":l,d=["connecting","decommission_in_progress","update_in_progress"].includes(u)||"Fetching HDFS Status"===p?5:30,f=Yl(u,p);a=!!f&&d})),a},HOSTS_INSTALLABLE_STATES:Wl,HOSTS_DELETABLE_STATES:Jl},Ql=function(e){return{hostsActionBtns:{marginLeft:.5*e.spacing.unit},decommissionedState:{color:e.palette.warning.dark,marginLeft:.5*e.spacing.unit},textWarning:{color:e.palette.warning.dark},dflexCenter:{display:"flex",alignItems:"center"},mLeft:{marginLeft:.5*e.spacing.unit},deleteInfoBtn:{cursor:"pointer",color:e.palette.error.dark,padding:"".concat(.3*e.spacing.unit,"px ").concat(.3*e.spacing.unit,"px"),fontSize:1.5*e.spacing.unit},disabled:{pointerEvents:"none",cursor:"not-allowed",background:e.palette.gray400},textError:{color:e.palette.error.dark},blinkAnimation:{animation:"blinker 2s infinite linear"},"@keyframes blinker":{"0%":{opacity:1},"50%":{opacity:0},"100%":{opacity:1}}}};function Zl(e){return(Zl="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Xl(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function eu(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?Xl(Object(a),!0).forEach((function(t){su(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):Xl(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function tu(e,t){for(var a=0;a<t.length;a++){var r=t[a];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function au(e,t){return(au=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function ru(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=iu(e);if(t){var n=iu(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return nu(this,a)}}function nu(e,t){return!t||"object"!==Zl(t)&&"function"!=typeof t?ou(e):t}function ou(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function iu(e){return(iu=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function su(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function cu(e){return function(e){if(Array.isArray(e))return lu(e)}(e)||function(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||function(e,t){if(!e)return;if("string"==typeof e)return lu(e,t);var a=Object.prototype.toString.call(e).slice(8,-1);"Object"===a&&e.constructor&&(a=e.constructor.name);if("Map"===a||"Set"===a)return Array.from(e);if("Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a))return lu(e,t)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function lu(e,t){(null==t||t>e.length)&&(t=e.length);for(var a=0,r=new Array(t);a<t;a++)r[a]=e[a];return r}var uu=er({path:["HostTable"]}),pu=er({path:["updateTagFormMsg"]}),du=$l.HOSTS_DELETABLE_STATES,fu=$l.HOSTS_INSTALLABLE_STATES,mu=void 0===fu?[]:fu,hu=(void 0===du?[]:du).filter((function(e){return"installed"!==e})),bu=[].concat(cu(mu),["installed"]),vu={Title:"",formSchema:{},methodActions:[{method:w.method.PUT,action:"#",data:"FORM_DATA"}]},yu=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&au(e,t)}(i,e);var t,a,r,o=ru(i);function i(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),(t=o.call(this,e)).state={selectableDisks:[],modalDiskData:[],updateTagform:vu},t.isBlinkAnimation=!1,t.getHostLabelOptions=t.getHostLabelOptions.bind(ou(t)),t.deleteEpicHostList=t.deleteEpicHostList.bind(ou(t)),t.deleteEpicHost=t.deleteEpicHost.bind(ou(t)),t.getTagNameById=t.getTagNameById.bind(ou(t)),t.closeEditDiskModal=t.closeEditDiskModal.bind(ou(t)),t.prepareModalDiskData=t.prepareModalDiskData.bind(ou(t)),t.onModalClose=t.onModalClose.bind(ou(t)),t.installWorkerList=t.installWorkerList.bind(ou(t)),t.commissionDecommissionDataNode=t.commissionDecommissionDataNode.bind(ou(t)),t.updateHostTag=t.updateHostTag.bind(ou(t)),t.onAddTagClick=t.onAddTagClick.bind(ou(t)),t.onDropTagClick=t.onDropTagClick.bind(ou(t)),t.onChangeUpdateTagForm=t.onChangeUpdateTagForm.bind(ou(t)),t.preProcessUpdateTagData=t.preProcessUpdateTagData.bind(ou(t)),t.validateForm=t.validateForm.bind(ou(t)),t.onDiskSelection=t.onDiskSelection.bind(ou(t)),t.checkWorkerAlert=t.checkWorkerAlert.bind(ou(t)),t.getNodeMtu=t.getNodeMtu.bind(ou(t)),t.checkMtuAlert=t.checkMtuAlert.bind(ou(t)),t.isEmptyDisksFound=t.isEmptyDisksFound.bind(ou(t)),t.vacateHost=t.vacateHost.bind(ou(t)),t.invokeHostsOperations=t.invokeHostsOperations.bind(ou(t)),t.onRowsSelect=t.onRowsSelect.bind(ou(t)),t.bdDialogRef=n.a.createRef(),t.bdModalEditDiskChildRef=n.a.createRef(),t.bdModalFormRef=n.a.createRef(),t.formData={},t}return t=i,(a=[{key:"getTagNameById",value:function(e){var t=this.props.hostsTags,a=cu(void 0===t?[]:t);return f.a.fetchSafeFromObjectArray({arr:a,path:["_links","self","href"],match:e,get:["label","name"],default_value:[]})}},{key:"isEmptyDisksFound",value:function(e){return!f.a.isEmptyObject(e.sysinfo)&&f.a.fetchSafeFromObject({path:["sysinfo","storage"],obj:e,default_value:[]}).some((function(e){var t=f.a.fetchSafeFromObject({path:["info","HasFilesystem"],obj:e,default_value:!1}),a=f.a.fetchSafeFromObject({path:["info","SizeBytes"],obj:e,default_value:0})>=150*w.settings.B_to_GB;return!t&&a}))}},{key:"checkWorkerAlert",value:function(e,t){var a=!1;if(this.isEmptyDisksFound(e))this.props.controllerHosts.map((function(e){if("primary"===e.purpose){var r=t.ephemeral_disks,n=void 0===r?[]:r,o=t.persistent_disks,i=void 0===o?[]:o,s=function(e,t){return e.includes(t.Name)||e.push(t.Name),e},c=n.reduce(s,[]).sort().join(","),l=i.reduce(s,[]).sort().join(","),u=f.a.fetchSafeFromObject({path:["container_disks_configured"],obj:e,default_value:""}),p=f.a.fetchSafeFromObject({path:["hdfs_disks_configured"],obj:e,default_value:""});c===u&&l===p||(a="Worker's disk configurations don't match with Controller.")}}));else{a="Worker does not have any empty disks and can not be installed as a ".concat(w.APP_TITLE.CP," worker.");var r={callback:null,title:"",context:"",description:"".concat(e.ip," (").concat(e.hostname,") does not have any empty disks and cannot be installed as a HPE Comtainer Platform worker.")};this.bdDialogRef.current.handleOpen(r)}return a}},{key:"getNodeMtu",value:function(e){var t=f.a.fetchSafeFromObject({path:["propinfo","bds_network_publicinterface"],obj:e,default_value:""}),a=f.a.fetchSafeFromObject({path:["sysinfo","network"],obj:e,default_value:[]}),r="";return a.length&&a.map((function(e){var a=e.info,n=(a=void 0===a?{}:a).Mtu,o=void 0===n?"":n,i=e.name;t===(void 0===i?"":i)&&(r=o)})),r}},{key:"checkMtuAlert",value:function(e){var t=this,a="";return this.props.controllerHosts.map((function(r){if("primary"===r.purpose){var n=t.getNodeMtu(r),o=t.getNodeMtu(e);n||(a="Unable to fetch mtu of the public interface on the controller."),o||(a+=" Unable to fetch mtu of the public interface on the worker."),n!==o&&(a+="Workers's MTU( ".concat(o," ) doesn't match controller's MTU ( ").concat(n," )."))}})),a}},{key:"getHostsTableSettings",value:function(){var e=this,t=this.props,a=t.pnodeList,r=t.classes,o=t.disks_selection,i=t.role_name,s=t.tagsInfo,c=void 0===s?{}:s,l=t.configCapabilities,u=t.applicableWorkers,p=t.isMaprInstallation,d=t.isLocalHdfs,m=l.gpu_usage_supported,h=void 0!==m&&m,b=l.persistent_supported,v=void 0!==b&&b,y=c.hostsTagsFetched,g=void 0!==y&&y,_=p||d,S={5:function(t,a){return t.sort((function(t,r){var n=f.a.fetchSafeFromObject({path:["data",5],obj:t,default_value:""}),o=f.a.fetchSafeFromObject({path:["data",5],obj:r,default_value:""}),i=JSON.parse(n),s=JSON.parse(o),c=e.getHostLabelOptions(i),l=e.getHostLabelOptions(s),u=c.title||"",p=l.title||"";return u<p?"asc"===a?-1:1:u>p?"asc"===a?1:-1:0}))}};return{columns:[{name:"Host",options:{filter:!0,sortDirection:"asc"}},{name:"Tags",options:{filter:!0,customBodyRender:function(t){var a=JSON.parse(t);return n.a.createElement("div",{className:"py-2"},a.length?a.map((function(t){var a=t.tag_id,r=void 0===a?"":a,o=t.tag_value,i=void 0===o?"":o,s=e.getTagNameById(r);return n.a.createElement(st.a,{key:r},"".concat(s).concat(i?":":""," ").concat(i))})):"")}}},{name:"Details",options:{filter:!0,customBodyRender:function(t){var a,r,o,i,s,c=JSON.parse(t),l=c.status,u=c.status_info,p=c.sysinfo,d=c.purpose,m=c.ephemeral_disks,h=c.persistent_disks,b=c.hdfs_commission_status,v=c.bds_network_publicinterface,y=c.classes,g=c.schedule,S=c.hacapable,k=c.hdfs_commission,O=c.workerAlert,E=c.mtuAlert,j=c.host_id,D="unknown",C="unknown";f.a.isEmptyObject(p)||(D=p.memory?f.a.roundNumber(p.memory.mem_total/w.settings.B_to_GB):"unknown",C=p.cpu?p.cpu.cpu_count:"unknown",r=p.gpu?p.gpu.gpu_count:"",o="configured"!==l&&p.keys&&p.keys.reported_worker_public_key?Nl()(p.keys.reported_worker_public_key):""),["installed","ha_setup","ready"].includes(l)&&(i=g?"enabled":"disabled",_&&S&&("Error"===b?s=k?"Decommissioning error":"Recommissioning error":("Fetching HDFS Status"===b||k&&!["Normal","Decommissioned"].includes(b)?e.isBlinkAnimation=!0:e.isBlinkAnimation=!1,s=b)));var T="",P=!1;return""!==u&&"unlicensed"!==l&&(T=u,"installed"===l&&(P=!0)),n.a.createElement("div",{className:"py-2"},n.a.createElement(st.a,{variant:"body1"},"Role: ",d),n.a.createElement(st.a,{variant:"body1"},"Memory (GB): ",D,", Cores : ",C),r?n.a.createElement(st.a,{variant:"body1"},"GPU Devices: ",r):"",v?n.a.createElement(st.a,{variant:"body1"},"Primary NIC: ",v):"",o?n.a.createElement(st.a,{variant:"body1"},"Fingerprint: ",o):"",i?n.a.createElement(st.a,{variant:"body1",className:y.dflexCenter},"Virtual nodes assignment:",n.a.createElement(st.a,{className:se()(y.mLeft,su({},"".concat(y.textWarning),!g)),variant:"caption"}," ",i)):"",s?n.a.createElement(st.a,{variant:"body1",className:se()(y.dflexCenter,(a={},su(a,"".concat(y.blinkAnimation),e.isBlinkAnimation),su(a,"".concat(y.textError),"Error"===b),a))},"Persistent Storage Status:",n.a.createElement(st.a,{className:se()("Decommissioned"===b?y.decommissionedState:y.mLeft,su({},"".concat(y.textError),"Error"===b)),variant:"caption"},s)):"",T?n.a.createElement(st.a,{variant:"body1",className:se()(y.dflexCenter,su({},"".concat(y.blinkAnimation),"vacating"===l))},"Status Info:",n.a.createElement(st.a,{className:se()(y.textWarning,y.mLeft),variant:"caption"},T),P&&n.a.createElement(ka,{title:"Delete status info",variant:"error"},n.a.createElement("span",{className:se()("delete-status-info  btn btn-danger btn-tiny icon icon-cross2 text-default",y.mLeft,y.deleteInfoBtn,su({},"".concat(y.disabled),"vacating"===l)),onClick:function(){e.invokeHostsOperations({operation:"status_info",host_id:j})}}))):"",m||h?n.a.createElement(Ia,null,m&&m.length?n.a.createElement(st.a,{variant:"body1"},"Container Disks: ",m.toString()):"",h&&h.length?n.a.createElement(st.a,{variant:"body1"},"Persistent Disks: ",h.toString()):""):"",O?n.a.createElement(st.a,{className:y.textWarning},n.a.createElement("span",{className:"icon icon-warning"})," ",O):"",E?n.a.createElement(st.a,{className:y.textWarning},E):"")}}},{name:"Utilization",options:{filter:!0,customBodyRender:function(e){var t=JSON.parse(e),a=t.status,r=t.vm_limit,o=void 0===r?0:r,i=t.vm_count,s=void 0===i?0:i,c=t.memory_mb_used,l=void 0===c?0:c,u=t.memory_mb,p=void 0===u?0:u,d=t.vcpus,m=void 0===d?0:d,b=t.vcpus_used,v=void 0===b?0:b,y=t.root_disk_gb,g=void 0===y?0:y,_=t.root_disk_gb_used,S=void 0===_?0:_,k=t.gpus,O=void 0===k?0:k,E=t.gpus_used,j=o?"".concat(s,"/").concat(o):s,D=parseInt(l/1024)+"/"+parseInt(p/1024),w="ready"!==a;return n.a.createElement("div",{className:"py-2"},w&&!f.a.isEmptyObject(t)?n.a.createElement(n.a.Fragment,null,n.a.createElement(st.a,{variant:"body1"},"Node Count: ",j),n.a.createElement(st.a,{variant:"body1"},"Memory (GB): ",D),h?n.a.createElement(st.a,{variant:"body1"},"GPU Devices: ","".concat(E,"/").concat(O)):"",n.a.createElement(st.a,{variant:"body1"},"VCPUS: ","".concat(v,"/").concat(m)),n.a.createElement(st.a,{variant:"body1"},"Node Storage (GB): ","".concat(S,"/").concat(g))):"")}}},{name:"Status",options:{filter:!0,customBodyRender:function(t){var a=JSON.parse(t),r=e.getHostLabelOptions(a);return n.a.createElement(Qa,r)}}},{name:"Actions",options:{filter:!1,sort:!1,customBodyRender:function(t){var a=JSON.parse(t),o=a.host_id,i=a.status,s=a.ipaddr,c=a.hostname,l=a.hdfs_commission_status,u=a.schedule,p=a.showDecommissionBtn,d=a.showRecommissionBtn,f=a.canDeleteHost,m=a.titleNodeAssignmnt,h=a.variantNodeAssignment;if(!$l.isTransientStatus(i,l)){var b="".concat(s," (").concat(c,")"),y=w.views.epicWorkerSetupLog.makeUrl({id:o});return n.a.createElement("div",{className:se()("row-action-btns",su({},"".concat(r.blinkAnimation),e.isBlinkAnimation))},mu.includes(i)&&n.a.createElement(ka,{title:"Edit Disks",variant:"primary"},n.a.createElement("span",{className:se()("icon","icon-rect-link","icon-pencil3"),onClick:function(){e.prepareModalDiskData(o),e.bdModalEditDiskChildRef.current.handleOpen()}})),[].concat(cu(mu),["error"]).includes(i)&&n.a.createElement(ka,{title:"Setup Log",variant:"primary"},n.a.createElement("a",{href:y,target:"_blank",rel:"noopener noreferrer",className:se()(r.NavLink,"icon","icon-rect-link","icon-cli")})),["installed","storage_error"].includes(i)&&n.a.createElement(ka,{title:"Update system info",variant:"primary"},n.a.createElement("span",{className:se()("icon","icon-rect-link","action-link","icon-download",su({},"".concat(r.disabled),e.isBlinkAnimation)),onClick:function(){e.invokeHostsOperations({operation:"update",hostName:b,host_id:o})}})),"installed"===i&&n.a.createElement(ka,{title:m,variant:h},n.a.createElement("span",{className:se()("icon","icon-rect-link","action-link",u?"icon-prohibited":"icon-checkmark-circle",su({},"".concat(r.disabled),e.isBlinkAnimation)),onClick:function(){e.invokeHostsOperations({operation:"schedule",hostName:b,host_id:o,schedule:u})}})),p&&n.a.createElement(ka,{title:"Decommission data node",variant:"warning"},n.a.createElement("span",{className:se()("icon","icon-rect-link","action-link","icon-unlink2",su({},"".concat(r.disabled),e.isBlinkAnimation)),onClick:function(){var t={callback:e.commissionDecommissionDataNode,context:{host_id:o,hostName:b,op:"decommission"},title:"Decommission host ("+s+")",description:uu.decommissionDescription};e.bdDialogRef.current.handleOpen(t)}})),d&&n.a.createElement(ka,{title:"Recommission data node",variant:"warning"},n.a.createElement("span",{className:se()("icon","icon-rect-link","action-link","icon-link2",su({},"".concat(r.disabled),e.isBlinkAnimation)),onClick:function(){var t={callback:e.commissionDecommissionDataNode,context:{host_id:o,hostName:b,op:"recommission"},title:"Recommission host ("+s+")",description:uu.recommissionDescription};e.bdDialogRef.current.handleOpen(t)}})),"installed"===i&&v&&n.a.createElement(ka,{title:"Vacate Host",variant:"warning"},n.a.createElement("span",{className:se()("icon","icon-rect-link","action-link","icon-dolly",su({},"".concat(r.disabled),e.isBlinkAnimation)),onClick:function(){var t={callback:e.vacateHost,context:{host_id:o,hostName:b},title:"Vacate host ("+s+")",description:uu.vacateHostDescription};e.bdDialogRef.current.handleOpen(t)}})),f&&n.a.createElement(ka,{title:"Delete",variant:"error"},n.a.createElement("span",{className:se()("icon","icon-rect-link","icon-trash2",su({},"".concat(r.disabled),e.isBlinkAnimation)),onClick:function(){var t={callback:e.deleteEpicHost,context:{host_id:o,ipaddr:s},title:"Delete host ("+s+")",description:uu.deleteDescription};e.bdDialogRef.current.handleOpen(t)}})),g&&bu.includes(i)&&n.a.createElement(ka,{title:"Update Tag",variant:"success"},n.a.createElement("span",{className:se()("icon","icon-rect-link","icon-tag",su({},"".concat(r.disabled),e.isBlinkAnimation)),onClick:function(){e.updateHostTag({host_id:o})}})))}}}}],data:u.reduce((function(t,n){var i=n.ip,s=void 0===i?"":i,c=n.hostname,l=void 0===c?"":c,u=n.state,m=void 0===u?"":u,h=n.sysinfo,b=void 0===h?{}:h,v=n.status_info,y=void 0===v?"":v,g=n.purpose,S=void 0===g?"":g,k=n.tags,O=void 0===k?[]:k,E=n.hdfs_commission,j=void 0!==E&&E,D=n.hdfs_commission_status,w=void 0===D?"":D,C=n.schedule,T=void 0!==C&&C,P=n.hacapable,A=void 0!==P&&P,R=n.container_disks_configured,N=void 0===R?"":R,F=n.hdfs_disks_configured,x=void 0===F?"":F,M=n.propinfo,I=(M=void 0===M?{}:M).bds_network_publicinterface,U=void 0===I?"":I,L=f.a.fetchSafeFromObject({path:["_links","self","href"],obj:n,default_value:""}),B=f.a.fetchSafeFromObject({path:[L],obj:o,default_value:{}}),H=f.a.isEmptyObject(B),K=[],q=[];n.container_disks_configured||n.hdfs_disks_configured?(K=x.length&&x.split(", "),q=N.length&&N.split(", ")):(K=!H&&B.persistent_disks.map((function(e){return e.Name}))||[],q=!H&&B.ephemeral_disks.map((function(e){return e.Name}))||[]);var V={};"ready"!==m&&a.length&&(V=f.a.fetchSafeFromObjectArray({arr:a,path:["name"],match:n.hostname,default_value:""}));var G=!1;mu.includes(m)&&!H&&(G=e.checkWorkerAlert(n,B));var z=!1;(mu.includes(m)||"installed"===m)&&(f.a.isEmptyObject(b)||(z=e.checkMtuAlert(n)));var W=!1,J=!1;"installed"===m&&(W=["Normal","Error"].includes(w)&&_&&A,J=["Decommissioned","Error"].includes(w)&&_&&A);var Y=T?"Disable virtual node assignment":"Enable virtual node assignment",$=T?"warning":"primary",Q=!1;return hu.includes(m)?Q=!0:p||"installed"!==m?(p||d)&&(Q=!A||"Decommissioned"===w):Q=!0,t.push(["".concat(s," ").concat(l?" ( ".concat(l," )"):""),JSON.stringify(O),JSON.stringify({status:m,status_info:y,sysinfo:b,purpose:S,ephemeral_disks:q,persistent_disks:K,hdfs_commission_status:w,bds_network_publicinterface:U,classes:r,schedule:T,hacapable:A,hdfs_commission:j,workerAlert:G,mtuAlert:z,host_id:L,canDeleteHost:Q}),JSON.stringify(V),JSON.stringify({status:m,status_info:y,hdfs_commission_status:w}),JSON.stringify({host_id:L,status:m,ipaddr:s,hostname:l,hdfs_commission:j,hdfs_commission_status:w,hacapable:A,schedule:T,showDecommissionBtn:W,showRecommissionBtn:J,canDeleteHost:Q,titleNodeAssignmnt:Y,variantNodeAssignment:$})]),t}),[]),options:{customToolbar:function(){return"Site Admin"===i?n.a.createElement("div",{className:"tableActionButtons"},n.a.createElement(Ue.a,{variant:"contained",color:"primary",disabled:!0,className:r.hostsActionBtns},"Install"),n.a.createElement(Ue.a,{variant:"contained",color:"primary",disabled:!0,className:r.hostsActionBtns},"Delete")):""},customToolbarSelect:function(t){var a=e.props.classes,r=e.onRowsSelect(t),o=r.canInstall,i=r.canDelete,s=r.hostInstallDesc,c=r.isInstallable,l=r.siteLDownMsg;return n.a.createElement("div",{className:a.tableActionButtonsSelected},o?n.a.createElement(ka,{title:l,variant:"info"},n.a.createElement(Ue.a,{variant:"contained",color:"primary",className:a.hostsActionBtns,onClick:function(){var a={callback:e.installWorkerList,context:t,title:"Install selected host(s).",description:s};c&&e.bdDialogRef.current.handleOpen(a)}},"Install")):n.a.createElement(Ue.a,{variant:"contained",color:"primary",disabled:!0,className:a.hostsActionBtns},"Install"),i?n.a.createElement(Ue.a,{variant:"contained",color:"secondary",className:a.hostsActionBtns,onClick:function(){var a={callback:e.deleteEpicHostList,context:t,title:"Delete selected host(s)",description:uu.deleteDescription};e.bdDialogRef.current.handleOpen(a)}},"Delete"):n.a.createElement(Ue.a,{variant:"contained",color:"primary",disabled:!0,className:a.hostsActionBtns},"Delete"))},customSort:S}}}},{key:"getHostLabelOptions",value:function(e){var t=e.status,a=e.status_info,r=e.hdfs_commission_status,n={status:t,title:t};switch("Fetching HDFS Status"===r&&(n={title:"fetching storage status",status:r}),"Decommissioning"===r&&(n={title:r,status:r}),t){case"bundle":n.title="running bundle";break;case"sysinfo":n.title="collecting sysinfo";break;case"ready":n.title="bundle completed";break;case"install_scheduled":n.title="install scheduled";break;case"decommission_in_progress":n.title="node decommissioning";break;case"delete_in_progress":n.title="delete in progress";break;case"ha_setup":n.title="setting up HA Setup";break;case"update_in_progress":n.title="updating";break;case"unlicensed":a&&(n.tooltip=a);break;case"storage_error":n.title="storage config error",a&&(n.tooltip=a);break;case"keys_error":n.title="host keys error",a&&(n.tooltip=a);break;case"error":n.tooltip=a;break;case"prechecks_error":n.title="prechecks error",a&&(n.tooltip=a);break;case"vacating":n.title="host vacating";break;default:n.title}return a&&(n.alert_title=a),n}},{key:"onRowsSelect",value:function(e){var t=this.props,a=t.lock_data,r=t.bds_install_workerreboot,n=a.locked,o=void 0!==n&&n,i=a.quiesced,s=void 0!==i&&i,c={canInstall:!0,canDelete:!0,siteLDownMsg:"",isInstallable:!0,hostInstallDesc:uu.installationConfirmation},l=!1;return e.data.map((function(e){var t=e.rowData,a=void 0===t?[]:t,r=JSON.parse(a[2]),n=r.status,o=r.workerAlert,i=r.canDeleteHost;mu.includes(n)?l=!!o:c.canInstall=!1,c.canDelete&&!i&&(c.canDelete=!1)})),o&&s?c.hostInstallDesc="true"===r?uu.workerRebootMsg:l?uu.diskMismatchMsg:c.hostInstallDesc:(c.isInstallable=!1,c.siteLDownMsg="Site has to be in lockdown mode prior to installing workers. ".concat(o?"Wait for the system to be quiesced.":"")),c}},{key:"installWorkerList",value:function(e){var t=this,a=this.props.disks_selection,r=void 0===a?{}:a,o={workers:e.data.reduce((function(e,t){var a=t.rowData,n=JSON.parse(a[a.length-1]),o=n.host_id,i=n.ipaddr,s=n.hostname,c=f.a.fetchSafeFromObject({path:[o],obj:r,default_value:{}}),l=c.ephemeral_disks.map((function(e){return e.Name})),u=c.persistent_disks.map((function(e){return e.Name})),p=s?"".concat(i," (").concat(s,")"):i;return e.push({id:o,containerdisks:l,hdfsdisks:u||[],name:p}),e}),[])};R({apiurl:w.apiurl.INSTALL_EPIC_WORKERS,method:w.method.PUT,data:o}).then((function(){_n({msg:"Worker(s) installation started successfully",variant:"success"}),t.props.fetchEpicHosts()})).catch((function(e){var t=f.a.parseAxiosError({error:e});_n({msg:n.a.createElement(ns,{errors:["Error occured during worker installation",t]}),variant:"error"})}))}},{key:"invokeHostsOperations",value:function(e){var t=this,a=e.operation,r=e.hostName,o=e.host_id,i=e.schedule,s={operation:a,id:o},c=i?"disable":"enable",l="",u="";switch(a){case"update":l="Worker system info update started successfully",u="Failed to update system info of the worker ".concat(r);break;case"schedule":l="Virtual nodes assignment ".concat(c,"d successfully for ").concat(r),u="Failed to update system info of the worker ".concat(r),s.schedule=!i;break;case"status_info":l="Worker status info cleared successfully",u="Failed to delete status info"}R({apiurl:o,method:w.method.PUT,data:s}).then((function(){_n({msg:l,variant:"success"}),t.props.fetchEpicHosts()})).catch((function(e){var t=f.a.parseAxiosError({error:e});_n({msg:n.a.createElement(ns,{errors:[u,t]}),variant:"error"})}))}},{key:"vacateHost",value:function(e){var t=this,a=e.host_id,r=e.hostName,o={operation:"vacate",id:a};R({apiurl:a,method:w.method.PUT,data:o}).then((function(){_n({msg:"Host vacate process started successfully for ".concat(r),variant:"success"}),t.props.fetchEpicHosts()})).catch((function(e){var t=f.a.parseAxiosError({error:e}),a=n.a.createElement(ns,{errors:["Failed to start host vacate process for ".concat(r),t]});_n({msg:a,variant:"error"})}))}},{key:"commissionDecommissionDataNode",value:function(e){var t=e.host_id,a=e.hostName,r=e.op,o=this.props.fetchEpicHosts,i="decommission"===r?"decommission":"recommission",s={commission:"recommission"===i,id:t,operation:"hdfs_commission"};R({apiurl:t,method:w.method.PUT,data:s}).then((function(){_n({msg:"Datanode ".concat(i," process started successfully for ").concat(a),variant:"success"}),o()})).catch((function(e){var t=f.a.parseAxiosError({error:e}),r=n.a.createElement(ns,{errors:["Failed to ".concat(i," the host ").concat(a),t]});_n({msg:r,variant:"error"})}))}},{key:"deleteEpicHostList",value:function(e){var t=this;e.data.map((function(e){var a=e.rowData,r=JSON.parse(a[a.length-1]),n=r.host_id,o=r.ipaddr;t.deleteEpicHost({host_id:n,ipaddr:o})}))}},{key:"deleteEpicHost",value:function(e){var t=e.host_id,a=e.ipaddr,r=this.props.fetchEpicHosts;R({apiurl:t,method:w.method.DELETE}).then((function(){r(),_n({msg:"Started deletion process for the host ( ".concat(a," )."),variant:"success"})})).catch((function(e){var t=f.a.parseAxiosError({error:e}),r=n.a.createElement(ns,{errors:["Failed to delete the host ".concat(a),t]});_n({msg:r,variant:"error"})}))}},{key:"updateHostTag",value:function(e){var t=e.host_id,a=this.props,r=a.tagsInfo,o=a.applicableWorkers,i=(void 0===o?[]:o).find((function(e){return t===f.a.fetchSafeFromObject({path:["_links","self","href"],obj:e,default_value:""})})),s=i.ip,c=void 0===s?"":s,l=i.hostname,u=void 0===l?"":l,p=i.tags,d=void 0===p?[]:p,m=r.tagItemSchema,h=r.tagItemDefaultData,b=r.tagOptions,v=r.tagValuesByID;if(b.length){d.length||(d=[h]);var y=d.reduce((function(e,t){var a=v[t.tag_id],r=JSON.parse(JSON.stringify(m));return r.properties.tag_value.suggestions=a?cu(a):[],e.push(r),e}),[]),g={type:"object",properties:{tags:{type:"array",title:"Tags",description:pu.tagsFieldDescription("epic"),items:y,canAdd:!0,addItemTitle:"Tag",onAddClick:this.onAddTagClick,onDropClick:this.onDropTagClick}}};this.formData={tags:d};var _=n.a.createElement(st.a,{variant:"h2"},"Update tag for ",c,u?" (".concat(u,")"):"");this.setState({updateTagform:{Title:_,formSchema:g,methodActions:[{method:w.method.PUT,action:t,data:"FORM_DATA"}]}}),this.bdModalFormRef.current.updateStateFormData({formData:this.formData}),this.bdModalFormRef.current.openModal()}else this.bdDialogRef.current.handleOpen({title:"Tags not available.",description:"Tags must be configured prior to adding them for epic host(s)."})}},{key:"onAddTagClick",value:function(){var e=this,t=this.props.tagsInfo,a=this.state.updateTagform,r=a.formSchema,n=t.tagItemSchema,o=t.tagItemDefaultData;r.properties.tags.items.push(JSON.parse(JSON.stringify(n))),this.formData.tags.push(o);var i=eu(eu({},a),{},{formSchema:r});this.setState({updateTagform:i},(function(){e.bdModalFormRef.current.updateStateFormData({formData:e.formData})}))}},{key:"onDropTagClick",value:function(e){var t=this,a=this.state.updateTagform,r=a.formSchema,n=r.properties.tags.items.slice();n.splice(e,1),r.properties.tags.items=n,this.formData.tags.splice(e,1);var o=eu(eu({},a),{},{formSchema:r});this.setState({updateTagform:o},(function(){t.bdModalFormRef.current.updateStateFormData({formData:t.formData})}))}},{key:"onChangeUpdateTagForm",value:function(e){var t=e.formData;this.formData=t;var a=this.state.updateTagform,r=document.activeElement,n=xl(r);if(n&&n.endsWith("_tag_id")){var o=this.props.tagsInfo.tagValuesByID,i=n.split("_tag_id")[0].split("_").pop(),s=a.formSchema,c=f.a.deepClone(s),l=o[f.a.fetchSafeFromObject({path:["tags",i,"tag_id"],obj:t,default_value:""})];c.properties.tags.items.some((function(e,t){if(t===parseInt(i,10))return e.properties.tag_value.suggestions=cu(l),!0})),this.setState({updateTagform:eu(eu({},a),{},{formSchema:c})}),this.bdModalFormRef.current.updateStateFormData({formData:t})}}},{key:"validateForm",value:function(e,t){var a=e.tags;return a&&a.length&&(a.some((function(e){return e.tag_value&&!Fl.tag_value.test(e.tag_value)?(t.tags.addError(er({path:["HostAddValidation","tags","invalid_character"]})),!0):e.tag_id&&!e.tag_value?(t.tags.addError(er({path:["HostAddValidation","tags","value_required"]})),!0):void 0})),Il(a)&&t.tags.addError(er({path:["HostAddValidation","tags","duplicate"]}))),t}},{key:"preProcessUpdateTagData",value:function(e){return{operation:"set_tag",id:this.state.updateTagform.methodActions[0].action,tags:e.tags}}},{key:"closeEditDiskModal",value:function(){return this.bdModalEditDiskChildRef.current.handleClose()}},{key:"prepareModalDiskData",value:function(e){var t=this.props,a=t.disks_selection,r=t.isMaprInstallation,n=f.a.fetchSafeFromObject({path:[e],obj:a,default_value:{}}),o=$l.getDisksDataEditModal({host_id:e,currentDiskSelection:n,isMaprInstallation:r});this.setState({modalDiskData:o})}},{key:"onDiskSelection",value:function(e){var t=e.arrayData;t.map((function(e,t){1===t?e.data.map((function(e){"both"!==e.disabled&&(e.diskSize<150*w.settings.B_to_GB?e.disabled="both":e.diskSize<500*w.settings.B_to_GB&&(e.disabled="right"))})):e.data.map((function(e){e.disabled="none"}))})),this.setState({modalDiskData:t})}},{key:"onModalClose",value:function(e){if("close"!==e){var t=this.props.updateDiskSelection,a=this.bdModalEditDiskChildRef.current,r=f.a.fetchSafeFromObject({path:["props","children"],obj:a,default_value:[]}),n=f.a.fetchSafeFromObject({path:["props","arrayData"],obj:r,default_value:[]});n.some((function(e){var t=e.title,a=void 0===t?"":t,r=e.data;if("Ephemeral"===a)return(void 0===r?[]:r).length}))?t(n):_n({msg:"Failed to set the disk. Ephemeral disk selection should have at least one disk.",variant:"error"})}}},{key:"render",value:function(){var e=this.props.fetchEpicHosts,t=this.state,a=t.modalDiskData,r=t.updateTagform,o=this.getHostsTableSettings(),i=n.a.createElement(Ue.a,{variant:"contained",color:"primary",onClick:this.closeEditDiskModal},"Set Disk"),s=n.a.createElement(Us,{arrayData:a,onMoveItem:this.onDiskSelection});return n.a.createElement(Ia,null,n.a.createElement(sa,o),n.a.createElement(no,{ref:this.bdDialogRef}),n.a.createElement(In,{Title:n.a.createElement(st.a,{variant:"h2"},"Edit Disk Allocation"),name:"edit disk allocation",description:"modal to edit disk allocation",onModalClose:this.onModalClose,ref:this.bdModalEditDiskChildRef,actionButton:i,footerCloseBtn:!0},s),n.a.createElement(Jn,{form_id:"updateTagFormEpic",Title:r.Title,name:pu.name||"",description:pu.description||"",formData:{},form_schema:r.formSchema,callBack:e,success_msg:pu.successMessage||"",failure_msg:pu.failureMessage||"",validate:this.validateForm,preProcessData:this.preProcessUpdateTagData,method_actions:r.methodActions,onChange:this.onChangeUpdateTagForm,ref:this.bdModalFormRef}))}}])&&tu(t.prototype,a),r&&tu(t,r),i}(r.Component);su(yu,"propTypes",{classes:u.a.object.isRequired,controllerHosts:u.a.array,applicableWorkers:u.a.array,fetchEpicHosts:u.a.func,pnodeList:u.a.array,updateDiskSelection:u.a.func,disks_selection:u.a.object,hostsTags:u.a.array,role_name:u.a.string,isMaprInstallation:u.a.bool,isLocalHdfs:u.a.bool,bds_install_workerreboot:u.a.string,configCapabilities:u.a.object,tagsInfo:u.a.object,lock_data:u.a.object});var gu=he()(Ql)(yu),_u=n.a.createElement(Ue.a,{type:"submit",variant:"contained",color:"primary",component:lo.a,to:w.views.tags.url},"Manage Tags");function Su(e){return(Su="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function ku(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function Ou(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?ku(Object(a),!0).forEach((function(t){Au(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):ku(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function Eu(e,t){for(var a=0;a<t.length;a++){var r=t[a];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function ju(e,t,a){return t&&Eu(e.prototype,t),a&&Eu(e,a),e}function Du(e,t){return(Du=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function wu(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=Pu(e);if(t){var n=Pu(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return Cu(this,a)}}function Cu(e,t){return!t||"object"!==Su(t)&&"function"!=typeof t?Tu(e):t}function Tu(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Pu(e){return(Pu=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Au(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}var Ru=er({path:["hostAddTooltipMsg"]}),Nu=$l.getHostFormSchema(),Fu=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Du(e,t)}(a,e);var t=wu(a);function a(e){var r;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,a),Au(Tu(r=t.call(this,e)),"CancelToken",T.a.CancelToken),Au(Tu(r),"source",null),Au(Tu(r),"timeout",null),r.state={submitted:0,formSchema:Nu,disks_selection:{},pnodeList:[],hostsTagsFetched:!1,tagItemSchema:{},tagItemDefaultData:{},tagOptions:[],tagValuesByID:{},applicableWorkers:[]},r.form={formData:{}},r.fetchEpicHosts=r.fetchEpicHosts.bind(Tu(r)),r.fetchPnodeList=r.fetchPnodeList.bind(Tu(r)),r.processDisksData=r.processDisksData.bind(Tu(r)),r.onFormChange=r.onFormChange.bind(Tu(r)),r.onChangeKeyFile=r.onChangeKeyFile.bind(Tu(r)),r.validateForm=r.validateForm.bind(Tu(r)),r.updateDiskSelection=r.updateDiskSelection.bind(Tu(r)),r.fetchHostsTags=r.fetchHostsTags.bind(Tu(r)),r.onAddTagClick=r.onAddTagClick.bind(Tu(r)),r.onDropTagClick=r.onDropTagClick.bind(Tu(r)),r.submitForm=r.submitForm.bind(Tu(r)),r.submitRESTAPI=r.submitRESTAPI.bind(Tu(r)),r.bdFormRef=n.a.createRef(),r}return ju(a,null,[{key:"getMeta",value:function(){return{title:"".concat(w.APP_TITLE.CP," | EPIC Hosts Page"),link:[{rel:"canonical",href:"".concat(w.serverUrl).concat(w.views.hosts.url)}],meta:[{charset:"utf-8"},{name:"description",content:"Epic Hosts"}]}}}]),ju(a,[{key:"componentDidMount",value:function(){this.fetchEpicHosts(),this.fetchPnodeList(),this.fetchHostsTags()}},{key:"componentWillUnmount",value:function(){clearTimeout(this.timeout),this.source&&this.source.cancel("component unmounted")}},{key:"validateForm",value:function(e,t){var a=e.worker_ip,r=e.cred_type,n=e.ssh_cred_type,o=e.tags;if(a){var i=Ml(a),s=$l.isDublicateHost(this.props.epicWorkers,a);i||t.worker_ip.addError(er({path:["HostAddValidation","worker_ip","valid"]})),s&&t.worker_ip.addError(er({path:["HostAddValidation","worker_ip","duplicate"]})),/\s/.test(a)&&t.worker_ip.addError("No space allowed")}else t.worker_ip.addError(er({path:["HostAddValidation","worker_ip","required"]}));return this.props.isAgentBased||("Password Access"===r?n.password||t.ssh_cred_type.password.addError(er({path:["HostAddValidation","password","required"]})):n.ssh_key_data||t.ssh_cred_type.ssh_key_data.addError(er({path:["HostAddValidation","ssh_key_data","required"]}))),o&&o.length&&(o.some((function(e){return e.tag_value&&!Fl.tag_value.test(e.tag_value)?(t.tags.addError(er({path:["HostAddValidation","tags","invalid_character"]})),!0):e.tag_id&&!e.tag_value?(t.tags.addError(er({path:["HostAddValidation","tags","value_required"]})),!0):void 0})),Il(o)&&t.tags.addError(er({path:["HostAddValidation","tags","duplicate"]}))),t}},{key:"onChangeKeyFile",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=this.form.formData,a=e.filesInfo,r=void 0===a?[]:a,n=e.values,o=void 0===n?[]:n,i=f.a.fetchSafeFromObject({path:[0,"content"],obj:r,default_value:""}),s=o[0]||"";t.ssh_cred_type.ssh_key_data=s,this.form.formData=t,this.setState({ssh_key_data:i})}},{key:"onFormChange",value:function(e){var t=e.formData,a=this.state.formSchema,r=document.activeElement,n=xl(r);if(n)if(n.endsWith("_cred_type")){var o=$l.getHostCredentialSchema(t,a,this.onChangeKeyFile);this.form.formData=t,this.setState({formSchema:o})}else if(n.endsWith("_tag_id")){var i=this.state.tagValuesByID;this.form.formData=t;var s=n.split("_tag_id")[0].split("_").pop(),c=f.a.fetchSafeFromObject({path:["tags",s,"tag_id"],obj:t,default_value:""});a.properties.tags.items[s].properties.tag_value.suggestions=i[c]||[],this.setState({formSchema:a})}this.form.formData=t}},{key:"submitRESTAPI",value:function(e,t){var a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],r=this;R({method:w.method.POST,apiurl:w.apiurl.EPICHOST,data:{ip:e,credentials:t,tags:a,purpose:"worker"}}).then((function(){_n({msg:"Successfully added host ".concat(e),variant:"success"})})).catch((function(t){var a=r.state.workerFailed;a--,r.setState({workerFailed:a});var o=f.a.parseAxiosError({error:t}),i=n.a.createElement(ns,{errors:["Failed to add ( ".concat(e," )"),o]});_n({msg:i,variant:"error"})})).then((function(){var e=r.state,t=e.submitted,a=e.workerFailed,n=e.tagItemSchema,o=e.formSchema;if(t--,r.setState({submitted:t}),!t){r.fetchEpicHosts(5e3),a||(r.form.formData={},f.a.isEmptyObject(n)||(o.properties.tags.items=[n],r.setState({formSchema:o})))}}))}},{key:"submitForm",value:function(e){var t=e.formData,a=e.errors,r=this.state.ssh_key_data;if(!a.length){var n=t.worker_ip,o=t.cred_type,i=t.ssh_cred_type,s=t.tags,c=$l.getIpListFromIpRange(n);this.setState({submitted:c.length,workerFailed:0});var l=void 0;this.props.isAgentBased||(l={type:"Password Access"===o?"password_access":"ssh_key_access",password:i.password,ssh_key_data:r,ssh_key_passphrase:i.ssh_key_passphrase});for(var u=s.length?s.filter((function(e){return e.tag_id&&e.tag_value})):[],p=0;p<c.length;p++)this.submitRESTAPI(c[p],l,u)}}},{key:"updateDiskSelection",value:function(e){var t=this.state.disks_selection,a=void 0===t?{}:t;e.length&&e.map((function(e){var t,r=e.data,n=void 0===r?[]:r,o=e.node,i=void 0===o?"":o,s=e.title,c=void 0===s?"":s,l=n.length?n.reduce((function(e,t){return e.push({Name:t.value,SizeBytes:t.diskSize}),e}),[]):[];a[i][(t=c,"Ephemeral"===t?"ephemeral_disks":"Persistent"===t?"persistent_disks":"unselected_disks")]=l})),this.setState({disks_selection:a})}},{key:"processDisksData",value:function(){var e=this,t=this.props.epicWorkers.length&&this.props.epicWorkers.filter((function(e){return"worker"===e.purpose}))||[],a=this.state.disks_selection;t.length&&(t.map((function(t){if(["ready","keys_error","storage_error"].includes(t.state)||Object.keys(t).includes("sysinfo")){var r=t.hostname,n=void 0===r?"":r,o=t.sysinfo,i=(o=void 0===o?{}:o).storage,s=void 0===i?[]:i,c=t._links.self.href,l=void 0===c?"":c;if(!a[l]&&s.length){var u=w.settings.B_to_GB,p=$l.processHostDisks(s,u),d=p.available_disks,f=void 0===d?[]:d,m=p.unselected_disks,h=void 0===m?[]:m,b=$l.makeDefaultDiskSelection(f,e.props.isMaprInstallation),v=b.ephemeral_disks,y=void 0===v?[]:v,g=b.persistent_disks,_=void 0===g?[]:g;a[l]={path:l,hostname:n,ephemeral_disks:y,persistent_disks:_,unselected_disks:h,available_disks:f}}}})),this.setState({disks_selection:a,applicableWorkers:t}))}},{key:"fetchEpicHosts",value:function(e){var t=this,a=this.props.dispatch;this.source=this.CancelToken.source(),a(Q(Ou(Ou({},oe.EPICHOST_DATA),{},{cancelToken:this.source.token,retry:e}))).then((function(){var a=t.props.epicWorkers,r=a.length&&a.filter((function(e){return"worker"===e.purpose}))||[],n=$l.liveUpdateHostsInterval(r);(n||e)&&(t.timeout=setTimeout((function(){t.fetchEpicHosts()}),1e3*(n||30))),t.processDisksData()}))}},{key:"fetchPnodeList",value:function(){var e=this,t=this.props.dispatch;this.source=this.CancelToken.source(),t(Q(Ou(Ou({},oe.PNODE_LIST_DATA),{},{cancelToken:this.source.token}))).then((function(){var t=e.props.pnode_list,a=(t=void 0===t?{}:t).result,r=void 0===a?"":a,n=t.objects,o=void 0===n?[]:n;"Success"===r&&e.setState({pnodeList:o})}))}},{key:"fetchHostsTags",value:function(){var e=this,t=this;(0,this.props.dispatch)(Q(oe.HOSTSTAGS)).then((function(){var a=e.state.formSchema,r=e.props.hostsTags,n=Ll(r),o=Ul(r),i=o.length?o[0].enum[0]:"",s=o.length?Hl(o,i,n):{},c=o.length?{tag_id:"",tag_value:""}:{};a.properties.tags=o.length?{type:"array",title:"Tags",description:Ru.tags("epic"),items:[s],canAdd:!0,addItemTitle:"Tag",onAddClick:t.onAddTagClick,onDropClick:t.onDropTagClick}:{type:"object",help:'Tags must be configured prior to adding them for epic host(s). Click "Manage Tags" above to add tags.'},t.setState({formSchema:a,tagItemSchema:s,tagItemDefaultData:c,tagOptions:o,tagValuesByID:n,hostsTagsFetched:!0})}))}},{key:"onAddTagClick",value:function(){var e=f.a.fetchSafeFromObject({path:["current","state","formData"],obj:this.bdFormRef,default_value:{}}),t=this.state,a=t.formSchema,r=t.tagItemSchema,n=t.tagItemDefaultData;a.properties.tags.items.push(r),e.tags.push(n),this.form.formData=e,this.setState({formSchema:a})}},{key:"onDropTagClick",value:function(e){var t=f.a.fetchSafeFromObject({path:["current","state","formData"],obj:this.bdFormRef,default_value:{}}),a=this.state.formSchema;a.properties.tags.items.splice(e,1),t.tags.splice(e,1),this.form.formData=t,this.setState({formSchema:a})}},{key:"render",value:function(){var e=a.getMeta(),t=this.state,r=t.formSchema,o=t.submitted,i=t.disks_selection,s=void 0===i?{}:i,c=t.pnodeList,l=t.tagItemSchema,u=t.hostsTagsFetched,p=t.tagItemDefaultData,d=t.tagOptions,m=t.tagValuesByID,h=t.applicableWorkers,b=this.props,v=b.stats_data,y=b.page_data,g=b.isAgentBased,_=b.isMaprInstallation,S=b.isLocalHdfs,k=b.configCapabilities,O=b.lock_data,E=b.bds_install_workerreboot,j=b.controllerHosts,D=b.userName,w=b.classes,C=v.session_data,T=(C=void 0===C?{}:C).role_name,P=void 0===T?"":T,A=f.a.fetchSafeFromObject({path:["hosts_tags","_embedded","tags"],obj:y,default_value:[]});return g?(delete r.properties.username,delete r.properties.cred_type,delete r.properties.ssh_cred_type):r.properties.username.default=D,n.a.createElement("div",{className:"K8sHostsAddPage"},n.a.createElement(Al.a,{title:e.title,description:e.description,link:e.link,meta:e.meta}),n.a.createElement(Nt,{title:"EPIC Hosts Installation",subComponent:_u}),g?n.a.createElement(st.a,{variant:"caption",className:w.agentBasedTextWarn},"Please install the agent (refer User Guide) before adding a worker."):"",D?n.a.createElement(En,{form_schema:r,formData:this.form.formData,form_id:"epichost-add",submitter:this.submitForm,onChange:this.onFormChange,validate:0===o?this.validateForm:null,nodeRef:this.bdFormRef}):n.a.createElement(st.a,{variant:"caption"},"...loading"),n.a.createElement(Nt,{title:"Worker(s) Status",variant:"secondary"}),n.a.createElement(gu,{controllerHosts:j,applicableWorkers:h,pnodeList:c,disks_selection:s,configCapabilities:k,tagsInfo:{hostsTagsFetched:u,tagItemSchema:l,tagItemDefaultData:p,tagOptions:d,tagValuesByID:m},hostsTags:A,fetchEpicHosts:this.fetchEpicHosts,updateDiskSelection:this.updateDiskSelection,role_name:P,isMaprInstallation:_,isLocalHdfs:S,lock_data:O,bds_install_workerreboot:E,page:"epic_host_page"}))}}]),a}(r.Component);Au(Fu,"propTypes",{classes:u.a.object.isRequired,dispatch:u.a.func.isRequired,page_data:u.a.object,stats_data:u.a.object,pnode_list:u.a.object,epicWorkers:u.a.array,controllerHosts:u.a.array,isAgentBased:u.a.bool,isMaprInstallation:u.a.bool,isLocalHdfs:u.a.bool,userName:u.a.string,configCapabilities:u.a.object,hostsTags:u.a.array,lock_data:u.a.object,bds_install_workerreboot:u.a.string});var xu=d()(he()((function(e){return{agentBasedTextWarn:{color:e.palette.warning.dark,paddingBottom:.6*e.spacing.unit}}}),{name:"HostsPage"}),Object(s.b)((function(e){var t=e.stats_data,a=void 0===t?{}:t,r=e.page_data,n=void 0===r?{}:r,o=f.a.fetchSafeFromObject({path:["epichost_list","_embedded","workers"],obj:n,default_value:[]}),i=o.filter((function(e){return"primary"===e.purpose})),s=f.a.fetchSafeFromObject({path:["hosts_tags","_embedded","tags"],obj:n,default_value:[]}),c=f.a.fetchSafeFromObject({path:["pnode_list"],obj:n,default_value:{}}),l=f.a.fetchSafeFromObject({path:["g_config_data_v1","objects","bdshared_install_agent"],obj:a,default_value:""}),u="true"===l,p="mapr"===f.a.fetchSafeFromObject({path:["g_install","bdshared_storage_localfstype"],obj:a,default_value:!1}),d="hdfs"===l,m=f.a.fetchSafeFromObject({path:["lock_data"],obj:a,default_value:{}}),h=f.a.fetchSafeFromObject({path:["g_config_data_v1","objects","bds_install_workerreboot"],obj:a,default_value:""}),b=f.a.fetchSafeFromObject({path:["g_config_data","_embedded","tenant_types"],obj:a,default_value:{}}),v=f.a.fetchSafeFromObject({path:["_embedded","docker","_embedded","capabilities"],obj:b,default_value:{}});return{stats_data:a,page_data:n,epicWorkers:o,controllerHosts:i,isAgentBased:u,userName:f.a.fetchSafeFromObject({path:["g_config_data_v1","objects","bds_global_user"],obj:a,default_value:""}),isMaprInstallation:p,isLocalHdfs:d,pnode_list:c,configCapabilities:v,hostsTags:s,lock_data:m,bds_install_workerreboot:h}})))(Fu);function Mu(e){return(Mu="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Iu(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function Uu(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?Iu(Object(a),!0).forEach((function(t){zu(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):Iu(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function Lu(e,t){for(var a=0;a<t.length;a++){var r=t[a];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Bu(e,t,a){return t&&Lu(e.prototype,t),a&&Lu(e,a),e}function Hu(e,t){return(Hu=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Ku(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=Gu(e);if(t){var n=Gu(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return qu(this,a)}}function qu(e,t){return!t||"object"!==Mu(t)&&"function"!=typeof t?Vu(e):t}function Vu(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Gu(e){return(Gu=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function zu(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}var Wu=er({path:["infosightConfigureTooltipMsg"]}),Ju={type:"object",properties:{collectorEnable:{type:"boolean",title:"Enable InfoSight Collection",description:Wu.collect,bd_required:!0},privacyOverrideAll:{type:"boolean",title:"Enable collection of private data",description:Wu.privacyDiagnostics,bd_required:!0},token:{type:"string",title:"Authentication Token",default:"",description:Wu.token,bd_required:!0,bd_widget:"textarea"}}},Yu=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Hu(e,t)}(a,e);var t=Ku(a);function a(e){var r;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,a),zu(Vu(r=t.call(this,e)),"CancelToken",T.a.CancelToken),zu(Vu(r),"source",null),r.fetchInfoSightConfiguration=r.fetchInfoSightConfiguration.bind(Vu(r)),r.submitRESTAPI=r.submitRESTAPI.bind(Vu(r)),r.submitForm=r.submitForm.bind(Vu(r)),r.validateForm=r.validateForm.bind(Vu(r)),r.onFormChange=r.onFormChange.bind(Vu(r)),r.schemaUpdate=r.schemaUpdate.bind(Vu(r)),r.getInfosightStatus=r.getInfosightStatus.bind(Vu(r)),r.bdFormRef=n.a.createRef(),r.state={formSchema:Ju,collectorEnable:!1},r.form={formData:{}},r.timeout=null,r}return Bu(a,null,[{key:"getMeta",value:function(){return{title:"".concat(w.APP_TITLE.CP," | InfoSight"),link:[{rel:"canonical",href:"".concat(w.serverUrl).concat(w.views.infosight.url)}],meta:[{charset:"utf-8"},{name:"description",content:"InfoSight"}]}}}]),Bu(a,[{key:"schemaUpdate",value:function(e,t,a){return a?(e.properties.token.bd_disabled=!0,e.properties.privacyOverrideAll.bd_disabled=!0,e.properties.collectorEnable.bd_disabled=!0):t?(e.properties.collectorEnable.bd_disabled=!1,e.properties.token.bd_disabled=!1,e.properties.privacyOverrideAll.bd_disabled=!1):(e.properties.collectorEnable.bd_disabled=!1,e.properties.token.bd_disabled=!0,e.properties.privacyOverrideAll.bd_disabled=!0),e}},{key:"componentDidMount",value:function(){this.fetchInfoSightConfiguration(!1)}},{key:"componentWillUnmount",value:function(){this.source&&this.source.cancel("component unmounted"),this.timeout&&clearTimeout(this.timeout)}},{key:"fetchInfoSightConfiguration",value:function(){var e=this,t=this.props.dispatch,a=this.state,r=a.formSchema,n=a.collectorEnable;this.source=this.CancelToken.source(),t(I({apiUrl:w.apiurl.CONFIG_V2,propVal:"g_config_data",cancelToken:this.source.token})).then((function(){var t=e.props.infosight_data,a=e.schemaUpdate(f.a.deepClone(r),t.configured,t.updating);t.updating?e.timeout=setTimeout((function(){e.fetchInfoSightConfiguration()}),5e3):(e.form.formData=Uu(Uu({},e.form.formData),{},{collectorEnable:t.configured,privacyOverrideAll:t["privacy-overrides"].all,token:t.configured?e.form.formData.token:""}),n=t.configured),e.setState({formSchema:a,collectorEnable:n})}))}},{key:"validateForm",value:function(e,t){var a=this.state.collectorEnable;return e.collectorEnable&&!1===a&&!e.token&&t.token.addError(er({path:["infosightConfigureValidation","noToken"]})),t}},{key:"onFormChange",value:function(e){var t,a=e.formData,r=this.props.infosight_data,n=this.state.formSchema,o={},i=document.activeElement,s=xl(i);s&&(s.endsWith("collectorEnable")&&(t=this.schemaUpdate(f.a.deepClone(n),a.collectorEnable,r.updating),o.formSchema=t),this.form.formData=a),Object.keys(o).length&&this.setState(o)}},{key:"submitRESTAPI",value:function(e,t,a){var r=this,o=e?[{op:"add",path:"/infosight",value:{"privacy-overrides":t,"claim-token":a,configured:e}}]:[{op:"remove",path:"/infosight"}];R({method:w.method.PATCH,apiurl:w.apiurl.CONFIG_V2,data:o}).then((function(){_n({msg:"Successfully updated InfoSight configuration",variant:"success"}),r.fetchInfoSightConfiguration()})).catch((function(e){var t=f.a.parseAxiosError({error:e});_n({msg:n.a.createElement(ns,{errors:["Failed to update InfoSight configuration",t]}),variant:"error"}),r.fetchInfoSightConfiguration()}))}},{key:"submitForm",value:function(e){var t=e.formData;if(!e.errors.length){var a=t.collectorEnable,r=t.privacyOverrideAll,n=t.token,o={all:r};this.form.formData=t,this.submitRESTAPI(a,o,n)}}},{key:"getInfosightStatus",value:function(e,t,a){return e?{collectionStatus:"updating",label:"Applying configuration updates ..."}:"failure"===a?{collectionStatus:"error",label:"Configuration failed"}:t?{collectionStatus:"ready",label:"Collection enabled"}:{collectionStatus:"disabled",label:"Collection disabled"}}},{key:"render",value:function(){var e=a.getMeta(),t=this.state.formSchema,o=this.props,i=o.classes,s=o.infosight_data,c=o.userName,l=this.getInfosightStatus(s.updating,s.configured,s["last-status"]),u=l.collectionStatus,p=l.label;return n.a.createElement("div",{className:"InfoSightConfiguration"},n.a.createElement(Al.a,{title:e.title,description:e.description,link:e.link,meta:e.meta}),n.a.createElement(Nt,{title:"InfoSight Configuration"}),c?n.a.createElement(r.Fragment,null,n.a.createElement("div",null,n.a.createElement("div",{className:i.statusLabelReverse},n.a.createElement(Qa,{classes:{statusLabel:i.collectingStatusDisplayed},status:u,title:f.a.capitalize(p)})),n.a.createElement(En,{form_schema:t,formData:this.form.formData,form_id:"infosight-update",submitter:this.submitForm,onChange:this.onFormChange,validate:this.validateForm,nodeRef:this.bdFormRef}))):n.a.createElement(st.a,{variant:"caption"},"Loading ..."))}}]),a}(r.Component);zu(Yu,"propTypes",{classes:u.a.object.isRequired,dispatch:u.a.func.isRequired,infosight_data:u.a.object,userName:u.a.string});var $u=d()(he()((function(){return{collectingStatusDisplayed:{display:"flex","flex-flow":"row-reverse",justifyContent:"start",width:"100%","max-width":"900px"}}}),{name:"InfoSightPage"}),Object(s.b)((function(e){var t=e.stats_data,a=void 0===t?{}:t;return{infosight_data:f.a.fetchSafeFromObject({path:["g_config_data","infosight"],obj:a,default_value:{}}),userName:f.a.fetchSafeFromObject({path:["g_config_data_v1","objects","bds_global_user"],obj:a,default_value:""})}})))(Yu);function Qu(e){return(Qu="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Zu(e,t){for(var a=0;a<t.length;a++){var r=t[a];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Xu(e,t,a){return t&&Zu(e.prototype,t),a&&Zu(e,a),e}function ep(e,t){return(ep=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function tp(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=np(e);if(t){var n=np(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return ap(this,a)}}function ap(e,t){return!t||"object"!==Qu(t)&&"function"!=typeof t?rp(e):t}function rp(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function np(e){return(np=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var op=function(e){var t=e.name,a=void 0===t?"":t,r=e.description;return{label:{name:a,description:void 0===r?"":r}}},ip={type:"object",properties:{name:{type:"string",title:"Tag Name",description:"Please enter name for tag",bd_required:!0},description:{type:"string",title:"Tag Description",description:"Please enter description for tag",bd_widget:"textarea"}}},sp={name:{"ui:autofocus":!0}},cp=er({path:["hostsTags"]}),lp=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&ep(e,t)}(a,e);var t=tp(a);function a(e){var r;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,a),(r=t.call(this,e)).state={formSchema:ip,hostsTagsFetched:!1,method_actions:[{method:w.method.POST,action:w.apiurl.HOST_TAGS,data:"FORM_DATA"}]},r.form={formData:{}},r.fetchHostsTags=r.fetchHostsTags.bind(rp(r)),r.deleteHostTag=r.deleteHostTag.bind(rp(r)),r.addTags=r.addTags.bind(rp(r)),r.deleteTagsList=r.deleteTagsList.bind(rp(r)),r.validateTagForm=r.validateTagForm.bind(rp(r)),r.isTagDuplicate=r.isTagDuplicate.bind(rp(r)),r.callBack=r.callBack.bind(rp(r)),r.bdDialogTagRef=n.a.createRef(),r.bdModalAddTagsChildRef=n.a.createRef(),r}return Xu(a,null,[{key:"getMeta",value:function(){return{title:"".concat(w.APP_TITLE.CP," | Host Tags"),link:[{rel:"canonical",href:"".concat(w.serverUrl).concat(w.views.tags.url)}],meta:[{charset:"utf-8"},{name:"description",content:"Manage Host Tags"}]}}}]),Xu(a,[{key:"componentDidMount",value:function(){this.fetchHostsTags()}},{key:"fetchHostsTags",value:function(){var e=this;(0,this.props.dispatch)(Q(oe.HOSTSTAGS)).then((function(){e.setState({hostsTagsFetched:!0})}))}},{key:"addTags",value:function(){this.bdModalAddTagsChildRef.current.openModal()}},{key:"deleteTagsList",value:function(e){var t=this,a=e.selected_rows,r=e.hostsTags;a.data.map((function(e){var a=e.dataIndex,n=r[a],o=f.a.fetchSafeFromObject({path:["_links","self","href"],obj:n,default_value:{}}),i=f.a.fetchSafeFromObject({path:["label","name"],obj:n,default_value:{}});t.deleteHostTag({tagId:o,name:i})}))}},{key:"deleteHostTag",value:function(e){var t=e.tagId,a=e.name,r=this;R({apiurl:t,method:w.method.DELETE}).then((function(){_n({msg:"Tag ( ".concat(a," ) successfully deleted"),variant:"success"}),r.fetchHostsTags()})).catch((function(e){var t=f.a.parseAxiosError({error:e}),r=n.a.createElement(ns,{errors:["Failed to delete the tag ( ".concat(a," )"),t]});_n({msg:r,variant:"error"})}))}},{key:"callBack",value:function(e){"success"===e.variant&&this.fetchHostsTags()}},{key:"getTagsTableSettings",value:function(){var e=this,t=this.props,a=t.hostsTags,r=t.classes;return{columns:[{name:"Tag Name",options:{filter:!0,sortDirection:"asc"}},{name:"Tag Description",options:{filter:!0}},{name:"Tag Values",options:{filter:!0}},{name:"Action",options:{filter:!1,sort:!1,customBodyRender:function(t){var a=JSON.parse(t),r=a.name,o=a.tagId;return n.a.createElement("div",{className:"row-action-btns"},o?n.a.createElement(ka,{title:"Delete Tag",variant:"error"},n.a.createElement("span",{className:se()("icon","icon-rect-link","icon-trash2"),onClick:function(){var t={callback:e.deleteHostTag,context:{tagId:o,name:r},title:"Delete tag (".concat(r,")."),description:cp.delete_description};e.bdDialogTagRef.current.handleOpen(t)}})):"")}}}],data:this.state.hostsTagsFetched&&a.reduce((function(e,t){var a=t.label,r=void 0===a?{}:a,n=t.values,o=void 0===n?[]:n,i=r.name,s=void 0===i?"":i,c=r.description,l=void 0===c?"":c,u=f.a.fetchSafeFromObject({path:["_links","self","href"],obj:t,default_value:""});return e.push([s,l,o.join(", "),JSON.stringify({name:s,tagId:u})]),e}),[]),options:{customToolbar:function(){return n.a.createElement("div",{className:"tableActionButtons"},n.a.createElement(Ue.a,{variant:"contained",color:"primary",className:r.mRight,onClick:e.addTags},"Add"))},customToolbarSelect:function(t){return n.a.createElement("div",{className:"tableActionButtonsSelected"},n.a.createElement(Ue.a,{variant:"contained",color:"secondary",onClick:function(){var r={callback:e.deleteTagsList,context:{selected_rows:t,hostsTags:a},title:"Delete selected tags(s)",description:cp.delete_description};e.bdDialogTagRef.current.handleOpen(r)}},"Delete"))}}}}},{key:"isTagDuplicate",value:function(e){var t=e.name,a=this.props.hostsTags;return a.length&&a.some((function(e){var a=e.label,r=(a=void 0===a?{}:a).name;return t===(void 0===r?"":r)}))}},{key:"validateTagForm",value:function(e,t){var a=e.name,r=e.description;return this.isTagDuplicate({name:a})&&t.name.addError(cp.isDuplicateTag),a||t.name.addError(cp.nameRequired),a&&a.length>20&&t.name.addError(cp.maxLengthName(20)),r&&r.length>72&&t.description.addError(cp.maxLengthDesc(72)),t}},{key:"render",value:function(){var e=a.getMeta(),t=this.state,r=t.hostsTagsFetched,o=t.formSchema,i=t.method_actions,s=this.getTagsTableSettings();return n.a.createElement("div",{className:"ManageTagsPage"},n.a.createElement(Al.a,{title:e.title,description:e.description,link:e.link,meta:e.meta}),n.a.createElement(Nt,{title:"Manage Tags"}),r?n.a.createElement(sa,s):n.a.createElement(ls,null),n.a.createElement(no,{ref:this.bdDialogTagRef}),n.a.createElement(Jn,{form_id:"addHostsTagsForm",Title:n.a.createElement(st.a,{variant:"h2"},"Create Tag"),name:"create host tags",description:"modal to create tags for hosts",form_schema:o,ui_schema:sp,method_actions:i,success_msg:cp.success_msg,failure_msg:cp.failure_msg,callBack:this.callBack,preProcessData:op,validate:this.validateTagForm,modalFormSubmitter:this.modalFormSubmitter,ref:this.bdModalAddTagsChildRef}))}}]),a}(r.Component);!function(e,t,a){t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a}(lp,"propTypes",{classes:u.a.object.isRequired,dispatch:u.a.func.isRequired,page_data:u.a.object,stats_data:u.a.object,hostsTags:u.a.array});var up=d()(he()((function(e){return{mRight:{marginRight:.5*e.spacing.unit}}}),{name:"ManageTagsPage"}),Object(s.b)((function(e){var t=e.stats_data,a=void 0===t?{}:t,r=e.page_data,n=void 0===r?{}:r;return{stats_data:a,page_data:n,hostsTags:f.a.fetchSafeFromObject({path:["hosts_tags","_embedded","tags"],obj:n,default_value:[]})}})))(lp),pp=a(153),dp=a.n(pp);function fp(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function mp(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?fp(Object(a),!0).forEach((function(t){hp(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):fp(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function hp(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}var bp=w.settings,vp=function(e){var t=[{id:"cores",label:"Cores",convert_gb:!1,usage_support:!0,unit:""},{id:"memory",label:"Memory",convert_gb:bp.MB_to_GB,usage_support:!0,unit:"GB"},{id:"disk",label:"Node Storage",convert_gb:bp.MB_to_GB,usage_support:!0,unit:"GB"}];return f.a.fetchSafeFromObject({path:["gpu_usage_supported"],obj:e,default_value:!1})&&t.push({id:"gpus",label:"GPU Devices",convert_gb:!1,usage_support:!0,unit:""}),f.a.fetchSafeFromObject({path:["persistent_supported"],obj:e,default_value:!1})&&t.push({id:"persistent",label:"Persistent Storage",convert_gb:bp.MB_to_GB,usage_support:!0,unit:"GB"}),f.a.fetchSafeFromObject({path:["tenant_storage_quota_supported"],obj:e,default_value:!1})&&t.push({id:"tenant_storage",label:"Tenant Storage Quota",convert_gb:!1,usage_support:!1,unit:"GB"}),t},yp=function(e){return{monitoring:{marginTop:"2rem",position:"relative"},pageSubtitle:{fontFamily:e.typography.fontFamilyLight,margin:"2rem 0 0",position:"relative"},chartContainer:{marginTop:"1rem"},chartSelectors:{display:"flex",justifyContent:"flex-end"},selectWrapper:{margin:e.spacing.unit,"&:first-child":{marginLeft:0},"&:last-child":{marginRight:0}},select:{minWidth:120,color:e.palette.gray700,fontWeight:300,fontSize:e.typography.fontSize,textAlign:"left",position:"relative"},chartTitle:{fontFamily:e.typography.fontFamilyLight},contentTitle:{marginBottom:3*e.spacing.unit,fontFamily:e.typography.fontFamilyLight},well:{background:e.palette.gray100,boxShadow:"none"},selectMenuList:{border:e.border,transformOrigin:"0 !important",transform:"scale(1, 1) translateZ(0px) translateY(40px) !important"},switchKubeDirector:{position:"absolute",top:4*-e.spacing.unit},list:{width:"100%",justifyContent:"flex-start",display:"flex"},nowrap:{whiteSpace:"nowrap"},refreshActionWrapper:{display:"flex",justifyContent:"flex-end",alignItems:"center"},padRight:{paddingRight:e.spacing.unit},txtBtn:{cursor:"pointer",fontFamily:e.typography.fontFamilySemiBold}}};function gp(e){return(gp="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function _p(){return(_p=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var r in a)Object.prototype.hasOwnProperty.call(a,r)&&(e[r]=a[r])}return e}).apply(this,arguments)}function Sp(e,t){for(var a=0;a<t.length;a++){var r=t[a];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function kp(e,t){return(kp=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Op(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=jp(e);if(t){var n=jp(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return Ep(this,a)}}function Ep(e,t){return!t||"object"!==gp(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function jp(e){return(jp=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var Dp=er({path:["dashboardTooltipMsg","resourceAllocation"]}),wp=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&kp(e,t)}(i,e);var t,a,r,o=Op(i);function i(e){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),o.call(this,e)}return t=i,(a=[{key:"render",value:function(){var e=this.props,t=e.tenant_data,a=e.available_resources,r=e.classes,o=e.title,i=function(e,t){var a=vp(e),r=f.a.getColorList(a.length),n=[];return a.map((function(a,o){var i=f.a.fetchSafeFromObject({path:["quota",a.id],obj:e,default_value:t[a.id]||0}),s=f.a.fetchSafeFromObject({path:["inusequota",a.id],obj:e,default_value:0});n.push(mp(mp({},a),{},{title:"".concat(a.label," Used"),color:r[o],total:i,used:s}))})),n}(t,a);return n.a.createElement("div",null,o?n.a.createElement("div",{style:{display:"flex"}},n.a.createElement(st.a,{variant:"h2",className:r.chartTitle},o," "),n.a.createElement("span",{style:{paddingLeft:"4px"}},n.a.createElement(lr,{title:Dp,placement:"right"}))):"",n.a.createElement(dp.a,{className:r.list},i.map((function(e){return n.a.createElement(Wt,_p({key:e.title},e))}))))}}])&&Sp(t.prototype,a),r&&Sp(t,r),i}(r.Component);!function(e,t,a){t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a}(wp,"propTypes",{classes:u.a.object,tenant_data:u.a.object,available_resources:u.a.object,title:u.a.string});var Cp=he()(yp)(wp);function Tp(e){return(Tp="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Pp(e,t){for(var a=0;a<t.length;a++){var r=t[a];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Ap(e,t){return(Ap=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Rp(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=xp(e);if(t){var n=xp(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return Np(this,a)}}function Np(e,t){return!t||"object"!==Tp(t)&&"function"!=typeof t?Fp(e):t}function Fp(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function xp(e){return(xp=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Mp(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function Ip(e){return n.a.createElement("div",{style:{padding:24}},e.children)}Ip.propTypes={children:u.a.node.isRequired};var Up=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Ap(e,t)}(i,e);var t,a,r,o=Rp(i);function i(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),Mp(Fp(t=o.call(this,e)),"handleChange",(function(e,a){t.setState({value:a})})),t.state={value:0},t}return t=i,(a=[{key:"render",value:function(){var e=this.state.value;return n.a.createElement("div",null,n.a.createElement(io.a,{value:e,onChange:this.handleChange,indicatorColor:"primary",textColor:"primary",className:"bdsTabs"},n.a.createElement(co.a,{label:"Usage"}),n.a.createElement(co.a,{label:"Load"}),n.a.createElement(co.a,{label:"Services"}),n.a.createElement(co.a,{label:"Alerts"})),0===e&&n.a.createElement(Ip,null,"Tenant Resources comes here"),1===e&&n.a.createElement(Ip,null,"Load Contents"),2===e&&n.a.createElement(Ip,null,"Services Contents"),3===e&&n.a.createElement(Ip,null,"Alerts Contents"))}}])&&Pp(t.prototype,a),r&&Pp(t,r),i}(r.Component);Mp(Up,"propTypes",{classes:u.a.object,tenant_list:u.a.object});var Lp=he()((function(){return{}}))(Up),Bp=a(54),Hp=a.n(Bp),Kp=a(55),qp=a.n(Kp),Vp=a(158),Gp=a.n(Vp),zp=function(e){var t=[],a=0;for(var r in e){var n=e[r];n&&(a+=n.yMax,t.push(n))}return{series:t,max:1.15*a}},Wp=function(e,t){if(["system_cpu","cpu","system_load","gpu","mem_usage_node_pct","mem_usage_limit_pct","cpu_usage_node_pct_per_pod","cpu_pod_usage_limit_pct"].includes(t))return e.toFixed(2)+"%";var a=Math.abs(e);return a>=0x4000000000000?(e/0x4000000000000).toFixed(2)+"P":a>=1099511627776?(e/1099511627776).toFixed(2)+"T":a>=1073741824?(e/1073741824).toFixed(2)+"G":a>=1048576?(e/1048576).toFixed(2)+"M":a>=1024?(e/1024).toFixed(2)+"K":a<1&&e>0?e.toFixed(2):0===a?0:e.toFixed(2)},Jp=a(708),Yp=a.n(Jp);function $p(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function Qp(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?$p(Object(a),!0).forEach((function(t){Zp(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):$p(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function Zp(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function Xp(e){return function(e){if(Array.isArray(e))return ed(e)}(e)||function(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||function(e,t){if(!e)return;if("string"==typeof e)return ed(e,t);var a=Object.prototype.toString.call(e).slice(8,-1);"Object"===a&&e.constructor&&(a=e.constructor.name);if("Map"===a||"Set"===a)return Array.from(e);if("Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a))return ed(e,t)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function ed(e,t){(null==t||t>e.length)&&(t=e.length);for(var a=0,r=new Array(t);a<t;a++)r[a]=e[a];return r}var td=["network_in","network_out","disk_write","disk_overlay_write_bytes","system_network_in","system_network_out","network_tx_pod_bytes","network_rx_pod_bytes"],ad=["cpu","system_cpu","mem_usage_node_pct","mem_usage_limit_pct","cpu_usage_node_pct_per_pod","cpu_pod_usage_limit_pct"],rd=function(e){var t=e.timeRangeParams,a=[],r=e.selectors.map((function(e){return{query_string:{fields:[e.field],query:e.value,analyze_wildcard:"*"===e.value}}}));a.push({query_string:{fields:["metricset.module"],query:"kubernetes",analyze_wildcard:!1}}),a.push.apply(a,Xp(r));var n={range:{"@timestamp":{gte:t.gte,lte:t.lte,format:"epoch_millis"}}};return a.push(n),a},nd=function(e){var t,a,r=(new Date).getTime();switch(e){case"hour":t=r-36e5,a="2m";break;case"6hr":t=r-216e5,a="10m";break;case"day":t=r-864e5,a="30m";break;case"week":t=r-6048e5,a="6h"}return{gte:t,lte:r,interval:a}},od=function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],a=Yp.a.determine(),r={field:"@timestamp",interval:e.interval,time_zone:a.name()};if(!t){var n={min:e.gte,max:e.lte};r.min_doc_count=0,r.extended_bounds=n}return r},id=function(e,t,a,r,n,o,i,s){var c,l=f.a.fetchSafeFromObject({path:[r,"buckets"],obj:e,default_value:[]}),u=0;l.forEach((function(e){c=i.find((function(t){return f.a.fetchSafeFromObject({path:["metrics",a,o],obj:t,default_value:""})===e.key})),u=f.a.fetchSafeFromObject({path:[n,"value"],obj:e,default_value:u});var r=c.fqdn;s[r].yMax=Math.max(s[r].yMax,u),s[r].data[t].y=u}))},sd=function(e){var t=e.raw_data,a=e.device_agg_selector,r=e.selected_objs,n=e.id,o=f.a.fetchSafeFromObject({path:["aggregations","MetricSet","buckets"],obj:t,default_value:[]}),i={};return"disk_write"===n||"disk_overlay_write_bytes"===n?function(e){var t=e.raw_data,a=e.selected_objs,r=e.device_agg_selector,n=f.a.fetchSafeFromObject({path:["aggregations","MetricSet","buckets"],obj:t,default_value:[]}),o={};return n.forEach((function(e,t){var n=e.key,i=f.a.fetchSafeFromObject({path:["Node","buckets"],obj:e,default_value:[]});a.forEach((function(e){var t=e.fqdn;Object.keys(o).includes(t)||(o[t]=Qp(Qp({},e),{},{name:t,data:[],yMax:0})),o[e.fqdn].data.push({x:n/1e3,y:0})})),i.forEach((function(e){e.Device.buckets.length?id(e,t,"disk_write","Device","Metric",r,a,o):e.Device1.buckets.length&&id(e,t,"disk_overlay_write_bytes","Device1","Metric1","docker.container.id",a,o)}))})),o}({raw_data:t,selected_objs:r,device_agg_selector:a}):(o.forEach((function(e,t){var o=e.key,s=f.a.fetchSafeFromObject({path:["Node","buckets"],obj:e,default_value:[]});r.forEach((function(e){var t=e.fqdn;Object.keys(i).includes(t)||(i[t]=Qp(Qp({},e),{},{name:t,data:[],yMax:0})),i[e.fqdn].data.push({x:o/1e3,y:0})})),s.forEach((function(e){var o,s,c;e.Device?f.a.fetchSafeFromObject({path:["Device","buckets"],obj:e,default_value:[]}).forEach((function(e){o=r.find((function(t){return t.metrics[n][a]===e.key})),s=e})):(o=r.find((function(t){return t.name===e.key})),s=e);var l=o.fqdn;c=Object.keys(s.Metric).includes("value")?s.Metric.value:s.Metric.values[0].value||0,i[l].yMax=Math.max(i[l].yMax,c),i[l].data[t].y=c}))})),i)},cd=function(e){var t=e.type,a=e.raw_data,r=e.selected_objs,n=e.id,o=function(e){return["gpu","gpu_memory_util","gpu_temperature"].includes(n)?e.value:1024*e.value*1024},i=f.a.fetchSafeFromObject({path:["aggregations","MetricSet","buckets"],obj:a,default_value:[]}),s={},c=1===r.length;return"system_chart"===t?i.forEach((function(e,t){var a=e.key,i=f.a.fetchSafeFromObject({path:["Host","buckets"],obj:e,default_value:[]});r.forEach((function(e){var t=e.hostname,r=void 0===t?"":t,n=e.gpu_count,o=void 0===n?0:n;if(c&&o)for(var i=f.a.getColorList(o,e.color),l=0;l<o;l++){var u="".concat(r,"-").concat(l);Object.keys(s).includes(u)||(s[u]=Qp(Qp({},e),{},{name:u,data:[],color:i[l],yMax:0})),s[u].data.push({x:a/1e3,y:0})}else Object.keys(s).includes(r)||(s[r]=Qp(Qp({},e),{},{name:"".concat(r," (agg)"),data:[],yMax:0})),s[r].data.push({x:a/1e3,y:0})})),i.forEach((function(e){var a=r.find((function(t){return t.hostname===e.key})),i=a.hostname,l=a.gpu_count;if(c&&l){f.a.fetchSafeFromObject({path:["GPU","buckets"],obj:e,default_value:[]}).forEach((function(e){var a=e.key,r="".concat(i,"-").concat(a),n=o(f.a.fetchSafeFromObject({path:["GPU_Metric"],obj:e,default_value:0}));s[r].yMax=Math.max(s[r].yMax,n),s[r].data[t].y=n}))}else{var u="gpu_temperature"===n?"Avg_GPU_Metric":"Sum_GPU_Metric",p=o(f.a.fetchSafeFromObject({path:[u],obj:e,default_value:0}));s[i].yMax=Math.max(s[i].yMax,p),s[i].data[t].y=p}}))})):i.forEach((function(e,t){var a=e.key,i=f.a.fetchSafeFromObject({path:["Node","buckets"],obj:e,default_value:[]});r.forEach((function(e){var t=e.fqdn,r=e.gpus;if(c&&r)for(var n=f.a.getColorList(r,e.color),o=0;o<r;o++){var i="".concat(t,"-").concat(o);Object.keys(s).includes(i)||(s[i]=Qp(Qp({},e),{},{name:i,data:[],color:n[o],yMax:0})),s[i].data.push({x:a/1e3,y:0})}else Object.keys(s).includes(t)||(s[t]=Qp(Qp({},e),{},{name:"".concat(t," (agg)"),data:[],yMax:0})),s[t].data.push({x:a/1e3,y:0})})),i.forEach((function(e){var a=r.find((function(t){return t.name===e.key})),i=a.fqdn,l=a.gpus;if(c&&l){f.a.fetchSafeFromObject({path:["Link","buckets"],obj:e,default_value:[]}).forEach((function(e){var a=e.key.match(/\d+$/),r="".concat(i,"-").concat(a),n=o(f.a.fetchSafeFromObject({path:["Avg_GPU_Metric"],obj:e,default_value:0}));s[r].yMax=Math.max(s[r].yMax,n),s[r].data[t].y=n}))}else{var u="gpu_temperature"===n?"Avg_Node_GPU_Metric":"Sum_Node_GPU_Metric",p=o(f.a.fetchSafeFromObject({path:[u],obj:e,default_value:0}));s[i].yMax=Math.max(s[i].yMax,p),s[i].data[t].y=p}}))})),s},ld=function(e){var t=e.raw_data,a=e.selected_objs,r=e.agg_type,n=f.a.fetchSafeFromObject({path:["aggregations","MetricSet","buckets"],obj:t,default_value:[]}),o={},i=new Set;(n.forEach((function(e,t){var n=e.key;if("total_avg"===r){var s="All Hosts Average",c=a[0].color;0===Object.keys(o).length&&(o[s]={name:s,data:[],yMax:0,color:c});var l=0;l=Object.keys(e.Metric).includes("value")?e.Metric.value:e.Metric.values[0].value||0,o[s].yMax=Math.max(o[s].yMax,l),o[s].data.push({x:n/1e3,y:l})}else{var u=f.a.fetchSafeFromObject({path:["Node","buckets"],obj:e,default_value:[]});a.forEach((function(e){var t=e.hostname;Object.keys(o).includes(t)||(o[t]=Qp(Qp({},e),{},{name:t,data:[],yMax:0})),o[t].data.push({x:n/1e3,y:0})})),u.forEach((function(e){var a=0,r=e.key;i.add(r),a=Object.keys(e.Metric).includes("value")?e.Metric.value:e.Metric.values[0].value||0,o[r].yMax=Math.max(o[r].yMax,a),o[r].data[t].y=a}))}})),"total_avg"!==r)&&Object.keys(o).forEach((function(e){i.has(e)||delete o[e]}));return o},ud=function(e){var t=e.applicable_metrics,a=void 0===t?[]:t,r=e.kubedirector,n=void 0!==r&&r,o=e.k8sTenants,i=void 0===o?[]:o,s=e.selection,c=void 0===s?{}:s,l={},u=[],p={},d="",f="",m="",h=i.map((function(e){return e.namespace})),b=c.pod,v=void 0===b?"*":b,y=c.agg_type,g=void 0===y?"total_avg":y;a.forEach((function(e,t){var a=e.selectors,r=void 0===a?[]:a,o=e.namespace_agg_selector,i=e.kubedirector_agg_selector,s=void 0===i?"kubernetes.labels.kubedirector_hpe_com/kdcluster":i,c=e.pod_agg_selector,b=e.id,y=e.value_field,g=e.label.name,_=void 0===g?"":g;0===t&&(d=o,f=c,n&&(m=s),r.forEach((function(e){"kubernetes.namespace"===e.field?u.push({field:e.field,value:h.join(" OR ")}):u.push(e)})),"*"!==v&&u.push({field:f,value:v})),l[b]={avg:{field:y}},p[b]=_}));var _={};if(!["total_avg_all_tenants","total_avg","pod"].includes(g)){var S="";switch(g){case"top_cpu_nanocores_pods":S="kubernetes.pod.cpu.usage.nanocores";break;case"top_cpu_limit_pods":S="kubernetes.pod.cpu.usage.limit.pct";break;case"top_memory_usage_pods":S="kubernetes.pod.memory.usage.byte";break;case"top_memory_limit_pods":S="kubernetes.pod.memory.usage.limit.pct"}_={sort_field:{avg:{field:S}},bucket_sort_by:{bucket_sort:{sort:[{sort_field:{order:"desc"}}],size:10}}}}var k={Pod:{terms:{field:f,size:1e4,order:{_key:"desc"}},aggs:Qp(Qp({},l),_)}};return{selectors:u,aggs:"total_avg_all_tenants"===g?l:{Namespace:{terms:{field:d,size:1e4,order:{_key:"desc"}},aggs:"total_avg"===g?l:n?!!n&&{KubeDirectorCluster:{terms:{field:m,size:1e4,order:{_key:"desc"}},aggs:k}}:k}}}},pd=function(e){var t=f.a.fetchSafeFromObject({path:["aggregations","Pages","buckets"],obj:e,default_value:[]});return{afterKey:f.a.fetchSafeFromObject({path:["aggregations","Pages","after_key"],obj:e,default_value:void 0}),buckets:t}},dd=function(e){var t=f.a.fetchSafeFromObject({path:["responses"],obj:e,default_value:[]});return 0===t.length?[{afterKey:{},buckets:[]}]:t.map((function(e){var t=f.a.fetchSafeFromObject({path:["aggregations","Pages","buckets"],obj:e,default_value:[]});return{afterKey:f.a.fetchSafeFromObject({path:["aggregations","Pages","after_key"],obj:e,default_value:{}}),buckets:t}}))},fd=function(e){var t=e.timeRangeParams,a=e.selectors,r=e.query_params,n=e.id,o=e.agg_type,i=[],s=a.map((function(e){return"".concat(e.field,":").concat(e.value)})).join(" AND ");["top_cpu_hosts","top_memory_hosts"].includes(o)&&(s="".concat(a[0].field,":").concat(a[0].value)),"disk_write"===n&&(s="(".concat(s,") OR (metricset.module:docker AND metricset.name:diskio)"));var c={query_string:{query:s,analyze_wildcard:!0}};if(i.push(c),void 0!==r){var l={query_string:{query:r,analyze_wildcard:!0}};i.push(l)}else n&&f.a.bdLog("Missing query parameter for chart: "+n);i.push({query_string:{query:"*",analyze_wildcard:!0}});var u={range:{"@timestamp":{gte:t.gte,lte:t.lte,format:"epoch_millis"}}};return i.push(u),i},md=function(e){var t=e.id,a=e.selected_objs,r=e.type,n={},o="system_chart"===r;return"cluster_chart"!==r||"disk_write"!==t&&"disk_overlay_write_bytes"!==t?(a.forEach((function(e){if(o)n.hostname||(n.hostname=[]),n.hostname.push(e.hostname);else{var a=t.includes("gpu")?"gpu":t,r=e.metrics[a];r&&Object.keys(r).forEach((function(e){n[e]||(n[e]=[]),n[e].includes(r[e])||n[e].push(r[e])}))}})),Object.keys(n).reduce((function(e,t){var a=n[t];return e.push(o?"beat.hostname:(".concat(a.join(" OR "),")"):"".concat(t,":(").concat(a.join(" OR "),")")),e}),[]).join(" AND ")):function(e){var t=[{},{}];return e.forEach((function(e){[e.metrics.disk_write,e.metrics.disk_overlay_write_bytes].forEach((function(e,a){e&&Object.keys(e).forEach((function(r){t[a][r]||(t[a][r]=[]),t[a][r].includes(e[r])||t[a][r].push(e[r])}))}))})),t.map((function(e){var t=Object.keys(e).reduce((function(t,a){var r=e[a];return t.push("".concat(a,":(").concat(r.join(" OR "),")")),t}),[]);return t.length>0?"(".concat(t.join(" AND "),")"):""})).filter((function(e){return e.length>0})).join(" OR ")}(a)},hd=nd,bd=function(e){var t=e.type,a=e.timeRangeParams,r=e.id,n=e.node_agg_selector,o=e.device_agg_selector,i=e.value_field,s=e.agg_type,c={};switch(r){case"memory":case"cpu":c={Node:{terms:{field:n,size:1e4,order:{_term:"desc"}},aggs:{Metric:{avg:Qp({field:i},ad.includes(r)&&{script:{lang:"painless",source:"_value * params.correction",params:{correction:100}}})}}}};break;case"network_in":c={Node:{terms:{field:n,size:1e4,order:{_term:"desc"}},aggs:{Device:{terms:{field:o,size:1e4,order:{_term:"desc"}},aggs:{Metric:{avg:{field:i}}}}}}};break;case"disk_write":case"disk_overlay_write_bytes":c={Node:{terms:{field:n,size:1e4,order:{_term:"desc"}},aggs:{Device:{terms:{field:o,size:1e4,order:{_term:"desc"}},aggs:{Metric:{avg:{field:i}}}},Device1:{terms:{field:"docker.container.id",size:1e4,order:{_term:"desc"}},aggs:{Metric1:{avg:{field:"docker.diskio.write.bytes"}}}}}}};break;case"gpu":case"gpu_memory_used":c="system_chart"===t?{Host:{terms:{field:n,size:1e4,order:{_key:"desc"}},aggs:{GPU:{terms:{field:o,size:1e4,order:{_key:"desc"}},aggs:{GPU_Metric:{avg:{field:i}}}},Sum_GPU_Metric:{sum_bucket:{buckets_path:"GPU>GPU_Metric"}},Avg_GPU_Metric:{avg_bucket:{buckets_path:"GPU>GPU_Metric"}}}}}:{Node:{terms:{field:n,script:{source:"if (!_value.isEmpty()) return _value.substring(0, _value.lastIndexOf('-')); else return _value",lang:"painless"},size:1e4,order:{_key:"desc"}},aggs:{NUM_GPU:{scripted_metric:{init_script:"state.gpu_idx = 0",combine_script:"return state",map_script:"state.gpu_idx = Integer.parseInt(doc.linkName.value.substring(doc.linkName.value.lastIndexOf('-')+1))",reduce_script:"int count = 1; for (a in states) { if (a.gpu_idx+1 > count) {count=a.gpu_idx+1;}} return count"}},Link:{terms:{field:"linkName",size:1e4,order:{_key:"desc"}},aggs:{GPU:{terms:{field:o,size:1e4,order:{_key:"desc"}},aggs:{GPU_Metric:{avg:{field:i}}}},Avg_GPU_Metric:{avg_bucket:{buckets_path:"GPU>GPU_Metric"}}}},Sum_Node_GPU_Metric:{sum_bucket:{buckets_path:"Link>Avg_GPU_Metric"}},Avg_Node_GPU_Metric:{avg_bucket:{buckets_path:"Link>Avg_GPU_Metric"}}}}};break;case"system_memory":case"system_swap":case"system_load":case"system_cpu":case"system_network_in":case"system_network_out":if("total_avg"===s)c={Metric:{avg:Qp({field:i},ad.includes(r)&&{script:{lang:"painless",source:"_value * params.correction",params:{correction:100}}})}};else{var l={};if("node"!==s)l={sort_field:{avg:{field:"top_cpu_hosts"===s?"system.cpu.user.pct":"system.memory.used.bytes"}},bucket_sort_by:{bucket_sort:{sort:[{sort_field:{order:"desc"}}],size:10}}};c={Node:{terms:{field:n,size:1e4,order:{_key:"desc"}},aggs:Qp({Metric:{avg:Qp({field:i},ad.includes(r)&&{script:{lang:"painless",source:"_value * params.correction",params:{correction:100}}})}},l)}}}}return{MetricSet:{date_histogram:od(a),aggs:c}}},vd=function(e){var t=e.raw_data,a=e.device_agg_selector,r=e.type,n=e.id,o=void 0===n?"":n,i=e.selected_objs,s=e.agg_type,c={};if(o.includes("gpu"))c=cd({type:r,raw_data:t,device_agg_selector:a,selected_objs:i,id:o});else switch(r){case"cluster_chart":c=sd({raw_data:t,device_agg_selector:a,selected_objs:i,id:o});break;case"system_chart":c=ld({raw_data:t,device_agg_selector:a,selected_objs:i,agg_type:s})}return td.includes(o)&&Object.keys(c).forEach((function(e){var t=c[e];t.yMax=0;var a=t.data;a.forEach((function(e,r){r+1===a.length||null===e.y||null===a[r+1].y?e.y=0:(e.y=a[r+1].y-e.y,t.yMax=t.yMax>e.y?t.yMax:e.y)})),a.pop()})),c},yd=function(e){var t=e.raw_data,a=e.applicable_metrics,r=e.tenantPodList,n=e.selection,o=[],i=0,s={},c={},l=n.pod,u=void 0===l?"*":l,p=n.tenant,d=void 0===p?"*":p,m=n.agg_type,h=void 0===m?"total_avg":m;"total_avg_all_tenants"!==h&&"total_avg"!==h&&"pod"!==h||(s=t.reduce((function(e,t){if("total_avg_all_tenants"===h){var r=f.a.fetchSafeFromObject({path:["key"],obj:t,default_value:{}}).UsagePeriod,n={total:{node_count:1,metrics:{}}},o={};if(a.forEach((function(e){var a=e.id,r=void 0===a?"":a,n=t[r].value||0;o[r]=n})),n.total.metrics=o,e.hasOwnProperty(r)){var i=e[r];return Object.keys(i.total.metrics).forEach((function(e){i.total.metrics[e]=(n.total.metrics[e]+i.total.node_count*i.total.metrics[e])/(i.total.node_count+1)})),i.total.node_count+=1,e}var s={};return s[r]=n,Qp(Qp({},e),s)}var c=t.Namespace,l=void 0===c?{}:c,u=t.key,p=(void 0===u?{}:u).UsagePeriod,d={},m=f.a.fetchSafeFromObject({path:["buckets"],obj:l,default_value:[]});if(("total_avg"===h?m:f.a.fetchSafeFromObject({path:["Pod","buckets"],obj:m[0],default_value:[]})).forEach((function(e){var t={node_count:1,metrics:{}},r={};a.forEach((function(t){var a=t.id,n=void 0===a?"":a,o=e[n].value||0;r[n]=o})),t.metrics=r;var n="total_avg"===h?e.key:m[0].key;d[n]=t})),e.hasOwnProperty(p)){var b=e[p];return Object.keys(b).forEach((function(e){if(d.hasOwnProperty(e)){var t=d[e],a=b[e];Object.keys(a.metrics).forEach((function(e){a.metrics[e]=(t.metrics[e]+a.node_count*a.metrics[e])/(a.node_count+1)})),a.node_count+=1}})),Object.keys(d).forEach((function(e){b.hasOwnProperty(e)||(b[e]=d[e])})),e}var v={};return v[p]=d,Qp(Qp({},e),v)}),{}));return Object.keys(s).sort().forEach((function(e,t){i=t;var n=s[e],l="total_avg_all_tenants"===h?["total"]:Object.keys(r);0===t&&l.length&&(o=f.a.getColorList(l.length)),l.forEach((function(t,n){if("*"===d||d===t){var i=o[n]||"#2AD2C9",s=r[t];if("*"===u||s.includes(u))!function(e){var t=e.list,r=e.color,n=e.ts;t.forEach((function(e){a.forEach((function(t){var a=t.id,o=void 0===a?"":a;o&&!Object.keys(c).includes(o)&&(c[o]={});var i=c[o];Object.keys(i).includes(e)||(i[e]={name:e,data:[],yMax:0,color:r}),i[e].data.push({x:n/1e3,y:0})}))}))}({list:"*"===u?[t]:[u],color:i,ts:e})}})),Object.keys(n).forEach((function(e){var t=n[e].metrics;if("*"===d||d===e){var o=r[e];if("*"===u||o.includes(u))!function(e){var t=e.list,r=e.metrics_data;"total_avg_all_tenants"===h||"total_avg"===h||"pod"===h?t.forEach((function(e){a.forEach((function(t){var a=t.id,n=void 0===a?"":a,o=c[n],s=r[n]||0;ad.includes(n)&&(s=f.a.roundNumber(100*s,2)),o[e].data[i].y=s,o[e].yMax=Math.max(o[e].yMax,s)}))})):f.a.fetchSafeFromObject({path:["Pod","buckets"],obj:r,default_value:[]}).forEach((function(e){var r=e.key;t.includes(r)&&a.forEach((function(t){var a=t.id,n=void 0===a?"":a,o=c[n],s=e[n].value||0;o[r].data[i].y=s,o[r].yMax=Math.max(o[r].yMax,s)}))}))}({list:"*"===u?[e]:[u],metrics_data:t})}}))})),Object.keys(c).forEach((function(e){if(td.includes(e)){var t=c[e];Object.keys(t).forEach((function(e){var a=t[e];a.yMax=0;var r=a.data;r.forEach((function(e,t){t+1===r.length||null===e.y||null===r[t+1].y?e.y=0:(e.y=r[t+1].y-e.y,a.yMax=a.yMax>e.y?a.yMax:e.y)})),r.shift()}))}})),c},gd=function e(t){var a=t.cancelToken,r=t.inBuckets,n=t.queryFun,o=t.queryParams,i=t.isK8S,s=void 0===i||i,c=n(o);return new Promise((function(t,i){R({op:s?w.op.K8S_MONITORING:w.op.MONITORING,data:c,timeout:6e4,cancelToken:a}).then((function(i){var s=i.data,c=pd(void 0===s?{}:s),l=c.afterKey,u=c.buckets;if(r.push.apply(r,Xp(u)),void 0===l)t(r);else{var p=Qp(Qp({},o),{},{afterKey:l});t(e({cancelToken:a,inBuckets:r,queryFun:n,queryParams:p}))}})).catch((function(e){i(e)}))}))},_d=function e(t){var a=t.cancelToken,r=t.inBuckets,n=t.queryFun,o=t.queryParams,i=n(o);return new Promise((function(t,s){R({op:w.op.MSEARCH_MONITORING,data:i,timeout:6e4,cancelToken:a}).then((function(i){var s=i.data,c=dd(void 0===s?{}:s),l=[];if(c.forEach((function(e){r.push.apply(r,Xp(e.buckets)),l.push(e.afterKey)})),l.every((function(e){return f.a.isEmptyObject(e)})))t(r);else{var u=Qp(Qp({},o),{},{afterKeys:l});t(e({cancelToken:a,inBuckets:r,queryFun:n,queryParams:u}))}})).catch((function(e){s(e)}))}))},Sd=function(e){var t=e.graph,a=e.metrics_params,r=e.applicable_graphs,n=[],o="tenant_types",i="node_metrics",s="docker",c=r.slice();switch(t){case"system":o="worker_types",i="host_metrics";break;case"k8s-tenant":s="k8s",i="k8s_metrics";break;case"tenant":s="docker",i="node_metrics",c.push("disk_overlay_write_bytes")}var l=f.a.fetchSafeFromObject({path:[o,s],obj:a,default_value:!1});if(l){var u=f.a.fetchSafeFromObject({path:[i],obj:l,default_value:[]});u.length&&u.forEach((function(e){c.includes(e.id)&&n.push(e)}))}return n},kd=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=f.a.getColorList(e.length);return e.forEach((function(e,a){var r=t[a];e.color=r;var n=f.a.getColorList(e.nodes.length,r).reverse();e.nodes.sort((function(e,t){return parseInt(e.name.match(/\d+$/),0)>parseInt(t.name.match(/\d+$/),0)?1:-1})).forEach((function(e,t){e.color=n[t]}))})),e},Od=function(e){var t,a,r=e.applicable_metrics,n=e.kubedirector,o=e.k8sTenants,i=e.selection,s=e.afterKeys,c=void 0===s?[]:s,l=nd(i.time_range),u=od(l,!0),p=(t=i.time_range,{hour:"pod"===(a=i.agg_type)?1e3:"total_avg"===a||"total_avg_all_tenants"===a?90:10,"6hr":"pod"===a?1e3:"total_avg"===a||"total_avg_all_tenants"===a?90:10,day:"pod"===a?100:"total_avg"===a||"total_avg_all_tenants"===a?60:10,week:"pod"===a?100:"total_avg"===a||"total_avg_all_tenants"===a?60:10}[t]),d={index:"metricbeat-6.6.3-*"},f=[],m="*"===i.tenant?o:[o.find((function(e){return e.namespace===i.tenant}))];if("total_avg_all_tenants"===i.agg_type){var h=ud({applicable_metrics:r,kubedirector:n,k8sTenants:o,selection:i}),b=h.selectors,v=h.aggs,y=rd({timeRangeParams:l,selectors:b}),g=void 0===c[0]?{}:{after:Qp({},c[0])};f.push(d);var _={query:{bool:{must:y,must_not:[]}},size:0,_source:{excludes:[]},aggs:{Pages:{composite:Qp(Qp({size:p},g),{},{sources:[{UsagePeriod:{date_histogram:u}},{Node:{terms:{field:"kubernetes.node.name"}}}]}),aggs:v}}};f.push(_)}else m.forEach((function(e){var t=c.find((function(t){return t.Namespace===e.namespace}));if(0===c.length||void 0!==t){var a=ud({applicable_metrics:r,kubedirector:n,k8sTenants:[e],selection:i}),o=a.selectors,s=a.aggs,m=rd({timeRangeParams:l,selectors:o}),h=void 0===t?{}:{after:Qp({},t)};f.push(d);var b={query:{bool:{must:m,must_not:[]}},size:0,_source:{excludes:[]},aggs:{Pages:{composite:Qp(Qp({size:p},h),{},{sources:[{UsagePeriod:{date_histogram:u}},{Node:{terms:{field:"kubernetes.node.name"}}},{Namespace:{terms:{field:"kubernetes.namespace"}}}]}),aggs:s}}};f.push(b)}}));return f};function Ed(e){return(Ed="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function jd(e,t){for(var a=0;a<t.length;a++){var r=t[a];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Dd(e,t){return(Dd=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function wd(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=Pd(e);if(t){var n=Pd(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return Cd(this,a)}}function Cd(e,t){return!t||"object"!==Ed(t)&&"function"!=typeof t?Td(e):t}function Td(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Pd(e){return(Pd=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Ad(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}var Rd=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Dd(e,t)}(i,e);var t,a,r,o=wd(i);function i(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),Ad(Td(t=o.call(this,e)),"CancelToken",T.a.CancelToken),Ad(Td(t),"source",null),Ad(Td(t),"timeout",null),t.state={width:0,data:[],loading:!1},t.fetchData=t.fetchData.bind(Td(t)),t.onResize=t.onResize.bind(Td(t)),t.createChart=t.createChart.bind(Td(t)),t.updateChart=t.updateChart.bind(Td(t)),t.getWidth=t.getWidth.bind(Td(t)),t}return t=i,(a=[{key:"componentDidUpdate",value:function(e){var t=this.props,a=t.time_range,r=t.selected_objs,n=t.updateData,o=t.props_data,i=t.agg_type;if(n){var s=e.time_range,c=e.selected_objs,l=e.agg_type;a===s&&f.a.isEqual(r,c)&&i===l||this.fetchData("load")}else{var u=e.props_data;f.a.isEqual(o,u)||this.updateChart()}}},{key:"componentDidMount",value:function(){var e=this.props.updateData;this.onResize(),e?this.fetchData("load"):this.updateChart(),window.addEventListener("resize",this.onResize.bind(this))}},{key:"componentWillUnmount",value:function(){window.removeEventListener("resize",this.onResize.bind(this)),clearTimeout(this.timeout),this.source&&this.source.cancel("Component unmounted")}},{key:"fetchData",value:function(e){var t=this;e&&this.setState({loading:!0}),clearTimeout(this.timeout),this.source=this.CancelToken.source();var a=this.props,r=a.time_range,n=a.selected_objs,o=a.selectors,i=a.id,s=a.type,c=a.node_agg_selector,l=a.device_agg_selector,u=a.value_field,p=a.agg_type,d=hd(r),m=md({id:i,selected_objs:n,type:s}),h={query:{bool:{must:fd({timeRangeParams:d,selectors:o,query_params:m,id:i,agg_type:p}),must_not:[]}},size:0,_source:{excludes:[]},aggs:bd({type:s,timeRangeParams:d,id:i,node_agg_selector:c,device_agg_selector:l,value_field:u,agg_type:p})};R({op:w.op.MONITORING,data:h,timeout:6e4,cancelToken:this.source.token}).then((function(a){var r=a.data,o=vd({raw_data:void 0===r?{}:r,device_agg_selector:l,type:s,id:i,selected_objs:n,agg_type:p});t.setState({data:o},(function(){t.updateChart(),e&&t.setState({loading:!1})})),t.timeout=setTimeout((function(){t.fetchData()}),6e4)})).catch((function(e){T.a.isCancel(e)?f.a.bdLog(e):t.timeout=setTimeout((function(){t.fetchData()}),6e4)}))}},{key:"onResize",value:function(){var e=this.getWidth();this.setState({width:e}),this.updateChart()}},{key:"createChart",value:function(){var e=this.state,t=e.width,a=e.data,r=this.props,n=r.updateData,o=r.props_data,i=r.renderer,s=r.id,c=n?a:o;return this.graph=function(e){var t=e.element,a=e.width,r=e.data,n=e.renderer,o=e.stack,i=e.interpolation,s=e.id,c=zp(r),l=c.max,u=void 0===l?0:l,p=c.series,d=void 0===p?[]:p,f=a>500?3:2,m=new Gp.a.Graph({element:t,max:u,renderer:n,stack:o||!0,width:a||t.offsetWidth,height:a/f,series:d||[],interpolation:i||"linear",padding:{top:1.5,bottom:1.5}});return m.data=r,new Gp.a.Graph.HoverDetail({graph:m,formatter:function(e,t,a){return"<span class='hover-detail'>".concat(e.name," : ").concat(Wp(a,s),"</span></br>")+"<span class='hover-time'> Time: ".concat(Fc()(1e3*t).format("MMM DD YYYY HH:mm"),"</span>")}}),new Gp.a.Graph.Axis.Time({graph:m,ticksTreatment:"glow",ticks:Math.floor(t.offsetWidth/50),timeFixture:new Gp.a.Fixtures.Time.Local}),new Gp.a.Graph.Axis.Y({graph:m,tickFormat:function(e){return Wp(e,s)},ticksTreatment:"glow",ticks:Math.floor(t.offsetHeight/99)>2?Math.floor(t.offsetHeight/99):2}),m.render(),m}({element:this.node,width:t,data:c,renderer:i,stack:!0,interpolation:"linear",id:s}),this.graph}},{key:"updateChart",value:function(){if(this.graph){var e=this.state,t=e.data,a=e.width,r=this.props,n=r.updateData,o=r.props_data,i=n?t:o;if(this.graph.configure({width:a}),this.graph.data!==i){var s=zp(i),c=s.max,l=void 0===c?0:c,u=s.series,p=void 0===u?[]:u;this.graph.setSeries(p),this.graph.configure({max:l})}return this.graph.render(),this.graph}return this.createChart()}},{key:"getWidth",value:function(){return this.node.parentElement.offsetWidth-16}},{key:"render",value:function(){var e=this,t=this.props,a=t.classes,r=t.id,o=t.label,i=(o=void 0===o?{}:o).name,s=void 0===i?"":i,c=t.grid,l=void 0===c?6:c,u=t.showLoading,p=void 0!==u&&u,d=this.state.loading,f=er({path:["dashboardTooltipMsg",r]});return n.a.createElement(bc.a,{className:a.widget,item:!0,sm:l},n.a.createElement(St.Typography,{variant:"h6",className:a.subtitle},s)," ",n.a.createElement(lr,{title:f}),n.a.createElement("div",{className:"rickshaw_graph",ref:function(t){e.node=t}}),d||p?n.a.createElement(ls,{size:"1.5rem"}):"")}}])&&jd(t.prototype,a),r&&jd(t,r),i}(r.Component);Ad(Rd,"defaultProps",{updateData:!0,renderer:"area"}),Ad(Rd,"propTypes",{classes:u.a.object.isRequired,selected_objs:u.a.array,time_range:u.a.string,label:u.a.object.isRequired,type:u.a.string.isRequired,id:u.a.string.isRequired,filter:u.a.bool,grid:u.a.number,node_agg_selector:u.a.string,device_agg_selector:u.a.string,value_field:u.a.string,selectors:u.a.array,updateData:u.a.bool,renderer:u.a.oneOf(["area","bar","line"]),props_data:u.a.object,metricId:u.a.string,showLoading:u.a.bool,agg_type:u.a.string});var Nd=he()((function(){return{widget:{position:"relative"},subtitle:{display:"inline-block"}}}))(Rd);function Fd(e){return(Fd="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function xd(){return(xd=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var r in a)Object.prototype.hasOwnProperty.call(a,r)&&(e[r]=a[r])}return e}).apply(this,arguments)}function Md(e){return function(e){if(Array.isArray(e))return Id(e)}(e)||function(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||function(e,t){if(!e)return;if("string"==typeof e)return Id(e,t);var a=Object.prototype.toString.call(e).slice(8,-1);"Object"===a&&e.constructor&&(a=e.constructor.name);if("Map"===a||"Set"===a)return Array.from(e);if("Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a))return Id(e,t)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Id(e,t){(null==t||t>e.length)&&(t=e.length);for(var a=0,r=new Array(t);a<t;a++)r[a]=e[a];return r}function Ud(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function Ld(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?Ud(Object(a),!0).forEach((function(t){zd(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):Ud(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function Bd(e,t){for(var a=0;a<t.length;a++){var r=t[a];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Hd(e,t){return(Hd=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Kd(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=Gd(e);if(t){var n=Gd(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return qd(this,a)}}function qd(e,t){return!t||"object"!==Fd(t)&&"function"!=typeof t?Vd(e):t}function Vd(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Gd(e){return(Gd=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function zd(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}var Wd=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Hd(e,t)}(i,e);var t,a,r,o=Kd(i);function i(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),(t=o.call(this,e)).state={cluster:"*",node:"*",time_range:"hour",applicable_metrics:[],applicable_graphs:[],grid:0,selections:{}},t.updateMetricDescriptors=t.updateMetricDescriptors.bind(Vd(t)),t.handleChangeSelection=t.handleChangeSelection.bind(Vd(t)),t.getQuerySelections=t.getQuerySelections.bind(Vd(t)),t.buildClustersObj=t.buildClustersObj.bind(Vd(t)),t.getApplicableNodes=t.getApplicableNodes.bind(Vd(t)),t}return t=i,(a=[{key:"componentDidMount",value:function(){this.updateMetricDescriptors()}},{key:"updateMetricDescriptors",value:function(){var e=this.props,t=e.metrics_params,a=e.gpu_usage_supported,r=void 0!==a&&a,n=w.applicable_graphs({gpu_usage_supported:r,graph:"tenant"}),o=4===n.length?6:4;if(f.a.isEmptyObject(t))setTimeout(this.updateMetricDescriptors,500);else{var i=Sd({graph:"tenant",metrics_params:t,gpu_usage_supported:r,applicable_graphs:n});this.setState({applicable_metrics:i,applicable_graphs:n,grid:o})}}},{key:"handleChangeSelection",value:function(e,t){var a=zd({},t,e);"cluster"===t&&(a.node="*"),this.setState(Ld({},a))}},{key:"getQuerySelections",value:function(e){var t=this.state,a=t.cluster,r=t.node,n=t.time_range,o=[];return e&&e.map((function(e){"*"!==a&&a!==e.href||e.nodes.map((function(e){"*"!==r&&r!==e.fqdn||o.push(e)}))})),{selected_objs:o,time_range:n,filter:!0}}},{key:"buildClustersObj",value:function(){var e=this.props,t=e.node_list,a=e.filterList,r=void 0===a?[]:a,n=f.a.fetchSafeFromObject({path:["_embedded","nodes"],obj:t,default_value:[]}),o=n.length?n.reduce((function(e,t){var a=f.a.fetchSafeFromObject({path:["_links","cluster","href"],obj:t,default_value:""});if("ready"===t.status&&!r.includes(a)){var n=t._links,o=(n=void 0===n?{}:n).cluster,i=void 0===o?{}:o,s=t.fqdn,c=void 0===s?"":s,l=t.name,u=void 0===l?"":l,p=t.metrics_instances,d=void 0===p?[]:p,m=t.flavor,h=(m=void 0===m?{}:m).gpus,b=void 0===h?0:h,v=e.find((function(e){return e.href===i.href})),y={fqdn:c,name:u,metrics:d.reduce((function(e,t){return e[t.metric_id]=t.selectors.reduce((function(e,t){return e[t.field]=t.value,e}),{}),e}),{}),gpus:b};v?v.nodes.push(y):e.push(Ld(Ld({},i),{},{nodes:[y]}))}return e}),[]).sort((function(e,t){return e.title.toLowerCase()>t.title.toLowerCase()?1:-1})):[];return o.length&&kd(o),o}},{key:"getApplicableNodes",value:function(e){var t=this.state.cluster,a=[];return"*"===t?e.map((function(e){var t;(t=a).push.apply(t,Md(e.nodes))})):a=f.a.fetchSafeFromObjectArray({arr:e,path:["href"],match:t,get:["nodes"],default_value:[]}),a}},{key:"render",value:function(){var e=this.props,t=e.title,a=e.classes,r=this.state,o=r.applicable_graphs,i=r.applicable_metrics,s=r.grid,c=r.time_range,l=r.node,u=r.cluster,p=this.buildClustersObj(),d=this.getApplicableNodes(p);p=f.a.bdSort(p,["title"]),d=f.a.bdSort(d,["name"]);var m=this.getQuerySelections(p);return n.a.createElement("div",{className:a.monitoring},t?n.a.createElement(st.a,{variant:"h2",className:a.contentTitle},t):"",p.length&&i.length?n.a.createElement("div",{className:a.chartContainer},n.a.createElement("div",{className:a.chartSelectors},n.a.createElement(Hr.a,{className:a.selectWrapper},n.a.createElement(nc,{value:u,onChange:this.handleChangeSelection,name:"cluster",className:a.select,items:[{val:"*",title:"All Clusters"}].concat(Md(p.map((function(e){return{val:e.href,title:e.title}}))))})),n.a.createElement(Hr.a,{className:a.selectWrapper},n.a.createElement(nc,{value:l,onChange:this.handleChangeSelection,name:"node",className:a.select,items:[{val:"*",title:"All Nodes"}].concat(Md(d.map((function(e){return{val:e.fqdn,title:e.fqdn}}))))})),n.a.createElement(Hr.a,{className:a.selectWrapper},n.a.createElement(nc,{value:c,onChange:this.handleChangeSelection,name:"time_range",className:a.select,items:Md(w.TIME_RANGES)}))),n.a.createElement(bc.a,{className:a.charts,container:!0,spacing:16},o.map((function(e){return n.a.createElement(Nd,xd({id:e,type:"cluster_chart"},i.find((function(t){return t.id===e})),m,{grid:s,key:e}))})))):n.a.createElement(Hp.a,{className:a.well},n.a.createElement(qp.a,null,n.a.createElement(st.a,{variant:"body1"},"Cluster charts will be available once clusters are created."))))}}])&&Bd(t.prototype,a),r&&Bd(t,r),i}(r.Component);zd(Wd,"propTypes",{classes:u.a.object,node_list:u.a.object,title:u.a.string,filterList:u.a.array,metrics_params:u.a.object,gpu_usage_supported:u.a.bool});var Jd=he()(yp)(Wd);function Yd(e){return(Yd="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function $d(){return($d=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var r in a)Object.prototype.hasOwnProperty.call(a,r)&&(e[r]=a[r])}return e}).apply(this,arguments)}function Qd(e,t){for(var a=0;a<t.length;a++){var r=t[a];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Zd(e,t,a){return t&&Qd(e.prototype,t),a&&Qd(e,a),e}function Xd(e,t){return(Xd=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function ef(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=rf(e);if(t){var n=rf(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return tf(this,a)}}function tf(e,t){return!t||"object"!==Yd(t)&&"function"!=typeof t?af(e):t}function af(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function rf(e){return(rf=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var nf=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Xd(e,t)}(a,e);var t=ef(a);function a(e){var r;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,a),(r=t.call(this,e)).state={current_role:"",filteredNodes:{},filterList:[]},r.fetchCurrentTenant=r.fetchCurrentTenant.bind(af(r)),r.filterMemberNoteBook=r.filterMemberNoteBook.bind(af(r)),r}return Zd(a,null,[{key:"getMeta",value:function(){return{title:"".concat(w.APP_TITLE.ML_OPS," | Dashboard"),link:[{rel:"canonical",href:"".concat(w.serverUrl).concat(w.views.dashboard.url)}],meta:[{charset:"utf-8"},{name:"description",content:"Dashboard reporting of general usages."}]}}}]),Zd(a,[{key:"componentDidMount",value:function(){var e=this.props.dispatch,t=this;this.fetchCurrentTenant(),e(sf()),e(Q(oe.CLUSTER_DATA)).then((function(){t.setState({clustersFetched:!0})}))}},{key:"fetchCurrentTenant",value:function(){var e=this,t=this.props,a=t.stats_data,r=t.dispatch,n=f.a.fetchSafeFromObject({path:["session_data","role_name"],obj:a,default_value:""});if(n){if(this.setState({current_role:n}),"Site Admin"!==n){var o=f.a.fetchSafeFromObject({path:["session_data","tenant"],obj:a,default_value:""});r(Q({apiUrl:o,propVal:"current_tenant_data"}))}"Member"===n&&this.filterMemberNoteBook()}else setTimeout((function(){e.fetchCurrentTenant()}),200)}},{key:"filterMemberNoteBook",value:function(){var e=this,t=this.props,a=t.page_data,r=void 0===a?{}:a,n=t.stats_data,o=void 0===n?{}:n;if(this.state.clustersFetched){var i=[],s=f.a.fetchSafeFromObject({path:["session_data","user"],obj:o,default_value:""});f.a.fetchSafeFromObject({path:["cluster_list","_embedded","clusters"],obj:r,default_value:[]}).map((function(e){if(f.a.fetchSafeFromObject({path:["nodegroup","intended_categories"],obj:e,default_value:[]}).includes("AIML/Notebook")){var t=e.created_by_user,a=void 0===t?"":t,r=e._links,n=(r=void 0===r?{}:r).self,o=(n=void 0===n?{}:n).href,c=void 0===o?"":o;s!==a&&i.push(c)}})),this.setState({filterList:i})}else setTimeout((function(){e.filterMemberNoteBook()}),200)}},{key:"render",value:function(){var e=a.getMeta(),t=this.props,r=t.page_data,o=(r=void 0===r?{}:r).current_tenant_data,i=void 0===o?{}:o,s=r.node_list,c=void 0===s?{}:s,l=r.metrics_params,u=void 0===l?{}:l,p=t.stats_data,d=(p=void 0===p?{}:p).session_data,m=void 0===d?{}:d,h=t.classes,b=this.state,v=b.current_role,y=b.filterList,g=f.a.fetchSafeFromObject({path:["gpu_usage_supported"],obj:i,default_value:!1}),_=f.a.fetchSafeFromObject({path:["current_tenant_data","available_resources"],obj:m,default_value:{}});return n.a.createElement("div",{className:"DashboardPage"},n.a.createElement(Al.a,{title:e.title,description:e.description,link:e.link,meta:e.meta}),n.a.createElement(Nt,{title:"Dashboard"}),"Site Admin"===v?n.a.createElement(Lp,null):"","Admin"===v?n.a.createElement("div",{className:h.AdminContent},n.a.createElement(Cp,$d({title:"Resource Allocation"},{tenant_data:i,available_resources:_})),n.a.createElement(Jd,$d({title:"Monitoring"},{gpu_usage_supported:g,node_list:c,metrics_params:u}))):"","Member"===v&&n.a.createElement("div",{className:h.MemberContent},n.a.createElement(Jd,$d({title:"Monitoring"},{gpu_usage_supported:g,node_list:c,metrics_params:u,filterList:y}))))}}]),a}(r.Component);!function(e,t,a){t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a}(nf,"propTypes",{classes:u.a.object.isRequired,dispatch:u.a.func.isRequired,stats_data:u.a.object,page_data:u.a.object});var of=d()(he()((function(){return{}}),{name:"App"}),Object(s.b)((function(e){var t=e.stats_data,a=void 0===t?{}:t,r=e.page_data;return{stats_data:a,page_data:void 0===r?{}:r}})))(nf),sf=function(){return function(e){return e(x(Q(oe.TENANT_DATA),Q(oe.NODE_DATA(["flavor"])),Q(oe.METRICS_PARAM_DATA)))}},cf=a(40),lf=a.n(cf);function uf(e){return(uf="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function pf(e,t){for(var a=0;a<t.length;a++){var r=t[a];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function df(e,t,a){return t&&pf(e.prototype,t),a&&pf(e,a),e}function ff(e,t){return(ff=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function mf(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=vf(e);if(t){var n=vf(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return hf(this,a)}}function hf(e,t){return!t||"object"!==uf(t)&&"function"!=typeof t?bf(e):t}function bf(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function vf(e){return(vf=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var yf=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&ff(e,t)}(a,e);var t=mf(a);function a(e){var r;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,a);var n=(r=t.call(this,e)).props.location,o=lf.a.parse(n.search),i=o.tenant_id,s=void 0===i?"":i,c=o.tenant_name,l=void 0===c?"":c;return r.state={selected_tenant:!(!s||!l)&&{tenant:s,tenant_name:l},usersDataFetched:!1},r.timeout=null,r.updatePage=r.updatePage.bind(bf(r)),r.fetchUserList=r.fetchUserList.bind(bf(r)),r.getApplicableTenant=r.getApplicableTenant.bind(bf(r)),r.revokeUser=r.revokeUser.bind(bf(r)),r.getUserTableSettings=r.getUserTableSettings.bind(bf(r)),r}return df(a,null,[{key:"getMeta",value:function(e){var t=e.kubernetes_access,a=e.role_name,r=e.tenantObj,n=r.tenant,o=r.tenant_name,i=t?"K8S Admin"===a&&n?w.views.k8sTenantUsers.makeTenantUserUrl({tenant_id:n,tenant_name:o}):w.views.k8sClusterAdminUsers.url:w.views.projectUsers.url,s=t?"Container Platform":"ML Ops",c="".concat("K8S Admin"===a?o+"'s ":"","Users");return{title:"HPE ".concat(s," | Users"),link:[{rel:"canonical",href:"".concat(w.serverUrl).concat(i)}],meta:[{charset:"utf-8"},{name:"description",content:"Manage ".concat(s," users page.")}],pageTitle:c}}}]),df(a,[{key:"componentDidMount",value:function(){var e=this.props.dispatch;this.fetchUserList(),e(Q(oe.ROLE_DATA))}},{key:"componentDidUpdate",value:function(e){e.location.search!==this.props.location.search&&this.updatePage()}},{key:"updatePage",value:function(){var e=this.props.location,t=lf.a.parse(e.search),a=t.tenant_id,r=void 0===a?"":a,n=t.tenant_name,o=void 0===n?"":n;this.setState({selected_tenant:!(!r||!o)&&{tenant:r,tenant_name:o},usersDataFetched:!1},this.fetchUserList)}},{key:"componentWillUnmount",value:function(){var e=this.props.dispatch;clearTimeout(this.timeout),["tenant_users"].map((function(t){e($(t))}))}},{key:"fetchUserList",value:function(){var e=this,t=this.props.dispatch,a=this.getApplicableTenant(),r=oe.TENANT_USER_DATA(a);t(Q(r)).then((function(){e.setState({usersDataFetched:!0})}))}},{key:"getApplicableTenant",value:function(){var e=this.state.selected_tenant,t=this.props,a=t.role_name,r=t.current_tenant;return"K8S Admin"===a&&e?e.tenant:r.tenant}},{key:"getUserTableSettings",value:function(){var e=this;return{columns:[{name:"Login Name",options:{filter:!0}},{name:"Full Name",options:{filter:!0}},{name:"Role",options:{filter:!0}},{name:"Authentication Type",options:{filter:!0}},{name:"Actions",options:{filter:!1,download:!1,customBodyRender:function(t){var a=JSON.parse(t);return!a.is_group_added_user&&n.a.createElement("div",{className:"test"},n.a.createElement(Ue.a,{variant:"contained",color:"secondary",onClick:function(){return e.revokeUser(a)}},"Revoke"))}}}],data:this.props.users.map((function(e){var t=e.user_id,a=e.name,r=e.description,n=e.role,o=e.role_name,i=e.auth_type,s=e.is_group_added_user,c=e.is_external;return[a,r,o,i,JSON.stringify({user_id:t,role:n,name:a,is_group_added_user:s,is_external:c})]})),options:{customToolbar:function(){var t=e.props.kubernetes_access?w.views.assignK8sUser.url:w.views.assignAimlUser.url;return n.a.createElement("div",{className:"tableActionButtons"},n.a.createElement(Ue.a,{variant:"contained",color:"primary",component:lo.a,to:t},"Assign"))},customToolbarSelect:function(t){return n.a.createElement("div",{className:"tableActionButtonsSelected"},n.a.createElement(Ue.a,{variant:"contained",color:"secondary",onClick:function(){e.revokeUserList(t)}},"Revoke"))},isRowSelectable:function(e,t){return!!t&&!JSON.parse(t[4]).is_group_added_user}}}}},{key:"revokeUserList",value:function(e){var t=this;e.data.map((function(e){var a=e.rowData,r=JSON.parse(a.pop());t.revokeUser(r)}))}},{key:"revokeUser",value:function(e){var t=this,a=e.user_id,r=e.role,o=e.name,i=this.getApplicableTenant(),s={operation:"revoke",user:a,role:r},c=w.apiurl.TENANT_USERS(i);R({apiurl:c,data:s,method:w.method.PUT}).then((function(e){f.a.isHttpStatusOk(e.status)?(_n({msg:"Successfully revoked ".concat(o),variant:"success"}),t.fetchUserList()):_n({msg:"Exception occured while revoking user",variant:"error"})})).catch((function(e){var t=f.a.parseAxiosError({error:e}),a=n.a.createElement("div",null,n.a.createElement(st.a,{variant:"caption"},"Failed to revoke ",o),n.a.createElement(st.a,{variant:"caption"},t));_n({msg:a,variant:"error"})}))}},{key:"render",value:function(){var e=this.props,t=e.kubernetes_access,r=void 0!==t&&t,o=e.role_name,i=void 0===o?"":o,s=e.current_tenant,c=void 0===s?{}:s,l=this.state.selected_tenant||c,u=a.getMeta({kubernetes_access:r,role_name:i,tenantObj:l}),p=this.getUserTableSettings();return n.a.createElement("div",{className:"UsersPage"},n.a.createElement(Al.a,{title:u.title,description:u.description,link:u.link,meta:u.meta}),n.a.createElement(Nt,{title:u.pageTitle}),n.a.createElement(sa,p))}}]),a}(r.Component);!function(e,t,a){t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a}(yf,"propTypes",{dispatch:u.a.func.isRequired,role_name:u.a.string,current_tenant:u.a.object,location:u.a.object,kubernetes_access:u.a.bool,users:u.a.array});var gf=Object(s.b)((function(e){var t=e.stats_data,a=(t=void 0===t?{}:t).session_data,r=void 0===a?{}:a,n=e.page_data,o=(n=void 0===n?{}:n).role_list,i=void 0===o?{}:o,s=n.tenant_users,c=void 0===s?{}:s,l=r.role_name,u=r.tenant,p=r.tenant_name,d=r.current_tenant_data,m=f.a.fetchSafeFromObject({path:["features","kubernetes_access"],obj:d,default_value:!1}),h=f.a.fetchSafeFromObject({path:["_embedded","users"],obj:c,default_value:[]}),b=f.a.fetchSafeFromObject({path:["_embedded","roles"],obj:i,default_value:[]}).reduce((function(e,t){var a=f.a.fetchSafeFromObject({path:["_links","self","href"],obj:t,default_value:""}),r=f.a.fetchSafeFromObject({path:["label","name"],obj:t,default_value:""});return e[a]=r,e}),{});return{role_name:l,current_tenant:{tenant:u,tenant_name:p},kubernetes_access:m,users:h.reduce((function(e,t){var a=t._embedded,r=(a=void 0===a?{}:a).label,n=(r=void 0===r?{}:r).name,o=void 0===n?"":n,i=r.description,s=void 0===i?"":i,c=a.role,l=void 0===c?"":c,u=a.is_service_account,p=void 0!==u&&u,d=a.is_group_added_user,m=void 0!==d&&d,h=a.is_external,v=void 0!==h&&h,y=t._links,g=void 0===y?{}:y;if(!p){var _=f.a.fetchSafeFromObject({path:["self","href"],obj:g,default_value:""}),S=b[l],k=v?"External":"Internal";m&&(k="".concat(k," (Group Added)")),e.push({user_id:_,name:o,description:s,role:l,role_name:S,auth_type:k,is_group_added_user:m,is_external:v})}return e}),[])}}))(yf),_f={getFlavorLabel:function(e){var t=f.a.fetchSafeFromObject({path:["label","name"],obj:e,default_value:""});return"".concat(t," - ").concat(e.cores," VCPU ").concat(e.memory," MB RAM ").concat(e.gpus?e.gpus+" GPU Devices ":"").concat(e.root_disk_size?e.root_disk_size+" GB root disk ":"").concat(e.persistent_storage_size?e.persistent_storage_size+" GB persistent storage ":"")},getStatusLabelOptions:function(e){return{status:e,title:e}},getFlavorActionButtons:function(e){var t=[];return"disabled"===f.a.fetchSafeFromObject({path:["flavor_state"],obj:e,default_value:""})?t.push({action:"Enable",icon:"icon-checkmark-circle",title:"Enable Flavor",variant:"primary"}):(t.push({action:"Disable",icon:"icon-prohibited",title:"Disable Flavor",variant:"warning"}),t.push({action:"Edit",icon:"icon-pencil3",title:"Edit Flavor",variant:"primary"})),t.push({action:"Delete",icon:"icon-trash2",title:"Delete Flavor",variant:"error"}),t}};function Sf(e){return(Sf="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function kf(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function Of(e,t){for(var a=0;a<t.length;a++){var r=t[a];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Ef(e,t,a){return t&&Of(e.prototype,t),a&&Of(e,a),e}function jf(e,t){return(jf=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Df(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=Tf(e);if(t){var n=Tf(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return wf(this,a)}}function wf(e,t){return!t||"object"!==Sf(t)&&"function"!=typeof t?Cf(e):t}function Cf(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Tf(e){return(Tf=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Pf(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}var Af=function(e){return Object.keys(e).reduce((function(t,a){var r="memory"===a?1024*e[a]:e[a];return t[a]=r,t}),{})},Rf={type:"object",properties:{label:w.bdSchemas.label,cores:{type:"number",title:"Cores",minimum:1,maximum:2e6},memory:{type:"number",title:"Memory (GB)",minimum:1,maximum:2e6},gpus:{type:"number",title:"Gpus",default:0,minimum:0,maximum:2e6},root_disk_size:{type:"number",title:"Root Disk Size (GB)",minimum:1,maximum:2e6},persistent_storage_size:{type:"number",title:"Persistent Storage Size(GB)",minimum:20,maximum:2e6}}},Nf={label:{name:{"ui:autofocus":!0}},root_disk_size:{"ui:help":"omit to use image default size"},persistent_storage_size:{"ui:help":"specify non-zero value to support migration"}},Ff=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&jf(e,t)}(a,e);var t=Df(a);function a(e){var r;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,a),(r=t.call(this,e)).state={selected_flavor:"",formTitle:"",formName:"",formDescription:"",method_actions:[{method:w.method.POST,action:w.apiurl.FLAVORS,data:"FORM_DATA"}]},r.fetchFlavorList=r.fetchFlavorList.bind(Cf(r)),r.callBack=r.callBack.bind(Cf(r)),r.validateFlavor=r.validateFlavor.bind(Cf(r)),r.invokeManageFlavorModal=r.invokeManageFlavorModal.bind(Cf(r)),r.invokeFlavorOp=r.invokeFlavorOp.bind(Cf(r)),r.deleteFlavor=r.deleteFlavor.bind(Cf(r)),r.deleteFlavorList=r.deleteFlavorList.bind(Cf(r)),r.resetFormData=r.resetFormData.bind(Cf(r)),r.bdModalFormChild=n.a.createRef(),r.bdDeleteDialog=n.a.createRef(),r}return Ef(a,null,[{key:"getMeta",value:function(){return{title:"".concat(w.APP_TITLE.ML_OPS," | Flavors"),link:[{rel:"canonical",href:"".concat(w.serverUrl).concat(w.views.flavors.url)}],meta:[{charset:"utf-8"},{name:"description",content:"Flavor Management."}]}}}]),Ef(a,[{key:"componentDidMount",value:function(){var e=this.props.stats_data,t=f.a.fetchSafeFromObject({path:["lock_data","locked"],obj:e,default_value:!1});this.fetchFlavorList(),t&&_n({msg:"System is in lockdown mode. You will not be able to add, edit, delete, enable, or disable flavors. Contact your site administrator.",variant:"success",timeout:15e3})}},{key:"fetchFlavorList",value:function(){(0,this.props.dispatch)(Q(oe.FLAVOR_DATA))}},{key:"resetFormData",value:function(){this.setState({selected_flavor:"",formTitle:"",formName:"",formDescription:"",method_actions:[{method:w.method.POST,action:w.apiurl.FLAVORS,data:"FORM_DATA"}]})}},{key:"validateFlavor",value:function(e,t){var a=this.props.page_data,r=this.state.selected_flavor,n=f.a.fetchSafeFromObject({path:["flavor_list","_embedded","flavor"],obj:a,default_value:[]}).map((function(e){return f.a.fetchSafeFromObject({path:["label","name"],obj:e,default_value:""})})),o=e.label,i=void 0===o?{}:o,s=e.memory,c=e.cores,l=i.name;return l||t.label.name.addError(er({path:["flavor","name","required"]})),l&&n.includes(l)&&l!==r&&t.label.name.addError(er({path:["flavor","name","duplicate"]})),c||t.cores.addError(er({path:["flavor","cores","required"]})),s||t.memory.addError(er({path:["flavor","memory","required"]})),t}},{key:"callBack",value:function(e){"success"===e.variant&&(this.fetchFlavorList(),this.resetFormData())}},{key:"getFlavorTableSettings",value:function(){var e=this,t=this.props,a=t.page_data,r=t.stats_data,o=f.a.fetchSafeFromObject({path:["lock_data","locked"],obj:r,default_value:!1}),i=o?"none":"multiple",s=f.a.fetchSafeFromObject({path:["flavor_list","_embedded","flavor"],obj:a,default_value:[]}),c=[{name:"Flavor Name",options:{filter:!0}},{name:"Flavor Description",options:{filter:!0}},{name:"Cores",options:{filter:!0}},{name:"Memory (GB)",options:{filter:!0}},{name:"GPU Devices",options:{filter:!0}},{name:"Root Disk Size (GB)",options:{filter:!0}},{name:"Persistent Storage Size (GB)",options:{filter:!0}},{name:"Status",options:{filter:!0,sort:!1,customBodyRender:function(e){var t=_f.getStatusLabelOptions(e);return n.a.createElement(Qa,t)}}},{name:"Actions",options:{filter:!1,sort:!1,customBodyRender:function(t){var a=function(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?kf(Object(a),!0).forEach((function(t){Pf(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):kf(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}({},t);a.memory=a.memory?t.memory/1024:0;var r=[];return o||(r=_f.getFlavorActionButtons(t)),n.a.createElement("div",{className:"row-action-btns"},r.map((function(t){var r=t.action,o=t.icon,i=t.title,s=t.variant;return n.a.createElement(ka,{title:i,variant:s,key:o},n.a.createElement("span",{className:se()("icon","icon-rect-link",o),onClick:function(){e.invokeFlavorOp({action:r,flavor:a})}}))})))}}}],l=s.reduce((function(e,t){var a=f.a.fetchSafeFromObject({path:["label"],obj:t,default_value:{}}),r=f.a.fetchSafeFromObject({path:["cores"],obj:t,default_value:""}),n=f.a.fetchSafeFromObject({path:["memory"],obj:t,default_value:""}),o=f.a.fetchSafeFromObject({path:["gpus"],obj:t,default_value:""}),i=f.a.fetchSafeFromObject({path:["root_disk_size"],obj:t,default_value:"use image default"}),s=f.a.fetchSafeFromObject({path:["persistent_storage_size"],obj:t,default_value:"0"}),c=f.a.fetchSafeFromObject({path:["flavor_state"],obj:t,default_value:""});return e.push([a.name||"",a.description||"",r,n/1024,o,i,s,c,t]),e}),[]),u={selectableRows:i};return o||(u.customToolbar=function(){return n.a.createElement("div",{className:"tableActionButtons"},n.a.createElement(Ue.a,{variant:"contained",color:"primary",onClick:function(){e.invokeManageFlavorModal({action:"Add",flavor:{}})}},"Add New Flavor"))},u.customToolbarSelect=function(t){return n.a.createElement("div",{className:"tableActionButtonsSelected"},n.a.createElement(Ue.a,{variant:"contained",color:"secondary",onClick:function(){var a={callback:e.deleteFlavorList,context:{selected_rows:t,flavors:s},title:"Delete selected flavor(s)",description:"Confirm Deletion. This action cannot be undone"};e.bdDeleteDialog.current.handleOpen(a)}},"Delete"))}),{columns:c,data:l,title:"",options:u}}},{key:"invokeManageFlavorModal",value:function(e){var t=e.action,a=e.flavor,r="Add"===t,o=f.a.fetchSafeFromObject({path:["label","name"],obj:a,default_value:""}),i=n.a.createElement(st.a,{variant:"h2"},t," Flavor Information"),s="".concat(t," flavor modal form"),c=r?"Form to add new flavor":"Form to update existing flavor",l=r?[{method:w.method.POST,action:w.apiurl.FLAVORS,data:"FORM_DATA"}]:[{method:w.method.DELETE,action:f.a.fetchSafeFromObject({path:["_links","self","href"],obj:a,default_value:""})},{method:w.method.POST,action:w.apiurl.FLAVORS,data:"FORM_DATA",default:!0}];this.setState({selected_flavor:o,formTitle:i,formName:s,formDescription:c,method_actions:l}),this.bdModalFormChild.current.updateStateFormData({formData:a}),this.bdModalFormChild.current.openModal()}},{key:"invokeFlavorOp",value:function(e){var t=e.action,a=e.flavor;if("Enable"===t||"Disable"===t)this.enableOrDisableFlavor({action:t,flavor:a});else if("Edit"===t)this.invokeManageFlavorModal({action:t,flavor:a});else{var r={callback:this.deleteFlavor,context:a,title:"Delete flavor ("+a.label.name+")",description:"Confirm Deletion. This action cannot be undone"};this.bdDeleteDialog.current.handleOpen(r)}}},{key:"deleteFlavorList",value:function(e){var t=this,a=e.selected_rows,r=e.flavors;a.data.map((function(e){var a=e.dataIndex;t.deleteFlavor(r[a])}))}},{key:"deleteFlavor",value:function(e){var t=f.a.fetchSafeFromObject({path:["_links","self","href"],obj:e,default_value:""}),a=this;R({apiurl:t,method:w.method.DELETE}).then((function(){a.fetchFlavorList(),_n({msg:"Flavor ( ".concat(e.label.name," ) successfully deleted"),variant:"success"})})).catch((function(){_n({msg:"Failed to delete the flavor ".concat(e.label.name),variant:"error"})}))}},{key:"enableOrDisableFlavor",value:function(e){var t=e.action,a=e.flavor,r=f.a.fetchSafeFromObject({path:["_links","self","href"],obj:a,default_value:""}),n=this;R({apiurl:r,method:w.method.POST,data:"Enable"===t?{action:"enable"}:{action:"disable"}}).then((function(){n.fetchFlavorList();var e="Enable"===t?"enabled":"disabled";_n({msg:"Flavor ( ".concat(a.label.name," ) ")+e+" successfully",variant:"success"})})).catch((function(){_n({msg:"Failed to "+("Enable"===t?"enable":"disable")+" the flavor ".concat(a.label.name),variant:"error"})}))}},{key:"render",value:function(){var e=a.getMeta(),t=this.getFlavorTableSettings(),r=this.state,o=r.method_actions,i=r.formTitle,s=r.formName,c=r.formDescription;return n.a.createElement("div",{className:"FlavorsPage"},n.a.createElement(Al.a,{title:e.title,description:e.description,link:e.link,meta:e.meta}),n.a.createElement(Nt,{title:"Flavor Management"}),n.a.createElement(sa,t),n.a.createElement(Jn,{form_id:"manageFlavorForm",Title:i,name:s,description:c,form_schema:Rf,ui_schema:Nf,method_actions:o,formData:{},success_msg:er({path:["flavor","success_msg"]}),failure_msg:er({path:["flavor","failure_msg"]}),preProcessData:Af,callBack:this.callBack,validate:this.validateFlavor,ref:this.bdModalFormChild}),n.a.createElement(no,{ref:this.bdDeleteDialog}))}}]),a}(r.Component);Pf(Ff,"propTypes",{classes:u.a.object.isRequired,dispatch:u.a.func.isRequired,page_data:u.a.object,stats_data:u.a.object});var xf=d()(he()((function(){return{}}),{name:"App"}),Object(s.b)((function(e){var t=e.stats_data,a=void 0===t?{}:t,r=e.page_data;return{stats_data:a,page_data:void 0===r?{}:r}})))(Ff);function Mf(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}var If=function e(t){var a=t.config_choices,r=t.choice_id,n=r;return a.some((function(t){if(r===t.id)return n=f.a.fetchSafeFromObject({path:["label","name"],obj:t,default_value:n}),!0;t.selections&&t.selections.some((function(t){var a=f.a.fetchSafeFromObject({path:["config","config_choices"],obj:t,default_value:[]});a.length&&(n=e({config_choices:a,choice_id:r}))}))})),n},Uf=function(e){var t=e.cluster_id,a=e.cluster_type,r=e.action,n=void 0===r?"":r;if("action_scripts"===n)return w.views.aimlClusterDashboard.makeUrl({id:t})+"#actionScripts";var o="edit"===n;switch(a){case"Training":return o?w.views.createEditTraining.editUrl({id:t}):w.views.createEditTraining.url;case"Notebook":return o?w.views.createEditNotebook.editUrl({id:t}):w.views.createEditNotebook.url;default:return o?w.views.createEditDeployment.editUrl({id:t}):w.views.createEditDeployment.url}},Lf=function(e){var t=e.cluster,a=e.callback,r=e.category,o=void 0===r?"":r,i=f.a.fetchSafeFromObject({path:["_links","self","href"],obj:t,default_value:""});i&&R({apiurl:i,method:w.method.DELETE}).then((function(){if(a&&a(),_n({msg:"Delete operation successfully started for cluster ( ".concat(t.label.name," )"),variant:"success"}),o){var e=o&&Bf({CLUSTER_TYPE:o});setTimeout((function(){window.location.href=w.views[e].url}),3e3)}})).catch((function(e){var a=f.a.parseAxiosError({error:e}),r=n.a.createElement(ns,{errors:["Failed to delete the cluster ".concat(t.label.name),a]});_n({msg:r,variant:"error"})}))},Bf=function(e){var t=e.CLUSTER_TYPE;return"AIML/Training"===t?"trainings":"AIML/Notebook"===t?"notebooks":"AIML/Deployment"===t?"deployments":"clusters"},Hf={"AIML/Notebook":{id:"clusters",title:"Associate with Training Environments"},"AIML/Deployment":{id:"models",title:"Select Model"}},Kf={clusterHasNodes:function(e){var t=!1;if(!(t=f.a.fetchSafeFromObject({path:["nodegroup","role_configs"],obj:e,default_value:[]}).find((function(e){return e.node_count})))){var a=e.dependent_nodegroups;a&&a.length&&(t=a.find((function(e){return e.role_configs.find((function(e){return e.node_count}))})))}return!!t},getChoiceLabel:function(e){var t=e.choice_id,a=e.distro,r=f.a.fetchSafeFromObject({obj:a,path:["config","config_choices"],default_value:[]});return If({config_choices:r,choice_id:t})},getStatusLabelOptions:function(e){var t=e.status,a=e.status_message,r=e.error_info,n={status:t,title:t};switch(t){case"delete_in_progress":n.title="deleting";break;case"service_down":n.title="ready",n.tooltip="Some services are down";break;case"updating_services":n.title="updating services";break;case"ready":n.tooltip="All services OK";break;case"updating_attachments":n.title="updating attachments"}return a&&r&&(n.alert_title=a,n.alert_message=r),n},getClusterActionButtons:function(e){var t=e.status,a=e.hasNodes,r=e.cluster_id,n=e.cluster_type,o=[{action:"start",btn_type:"power_ops",icon:"icon-chevron-right",title:"Start ".concat(n),variant:"success",requireNodes:!0},{action:"stop",btn_type:"power_ops",icon:"icon-square",title:"Stop ".concat(n),variant:"warning",requireNodes:!0},{action:"reboot",btn_type:"power_ops",icon:"icon-sync",title:"Reboot ".concat(n),variant:"warning",requireNodes:!0},{action:"delete",btn_type:"power_ops",icon:"icon-trash2",title:"Delete ".concat(n),variant:"error",requireNodes:!1},{action:"edit",btn_type:"link",icon:"icon-pencil3",title:"Edit ".concat(n),variant:"primary",url:Uf({cluster_id:r,cluster_type:n,action:"edit"}),requireNodes:!1},{action:"attach",btn_type:"reattach",icon:"icon-window",title:"Update ".concat("Deployment"===n?"model":"cluster"," attachments"),variant:"info",requireNodes:!0},{action:"hostdata",btn_type:"general_ops",icon:"icon-desktop",title:"Host file info",variant:"info",requireNodes:!0},{action:"action_scripts",btn_type:"link",icon:"icon-file-code",title:"Manage ActionScripts",variant:"primary",url:Uf({cluster_id:r,cluster_type:n,action:"action_scripts"}),requireNodes:!1},{action:"log",btn_type:"general_ops",icon:"icon-cli",title:"Setup log info",variant:"info",requireNodes:!1}],i={start:["stopped"],stop:["ready","service_down","warning"],reboot:["ready","service_down","warning"],attach:["ready","service_down","warning"],delete:["starting","ready","service_down","warning","updating","rebooting","restarting","stopping","stopped","error"],edit:["ready","service_down","warning","stopped"],hostdata:["starting","ready","service_down","warning","updating","rebooting","restarting","stopping","stopped","error","updating_services","updating_attachments"],action_scripts:["ready","service_down","warning"],log:["ready","service_down","warning","updating","rebooting","restarting","stopping","stopped","error","updating_services","updating_attachments"],template:["starting","ready","service_down","warning","updating","rebooting","restarting","stopping","stopped"],services_update:["ready","service_down","warning"],download_endpoints:["ready","service_down","warning","updating","rebooting","restarting","stopping","stopped","error"]};return o.filter((function(e){if(i[e.action].includes(t))return"attach"===e.action?a&&!["Training","Notebook"].includes(n):!e.requireNodes||a}))},createDistroListByType:function(e){var t=e.independent_catalog_entries,a={};return t.map((function(e){e.categories.map((function(t){a[t]||(a[t]=[]),a[t].push(e)}))})),a},liveUpdateClusters:function(e){var t=["created","starting","updating","rebooting","restarting","stopping","delete_in_progress","service_down","migrating","updating_services","updating_attachments"];return e.find((function(e){return t.includes(e.status)}))},clusterPowerOps:function(e){var t=e.cluster_info,a=e.action,r=e.callback,n=t.cluster_id,o=t.label,i={operation:"power_op",change_spec:{action:a}};"start"!==a&&"stop"!==a&&"reboot"!==a||R({method:w.method.POST,apiurl:w.apiurl.CLUSTER_CHANGE_TASK(n),data:i}).then((function(){r(),_n({msg:"".concat(a," operation successfully started for cluster ( ").concat(o.name," )"),variant:"success"})})).catch((function(){_n({msg:"Failed to ".concat(a," the cluster ").concat(o.name),variant:"error"})}))},deleteSelectedClusterList:function(e){var t=e.selected_rows,a=e.clusters,r=e.callback;t.data.map((function(e){var t=e.dataIndex;Lf({cluster:a[t],callback:r})}))},deleteSelectedCluster:Lf,getClusterActionUrl:Uf,filterSelectedClusterType:function(e){var t=e.cluster_list,a=e.CLUSTER_TYPE;return f.a.fetchSafeFromObject({path:["_embedded","clusters"],obj:t,default_value:[]}).filter((function(e){return f.a.fetchSafeFromObject({path:["nodegroup","intended_categories"],obj:e,default_value:""}).includes(a)}))},getViewKey:Bf,attachSupportList:Hf,getUpdateAttachmentFormData:function(e){var t=e.cluster,a=e.attachmentNames,r=e.CLUSTER_TYPE;if(!Object.keys(Hf).includes(r))return{};var n=f.a.fetchSafeFromObject({path:["_links","self","href"],obj:t,default_value:""}),o="AIML/Deployment"===r,i=t.attachments,s=void 0===i?{}:i,c=Hf[r].id,l=o?"attachmentModelDescription":"attachmentClusterDescription";return{formData:s,form_schema:{type:"object",properties:Mf({},c,{type:"array",title:Hf[r].title,description:er({path:["createEditCluster",l]}),default:f.a.fetchSafeFromObject({path:[c],obj:s,default_value:[]}),minItems:0,items:{type:"string",enum:Object.keys(a),enumNames:Object.keys(a).map((function(e){return a[e]}))},uniqueItems:!0})},preProcessData:function(e){return{operation:"reattach",change_spec:{attachments:e}}},variant:"trim",clusterApiUrl:n}}},qf=function(e){return{link:e.bdMixins.Link,preserveWhitespace:e.bdMixins.PreserveWhitespace,dataTitle:{display:"flex",justifyContent:"space-between",alignItems:"center"},clusterCreateBtn:{marginRight:.5*e.spacing.unit},clusterStatus:{paddingLeft:e.spacing.unit,display:"flex",alignItems:"flex-end"}}};function Vf(e){return(Vf="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Gf(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function zf(e,t){for(var a=0;a<t.length;a++){var r=t[a];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Wf(e,t){return(Wf=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Jf(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=$f(e);if(t){var n=$f(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return Yf(this,a)}}function Yf(e,t){return!t||"object"!==Vf(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function $f(e){return($f=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var Qf=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Wf(e,t)}(i,e);var t,a,r,o=Jf(i);function i(){return Gf(this,i),o.apply(this,arguments)}return t=i,(a=[{key:"render",value:function(){var e=this.props,t=e.cluster_id,a=void 0===t?"":t,r=e.label,o=e.role_name,i=e.hasNodes,s=void 0!==i&&i,c=e.status,l=r.name,u=void 0===l?"":l,p=r.description,d=void 0===p?"":p,f=w.views.aimlClusterDashboard.makeUrl({id:a}),m=function(e){var t=e.role_name,a=e.hasNodes,r=e.to,o=e.name;return"Site Admin"!==t&&a&&"delete_in_progress"!==c?n.a.createElement(lo.a,{to:r,className:"link"},o):n.a.createElement(st.a,{variant:"body2"},o)};return n.a.createElement("span",null,d?n.a.createElement(ka,{title:d,variant:"primary"},n.a.createElement(m,{role_name:o,hasNodes:s,to:f,name:u})):n.a.createElement(m,{role_name:o,hasNodes:s,to:f,name:u}))}}])&&zf(t.prototype,a),r&&zf(t,r),i}(r.Component);!function(e,t,a){t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a}(Qf,"propTypes",{cluster_id:u.a.string,label:u.a.object,role_name:u.a.string,hasNodes:u.a.bool,status:u.a.string});var Zf=Qf;function Xf(e){return(Xf="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function em(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function tm(e,t){for(var a=0;a<t.length;a++){var r=t[a];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function am(e,t){return(am=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function rm(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=om(e);if(t){var n=om(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return nm(this,a)}}function nm(e,t){return!t||"object"!==Xf(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function om(e){return(om=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var im=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&am(e,t)}(i,e);var t,a,r,o=rm(i);function i(){return em(this,i),o.apply(this,arguments)}return t=i,(a=[{key:"render",value:function(){var e=this.props,t=e.role,a=void 0===t?{}:t,r=e.classes,o=f.a.fetchSafeFromObject({path:["flavor"],obj:a,default_value:{}}),i=f.a.fetchSafeFromObject({path:["label","name"],obj:o,default_value:""}),s=n.a.createElement("span",{className:r.icon},n.a.createElement(xe,{name:"moreInfo",className:r.spacing,type:"icon"}));return n.a.createElement(st.a,{variant:"body1"},"".concat(a.role_id,"(").concat(a.node_count||0,"/").concat(i||"...",")"),n.a.createElement(xa,{title:s},n.a.createElement("div",{className:"header"},n.a.createElement(st.a,{variant:"h5"},"Distribution","1"!==a.nodegroup_id?"(Dependent)":"",": ",a.distro)),n.a.createElement("div",{className:"content"},n.a.createElement(st.a,{variant:"body1"},"Role : ",a.role_id),n.a.createElement(st.a,{variant:"body1"},"Node Count : ",a.node_count),n.a.createElement(st.a,{variant:"body1"},"Flavor : ",_f.getFlavorLabel(o)))))}}])&&tm(t.prototype,a),r&&tm(t,r),i}(r.Component);!function(e,t,a){t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a}(im,"propTypes",{classes:u.a.object,role:u.a.object});var sm=he()((function(e){return{icon:{paddingLeft:.5*e.spacing.unit,fill:e.palette.gray600,verticalAlign:"middle"}}}))(im);function cm(e){return(cm="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function lm(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function um(e,t){for(var a=0;a<t.length;a++){var r=t[a];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function pm(e,t){return(pm=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function dm(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=mm(e);if(t){var n=mm(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return fm(this,a)}}function fm(e,t){return!t||"object"!==cm(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function mm(e){return(mm=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var hm=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&pm(e,t)}(i,e);var t,a,r,o=dm(i);function i(){return lm(this,i),o.apply(this,arguments)}return t=i,(a=[{key:"render",value:function(){var e=this.props,t=e.distro_config,a=void 0===t?{}:t,r=e.classes,o=a.catalog_entry_label,i=(o=void 0===o?{}:o).description,s=void 0===i?"":i,c=o.name,l=void 0===c?"":c,u=a.catalog_entry_distro_id,p=void 0===u?"":u,d=a.catalog_entry_version,f=void 0===d?"":d,m=a.catalog_entry_state,h=void 0===m?"":m,b=a.isDependentDistro,v=void 0!==b&&b,y=n.a.createElement("span",{className:r.icon},n.a.createElement(xe,{name:"moreInfo",className:r.spacing,type:"icon"}));return n.a.createElement(st.a,{variant:"body1"},v?"Dependent Distro: ":"",l,n.a.createElement(xa,{title:y},n.a.createElement("div",{className:"header"},n.a.createElement(st.a,{variant:"h5"},v?"Add-On Image Information":"RunTime Image Information")),n.a.createElement("div",{className:"content"},n.a.createElement(st.a,{variant:"body1"},"Description : ",s),n.a.createElement(st.a,{variant:"body1"},"Distro id : ",p),n.a.createElement(st.a,{variant:"body1"},"Version : ",f),n.a.createElement(st.a,{variant:"body1"},"State : ",h))))}}])&&um(t.prototype,a),r&&um(t,r),i}(r.Component);!function(e,t,a){t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a}(hm,"propTypes",{classes:u.a.object,distro_config:u.a.object});var bm=he()((function(e){return{icon:{paddingLeft:.5*e.spacing.unit,fill:e.palette.gray600,verticalAlign:"middle"}}}))(hm);function vm(e){return(vm="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function ym(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function gm(e,t){for(var a=0;a<t.length;a++){var r=t[a];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function _m(e,t){return(_m=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Sm(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=Om(e);if(t){var n=Om(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return km(this,a)}}function km(e,t){return!t||"object"!==vm(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Om(e){return(Om=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var Em=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&_m(e,t)}(i,e);var t,a,r,o=Sm(i);function i(){return ym(this,i),o.apply(this,arguments)}return t=i,(a=[{key:"render",value:function(){var e=this.props,t=e.config_choices,a=e.distro;return n.a.createElement(xi.a,null,n.a.createElement(Ii.a,{expandIcon:n.a.createElement("span",{className:"icon icon-chevron-down"})},n.a.createElement(st.a,{variant:"h6"},"Config Choices")),n.a.createElement(Li.a,null,t.map((function(e){var t=e.choice_id,r=Kf.getChoiceLabel({distro:a,choice_id:t});return n.a.createElement(st.a,{variant:"body1",key:t},"".concat(r," : ").concat(e.selection_id))}))))}}])&&gm(t.prototype,a),r&&gm(t,r),i}(r.Component);!function(e,t,a){t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a}(Em,"propTypes",{config_choices:u.a.array.isRequired,distro:u.a.object});var jm=Em;function Dm(e){return(Dm="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function wm(){return(wm=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var r in a)Object.prototype.hasOwnProperty.call(a,r)&&(e[r]=a[r])}return e}).apply(this,arguments)}function Cm(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function Tm(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?Cm(Object(a),!0).forEach((function(t){Mm(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):Cm(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function Pm(e,t){for(var a=0;a<t.length;a++){var r=t[a];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Am(e,t){return(Am=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Rm(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=xm(e);if(t){var n=xm(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return Nm(this,a)}}function Nm(e,t){return!t||"object"!==Dm(t)&&"function"!=typeof t?Fm(e):t}function Fm(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function xm(e){return(xm=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Mm(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}var Im=er({path:["updateAttachments"]}),Um=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Am(e,t)}(i,e);var t,a,r,o=Rm(i);function i(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),(t=o.call(this,e)).updateClusterData=t.updateClusterData.bind(Fm(t)),t.downloadData=t.downloadData.bind(Fm(t)),t.getHostData=t.getHostData.bind(Fm(t)),t.getLogData=t.getLogData.bind(Fm(t)),t.onClickScalingPolicy=t.onClickScalingPolicy.bind(Fm(t)),t.downLoadKeyPair=t.downLoadKeyPair.bind(Fm(t)),t.onClickUpdateAttachments=t.onClickUpdateAttachments.bind(Fm(t)),t.clusterPowerOpDialog=n.a.createRef(),t.bdModalChildRef=n.a.createRef(),t.bdModalFormChildRef=n.a.createRef(),t.state={modalData:{},modalFormData:{}},t}return t=i,(a=[{key:"componentDidMount",value:function(){}},{key:"updateClusterData",value:function(){(0,this.props.fetchClusterData)()}},{key:"getDistro",value:function(e){var t=e.distro_id,a=this.props.catalog_list,r=void 0===a?{}:a,n=f.a.fetchSafeFromObject({path:["_embedded","independent_catalog_entries"],obj:r,default_value:[]}).find((function(e){return e.distro_id===t}));return n||(n=f.a.fetchSafeFromObject({path:["_embedded","dependent_catalog_entries"],obj:r,default_value:[]}).find((function(e){return e.distro_id===t}))||{}),n}},{key:"getHostData",value:function(e,t,a){var r=this,o=e.cluster_id,i=e.label,s=this.props.classes;R({method:w.method.GET,apiurl:w.apiurl.CLUSTER_NODES(o)}).then((function(o){var c=f.a.fetchSafeFromObject({path:["data","_embedded","nodes"],obj:o,default_value:""}),l='# BEGIN HOSTS DATA FOR CLUSTER "'.concat(i.name,'" \n');c.map((function(e){var t=e.private_ip,a=e.public_ip,r=e.fqdn,n=t||a;n&&r&&(l+="".concat(n,"     ").concat(r," \n"))})),l+='# END HOSTS DATA FOR CLUSTER "'.concat(i.name,'" \n');var u={Title:n.a.createElement(Ia,null,n.a.createElement(St.Typography,{variant:"h4",className:s.dataTitle},t),n.a.createElement(ka,{title:"Download host data",variant:"primary"},n.a.createElement(Ue.a,{color:"primary",size:"small",onClick:r.downloadData(l,a,e)},n.a.createElement("span",{className:"icon icon-download2 icon-rect-link"})))),name:"Cluster host data",description:"Modal to display cluster's host data",content:n.a.createElement(St.Typography,{variant:"caption",className:s.preserveWhitespace},l)};r.setState({modalData:u},(function(){r.bdModalChildRef.current.handleOpen()}))})).catch((function(e){_n({msg:"Failed to show ".concat(t,". ").concat(e),variant:"error"})}))}},{key:"getLogData",value:function(e,t,a){var r=this,o=e.log_url,i=this.props.classes;R({op:w.op.GET_CLUSTER_LOG_DATA,data:{log_url:o}}).then((function(o){var s={Title:n.a.createElement(Ia,null,n.a.createElement(St.Typography,{variant:"h4",className:i.dataTitle},t),n.a.createElement(ka,{title:"Download Log",variant:"primary"},n.a.createElement(Ue.a,{color:"primary",size:"small",onClick:r.downloadData(o.data,a,e)},n.a.createElement("span",{className:"icon icon-download2 icon-rect-link"})))),name:"Setup log info",description:"Modal to display setup log info",content:n.a.createElement(St.Typography,{variant:"caption",className:i.preserveWhitespace},o.data)};r.setState({modalData:s},(function(){r.bdModalChildRef.current.handleOpen()}))})).catch((function(e){_n({msg:"Failed to show ".concat(t,". ").concat(e),variant:"error"})}))}},{key:"onClickScalingPolicy",value:function(e){var t=this,a=e.scale_policy,r=this.props.classes,o={Title:n.a.createElement(Ia,null,n.a.createElement(St.Typography,{variant:"h4",className:r.dataTitle},"Scaling Policy"),n.a.createElement(ka,{title:"Download Scaling Policy",variant:"primary"},n.a.createElement(Ue.a,{color:"primary",size:"small",onClick:this.downloadData(a,"scale_policy")},n.a.createElement("span",{className:"icon icon-download2 icon-rect-link"})))),name:"Scaling Policy",description:"Modal to display scaling policy",content:n.a.createElement(St.Typography,{variant:"caption",className:r.preserveWhitespace},a)};this.setState({modalData:o},(function(){t.bdModalChildRef.current.handleOpen()}))}},{key:"downloadData",value:function(e,t,a){return function(){var r="";if("scale_policy"===t){var n=JSON.parse(e);r="".concat(n.name||"cluster_scale_policy",".json")}else{var o=f.a.fetchSafeFromObject({path:["label","name"],obj:a,default_value:""}),i="log"===t?"setuplog":"hostfile";r="Cluster_".concat(o,"_").concat(i,".txt")}e?f.a.downloadOrSaveData(e,r,"text/txt"):_n({msg:"Data to download is empty",variant:"error"})}}},{key:"downLoadKeyPair",value:function(){var e=this.props,t=e.tenant,a=e.tenant_name;if(t){var r=w.apiurl.PRIVATEKEY(t);R({apiurl:r}).then((function(e){var t=f.a.fetchSafeFromObject({path:["data","private_key"],obj:e,default_value:""}),r="BD_".concat(a.replace(/\s+/g,"-"),".pem");t?f.a.downloadOrSaveData(t,r,"application/text"):_n({msg:"Data to download is empty",variant:"error"})})).catch((function(e){var t=f.a.parseAxiosError({error:e}),r=n.a.createElement(ns,{errors:["Exception while trying to get keypair for tenant ".concat(a),t]});_n({msg:r,variant:"error"})}))}}},{key:"onClickUpdateAttachments",value:function(e){var t=this,a=e.cluster_id,r=this.props,n=r.attachmentNames,o=r.clusters,i=r.CLUSTER_TYPE,s=o.find((function(e){return f.a.fetchSafeFromObject({path:["_links","self","href"],obj:e,default_value:""})===a})),c=Kf.getUpdateAttachmentFormData({cluster:s,attachmentNames:n,CLUSTER_TYPE:i});this.setState({modalFormData:c},(function(){t.bdModalFormChildRef.current.openModal()}))}},{key:"getClusterTableSettings",value:function(){var e=this,t=this.props,a=t.clusters,r=t.CLUSTER_TYPE,o=void 0===r?"cluster":r,i=t.attachmentNames,s=void 0===i?{}:i,c=t.classes,l=t.is_cluster_superuser,u=t.current_tenant_data,p=(u=void 0===u?{}:u).status,d=void 0===p?"":p,m=o.split("AIML/").pop();return{columns:[{name:"Name",options:{filter:!0,customBodyRender:function(e){var t=JSON.parse(e);return n.a.createElement(Zf,t)}}},{name:"Distribution",options:{filter:!0,customBodyRender:function(t){var a=JSON.parse(t),r=a.distro_id,o=a.config_choices,i=a.nodegroup,s=a.dependent_nodegroups,c=e.getDistro({distro_id:r}),l=o.length?n.a.createElement(jm,{config_choices:o,distro:c}):"";return n.a.createElement("div",{className:"py-2"},i?n.a.createElement(bm,{distro_config:i}):"",s?s.map((function(e){return e.isDependentDistro=!0,n.a.createElement(bm,{distro_config:e,key:e.id})})):"",l)}}},{name:"Role Configurations",options:{filter:!0,customBodyRender:function(e){var t=JSON.parse(e);return n.a.createElement("div",{className:"py-2"},t.map((function(e){return e.selected?n.a.createElement(sm,{role:e,key:"".concat(e.nodegroup_id,"_").concat(e.role_id)}):""})))}}},{name:"Details",options:{filter:!0,customBodyRender:function(t){var a=JSON.parse(t),r=a.created_time,o=void 0===r?"":r,i=a.created_by_user_name,s=void 0===i?"":i,c=a.debug,l=void 0!==c&&c,u=a.isolated,p=void 0!==u&&u,d=a.two_phase_delete,m=void 0!==d&&d,h=a.attachments,b=void 0===h?{}:h,v=a.classes,y=void 0===v?{}:v,g=a.scale_policy,_=void 0===g?{}:g,S=b.clusters,k=void 0===S?[]:S,O=b.models,E=void 0===O?[]:O;return n.a.createElement("div",{className:"py-2"},n.a.createElement(St.Typography,{variant:"body1"},"Created At: ",o),n.a.createElement(St.Typography,{variant:"body1"},"Created By: ",s),l?n.a.createElement(St.Typography,{variant:"body1"},"Debug: true"):"",p?n.a.createElement(St.Typography,{variant:"body1"},"Isolated: true"):"",m?n.a.createElement(St.Typography,{variant:"body1"},"Two Phase Delete: true"):"",k.length?n.a.createElement(St.Typography,{variant:"body1"},"Attached Cluster(s):",k.map((function(e){return n.a.createElement(lo.a,{key:e.id,to:w.views.aimlClusterDashboard.makeUrl({id:e.id}),className:y.link},e.name)})).reduce((function(e,t){return[e,", ",t]}))):"",E.length?n.a.createElement(St.Typography,{variant:"body1"},"Attached Model(s):",E.map((function(e){return n.a.createElement(lo.a,{key:e.id,to:w.views.createEditModel.editUrl({id:e.id}),className:y.link},e.name)})).reduce((function(e,t){return[e,", ",t]}))):"",f.a.isEmptyObject(_)?"":n.a.createElement(St.Typography,{variant:"body1",className:y.link,onClick:function(){e.onClickScalingPolicy({scale_policy:_})}},"Scaling Policy"))}}},{name:"Status",options:{filter:!0,customBodyRender:function(e){var t=JSON.parse(e),a=Kf.getStatusLabelOptions(t);return n.a.createElement(Qa,a)}}},{name:"Actions",options:{filter:!1,download:!1,customBodyRender:function(t){var a=JSON.parse(t),r=a.status,o=a.cluster_id,i=a.hasNodes,s=a.label,c=a.cluster_type,l=Kf.getClusterActionButtons({status:r,hasNodes:i,cluster_id:o,cluster_type:c}).filter((function(e){return"delete"!==e.action}));return n.a.createElement("div",{className:"row-action-btns"},l.map((function(t){var r=t.action,i=t.btn_type,l=t.icon,u=t.title,p=t.variant,d=t.url;return"power_ops"===i?n.a.createElement(ka,{title:u,variant:p,key:l},n.a.createElement("span",{className:se()("icon","icon-rect-link",l),onClick:function(){var t={callback:Kf.clusterPowerOps,context:{cluster_info:a,action:r,callback:e.updateClusterData},title:"",description:"Confirm '".concat(r,"' action  for ").concat(c," '").concat(s.name,"'")};e.clusterPowerOpDialog.current.handleOpen(t)}})):"link"===i?n.a.createElement(ka,{title:u,variant:p,key:l},n.a.createElement(lo.a,{to:d},n.a.createElement("span",{className:se()("icon","icon-rect-link",l)}))):"general_ops"===i?n.a.createElement(ka,{title:u,variant:p,key:l},n.a.createElement("span",{className:se()("icon","icon-rect-link",l),onClick:function(){"hostdata"===r?e.getHostData(a,u,r):"log"===r&&e.getLogData(a,u,r)}})):"reattach"===i&&"Notebook"!==c?n.a.createElement(ka,{title:u,variant:p,key:l},n.a.createElement("span",{className:se()("icon","icon-rect-link",l),onClick:function(){e.onClickUpdateAttachments({cluster_id:o})}})):void 0})))}}}],data:a.reduce((function(t,a){var r=e.props.role_name,n=a.nodegroup,o=void 0===n?{}:n,i=a.label,l=void 0===i?{}:i,u=a.dependent_nodegroups,p=void 0===u?[]:u,d=a.created_time,h=void 0===d?"unKnown (pre EPIC 3.0)":d,b=a.created_by_user_name,v=void 0===b?"unKnown (pre EPIC 3.0)":b,y=a.debug,g=a.isolated,_=a.two_phase_delete,S=a.attachments,k=a.status,O=a.status_message,E=a.error_info,j=a.log_url,D=a.scale_policy,C=f.a.fetchSafeFromObject({path:["_links","self","href"],obj:a,default_value:""}),T=o.catalog_entry_distro_id||"",P=f.a.fetchSafeFromObject({path:["config_choice_selections"],obj:o,default_value:[]}).filter((function(e){return e.selection_id})),A=Kf.clusterHasNodes(a),R=o.role_configs.map((function(e){return Tm({distro:f.a.fetchSafeFromObject({path:["catalog_entry_label","name"],obj:o,default_value:""}),nodegroup_id:o.id},e)}));p.map((function(e){e.role_configs.map((function(t){R.push(Tm({distro:f.a.fetchSafeFromObject({path:["catalog_entry_label","name"],obj:e,default_value:""}),nodegroup_id:e.id},t))}))}));var N={created_time:Fc.a.unix(h).format(w.settings.time_format),created_by_user_name:v,classes:c};if(y&&(N.debug=y),g&&(N.isolated=g),_&&(N.two_phase_delete=_),S){var F={};S.clusters&&S.clusters.length&&(F.clusters=S.clusters.map((function(e){return{id:e,name:s[e]}})).filter((function(e){return e.name}))),S.models&&S.models.length&&(F.models=S.models.map((function(e){return{id:e,name:s[e]}}))),N.attachments=F}return N.scale_policy=D,t.push([JSON.stringify({cluster_id:C,label:l,hasNodes:A,role_name:r,status:k}),JSON.stringify({distro_id:T,nodegroup:o,dependent_nodegroups:p,config_choices:P}),JSON.stringify(R),JSON.stringify(N),JSON.stringify({status:k,status_message:O,error_info:E}),JSON.stringify({status:k,cluster_id:C,isolated:g,hasNodes:A,label:l,cluster_type:m,log_url:j})]),t}),[]),options:{customToolbar:function(){var t=!!["Deployment","Training"].includes(m)&&"ready"!==d,a=n.a.createElement(Ue.a,{variant:"contained",color:"primary",disabled:t,component:lo.a,to:Kf.getClusterActionUrl({cluster_type:m}),className:c.clusterCreateBtn},"Create ",m);return n.a.createElement("div",{className:"tableActionButtons"},t?n.a.createElement(ka,{title:"Project repository must be initialized first to create ".concat(m),variant:"primary"},a):a,l?n.a.createElement(Ue.a,{variant:"contained",color:"primary",onClick:e.downLoadKeyPair},n.a.createElement("span",{className:"icon icon-download2"}),"Tenant KeyPair"):"")},customToolbarSelect:function(t){return n.a.createElement("div",{className:"tableActionButtonsSelected"},n.a.createElement(Ue.a,{variant:"contained",color:"secondary",onClick:function(){var a={callback:Kf.deleteSelectedClusterList,context:{selected_rows:t,clusters:e.props.clusters,callback:e.updateClusterData},title:"Delete selected ".concat(m,"(s)"),description:"Confirm deletion. This action cannot be undone."};e.clusterPowerOpDialog.current.handleOpen(a)}},"Delete"))}}}}},{key:"render",value:function(){var e=this,t=this.getClusterTableSettings(),a=this.state,r=a.modalData,o=void 0===r?{}:r,i=a.modalFormData,s=void 0===i?{}:i,c=Im.title,l=Im.name,u=Im.description,p=Im.success_msg,d=void 0===p?"":p,m=Im.failure_msg,h=void 0===m?"":m,b=this.props.CLUSTER_TYPE,v=f.a.fetchSafeFromObject({path:[b,"id"],obj:Kf.attachSupportList,default_value:""});return n.a.createElement("div",{className:"clusters-table-container"},n.a.createElement(sa,t),n.a.createElement(no,{ref:this.clusterPowerOpDialog}),n.a.createElement(In,wm({ref:this.bdModalChildRef},o,{footerCloseBtn:!0,onModalClose:function(){return e.setState({modalData:{}})}}),o.content),Object.keys(Kf.attachSupportList).includes(b)?n.a.createElement(Jn,wm({form_id:"updateAttachments",Title:n.a.createElement(St.Typography,{variant:"h2"},c(v)),name:l(v),description:u(v),method_actions:[{method:w.method.POST,action:w.apiurl.CLUSTER_CHANGE_TASK(s.clusterApiUrl||"#"),data:"FORM_DATA"}]},s,{success_msg:d,failure_msg:h,callBack:this.updateClusterData,ref:this.bdModalFormChildRef})):"")}}])&&Pm(t.prototype,a),r&&Pm(t,r),i}(r.Component);Mm(Um,"propTypes",{classes:u.a.object.isRequired,clusters:u.a.array,fetchClusterData:u.a.func,catalog_list:u.a.object,role_name:u.a.string,CLUSTER_TYPE:u.a.string,attachmentNames:u.a.object,tenant:u.a.string,tenant_name:u.a.string,is_cluster_superuser:u.a.bool,current_tenant_data:u.a.object});var Lm=he()(qf)(Um);function Bm(e){return(Bm="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Hm(){return(Hm=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var r in a)Object.prototype.hasOwnProperty.call(a,r)&&(e[r]=a[r])}return e}).apply(this,arguments)}function Km(e,t){for(var a=0;a<t.length;a++){var r=t[a];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function qm(e,t,a){return t&&Km(e.prototype,t),a&&Km(e,a),e}function Vm(e,t){return(Vm=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Gm(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=Jm(e);if(t){var n=Jm(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return zm(this,a)}}function zm(e,t){return!t||"object"!==Bm(t)&&"function"!=typeof t?Wm(e):t}function Wm(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Jm(e){return(Jm=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Ym(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}var $m=w.clusterTypes.notebook,Qm=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Vm(e,t)}(a,e);var t=Gm(a);function a(e){var r;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,a),Ym(Wm(r=t.call(this,e)),"timeout",null),r.fetchClusterData=r.fetchClusterData.bind(Wm(r)),r.getUserNotebooks=r.getUserNotebooks.bind(Wm(r)),r}return qm(a,null,[{key:"getMeta",value:function(){return{title:"".concat(w.APP_TITLE.ML_OPS," | Notebooks"),link:[{rel:"canonical",href:"".concat(w.serverUrl).concat(w.views.deployments.url)}],meta:[{charset:"utf-8"},{name:"description",content:"Manage Notebooks clusters."}]}}}]),qm(a,[{key:"componentDidMount",value:function(){var e=this.props.dispatch;this.fetchClusterData(),e(Q(oe.CATALOG_DATA))}},{key:"componentWillUnmount",value:function(){clearTimeout(this.timeout)}},{key:"fetchClusterData",value:function(){var e=this,t=this;(0,this.props.dispatch)(Q(oe.CLUSTER_DATA)).then((function(){var a=e.getUserNotebooks();Kf.liveUpdateClusters(a)&&(e.timeout=setTimeout((function(){t.fetchClusterData()}),3e4))}))}},{key:"getUserNotebooks",value:function(){var e=this.props,t=e.page_data,a=(t=void 0===t?{}:t).cluster_list,r=void 0===a?{}:a,n=e.stats_data,o=(n=void 0===n?{}:n).session_data,i=void 0===o?{}:o,s=i.user,c=void 0===s?"":s,l=i.role_name,u=void 0===l?"":l,p=Kf.filterSelectedClusterType({cluster_list:r,CLUSTER_TYPE:$m});return"Admin"===u?p:p.filter((function(e){return e.created_by_user===c}))}},{key:"render",value:function(){var e=a.getMeta(),t=this.props,r=t.page_data,o=(r=void 0===r?{}:r).catalog_list,i=void 0===o?{}:o,s=r.cluster_list,c=void 0===s?{}:s,l=t.stats_data,u=(l=void 0===l?{}:l).session_data,p=void 0===u?{}:u,d=p.role_name,m=void 0===d?"":d,h=this.getUserNotebooks(),b=f.a.fetchSafeFromObject({path:["_embedded","clusters"],obj:c,default_value:[]}).reduce((function(e,t){if(f.a.fetchSafeFromObject({path:["nodegroup","intended_categories"],obj:t,default_value:[]}).includes("AIML/Training")){var a=f.a.fetchSafeFromObject({path:["_links","self","href"],obj:t,default_value:""}),r=f.a.fetchSafeFromObject({path:["label","name"],obj:t,default_value:""});a&&r&&(e[a]=r)}return e}),{});return n.a.createElement("div",{className:"NotebooksPage"},n.a.createElement(Al.a,{title:e.title,description:e.description,link:e.link,meta:e.meta}),n.a.createElement(Nt,{title:"Notebooks"}),n.a.createElement(Lm,Hm({catalog_list:i,clusters:h,role_name:m,CLUSTER_TYPE:$m,fetchClusterData:this.fetchClusterData,attachmentNames:b},p)))}}]),a}(r.Component);Ym(Qm,"propTypes",{classes:u.a.object.isRequired,dispatch:u.a.func.isRequired,stats_data:u.a.object,page_data:u.a.object});var Zm=d()(he()(qf,{name:"App"}),Object(s.b)((function(e){var t=e.stats_data,a=void 0===t?{}:t,r=e.page_data;return{stats_data:a,page_data:void 0===r?{}:r}})))(Qm),Xm=er({path:["actionScript"]}),eh=function(e,t,a,r){var n=e.label,o=(n=void 0===n?{}:n).name,i=void 0===o?"":o,s=e.cmd,c=void 0===s?"":s,l=e.nodegroup_id,u=void 0===l?t[0].enum[0]:l,p=e.roles,d=void 0===p?[]:p,f=e.as_root,m=void 0===f||f,h=e.source,b=void 0===h?c?"cmd":"file":h;return{type:"object",properties:{label:{type:"object",properties:{name:{type:"string",title:"Action Name",description:Xm.labelNameDescription,default:i,bd_required:!0},description:{type:"string",hidden:!0}}},source:{type:"string",title:"Script Source",description:Xm.sourceDescription,oneOf:[{type:"string",enum:["file"],title:"Upload script file"},{type:"string",enum:["cmd"],title:"Type script commands"}],default:b},dependent_scripts:{type:"array",uniqueItems:!0,title:"Dependent scripts/files",description:Xm.dependentScriptsDescription,items:{type:"string",format:"data-url"}},nodegroup_id:{type:"number",title:"Node Group",description:Xm.nodegroupIdDescription,oneOf:t,hidden:1===t.length,default:u,bd_required:!0},roles:{type:"array",title:"Node Roles",description:Xm.rolesDescription,uniqueItems:!0,items:{type:"string",enum:a},default:d},as_root:{type:"boolean",title:"Run as root",description:Xm.asRootDescription,default:m,help:Xm.runAsRoot_selected,helpVariant:"helpInfo",hidden:!r}}}},th=function(e){return{label:{name:f.a.fetchSafeFromObject({path:["properties","label","properties","name","default"],obj:e,default_value:""})},source:f.a.fetchSafeFromObject({path:["properties","source","default"],obj:e,default_value:""}),nodegroup_id:f.a.fetchSafeFromObject({path:["properties","nodegroup_id","default"],obj:e,default_value:""}),roles:f.a.fetchSafeFromObject({path:["properties","roles","default"],obj:e,default_value:[]}),as_root:f.a.fetchSafeFromObject({path:["properties","as_root","default"],obj:e,default_value:""})}},ah=function(e){var t=e.formSchema,a=void 0===t?{}:t,r=e.bootstrap_action,n=void 0===r?{}:r,o=e.uiSchema,i=void 0===o?{}:o;return"file"===n.source?(a.script={type:"string",format:"data-url",title:"Script",description:Xm.scriptDescription,bd_required:!0},a.args={type:"string",title:"Arguments",description:Xm.argsDescription},i["ui:order"]=["label","source","script","args","dependent_scripts","nodegroup_id","roles","as_root"],i.script={"ui:rootFieldId":"bootstrap_action_script"},delete a.cmd,delete n.cmd,delete i.cmd):(a.cmd={type:"string",title:"Command",description:Xm.cmdDescription,bd_required:!0,bd_widget:"textarea"},i["ui:order"]=["label","source","cmd","dependent_scripts","nodegroup_id","roles","as_root"],delete a.script,delete a.args,delete n.script,delete n.args),{formSchema:a,bootstrap_action:n,uiSchema:i}},rh=function(e,t){if(t.label){var a=e.label,r=(a=void 0===a?{}:a).name,n=void 0===r?"":r,o=e.source,i=e.script,s=e.cmd;n||t.label.name.addError("Please provide valid action name."),"file"===o?!i&&t.script&&t.script.addError("Please provide valid script file."):!s&&t.cmd&&t.cmd.addError("Please provide valid command scripts.")}return t},nh=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],r=[];r.push({type:"number",title:f.a.fetchSafeFromObject({path:["label","name"],obj:t,default_value:f.a.fetchSafeFromObject({path:["nodegroup","catalog_entry_label","name"],obj:e,default_value:""})}),enum:[1]});var n=e.dependent_nodegroups,o=void 0===n?[]:n;return o.map((function(e){var t=e.catalog_entry_distro_id,n=void 0===t?"":t,o=e.id,i=void 0===o?"":o,s=e.useDistro,c=void 0!==s&&s,l=f.a.fetchSafeFromObject({path:["catalog_entry_label","name"],obj:e,default_value:""});c&&(l=f.a.fetchSafeFromObjectArray({arr:a,path:["catalog_entry_distro_id"],match:n,get:["catalog_entry_label","name"],default_value:l})),l&&r.push({type:"number",title:l,enum:[parseInt(i,10)]})})),r},oh=function(e,t){var a=[],r=t||f.a.fetchSafeFromObject({path:["advanced_settings","bootstrap_action","nodegroup_id"],obj:e,default_value:1});if(1===r){var n=f.a.fetchSafeFromObject({path:["nodegroup","role_configs"],obj:e,default_value:[]});f.a.bdSort(n,["role_id"]).map((function(e){a.push(e.role_id)}))}else{var o=e.dependent_nodegroups;(void 0===o?[]:o).some((function(e){if(e.id===r){var t=e.role_configs,n=void 0===t?[]:t;return f.a.bdSort(n,["role_id"]).map((function(e){a.push(e.role_id)})),!0}}))}return a},ih=function(e,t,a){return new Promise((function(r,n){var o=!1;if(e.length){var i=new FormData;e.forEach((function(e){if(e.files.length){o=!0;var t=e.getAttribute("id");t.includes("dependent_scripts")?Array.from(e.files).forEach((function(e){i.append("dependent_scripts",e)})):t.includes("script")&&i.append("script",e.files[0])}})),o&&Xo({op:w.op.BOOTSTRAP_ACTION_SCRIPT,formData:i,opts:{action_name:t,cluster_name:a},events:{onReadyStateChange:function(e){if(4===e.target.readyState){var t=e.target.response;if(e.target.status>=200&&e.target.status<=207){var a=JSON.parse(t);r(a)}else n(t)}},onError:function(e){var t=e.target.response;n(t)}}})}!o&&r({})}))},sh=function(e){var t=e.formSchema,a=void 0===t?{}:t,r=e.bootstrap_action,n=(void 0===r?{}:r).as_root,o=void 0!==n&&n;return a.as_root.help=o?Xm.runAsRoot_selected:Xm.runAsRoot_deselected,{formSchema:a}};function ch(e){return function(e){if(Array.isArray(e))return lh(e)}(e)||function(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||function(e,t){if(!e)return;if("string"==typeof e)return lh(e,t);var a=Object.prototype.toString.call(e).slice(8,-1);"Object"===a&&e.constructor&&(a=e.constructor.name);if("Map"===a||"Set"===a)return Array.from(e);if("Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a))return lh(e,t)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function lh(e,t){(null==t||t>e.length)&&(t=e.length);for(var a=0,r=new Array(t);a<t;a++)r[a]=e[a];return r}function uh(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function ph(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?uh(Object(a),!0).forEach((function(t){dh(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):uh(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function dh(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}var fh=function(e){return e.length?e.map((function(e){var t=ph({},e);return e.tag_value||("equal"===e.operator&&(t.operator="is-set"),"not-equal"===e.operator&&(t.operator="is-unset")),t})):[]},mh=function(e){return e.role_configs.map((function(e){var t=e.role_id,a=void 0===t?"":t,r=e.node_count,n=void 0===r?"":r,o=e.flavor,i=void 0===o?{}:o;return{role_id:a,node_count:n,flavor_name:f.a.fetchSafeFromObject({path:["label","name"],obj:i,default_value:""})}}))},hh=function(e,t){return e.sort((function(e,t){return e.cores===t.cores?parseInt(e.memory,10)>parseInt(t.memory,10)?1:-1:parseInt(e.cores,10)>parseInt(t.cores,10)?1:-1})),e.map((function(e){var a=f.a.fetchSafeFromObject({path:["_links","self","href"],obj:e,default_value:""}),r=f.a.fetchSafeFromObject({path:["label","name"],obj:e,default_value:""}),n="".concat(r," - ").concat(e.cores," VCPU, ").concat((e.memory/1024).toFixed(2)," GB RAM");return e.gpus&&(n+=", ".concat(e.gpus," GPU Devices")),e.root_disk_size&&(n+=", ".concat(e.root_disk_size," GB root disk")),e.persistent_storage_size&&(n+=", ".concat(e.persistent_storage_size," GB persistent storage")),{type:"string",enum:["flavor"===t?a:r],title:n,flavor_object:e}}))},bh=function(e,t,a,r){var n,o=arguments.length>4&&void 0!==arguments[4]&&arguments[4];return e.some((function(i,s){if(e.length===s+1)return n=i,!0;var c=i.flavor_object,l=c.cores,u=c.memory,p=c.gpus;if(l>=t&&u>=a){if("number"!=typeof minGpu||!o)return n=i,!0;if(p>=r)return n=i,!0}})),n.enum[0]},vh=function(e){var t=e.role_configs,a=e.clusterRoleConfigs,r=e.errors;f.a.isEqual(t,a)||t.map((function(e,t){var n=e.node_fqdns_to_remove,o=void 0===n?[]:n;if(o.length){var i=f.a.fetchSafeFromObjectArray({arr:a,path:["role_id"],match:e.role_id}).node_count-e.node_count;i>0&&o.length!==i&&r.role_configs[t].node_fqdns_to_remove.addError("Selected node(s) count must match number of nodes shrinked, ".concat(i))}}))},yh={fetchCommonClusterCreateData:function(e){var t=e.dispatch,a=e.id;t(x(Q(oe.CLUSTER_DATA),Q(oe.FLAVOR_DATA),Q(oe.CATALOG_DATA),Q(oe.HOSTSTAGS))),a&&t(x(Q(oe.CURRENT_CLUSTER_DATA(a)),Q(oe.CLUSTER_NODE_DATA(a))))},clearPageDataCurrentCluster:function(e){(0,e.dispatch)($("current_cluster"))},getClusterCreateParams:function(e){var t=e.location,a=lf.a.parse(t.search),r=a.op,n=a.id,o=void 0===n?"":n,i=a.model_id,s=void 0===i?"":i,c={operation:w.applicable_cluster_ops.includes(r)?r:"create_cluster",id:o};return s&&(c.model_id=s),ph({},c)},getCatalogCategories:function(e){var t=e.catalog_list._embedded,a=(t=void 0===t?{}:t).independent_catalog_entries;return(void 0===a?[]:a).reduce((function(e,t){return[new Set([].concat(ch(e),[t.categories]))]}))},getDistros:function(e){var t=e.catalog_list,a=e.categories,r=void 0===a?[]:a,n=e.fetch,o=void 0===n?"independent_catalog_entries":n,i=e.distro_id,s=void 0===i?"":i,c=f.a.fetchSafeFromObject({path:["_embedded",o],obj:t,default_value:[]});return s?c.find((function(e){return e.distro_id===s})):r.length?c.filter((function(e){return"installed"===e.state&&e.categories.find((function(e){return r.includes(e)}))})):c},getNamesNClusterCategories:function(e){var t=e.cluster_list;return f.a.fetchSafeFromObject({path:["_embedded","clusters"],obj:t,default_value:[]}).reduce((function(e,t){var a=t.label,r=(a=void 0===a?{}:a).name,n=void 0===r?"":r,o=t.nodegroup,i=(o=void 0===o?{}:o).intended_categories,s=void 0===i?[]:i;return e[n]=s,e}),{})},getFormDataFromClusterData:function(e,t){var a=e.nodegroup,r=(a=void 0===a?{}:a).role_configs,n=void 0===r?[]:r,o=e.dependent_nodegroups,i=void 0===o?[]:o,s=e.bootstrap_action,c=void 0===s?null:s,l=e.attachments,u=void 0===l?{}:l,p=e.scale_policy,d=e.scale_policy_path,f=void 0===d?"":d,m=mh({role_configs:n}),h={label:e.label||{},nodegroup:{catalog_entry_distro_id:e.nodegroup.catalog_entry_distro_id,constraints:fh(e.nodegroup.constraints),role_configs:m},advanced_settings:{debug:!!e.debug,isolated:!!e.isolated,two_phase_delete:!!e.two_phase_delete},attachments:u};if(i.length){var b=i.reduce((function(e,t){var a=mh({role_configs:t.role_configs});return delete t.catalog_entry,e.push(ph(ph({},t),{},{role_configs:a,useDistro:!0,id:parseInt(t.id,10),constraints:fh(t.constraints||[])})),e}),[]);h.dependent_nodegroups=b}return c&&(h.advanced_settings.bootstrap_action=c),p&&t.setState({scale_policy:p}),f&&t.setState({scale_policy_path:f}),h},processConfigChoices:function e(t,a,r,n){var o=arguments.length>4&&void 0!==arguments[4]&&arguments[4],i=arguments.length>5?arguments[5]:void 0;t.map((function(t){var s=t.id,c=t.type,l=t.label,u=t.selections,p=l.name,d={type:"object",title:p,description:n?n.configChoiceDescription(p,c):"",singleRow:!0,properties:{},bd_disabled:o,hidden:"kerberos"===s&&!i},m="boolean"!==c&&"",h={},b=d.properties;if(b.choice_id={type:"string",default:s,hidden:!0},b.selection_id={type:c,bd_disabled:o},["string","password"].includes(c)){var v=r.find((function(e){if(e.choice_id===s)return m=e.selection_id,!0}));b.selection_id=ph(ph({},b.selection_id),{},{default:m,type:"string",bd_widget:c}),v||r.push({choice_id:s,selection_id:m})}else{var y=b.selection_id,g=new Array;u.map((function(e){if(e.preferred&&(m=e.id),"multi"===c&&g.push({type:"string",enum:[e.id],title:e.label.name}),h[e.id.toString()]=f.a.fetchSafeFromObject({path:["config","config_choices"],obj:e,default_value:[]}),h[e.id.toString()].length){var t=h[e.id.toString()].map((function(e){return e.id}));y.dependents=ph(ph({},y.dependents),{},dh({},e.id,t))}}));var _=r.find((function(e){if(e.choice_id===s)return m=e.selection_id,!0}));y.default=m,g.length&&(y.oneOf=g),_||r.push({choice_id:s,selection_id:m})}a.push(d),m&&h[m.toString()]&&h[m.toString()].length&&e(h[m.toString()],a,r,n,o,i)}))},getFlavorSelections:hh,getDefaultFlavor:bh,validateForm:function(e,t,a,r,n,o){if(t.label){var i=e.label,s=(i=void 0===i?{}:i).name,c=void 0===s?"":s,l=i.description,u=void 0===l?"":l,p=e.advanced_settings,d=(p=void 0===p?{}:p).use_bootstrap_action,m=void 0!==d&&d,h=p.bootstrap_action,b=void 0===h?{}:h,v=e.nodegroup,y=(v=void 0===v?{}:v).role_configs,g=void 0===y?[]:y,_=e.dependent_nodegroups,S=void 0===_?[]:_;if(c||t.label.name.addError("Please provide a valid name."),["edit_cluster"].includes(r)){var k=n.label,O=(k=void 0===k?{}:k).name,E=void 0===O?"":O,j=n.nodegroup,D=(j=void 0===j?{}:j).role_configs,w=void 0===D?[]:D,C=n.dependent_nodegroups,T=void 0===C?[]:C;Object.keys(a).includes(c)&&c!==E&&t.label.name.addError("Name already exists in [".concat(a[c].join(","),"] cluster type(s). Please specify a different one")),vh({role_configs:g,clusterRoleConfigs:w,errors:t.nodegroup}),S.length&&T.length&&S.map((function(e,a){var r=f.a.fetchSafeFromObjectArray({arr:T,path:["id"],match:e.id});vh({role_configs:e.role_configs,clusterRoleConfigs:r.role_configs,errors:t.dependent_nodegroups[a]})}))}else Object.keys(a).includes(c)&&t.label.name.addError("Name already exists in [".concat(a[c].join(","),"] cluster type(s). Please specify a different one"));if(u&&u.length>80&&t.label.description.addError("Description must not exceed 80 characters"),m&&t.advanced_settings.bootstrap_action){var P=rh(b,t.advanced_settings.bootstrap_action);t.advanced_settings.bootstrap_action=P}}return o.length&&o.map((function(e){t.addError(e)})),t},getUniqueId:function e(t,a){return a.indexOf(t)<0?t:e(t+1,a)},processNodeRoles:function(e,t,a,r,n,o,i,s,c){var l=f.a.fetchSafeFromObject({path:["_embedded","flavor"],obj:n,default_value:[]}),u="edit_cluster"===i,p=e.node_roles,d=void 0===p?[]:p,m=e.config,h=(m=void 0===m?{}:m).node_services,b=void 0===h?[]:h,v=e.services,y=void 0===v?[]:v;a.role_configs={type:"array",items:[]};var g=b.reduce((function(e,t){var a=t.role_id,r=t.service_ids,n=(void 0===r?[]:r).map((function(e){return f.a.fetchSafeFromObjectArray({arr:y,path:["id"],match:e,get:["label","name"],default_val:e})}));return e[a]=n,e}),{});t.length&&(a.role_configs=ph(ph({},a.role_configs),{},{title:"Node Roles",canCollapse:!0}));var _=a.role_configs.items,S=f.a.fetchSafeFromObject({path:["role_configs",0,"flavor"],obj:r,default_value:!1})?"flavor":"flavor_name",k=[];d.map((function(e){var a=e.id;if(!t.length||t.includes(a)){var n,p={type:"object",singleRow:!0,title:a,description:c.roleDescription(a),more:{title:"List of services for ".concat(a),data:g[a]||[]},properties:{}},d=p.properties,m=e.min_cores,h=void 0===m?0:m,b=e.min_memory,v=void 0===b?0:b,y=e.min_gpus,O=void 0===y?0:y,E=e.cardinality,j={};o&&(j=f.a.fetchSafeFromObjectArray({arr:r.role_configs,path:["role_id"],match:a,default_value:{}}),"edit_cluster"===i&&s.length&&s.includes("Kafka")&&"worker"===e.id&&(E=j.node_count+"+")),d.role_id={type:"string",default:a,hidden:!0};var D=hh(l,S),w=j[S]||bh(D,h,v,O),C=j.node_count||parseInt(E.split("+")[0],10);d[S]={type:"string",oneOf:D,default:w,bd_disabled:u&&C>0},d.node_count={type:"integer",default:C,minimum:E.includes("+")?parseInt(e.cardinality.split("+")[0],10):0,bd_disabled:!E.includes("+")},_.push(p),k.push((dh(n={role_id:a},S,w),dh(n,"node_count",C),n))}})),r.role_configs=k},getDefaultConstraintFields:function(e,t,a){var r="edit_cluster"===a,n=Ll(t),o=Ul(t),i=o.length?o[0].enum[0]:"",s=Bl(n[i]),c=[{type:"string",enum:["equal"],title:"Equal"},{type:"string",enum:["not-equal"],title:"Not Equal"},{type:"string",enum:["unique"],title:"Unique"},{type:"string",enum:["is-set"],title:"Is Set"},{type:"string",enum:["is-unset"],title:"Is Unset"}],l=c[0].enum[0],u=s[0].enum[0];return{constraintSchema:{type:"object",singleRow:!0,properties:{roles:{type:"array",placeholder:"Roles",fullWidth:!0,uniqueItems:!0,bd_disabled:r,items:{type:"string",enum:e}},tag:{type:"string",placeholder:"Tag",oneOf:o,default:i,hidden:!0,bd_disabled:r},operator:{type:"string",placeholder:"Operator",oneOf:c,default:l,sort:!1,hidden:!0,bd_disabled:r},tag_value:{type:"string",placeholder:"Tag Value",oneOf:s,default:u,hidden:!0,bd_disabled:r}}},constraintData:{roles:[],tag:i,operator:l,tag_value:u}}},getApplicableAddonsObj:function(e){var t=e.k8s_manifest,a=e.addonIds,r=f.a.fetchSafeFromObject({path:["addon_info"],obj:t,default_value:{}});return a.reduce((function(e,t){var a=r[t],n=!0===f.a.fetchSafeFromObject({path:["system"],obj:a,default_value:!1});return a&&!n&&(e[t]=a),e}),{})}};function gh(e){return(gh="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function _h(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function Sh(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?_h(Object(a),!0).forEach((function(t){Ch(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):_h(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function kh(e,t){for(var a=0;a<t.length;a++){var r=t[a];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Oh(e,t){return(Oh=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Eh(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=wh(e);if(t){var n=wh(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return jh(this,a)}}function jh(e,t){return!t||"object"!==gh(t)&&"function"!=typeof t?Dh(e):t}function Dh(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function wh(e){return(wh=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Ch(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}var Th=er({path:["createEditCluster"]}),Ph=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Oh(e,t)}(i,e);var t,a,r,o=Eh(i);function i(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),(t=o.call(this,e)).state={hasDistros:!0,clusterFormSchema:{type:"object",properties:{}},clusterUiSchema:{},dependent_catalogs:[],resource_errors:[],scale_policy:"",scale_policy_path:""},t.clusterFormData={},t.createClusterScheme=t.createClusterScheme.bind(Dh(t)),t.onChangeClusterCategories=t.onChangeClusterCategories.bind(Dh(t)),t.onChangeDistro=t.onChangeDistro.bind(Dh(t)),t.processScalePolicyPath=t.processScalePolicyPath.bind(Dh(t)),t.onFormChange=t.onFormChange.bind(Dh(t)),t.doDryRun=t.doDryRun.bind(Dh(t)),t.processData=t.processData.bind(Dh(t)),t.submitClusterAndTemplateForm=t.submitClusterAndTemplateForm.bind(Dh(t)),t.processIndependentRoles=t.processIndependentRoles.bind(Dh(t)),t.processDDRoles=t.processDDRoles.bind(Dh(t)),t.processAdvancedSettings=t.processAdvancedSettings.bind(Dh(t)),t.onChangeNodeCount=t.onChangeNodeCount.bind(Dh(t)),t.onChangeUseBootstrapAction=t.onChangeUseBootstrapAction.bind(Dh(t)),t.onChangeBootstrapActionNodegroupID=t.onChangeBootstrapActionNodegroupID.bind(Dh(t)),t.onChangeScriptSource=t.onChangeScriptSource.bind(Dh(t)),t.onChangeRunAsRootClustorForm=t.onChangeRunAsRootClustorForm.bind(Dh(t)),t.checkAndSubmitEditCluster=t.checkAndSubmitEditCluster.bind(Dh(t)),t.onChangeScalePolicyPath=t.onChangeScalePolicyPath.bind(Dh(t)),t.checkDependentDistroDefaultSelection=t.checkDependentDistroDefaultSelection.bind(Dh(t)),t.onAddConstraint=t.onAddConstraint.bind(Dh(t)),t.onDropConstraint=t.onDropConstraint.bind(Dh(t)),t.onChangeConstraintFields=t.onChangeConstraintFields.bind(Dh(t)),t.bdFormRef=n.a.createRef(),t}return t=i,(a=[{key:"componentDidMount",value:function(){this.createClusterScheme()}},{key:"componentWillUnmount",value:function(){window.localStorage.removeItem("collapsed_states")}},{key:"createClusterScheme",value:function(){var e=this,t=this.state,a=t.clusterFormSchema,r=t.clusterUiSchema,n=this.props,o=n.operation,i=n.catalog_list,s=n.CLUSTER_TYPE,c=n.cluster_data,l=!f.a.isEmptyObject(c),u=l?yh.getFormDataFromClusterData(c,this):{},p=s?[s]:yh.getCatalogCategories({catalog_list:i}),d=s?s.split("/").pop():"cluster",m="edit_cluster"===o,h=u.label,b=(h=void 0===h?{}:h).name,v=void 0===b?"":b,y=h.description,g=void 0===y?"":y,_=u.nodegroup,S=(_=void 0===_?{}:_).intended_categories,k=void 0===S?[p[0]]:S;l||(u.nodegroup={intended_categories:k}),a.properties=Sh(Sh({label:{title:"Cluster Detail",type:"object",properties:{name:{type:"string",title:"Name",default:v,description:Th.labelNameDescription(d),bd_required:!0},description:{type:"string",title:"Description",default:g,description:Th.labelDescriptionDescription(d)}}}},m&&{reason:{type:"string",title:"Reason",description:"Enter reason for reconfiguring cluster"}}),{},{nodegroup:{type:"object",required:["catalog_entry_distro_id"],properties:{intended_categories:{type:"array",title:"Cluster Types",description:Th.categoryDescription,items:{type:"string",enum:p},default:k,uniqueItems:!0,hidden:["AIML/Training","AIML/Notebook","AIML/Deployment"].includes(s),bd_required:!0,bd_disabled:m}}}});var O=["label","nodegroup"];r.nodegroup=Sh(Sh({},r.nodegroup),{},Ch({},"ui:order",["intended_categories"])),m&&(O=["label","reason","nodegroup"]),r["ui:order"]=O,"AIML/Deployment"===s&&this.processAttachments(),this.clusterFormData=u,this.setState({clusterFormSchema:a,clusterUiSchema:r},(function(){e.onChangeClusterCategories(),e.processAdvancedSettings()}))}},{key:"onChangeClusterCategories",value:function(){var e=this,t=JSON.parse(JSON.stringify(this.clusterFormData)),a=this.state,r=a.clusterFormSchema,n=a.clusterUiSchema,o=this.props,i=o.operation,s=o.catalog_list,c=o.cluster_data,l=o.CLUSTER_TYPE,u="edit_cluster"===i,p=t.nodegroup,d=(p=void 0===p?{}:p).intended_categories,m=void 0===d?[l]:d,h=yh.getDistros({catalog_list:s,categories:m});if(h.length){var b=h.map((function(e){return{type:"string",enum:[e.distro_id],title:e.label.name}})),v=f.a.fetchSafeFromObject({path:["nodegroup","catalog_entry_distro_id"],obj:t,default_value:""}),y=u||!f.a.isEmptyObject(c)&&c.nodegroup.catalog_entry_distro_id===v?v:h[0].distro_id;u||(t.nodegroup=Sh(Sh({},t.nodegroup),{},{catalog_entry_distro_id:y})),f.a.fetchSafeFromObject({path:["properties","nodegroup","properties"],obj:r,default_value:{}}).catalog_entry_distro_id={type:"string",title:"RunTime Image",description:Th.distributionDescription(l.split("/").pop()),oneOf:b,default:y,bd_required:!0,bd_disabled:u};var g=f.a.fetchSafeFromObject({path:["nodegroup","ui:order"],obj:n,default_value:[]});!g.includes("catalog_entry_distro_id")&&g.push("catalog_entry_distro_id"),this.clusterFormData=t,this.setState({clusterFormSchema:r,clusterUiSchema:n,hasDistros:!0},(function(){e.onChangeDistro()}))}else this.setState({hasDistros:!1})}},{key:"onChangeDistro",value:function(){var e=this,t=JSON.parse(JSON.stringify(this.clusterFormData)),a=this.state,r=a.clusterFormSchema,n=a.clusterUiSchema,o=this.props,i=o.operation,s=o.cluster_data,c=o.tenantKDC,l=this.getSelectedDistroObject(),u=f.a.fetchSafeFromObject({path:["config","config_choices"],obj:l,default_value:[]}),p=f.a.fetchSafeFromObject({path:["properties","nodegroup","properties"],obj:r,default_value:{}}),d=f.a.fetchSafeFromObject({path:["nodegroup","ui:order"],obj:n,default_value:[]}),m="edit_cluster"===i;if(this.processScalePolicyPath({distro:l}),u.length){var h=f.a.fetchSafeFromObject({path:["nodegroup","config_choice_selections"],obj:s,default_value:[]}),b=m||h.length&&l.distro_id===s.nodegroup.catalog_entry_distro_id?h:[],v=[];yh.processConfigChoices(u,v,b,Th,m,c);var y=v.reduce((function(e,t,a){return e[t.properties.choice_id.default]=a,e}),{}),g=new Array(v.length);b.map((function(e){var t=y[e.choice_id];g[t]=e})),p.config_choice_selections={type:"array",title:"Config Choices",items:v,canCollapse:!0,collapsed:!f.a.isEmptyObject(s)},t.nodegroup.config_choice_selections=g,!d.includes("config_choice_selections")&&d.splice(d.indexOf("catalog_entry_distro_id")+1,0,"config_choice_selections")}else delete p.config_choice_selections,delete t.nodegroup.config_choice_selections,d.includes("config_choice_selections")&&d.splice(d.indexOf("config_choice_selections"),1);this.clusterFormData=t,this.setState({clusterFormSchema:r,clusterUiSchema:n},(function(){e.doDryRun("independent_distros")}))}},{key:"processScalePolicyPath",value:function(e){var t=e.distro,a=this.props.project_repo,r=this.state,n=r.clusterFormSchema,o=r.clusterUiSchema,i=r.scale_policy,s=void 0===i?"":i,c=r.scale_policy_path,l=void 0===c?"":c,u=t.categories,p=(void 0===u?[]:u).find((function(e){return w.autoScaleCategories.includes(e)})),d=o["ui:order"],m=!!s&&JSON.parse(s);if(p){var h={};if(a){var b=f.a.fetchSafeFromObject({path:["_links","self","href"],obj:a,default_value:""}),v=(a._embedded||{}).mountspec,y=void 0===v?{}:v;h.key=b,h.source=b,h.name=y.mount_name,h.type="NFS",h.source_type="fsMount",h.path="/",h.path_prefix="repo://"}n.properties.scale_policy_path={type:"string",title:"Upload Scaling Policy",placeholder:m&&!m.name?"Scaling policy is set. Click to upload a new policy":"Select a valid JSON file",description:Th.scalePolicyDescription,default:l||m.name,accept:["json"],bd_widget:"file-tree",bd_widget_data:h},!d.includes("scale_policy_path")&&d.splice(d.indexOf("advanced_settings"),0,"scale_policy_path")}else delete n.properties.scale_policy_path,d.splice(d.indexOf("scale_policy_path"),0);this.setState({clusterFormSchema:n,clusterUiSchema:o})}},{key:"getSelectedDistroObject",value:function(){var e=this.props.catalog_list,t=f.a.fetchSafeFromObject({path:["nodegroup","catalog_entry_distro_id"],obj:this.clusterFormData,default_value:""});return yh.getDistros({catalog_list:e,distro_id:t})}},{key:"processIndependentRoles",value:function(e){var t=this,a=JSON.parse(JSON.stringify(this.clusterFormData)),r=this.state,n=r.clusterFormSchema,o=r.clusterUiSchema,i=this.props,s=i.flavor_list,c=i.cluster_data,l=i.operation,u=i.tags,p=i.constraints_supported,d=a.nodegroup,m=void 0===d?{}:d,h=m.intended_categories,b=void 0===h?[]:h,v=f.a.fetchSafeFromObject({path:["properties","nodegroup","properties"],obj:n,default_value:{}}),y=this.getSelectedDistroObject(),g=!f.a.isEmptyObject(c)&&c.nodegroup.catalog_entry_distro_id===y.distro_id;yh.processNodeRoles(y,e,v,m,s,g,l,b,Th);var _=f.a.fetchSafeFromObject({path:["nodegroup","ui:order"],obj:o,default_value:[]}),S="edit_cluster"===l;_.includes("role_configs")||_.push("role_configs");var k=m.role_configs.map((function(e){return e.role_id}));if(p&&u.length&&k.length){var O=yh.getDefaultConstraintFields(k,u,l);m.constraints=m.constraints||[JSON.parse(JSON.stringify(O.constraintData))];var E=this.getConstraintItemsSchema({data:m,operation:l,constraintFields:O});v.constraints={type:"array",title:"Placement Constraints",canCollapse:!0,collapseLabel:"Add Placement Constraints",description:Th.constraintsDesription,canAdd:!S,onAddClick:function(){t.onAddConstraint({nodegroupType:"independent",constraintFields:O})},onDropClick:function(e){t.onDropConstraint({nodegroupType:"independent",idx:e})},addItemTitle:"Placement Constraint",items:E},_.includes("constraints")||_.push("constraints")}this.clusterFormData=a,this.setState({clusterFormSchema:n},(function(){t.doDryRun("dependent_distros"),t.processAdvancedSettings()}))}},{key:"onAddConstraint",value:function(e){var t,a,r=e.nodegroupType,n=e.nodegroupIdx,o=e.constraintFields,i=JSON.parse(JSON.stringify(this.clusterFormData)),s=this.state.clusterFormSchema;"independent"===r?(t=f.a.fetchSafeFromObject({path:["properties","nodegroup","properties","constraints","items"],obj:s,default_value:[]}),a=f.a.fetchSafeFromObject({path:["nodegroup","constraints"],obj:i,default_value:[]})):(t=f.a.fetchSafeFromObject({path:["properties","dependent_nodegroups","items",n,"properties","constraints","items"],obj:s,default_value:[]}),a=f.a.fetchSafeFromObject({path:["dependent_nodegroups",n,"constraints"],obj:i,default_value:[]})),t.push(JSON.parse(JSON.stringify(o.constraintSchema))),a.push(JSON.parse(JSON.stringify(o.constraintData))),this.clusterFormData=i,this.setState({clusterFormSchema:s})}},{key:"onDropConstraint",value:function(e){var t,a,r=this,n=e.nodegroupType,o=e.idx,i=e.nodegroupIdx,s=JSON.parse(JSON.stringify(this.clusterFormData)),c=this.state.clusterFormSchema,l=this.props.operation;"independent"===n?(t=f.a.fetchSafeFromObject({path:["properties","nodegroup","properties","constraints","items"],obj:c,default_value:[]}),a=f.a.fetchSafeFromObject({path:["nodegroup","constraints"],obj:s,default_value:[]})):(t=f.a.fetchSafeFromObject({path:["properties","dependent_nodegroups","items",i,"properties","constraints","items"],obj:c,default_value:[]}),a=f.a.fetchSafeFromObject({path:["dependent_nodegroups",i,"constraints"],obj:s,default_value:[]})),t.splice(o,1),a.splice(o,1),this.clusterFormData=s,this.setState({clusterFormSchema:c},(function(){"create_cluster"===l&&r.doDryRun("resource_check")}))}},{key:"onChangeConstraintFields",value:function(e){var t=this,a=e.idx,r=e.field,n=e.nodegroupType,o=e.nodegroupIdx;if("tag_value"===r)return!1;var i,s,c=JSON.parse(JSON.stringify(this.clusterFormData)),l=this.state.clusterFormSchema,u=this.props.operation;if("independent"===n?(i=f.a.fetchSafeFromObject({path:["properties","nodegroup","properties","constraints","items",a],obj:l,default_value:{}}),s=f.a.fetchSafeFromObject({path:["nodegroup","constraints",a],obj:c,default_value:{}})):(i=f.a.fetchSafeFromObject({path:["properties","dependent_nodegroups","items",o,"properties","constraints","items",a],obj:l,default_value:[]}),s=f.a.fetchSafeFromObject({path:["dependent_nodegroups",o,"constraints",a],obj:c,default_value:[]})),i&&s)if("roles"===r){var p=!s.roles.length;["tag","operator","tag_value"].map((function(e){"tag_value"===e&&["unique","is-set","is-unset"].includes(s.operator)&&(p=!0),i.properties[e].hidden=p}))}else if("tag"===r){var d=this.props.tags,m=Ll(d),h=Bl(m[s.tag]),b=h[0].enum[0];i.properties.tag_value=Sh(Sh({},i.properties.tag_value),{},{oneOf:h,default:b,hidden:!1}),s.operator=i.properties.operator.default,s.tag_value=b}else if("operator"===r){var v=["unique","is-set","is-unset"].includes(s.operator);i.properties.tag_value.hidden=v}this.clusterFormData=c,this.setState({clusterFormSchema:l},(function(){"create_cluster"===u&&t.doDryRun("resource_check")}))}},{key:"checkDependentDistroDefaultSelection",value:function(e){var t=e.dependent_distro,a=e.catalog_entry_distro_id;if(f.a.isEmptyObject(t)){var r=this.getSelectedDistroObject();return"edit_cluster"!==this.props.operation&&!!r.recommended_dep_distro_id&&r.recommended_dep_distro_id===a}return!0}},{key:"processDependentCatalogs",value:function(){var e=this,t=JSON.parse(JSON.stringify(this.clusterFormData)),a=this.state,r=a.clusterFormSchema,n=a.clusterUiSchema,o=a.dependent_catalogs,i=this.props.operation,s=n["ui:order"],c=[];if(o.length){var l=[],u={},p=t.dependent_nodegroups,d=void 0===p?[]:p;o.map((function(t,a){var r=t.catalog_entry_distro_id,n=void 0===r?"":r,o=d.length?d.map((function(e){return e.id})):[],i=d.find((function(e){return e.catalog_entry_distro_id===n}))||{},s=e.checkDependentDistroDefaultSelection({dependent_distro:i,catalog_entry_distro_id:n}),p=i.id||yh.getUniqueId(a+2,o),m=f.a.fetchSafeFromObject({path:["catalog_entry_label","name"],obj:t,default_value:""}),h={type:"object",properties:{id:{type:"number",default:p,hidden:!0},catalog_entry_distro_id:{type:"string",default:n,hidden:!0},useDistro:{type:"boolean",title:m,description:Th.dependentDescription(m),default:s}}};s&&(c.push(a),d.length||d.push({id:p,catalog_entry_distro_id:n,useDistro:s})),l.push(h),u[a]={"ui:order":["id","catalog_entry_distro_id","useDistro","role_configs","constraints"]}})),d.length&&(t.dependent_nodegroups=d),r.properties.dependent_nodegroups={type:"array",title:"Add-Ons",items:l,canCollapse:!0},!s.includes("dependent_nodegroups")&&s.splice(s.indexOf("nodegroup")+1,0,"dependent_nodegroups"),n.dependent_nodegroups=u}else{delete r.properties.dependent_nodegroups,delete t.dependent_nodegroups,delete n.dependent_nodegroups;var m=s.indexOf("dependent_nodegroups");m>-1&&s.splice(m,1)}this.clusterFormData=t,this.setState({clusterFormSchema:r,clusterUiSchema:n},(function(){c.length?c.map((function(t){e.processDDRoles(t)})):"create_cluster"===i&&e.doDryRun("resource_check")}))}},{key:"processDDRoles",value:function(e){var t=this,a=JSON.parse(JSON.stringify(this.clusterFormData)),r=this.state,n=r.clusterFormSchema,o=r.clusterUiSchema,i=this.props,s=i.operation,c=i.tags,l=i.constraints_supported,u=f.a.fetchSafeFromObject({path:["dependent_nodegroups",e],obj:a,default_value:{}}),p=u.catalog_entry_distro_id,d=void 0===p?"":p,m=u.useDistro,h=void 0!==m&&m,b=f.a.fetchSafeFromObject({path:["properties","dependent_nodegroups","items",e,"properties"],obj:n,default_value:{}}),v=f.a.fetchSafeFromObject({path:["dependent_nodegroups",e],obj:o,default_value:{}}),y="edit_cluster"===s;if(h){var g=this.props,_=g.catalog_list,S=g.flavor_list,k=g.cluster_data,O=void 0===k?{}:k,E=g.operation,j=yh.getDistros({catalog_list:_,distro_id:d,fetch:"dependent_catalog_entries"}),D=f.a.fetchSafeFromObject({path:["dependent_nodegroups"],obj:O,default_value:[]}),w=D.length&&D.find((function(e){return e.catalog_entry_distro_id===d}));yh.processNodeRoles(j,[],b,u,S,w,E,[],Th),v["ui:order"]=["id","catalog_entry_distro_id","useDistro","role_configs"];var C=u.role_configs.map((function(e){return e.role_id})),T={};if(l&&c.length&&C.length){T=yh.getDefaultConstraintFields(C,c,E),u.constraints=u.constraints||[JSON.parse(JSON.stringify(T.constraintData))];var P=this.getConstraintItemsSchema({data:u,operation:E,constraintFields:T});b.constraints={type:"array",title:"Add Placement Constraints",description:Th.constraintsDesription,canAdd:!y,onAddClick:function(){t.onAddConstraint({nodegroupType:"dependent",nodegroupIdx:e,constraintFields:T})},onDropClick:function(a){t.onDropConstraint({nodegroupType:"dependent",nodegroupIdx:e,idx:a})},addItemTitle:"Placement Constraint",items:P},v["ui:order"].includes("constraints")||v["ui:order"].push("constraints")}}else{delete b.role_configs,delete u.role_configs,delete b.constraints,delete u.constraints,v["ui:order"]=["id","catalog_entry_distro_id","useDistro"];var A=this.getSelectedDistroObject();A.recommended_dep_distro_id&&A.recommended_dep_distro_id===d&&_n({msg:"This dependent distro is recommended for this distro to function correctly.",variant:"warn",timeout:1e4})}this.clusterFormData=a,this.setState({clusterFormSchema:n,clusterUiSchema:o},(function(){"create_cluster"===s&&t.doDryRun("resource_check")}))}},{key:"processAttachments",value:function(e){var t=this.state,a=t.clusterFormSchema,r=t.clusterUiSchema,n=this.props,o=n.CLUSTER_TYPE,i=n.attach_list,s=n.operation,c=n.attach,l=void 0===c?"":c,u=Kf.attachSupportList[o].id,p="AIML/Deployment"===o,d="edit_cluster"===s,m=[];if(e){var h=e[u];m=i.filter((function(e){return h.includes(f.a.fetchSafeFromObject({path:["_links","self","href"],obj:e,default_value:""}))}))}else m=i;var b=[],v=[];m.map((function(e){b.push(f.a.fetchSafeFromObject({path:["_links","self","href"],obj:e,default_value:""}));var t=f.a.fetchSafeFromObject({path:["label","name"],obj:e,default_value:""});p&&(t+=", ".concat(e.version)),v.push(t)}));var y=p?"attachmentModelDescription":"attachmentClusterDescription",g=m.length?Ch({},u,{type:"array",title:Kf.attachSupportList[o].title,description:Th[y],default:l?[l]:[],minItems:0,items:{type:"string",enum:b,enumNames:v},uniqueItems:!0,bd_disabled:d}):{};a.properties.attachments={type:"object",properties:g,help:m.length?"":"Applicable ".concat(u," are not available")};var _=r["ui:order"];if(!_.includes("attachments")){var S=p?d?2:1:_.indexOf("nodegroup")+1;_.splice(S,0,"attachments")}this.setState({clusterFormSchema:a,clusterUiSchema:r})}},{key:"processAdvancedSettings",value:function(){var e=this,t=JSON.parse(JSON.stringify(this.clusterFormData)),a=this.state,r=a.clusterFormSchema,n=a.clusterUiSchema,o=this.props.operation,i=t.advanced_settings,s=void 0===i?{}:i,c=this.getSelectedDistroObject(),l=s.debug,u=void 0===l?c.isdebug:l,p=s.isolated,d=void 0!==p&&p,m=s.two_phase_delete,h=void 0!==m&&m,b=s.bootstrap_action,v=void 0===b?{}:b;if(r.properties.advanced_settings={type:"object",title:"Advanced Settings",canCollapse:!0,collapsed:!c.isdebug,properties:{debug:{type:"boolean",title:"Debug Mode",description:Th.debugDescription,default:u},isolated:{type:"boolean",title:"Isolated Mode",description:Th.isolatedDescription,default:d,hidden:!0},two_phase_delete:{type:"boolean",title:"Two Phase Delete",description:Th.twoPhaseDeleteDescription,default:h,hidden:!0}}},s.debug=u,s.isolated=d,s.two_phase_delete=h,n["ui:order"].includes("advanced_settings")||n["ui:order"].push("advanced_settings"),"edit_cluster"!==o){var y=f.a.fetchSafeFromObject({path:["properties","advanced_settings","properties"],obj:r,default_value:{}}),g=!f.a.isEmptyObject(v);y.use_bootstrap_action={type:"boolean",title:"Bootstrap Action",default:g,description:Th.bootstrapActionDescription},s.use_bootstrap_action=g,this.clusterFormData=t,this.setState({clusterFormSchema:r},(function(){g&&e.onChangeUseBootstrapAction()}))}else this.clusterFormData=t,this.setState({clusterFormSchema:r})}},{key:"onChangeNodeCount",value:function(e){var t,a,r=e.roleIdx,n=e.nodegroupIdx,o=void 0===n?null:n,i=JSON.parse(JSON.stringify(this.clusterFormData)),s=this.state.clusterFormSchema,c=this.props,l=c.cluster_nodes,u=c.cluster_data,p=f.a.fetchSafeFromObject({path:["_embedded","nodes"],obj:l,default_value:[]}),d={};if("number"==typeof o){var m=f.a.fetchSafeFromObject({path:["properties","dependent_nodegroups","items",o,"properties"],obj:s,default_value:{}}),h=f.a.fetchSafeFromObject({path:["id","default"],obj:m,default_value:""});d=f.a.fetchSafeFromObject({path:["role_configs","items",r,"properties"],obj:m,default_value:{}}),t=i.dependent_nodegroups.find((function(e){return e.id===h})),a=u.dependent_nodegroups?u.dependent_nodegroups.find((function(e){return e.id===h})):{}}else d=f.a.fetchSafeFromObject({path:["properties","nodegroup","properties","role_configs","items",r,"properties"],obj:s,default_value:{}}),t=i.nodegroup,a=u.nodegroup;var b=f.a.fetchSafeFromObject({path:["role_id","default"],obj:d,default_value:""}),v=t.role_configs.find((function(e){return e.role_id===b})),y=v.node_count||0,g=f.a.fetchSafeFromObjectArray({arr:a.role_configs,path:["role_id"],match:b,get:["node_count"],default_value:0});if(y&&g-y>0){var _=f.a.bdSort(p.filter((function(e){return e.role===b})),["fqdn"]);d.node_fqdns_to_remove={type:"array",items:{type:"string",enum:_.map((function(e){return e.fqdn}))},uniqueItems:!0,default:[],minItems:0,newRow:!0}}else d.node_fqdns_to_remove&&(delete d.node_fqdns_to_remove,delete v.node_fqdns_to_remove);this.clusterFormData=i,this.setState({clusterFormSchema:s})}},{key:"onChangeUseBootstrapAction",value:function(){var e=this,t=JSON.parse(JSON.stringify(this.clusterFormData)),a=this.state,r=a.clusterFormSchema,n=a.clusterUiSchema,o=a.dependent_catalogs,i=f.a.fetchSafeFromObject({path:["properties","advanced_settings","properties"],obj:r,default_value:{}}),s=t.advanced_settings,c=void 0===s?{}:s,l=c.use_bootstrap_action,u=void 0!==l&&l,p=this.getSelectedDistroObject(),d=nh(t,p,o),m=oh(t);if(n.advanced_settings={},u){var h=c.bootstrap_action,b=void 0===h?{}:h;i.bootstrap_action=eh(b,d,m),c.bootstrap_action=th(i.bootstrap_action),n.advanced_settings.bootstrap_action={"ui:order":["label","source","dependent_scripts","nodegroup_id","roles","as_root"]}}else delete i.bootstrap_action,delete c.bootstrap_action,delete n.advanced_settings.bootstrap_action;this.clusterFormData=t,this.setState({clusterFormSchema:r,clusterUiSchema:n},(function(){e.onChangeScriptSource()}))}},{key:"onChangeBootstrapActionNodegroupID",value:function(){var e=JSON.parse(JSON.stringify(this.clusterFormData)),t=this.state.clusterFormSchema,a=f.a.fetchSafeFromObject({path:["properties","advanced_settings","properties","bootstrap_action","properties","roles"],obj:t,default_value:{}}),r=oh(e);a.items={type:"string",enum:r},a.default=[],e.advanced_settings.bootstrap_action.roles=[],this.clusterFormData=e,this.setState({clusterFormSchema:t})}},{key:"onChangeScriptSource",value:function(){var e=JSON.parse(JSON.stringify(this.clusterFormData)),t=this.state,a=t.clusterFormSchema,r=t.clusterUiSchema,n=f.a.fetchSafeFromObject({path:["properties","advanced_settings","properties","bootstrap_action"],obj:a,default_value:{}}),o=e.advanced_settings,i=void 0===o?{}:o,s=r.advanced_settings,c=void 0===s?{}:s,l=ah({formSchema:n.properties,bootstrap_action:i.bootstrap_action,uiSchema:c.bootstrap_action}),u=l.formSchema,p=void 0===u?{}:u,d=l.uiSchema,m=void 0===d?{}:d;n.properties=p,r.advanced_settings.bootstrap_action=m,this.clusterFormData=e,this.setState({clusterFormSchema:a,clusterUiSchema:r})}},{key:"onChangeRunAsRootClustorForm",value:function(){var e=JSON.parse(JSON.stringify(this.clusterFormData)),t=this.state.clusterFormSchema,a=f.a.fetchSafeFromObject({path:["properties","advanced_settings","properties","bootstrap_action"],obj:t,default_value:{}}),r=e.advanced_settings,n=void 0===r?{}:r,o=sh({formSchema:a.properties,bootstrap_action:n.bootstrap_action}).formSchema,i=void 0===o?{}:o;a.properties=i,this.clusterFormData=e,this.setState({clusterFormSchema:t})}},{key:"onFormChange",value:function(e){var t=this,a=e.formData;this.clusterFormData=a;var r=this.state.clusterFormSchema,n=this.props.operation,o=document.activeElement,i=xl(o);if(i){var s="edit_cluster"===n;if(i.includes("_intended_categories")&&!s)this.onChangeClusterCategories();else if(i.includes("catalog_entry_distro_id")&&!s)this.onChangeDistro();else if(i.includes("_selection")&&!s){var c=parseInt(i.split("config_choice_selections_").pop().split("_")[0],10),l=f.a.fetchSafeFromObject({path:["nodegroup","config_choice_selections"],obj:a,default_value:[]}),u=l[c]||{},p=u.selection?"selection":"selection_id";if("selection_id"===p){var d=u[p],m=d&&"string"!=typeof d,h=f.a.fetchSafeFromObject({path:["properties","nodegroup","properties","config_choice_selections"],obj:r,default_value:{}}),b=h.items,v=void 0===b?[]:b,y=f.a.fetchSafeFromObject({path:[c,"properties","selection_id","dependents"],obj:v,default_value:!1});y&&Object.keys(y).map((function(e){if(e===d.toString()){if(y[e].length){var r=t.getSelectedDistroObject(),n=f.a.fetchSafeFromObject({path:["config","config_choices"],obj:r,default_value:[]}),o=f.a.fetchSafeFromObjectArray({arr:n,path:["id"],match:u.choice_id,get:["selections"],default_value:[]}),i=[];o.some((function(t){if(t.id.toString()===e)return i=t.config.config_choices,!0})),yh.processConfigChoices(i,v,l,Th);var s=v.reduce((function(e,t,a){return e[t.properties.choice_id.default]=a,e}),{}),c=new Array(v.length);l.map((function(e){var t=s[e.choice_id];c[t]=e})),h.items=v,a.nodegroup.config_choice_selections=c}}else{var p=y[e],m=v.filter((function(e){var t=f.a.fetchSafeFromObject({path:["properties","choice_id","default"],obj:e,default_value:""});return!p.includes(t)})),b=l.filter((function(e){var t=f.a.fetchSafeFromObject({path:["choice_id"],obj:e,default_value:""});return!p.includes(t)}));h.items=m,a.nodegroup.config_choice_selections=b}})),m&&(this.clusterFormData=a,this.setState({clusterFormSchema:r},(function(){t.doDryRun("independent_distros")})))}}else if(i.includes("_flavor"))"create_cluster"===n&&this.doDryRun("resource_check");else if(i.includes("_node_count")){if("create_cluster"===n&&this.doDryRun("resource_check"),s){var g,_=parseInt(i.split("_node_count")[0].split("_").pop(),10);i.includes("dependent_nodegroups_")&&(g=parseInt(i.split("dependent_nodegroups_")[1].split("_").shift(),10)),this.onChangeNodeCount({roleIdx:_,nodegroupIdx:g})}}else if(i.includes("_useDistro")){var S=parseInt(i.split("_useDistro")[0].split("_").pop(),10);this.processDDRoles(S),this.onChangeUseBootstrapAction()}else if(i.includes("_use_bootstrap_action"))this.onChangeUseBootstrapAction();else if(i.includes("_bootstrap_action_nodegroup_id"))this.onChangeBootstrapActionNodegroupID();else if(i.includes("_bootstrap_action_source"))this.onChangeScriptSource();else if(i.includes("_as_root"))this.onChangeRunAsRootClustorForm();else if(i.includes("_scale_policy_path"))this.onChangeScalePolicyPath();else if(i.includes("_constraints_")){var k=i.split("_constraints_")[1].split("_"),O=parseInt(k[0],10),E=k.slice(1).join("_"),j="independent",D=0;i.includes("dependent_nodegroups_")&&(D=parseInt(i.split("dependent_nodegroups_")[1].split("_").shift(),10),j="dpendent"),this.onChangeConstraintFields({idx:O,field:E,nodegroupType:j,nodegroupIdx:D})}}}},{key:"doDryRun",value:function(e){if(!f.a.isEmptyObject(this.clusterFormData)){var t=this.processData(this.clusterFormData,e),a=w.apiurl.DRYRUN;this.submitRestApi({dryRun:e,data:t,apiurl:a})}}},{key:"processData",value:function(e,t){var a=this,r=this.state.scale_policy_path,n=JSON.parse(JSON.stringify(e)),o=n.advanced_settings,i=n.dependent_nodegroups,s=void 0===i?[]:i,c=n.nodegroup,l=void 0===c?{}:c;if(delete n.advanced_settings,t){var u=new Date;n.label={name:"dummy".concat(u.getTime()),description:"Dry run"},n.nodegroup&&"independent_distros"===t&&(n.nodegroup.role_configs=[])}else f.a.isEmptyObject(o)||Object.keys(o).map((function(e){n[e]=o[e]}));if(delete n.use_bootstrap_action,n.attachments&&f.a.isEmptyObject(n.attachments)&&delete n.attachments,s.length){var p=[];s.map((function(e){e.useDistro&&(delete e.useDistro,e.constraints&&(e.constraints=a.getProcessedConstraints(e)),p.push(e))})),n.dependent_nodegroups=p}return r&&r.length&&(n.scale_policy_path=r),l.constraints&&(l.constraints=this.getProcessedConstraints(l)),n}},{key:"onChangeScalePolicyPath",value:function(){var e=this,t=this.clusterFormData.scale_policy_path,a=void 0===t?"":t,r=this.props.operation;this.setState({scale_policy_path:a},(function(){var t=e.getSelectedDistroObject();e.processScalePolicyPath({distro:t}),"create_cluster"===r&&e.doDryRun("resource_check")}))}},{key:"submitClusterAndTemplateForm",value:function(e){var t=e.formData,a=e.errors,r=e.method,o=e.action,i=this.props.operation;if(!a.length){var s=this.processData(t);if("edit_cluster"===i)return void this.checkAndSubmitEditCluster({data:s});var c=document.querySelectorAll("input[type=file][id*='bootstrap_action']");if(c.length){var l=this,u=s.label.name,p=s.bootstrap_action.label.name;ih(c,p,u).then((function(e){if(!f.a.isEmptyObject(e)){var t=s.bootstrap_action;s.bootstrap_action=Sh(Sh({},t),e)}l.submitRestApi({data:s,method:r,apiurl:o})})).catch((function(e){var t=f.a.parseAxiosError({error:JSON.parse(e)});_n({msg:n.a.createElement(ns,{errors:["Failed to upload the bootstrap script files",t]}),variant:"error"})}))}else this.submitRestApi({data:s,method:r,apiurl:o})}}},{key:"checkAndSubmitEditCluster",value:function(e){var t=e.data,a=this.props.cluster_data,r=t.label,n=void 0===r?{}:r,o=t.reason,i=void 0===o?"":o,s=t.nodegroup,c=void 0===s?{}:s,l=t.dependent_nodegroups,u=void 0===l?[]:l,p=t.scale_policy_path,d=[],m=[],h=[],b=[],v={};if(n.name===f.a.fetchSafeFromObject({path:["label","name"],obj:a,default_value:""})&&delete n.name,n.description===f.a.fetchSafeFromObject({path:["label","description"],obj:a,default_value:""})&&delete n.description,c.role_configs.map((function(e){var t=a.nodegroup.role_configs.find((function(t){return t.role_id===e.role_id}));t.node_count&&(delete e.flavor,delete e.flavor_name),e.node_count!==t.node_count&&(e.node_fqdns_to_remove&&(e.node_fqdns_to_remove.length?delete e.node_count:delete e.node_fqdns_to_remove),d.push(e))})),u.map((function(e,t){var r=!!a.dependent_nodegroups&&a.dependent_nodegroups.find((function(t){return parseInt(t.id,10)===e.id}));if(r){var n=[];e.role_configs.map((function(e){var t=r.role_configs.find((function(t){return t.role_id===e.role_id}));t.node_count&&(delete e.flavor,delete e.flavor_name),e.node_count!==t.node_count&&(e.node_fqdns_to_remove&&(e.node_fqdns_to_remove.length?delete e.node_count:delete e.node_fqdns_to_remove),n.push(e))})),n.length&&m.push({id:e.id,role_configs:n})}else h.push(e),u.splice(t,1)})),a.dependent_nodegroups&&a.dependent_nodegroups.map((function(e){u.find((function(t){return t.id===e.id}))||b.push(e.id)})),f.a.isEmptyObject(n)||(v.label=n),t.debug!==a.debug&&(v.debug=t.debug),t.isolated!==a.isolated&&(v.isolated=t.isolated),t.two_phase_delete!==a.two_phase_delete&&(v.two_phase_delete=t.two_phase_delete),d.length&&(v.nodegroup={role_configs:d}),m.length&&(v.dependent_nodegroups=m),h.length&&(v.add_dependent_nodegroups=h),b.length&&(v.remove_dependent_nodegroups=b),p?(a.scale_policy_path&&a.scale_policy_path,v.scale_policy_path=p):a.scale_policy_path&&(v.scale_policy_path=""),f.a.isEmptyObject(v))_n({msg:"Nothing to update",variant:"success"});else{var y=f.a.fetchSafeFromObject({path:["_links","self","href"],obj:a,default_value:""});this.submitRestApi({data:{operation:"reconfigure",change_spec:v,reason:i||""},method:w.method.POST,apiurl:w.apiurl.CLUSTER_CHANGE_TASK(y),name:a.label.name})}}},{key:"getConstraintItemsSchema",value:function(e){var t=e.data,a=e.operation,r=e.constraintFields;return t.constraints.reduce((function(e,t){var n=["unique","is-set","is-unset"].includes(t.operator),o=JSON.parse(JSON.stringify(r.constraintSchema));return"edit_cluster"===a&&t.roles.length&&(o.properties.tag.hidden=!1,o.properties.operator.hidden=!1,o.properties.tag_value.hidden=n,t.tag_value&&(o.properties.tag_value.oneOf=[{type:"string",enum:[t.tag_value]}])),e.push(o),e}),[])}},{key:"getProcessedConstraints",value:function(e){var t=[];return e.constraints.map((function(e){e.roles.length&&(["unique","is-set","is-unset"].includes(e.operator)&&(delete e.tag_value,"is-set"===e.operator&&(e.operator="equal"),"is-unset"===e.operator&&(e.operator="not-equal")),t.push(e))})),t}},{key:"submitRestApi",value:function(e){var t=this,a=e.dryRun,r=void 0!==a&&a,o=e.data,i=e.method,s=void 0===i?w.method.POST:i,c=e.apiurl,l=e.name,u=void 0===l?"":l,p=this.props,d=p.CLUSTER_TYPE,m=p.operation,h=u||f.a.fetchSafeFromObject({path:["label","name"],obj:o,default_value:""});R({method:s,apiurl:c,data:o}).then((function(e){if(r){if("independent_distros"===r){var a=e.data,n=a.independent_nodegroup_selected_roles,o=a.valid_attachments,i=void 0===o?{}:o;n.length?(t.processIndependentRoles(n),Object.keys(Kf.attachSupportList).includes(d)&&"clusters"===Kf.attachSupportList[d].id&&(f.a.isEmptyObject(i)||t.processAttachments(i))):setTimeout((function(){t.doDryRun(r)}),1e3)}else if("dependent_distros"===r){var s=e.data.valid_dependent_catalog_entries,c=void 0===s?[]:s;t.setState({dependent_catalogs:c},(function(){t.processDependentCatalogs()}))}else if("resource_check"===r){var l=e.data,u=(l=void 0===l?{}:l).response,p=(u=void 0===u?{}:u).status,b=void 0===p?201:p,v=u.body,y=[];403===b&&(y=(void 0===v?"":v).split(/\r?\n/)).shift(),t.setState({resource_errors:y})}}else{_n({msg:"Successfully ".concat(["create_cluster","create_template"].includes(m)?"created":"updated"," ").concat(d.split("AIML/").pop()," ").concat(h),variant:"success"});var g=Kf.getViewKey({CLUSTER_TYPE:d});window.location.href=w.views[g].url}})).catch((function(e){if(!r){var t=f.a.parseAxiosError({error:e}),a=n.a.createElement(ns,{errors:["Failed to ".concat(["create_cluster","create_template"].includes(m)?"create":"update"," ").concat(d.split("AIML/").pop()," ").concat(h),t]});_n({msg:a,variant:"error"})}}))}},{key:"render",value:function(){var e=this.state,t=e.clusterFormSchema,a=e.clusterUiSchema,r=e.hasDistros,o=e.resource_errors,i=this.props,s=i.operation,c=i.cluster_list,l=i.cluster_data,u=yh.getNamesNClusterCategories({cluster_list:c});return n.a.createElement("div",null,r?n.a.createElement(En,{form_schema:t,ui_schema:a,formData:this.clusterFormData,form_id:s,method:w.method.POST,action:w.apiurl.CLUSTER,onChange:this.onFormChange,submitter:this.submitClusterAndTemplateForm,nodeRef:this.bdFormRef,validate:function(e,t){return yh.validateForm(e,t,u,s,l,o)}}):n.a.createElement(st.a,null,"Applicable apps are not available, Please contact Project Admin or Site Administrator."))}}])&&kh(t.prototype,a),r&&kh(t,r),i}(r.Component);Ch(Ph,"propTypes",{CLUSTER_TYPE:u.a.string.isRequired,operation:u.a.string.isRequired,cluster_list:u.a.object,catalog_list:u.a.object.isRequired,flavor_list:u.a.object.isRequired,cluster_data:u.a.object,attach_list:u.a.array,cluster_nodes:u.a.object,project_repo:u.a.object,attach:u.a.string,tenantKDC:u.a.string,tags:u.a.array,constraints_supported:u.a.bool});var Ah=Ph;function Rh(e){return(Rh="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Nh(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Fh(e,t){for(var a=0;a<t.length;a++){var r=t[a];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function xh(e,t){return(xh=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Mh(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=Uh(e);if(t){var n=Uh(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return Ih(this,a)}}function Ih(e,t){return!t||"object"!==Rh(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Uh(e){return(Uh=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var Lh=w.clusterTypes.notebook,Bh=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&xh(e,t)}(i,e);var t,a,r,o=Mh(i);function i(){return Nh(this,i),o.apply(this,arguments)}return t=i,r=[{key:"getMeta",value:function(){return{title:"".concat(w.APP_TITLE.ML_OPS," | Create or Update Notebooks"),link:[{rel:"canonical",href:"".concat(w.serverUrl).concat(w.views.createEditDeployment.url)}],meta:[{charset:"utf-8"},{name:"description",content:"Create or Update notebooks."}]}}},{key:"filterAttachmentsClusters",value:function(e,t){var a=e.map((function(e){return f.a.fetchSafeFromObject({path:["_links","self","href"],obj:e,default_value:""})}));return t.clusters.filter((function(e){return a.includes(e)}))}}],(a=[{key:"componentDidMount",value:function(){var e=this.props,t=e.dispatch,a=e.location,r=yh.getClusterCreateParams({location:a});yh.fetchCommonClusterCreateData({dispatch:t,id:r.id})}},{key:"componentWillUnmount",value:function(){var e=this.props.dispatch;yh.clearPageDataCurrentCluster({dispatch:e})}},{key:"render",value:function(){var e=i.getMeta(),t=this.props,a=t.page_data,r=(a=void 0===a?{}:a).catalog_list,o=void 0===r?{}:r,s=a.cluster_list,c=void 0===s?{}:s,l=a.flavor_list,u=void 0===l?{}:l,p=a.current_cluster,d=void 0===p?{}:p,m=a.cluster_nodes,h=void 0===m?{}:m,b=a.hosts_tags,v=void 0===b?{}:b,y=t.stats_data,g=void 0===y?{}:y,_=f.a.fetchSafeFromObject({path:["lock_data","locked"],obj:g,default_value:!1}),S=f.a.fetchSafeFromObject({path:["session_data","current_tenant_data","kdc_type"],obj:g,default_value:""}),k=f.a.fetchSafeFromObject({path:["_embedded","clusters"],obj:c,default_value:[]}),O=f.a.fetchSafeFromObject({path:["_embedded","tags"],obj:v,default_value:[]}),E=f.a.fetchSafeFromObject({path:["session_data","current_tenant_data","constraints_supported"],obj:g,default_value:!1}),j=yh.getClusterCreateParams({location}),D=j.id,w=void 0===D?"":D,C=j.operation,T=C.split("_"),P="".concat(f.a.capitalize(T[0])," Notebook ").concat(f.a.capitalize(T[1])),A=!f.a.isEmptyObject(o)&&!f.a.isEmptyObject(u)&&!f.a.isEmptyObject(v);A&&w&&(A=!f.a.isEmptyObject(d));var R=k.filter((function(e){return e.nodegroup.intended_categories.includes("AIML/Training")&&!["delete_in_progress","starting","error"].includes(e.status)}));return A&&d.attachments&&d.attachments.clusters&&(d.attachments.clusters=i.filterAttachmentsClusters(k,d.attachments)),n.a.createElement("div",{className:"CreateEditNotebookPage"},n.a.createElement(Al.a,{title:e.title,description:e.description,link:e.link,meta:e.meta}),n.a.createElement(Nt,{title:P}),A&&!_?n.a.createElement(Ah,{CLUSTER_TYPE:Lh,operation:C,cluster_list:c,flavor_list:u,catalog_list:o,cluster_data:d,attach_list:R,cluster_nodes:h,tags:O,constraints_supported:E,tenantKDC:S}):n.a.createElement(Ia,null,_?n.a.createElement(st.a,null,"System is in lockdown mode. You will not be able to create the cluster. Contact your site administrator."):n.a.createElement(ls,null)))}}])&&Fh(t.prototype,a),r&&Fh(t,r),i}(r.Component);!function(e,t,a){t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a}(Bh,"propTypes",{classes:u.a.object.isRequired,dispatch:u.a.func.isRequired,stats_data:u.a.object,page_data:u.a.object,location:u.a.object});var Hh=d()(he()((function(){return{}}),{name:"App"}),Object(s.b)((function(e){var t=e.stats_data,a=void 0===t?{}:t,r=e.page_data;return{stats_data:a,page_data:void 0===r?{}:r}})))(Bh);function Kh(e){return(Kh="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function qh(){return(qh=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var r in a)Object.prototype.hasOwnProperty.call(a,r)&&(e[r]=a[r])}return e}).apply(this,arguments)}function Vh(e,t){for(var a=0;a<t.length;a++){var r=t[a];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Gh(e,t,a){return t&&Vh(e.prototype,t),a&&Vh(e,a),e}function zh(e,t){return(zh=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Wh(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=$h(e);if(t){var n=$h(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return Jh(this,a)}}function Jh(e,t){return!t||"object"!==Kh(t)&&"function"!=typeof t?Yh(e):t}function Yh(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function $h(e){return($h=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Qh(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}var Zh=w.clusterTypes.deployment,Xh=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&zh(e,t)}(a,e);var t=Wh(a);function a(e){var r;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,a),Qh(Yh(r=t.call(this,e)),"timeout",null),r.fetchClusterData=r.fetchClusterData.bind(Yh(r)),r}return Gh(a,null,[{key:"getMeta",value:function(){return{title:"".concat(w.APP_TITLE.ML_OPS," | Deployments"),link:[{rel:"canonical",href:"".concat(w.serverUrl).concat(w.views.deployments.url)}],meta:[{charset:"utf-8"},{name:"description",content:"Manage deployments."}]}}}]),Gh(a,[{key:"componentDidMount",value:function(){var e=this.props.dispatch;this.fetchClusterData(),e(Q(oe.CATALOG_DATA)),e(Q(oe.MODEL_DATA))}},{key:"componentWillUnmount",value:function(){clearTimeout(this.timeout)}},{key:"fetchClusterData",value:function(){var e=this,t=this;(0,this.props.dispatch)(Q(oe.CLUSTER_DATA)).then((function(){var a=t.props.page_data,r=(a=void 0===a?{}:a).cluster_list,n=void 0===r?{}:r,o=Kf.filterSelectedClusterType({cluster_list:n,CLUSTER_TYPE:Zh});Kf.liveUpdateClusters(o)&&(e.timeout=setTimeout((function(){t.fetchClusterData()}),3e4))}))}},{key:"render",value:function(){var e=a.getMeta(),t=this.props,r=t.page_data,o=(r=void 0===r?{}:r).catalog_list,i=void 0===o?{}:o,s=r.cluster_list,c=void 0===s?{}:s,l=r.model_list,u=void 0===l?{}:l,p=t.stats_data,d=(p=void 0===p?{}:p).session_data,m=void 0===d?{}:d,h=m.role_name,b=void 0===h?"":h,v=Kf.filterSelectedClusterType({cluster_list:c,CLUSTER_TYPE:Zh}),y=f.a.fetchSafeFromObject({path:["_embedded","models"],obj:u,default_value:[]}).reduce((function(e,t){var a=f.a.fetchSafeFromObject({path:["_links","self","href"],obj:t,default_value:""}),r=f.a.fetchSafeFromObject({path:["label","name"],obj:t,default_value:""});return a&&r&&(e[a]="".concat(r,", ").concat(t.version)),e}),{});return n.a.createElement("div",{className:"DeploymentsPage"},n.a.createElement(Al.a,{title:e.title,description:e.description,link:e.link,meta:e.meta}),n.a.createElement(Nt,{title:"Deployments"}),n.a.createElement(Lm,qh({catalog_list:i,clusters:v,role_name:b,CLUSTER_TYPE:Zh,fetchClusterData:this.fetchClusterData,attachmentNames:y},m)))}}]),a}(r.Component);Qh(Xh,"propTypes",{classes:u.a.object.isRequired,dispatch:u.a.func.isRequired,stats_data:u.a.object,page_data:u.a.object});var eb=d()(he()(qf,{name:"App"}),Object(s.b)((function(e){var t=e.stats_data,a=void 0===t?{}:t,r=e.page_data;return{stats_data:a,page_data:void 0===r?{}:r}})))(Xh);function tb(e){return(tb="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function ab(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function rb(e,t){for(var a=0;a<t.length;a++){var r=t[a];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function nb(e,t){return(nb=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function ob(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=sb(e);if(t){var n=sb(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return ib(this,a)}}function ib(e,t){return!t||"object"!==tb(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function sb(e){return(sb=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var cb=w.clusterTypes.deployment,lb=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&nb(e,t)}(i,e);var t,a,r,o=ob(i);function i(){return ab(this,i),o.apply(this,arguments)}return t=i,r=[{key:"getMeta",value:function(){return{title:"".concat(w.APP_TITLE.ML_OPS," | Create or Update Deployments"),link:[{rel:"canonical",href:"".concat(w.serverUrl).concat(w.views.createEditDeployment.url)}],meta:[{charset:"utf-8"},{name:"description",content:"Create or Update deployments."}]}}}],(a=[{key:"componentDidMount",value:function(){var e=this.props,t=e.dispatch,a=e.location,r=e.stats_data,n=yh.getClusterCreateParams({location:a}),o=f.a.fetchSafeFromObject({path:["session_data","tenant"],obj:r,default_value:{}});t(Q(oe.MODEL_DATA)),t(Q(oe.PROJECT_REPO_DATA(o))),yh.fetchCommonClusterCreateData({dispatch:t,id:n.id})}},{key:"componentWillUnmount",value:function(){var e=this.props.dispatch;yh.clearPageDataCurrentCluster({dispatch:e})}},{key:"render",value:function(){var e=i.getMeta(),t=this.props,a=t.page_data,r=(a=void 0===a?{}:a).catalog_list,o=void 0===r?{}:r,s=a.cluster_list,c=void 0===s?{}:s,l=a.flavor_list,u=void 0===l?{}:l,p=a.current_cluster,d=void 0===p?{}:p,m=a.model_list,h=void 0===m?{}:m,b=a.cluster_nodes,v=void 0===b?{}:b,y=a.hosts_tags,g=void 0===y?{}:y,_=a.project_repo,S=void 0===_?void 0:_,k=t.stats_data,O=void 0===k?{}:k,E=f.a.fetchSafeFromObject({path:["lock_data","locked"],obj:O,default_value:!1}),j=f.a.fetchSafeFromObject({path:["session_data","current_tenant_data","kdc_type"],obj:O,default_value:""}),D=f.a.fetchSafeFromObject({path:["_embedded","models"],obj:h}),w=f.a.fetchSafeFromObject({path:["_embedded","tags"],obj:g,default_value:[]}),C=f.a.fetchSafeFromObject({path:["session_data","current_tenant_data","constraints_supported"],obj:O,default_value:!1}),T=yh.getClusterCreateParams({location}),P=T.id,A=void 0===P?"":P,R=T.operation,N=T.model_id,F=void 0===N?"":N,x=R.split("_"),M="".concat(f.a.capitalize(x[0])," Deployment ").concat(f.a.capitalize(x[1])),I=!f.a.isEmptyObject(o)&&!f.a.isEmptyObject(u)&&!f.a.isEmptyObject(g);return I&&A&&(I=!f.a.isEmptyObject(d)),n.a.createElement("div",{className:"CreateDeploymentPage"},n.a.createElement(Al.a,{title:e.title,description:e.description,link:e.link,meta:e.meta}),n.a.createElement(Nt,{title:M}),I&&S&&!E?n.a.createElement(Ah,{CLUSTER_TYPE:cb,operation:R,attach:F,cluster_list:c,flavor_list:u,catalog_list:o,cluster_data:d,cluster_nodes:v,project_repo:S,attach_list:D,tags:w,constraints_supported:C,tenantKDC:j}):n.a.createElement(Ia,null,E?n.a.createElement(st.a,null,"System is in lockdown mode. You will not be able to create the cluster. Contact your site administrator."):n.a.createElement(ls,null)))}}])&&rb(t.prototype,a),r&&rb(t,r),i}(r.Component);!function(e,t,a){t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a}(lb,"propTypes",{classes:u.a.object.isRequired,dispatch:u.a.func.isRequired,stats_data:u.a.object,page_data:u.a.object,location:u.a.object});var ub=d()(he()((function(){return{}}),{name:"App"}),Object(s.b)((function(e){var t=e.stats_data,a=void 0===t?{}:t,r=e.page_data;return{stats_data:a,page_data:void 0===r?{}:r}})))(lb),pb=a(149),db=a.n(pb),fb=a(249),mb=a.n(fb),hb=function(e){return{appTiles:{display:"flex",flexFlow:"wrap"},tile:{width:"calc(100% + ".concat(2*e.spacing.unit,"px)"),maxWidth:275,minWidth:250,position:"relative",margin:2*e.spacing.unit,padding:"".concat(3*e.spacing.unit,"px 0"),borderRadius:"1rem !important",boxShadow:"".concat(e.shadows[5]," !important"),left:2*-e.spacing.unit},banner:{position:"absolute",top:0,right:.75*e.spacing.unit,color:e.palette.gray700},tileBrand:{position:"relative",height:160,padding:"0 ".concat(e.spacing.unit,"px"),textAlign:"center"},logo:{width:"100%",display:"block",height:100,position:"relative",overflow:"hidden",whiteSpace:"nowrap",backgroundRepeat:"no-repeat",backgroundPosition:"center center",backgroundSize:200,transition:"transform 0.5s linear"},textLogo:{fontSize:82,textTransform:"capitalize",fontWeight:"bold",color:e.palette.primary.main},tileInfo:{position:"absolute",bottom:0,width:"100%",marginLeft:-e.spacing.unit},moreInfo:{cursor:"pointer","& .icon":{color:e.typography.fontColor,verticalAlign:"middle"}},name:{fontSize:e.typography.fontSizeMedium,fontFamily:e.typography.fontFamilyBold,lineHeight:1,padding:"0 ".concat(e.spacing.unit,"px")},actions:{padding:0,justifyContent:"center"},detail:{alignItems:"center"},img:{textAlign:"center"},link:{textDecoration:"none"}}};function bb(e){return(bb="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function vb(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function yb(e,t){for(var a=0;a<t.length;a++){var r=t[a];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function gb(e,t){return(gb=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function _b(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=kb(e);if(t){var n=kb(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return Sb(this,a)}}function Sb(e,t){return!t||"object"!==bb(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function kb(e){return(kb=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var Ob=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&gb(e,t)}(i,e);var t,a,r,o=_b(i);function i(){return vb(this,i),o.apply(this,arguments)}return t=i,(a=[{key:"shouldComponentUpdate",value:function(e){var t=e.acls,a=this.props.acls;return f.a.isEqual(a,t)}},{key:"render",value:function(){var e=this.props,t=e.catalog,a=e.classes,r=e.dependent,o=void 0!==r&&r,i=e.acls,s=(i=void 0===i?{}:i).category,c=i.distro_id,l=e.updateAclList,u=e.showCatalogDetail,p=e.userRole,d=c.length&&c.includes("Member"),m=f.a.fetchSafeFromObject({path:["logo","url"],obj:t}),h=f.a.fetchSafeFromObject({path:["label","name"],obj:t,default_value:""});return n.a.createElement(Hp.a,{className:a.tile},o?n.a.createElement("span",{className:a.banner},"Add-on Image"):"",n.a.createElement(qp.a,{className:a.tileBrand},m?n.a.createElement("span",{className:a.logo,style:{backgroundImage:"url(".concat(t.logo.url,")")}}):n.a.createElement("span",{className:a.textLogo},h.substring(0,1)),n.a.createElement("div",{className:a.tileInfo},n.a.createElement(st.a,{variant:"caption",component:"h3",className:a.name},h),n.a.createElement(st.a,{className:a.moreInfo,onClick:function(){u(t)}},"More info ",n.a.createElement("span",{className:"icon icon-chevron-right"})))),"Member"!==p?n.a.createElement(db.a,{className:a.actions},n.a.createElement(st.a,{variant:"caption"},"Allow access for role: Member"),n.a.createElement(mb.a,{value:"installed",color:"primary",checked:!d,disabled:!!s.length,onChange:function(){l(d?"reinstate":"revoke",t.distro_id,h)}})):"")}}])&&yb(t.prototype,a),r&&yb(t,r),i}(r.Component);!function(e,t,a){t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a}(Ob,"propTypes",{classes:u.a.object,catalog:u.a.object,acls:u.a.object,updateAclList:u.a.func,showCatalogDetail:u.a.func,tenantApiUrl:u.a.string,userRole:u.a.string,dependent:u.a.bool});var Eb=he()(hb)(Ob);function jb(e){return(jb="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Db(){return(Db=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var r in a)Object.prototype.hasOwnProperty.call(a,r)&&(e[r]=a[r])}return e}).apply(this,arguments)}function wb(e,t){for(var a=0;a<t.length;a++){var r=t[a];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Cb(e,t,a){return t&&wb(e.prototype,t),a&&wb(e,a),e}function Tb(e,t){return(Tb=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Pb(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=Nb(e);if(t){var n=Nb(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return Ab(this,a)}}function Ab(e,t){return!t||"object"!==jb(t)&&"function"!=typeof t?Rb(e):t}function Rb(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Nb(e){return(Nb=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var Fb=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Tb(e,t)}(a,e);var t=Pb(a);function a(e){var r;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,a),(r=t.call(this,e)).state={selected_catalog:{}},r.fetchAppStorePageData=r.fetchAppStorePageData.bind(Rb(r)),r.fetchTenantAclData=r.fetchTenantAclData.bind(Rb(r)),r.updateAclList=r.updateAclList.bind(Rb(r)),r.showCatalogDetail=r.showCatalogDetail.bind(Rb(r)),r.bdModalChildRef=n.a.createRef(),r}return Cb(a,null,[{key:"getMeta",value:function(){return{title:"".concat(w.APP_TITLE.ML_OPS," | App Store"),link:[{rel:"canonical",href:"".concat(w.serverUrl).concat(w.views.aimlApps.url)}],meta:[{charset:"utf-8"},{name:"description",content:"Manage applications"}]}}}]),Cb(a,[{key:"componentDidMount",value:function(){this.fetchAppStorePageData()}},{key:"fetchAppStorePageData",value:function(){var e=this,t=this.props,a=t.dispatch,r=t.stats_data,n=void 0===r?{}:r,o=f.a.fetchSafeFromObject({path:["session_data","tenant"],obj:n,default_value:""});o?(a(Q(oe.CATALOG_DATA)),this.fetchTenantAclData(o)):setTimeout((function(){e.fetchAppStorePageData()}),50)}},{key:"fetchTenantAclData",value:function(e){(0,this.props.dispatch)(Q(oe.TENANT_ACLS_DATA(e)))}},{key:"updateAclList",value:function(e,t,a){var r=this,o=this.props,i=o.page_data,s=(i=void 0===i?{}:i).tenant_acls,c=(s=void 0===s?{}:s).category,l=void 0===c?{}:c,u=s.distro_id,p=void 0===u?{}:u,d=o.stats_data,m=void 0===d?{}:d,h=f.a.fetchSafeFromObject({path:["session_data","tenant"],obj:m,default_value:""});"revoke"===e?(p[t]||(p[t]=[]),p[t].push("Member")):p[t].splice(p[t].indexOf("Member",1)),R({method:w.method.PUT,apiurl:w.apiurl.TENANT_ACLS(h),data:{category:l,distro_id:p}}).then((function(){_n({msg:"Access of ".concat(a," for users is ").concat(e,"d"),variant:"success"}),r.fetchTenantAclData(h)})).catch((function(t){var r=f.a.parseAxiosError({error:t}),o=n.a.createElement(ns,{errors:["Failed to ".concat(e," access of ").concat(a," for users"),r]});_n({msg:o,variant:"error"})}))}},{key:"showCatalogDetail",value:function(e){var t=this;this.setState({selected_catalog:e},(function(){t.bdModalChildRef.current.handleOpen()}))}},{key:"render",value:function(){var e=this,t=a.getMeta(),r=this.props,o=r.page_data,i=r.classes,s=r.stats_data,c=void 0===s?{}:s,l=r.location,u=f.a.fetchSafeFromObject({path:["session_data","tenant"],obj:c,default_value:""}),p=f.a.fetchSafeFromObject({path:["session_data","role_name"],obj:c,default_value:""}),d=o.catalog_list,m=void 0===d?{}:d,h=o.tenant_acls,b=(h=void 0===h?{}:h).category,v=void 0===b?{}:b,y=h.distro_id,g=void 0===y?{}:y,_=[{label:"Training",key:"AIML/Training"},{label:"Notebook",key:"AIML/Notebook"},{label:"Deployment",key:"AIML/Deployment"}],S=_.map((function(t){var a=f.a.fetchSafeFromObject({path:["_embedded","independent_catalog_entries"],obj:m,default_value:[]}).filter((function(e){return"installed"===e.state&&e.categories&&e.categories.includes(t.key)})),r=f.a.fetchSafeFromObject({path:["_embedded","dependent_catalog_entries"],obj:m,default_value:[]}).filter((function(e){return"installed"===e.state&&e.categories&&e.categories.includes(t.key)}));return n.a.createElement("div",{className:i.appTiles,key:t.key},a.map((function(a){return n.a.createElement(Eb,Db({catalog:a,tenantApiUrl:u,userRole:p,acls:{category:v[t.key]||[],distro_id:g[a.distro_id]||[]},updateAclList:e.updateAclList,showCatalogDetail:e.showCatalogDetail},{key:a.distro_id}))})),r.map((function(a){return n.a.createElement(Eb,Db({catalog:a,tenantApiUrl:u,userRole:p,acls:{category:v[t.key]||[],distro_id:g[a.distro_id]||[]},updateAclList:e.updateAclList,showCatalogDetail:e.showCatalogDetail,dependent:!0},{key:a.distro_id}))})))})),k=this.state.selected_catalog,O=(k=void 0===k?{}:k).label,E=(O=void 0===O?"":O).name,j=void 0===E?"":E,D=O.description,C=void 0===D?"":D,T=k.logo,P=(T=void 0===T?{}:T).url,A=void 0===P?"":P,R=k.distro_id,N=void 0===R?"":R,F=k.version,x=void 0===F?"":F,M=k.categories,I=void 0===M?[]:M;return n.a.createElement("div",{className:"AppStorePage"},n.a.createElement(Al.a,{title:t.title,description:t.description,link:t.link,meta:t.meta}),n.a.createElement(Nt,{title:"App Store",icon:n.a.createElement("img",{style:{width:"4rem",verticalAlign:"text-bottom",marginRight:"1rem"},src:"".concat(w.views.staticUrl,"/assets/images/hpe-ezmeral-gem.png")})}),n.a.createElement(_o,{tabs:_,tabContents:S,location:l}),n.a.createElement(In,{Title:n.a.createElement(st.a,{variant:"h2"},"Catalog Details"),name:"Catalog detail",description:"Modal to display catalog details",ref:this.bdModalChildRef,footerCloseBtn:!0,onModalClose:function(){return e.setState({selected_catalog:{}})}},n.a.createElement(bc.a,{container:!0,className:i.detail,spacing:16},n.a.createElement(bc.a,{xs:5,item:!0,className:i.img},A?n.a.createElement("span",{className:i.logo,style:{backgroundImage:"url(".concat(A,")")}}):n.a.createElement("span",{className:i.textLogo},j.substring(0,1)),n.a.createElement(st.a,{variant:"caption",component:"h3",className:i.name},j)),n.a.createElement(bc.a,{xs:7,item:!0,className:i.info},n.a.createElement(st.a,{variant:"caption"},C),n.a.createElement(st.a,{variant:"caption"},"Image Version: ",x),n.a.createElement(st.a,{variant:"caption"},"Distro Id: ",N),n.a.createElement(st.a,{variant:"caption"},I.length>1?"Categories":"Category",": ",I.join(", "))))))}}]),a}(r.Component);!function(e,t,a){t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a}(Fb,"propTypes",{classes:u.a.object,dispatch:u.a.func.isRequired,stats_data:u.a.object,page_data:u.a.object,location:u.a.object});var xb=d()(he()(hb,{name:"App"}),Object(s.b)((function(e){var t=e.stats_data,a=void 0===t?{}:t,r=e.page_data;return{stats_data:a,page_data:void 0===r?{}:r}})))(Fb),Mb=["mounting","unmounting"],Ib=["creating","updating","deleting"],Ub={isDataSourceLocal:function(e){var t=e.data_source,a=e.g_install;if(f.a.isEmptyObject(t)||f.a.isEmptyObject(a))return!1;var r=f.a.fetchSafeFromObject({path:["_embedded","endpoint","host"],obj:t,default_value:""}),n=f.a.fetchSafeFromObject({path:["_embedded","endpoint","type"],obj:t,default_value:"hdfs"}),o=f.a.fetchSafeFromObject({path:["_embedded","is_protected"],obj:t,default_value:!1});if("hdfs"===n){if(r)return function(e,t){var a=t.primary_ip,r=void 0===a?"":a,n=t.primary_hostname,o=void 0===n?"":n,i=t.shadow_ip,s=void 0===i?"":i,c=t.shadow_hosthame,l=void 0===c?"":c;return!!("127.0.0.1"===e||"localhost"===e||"localhost.localdomain"===e||r&&e===r||o&&e===o||s&&e===s||l&&e===l)}(r,a)}else if("mapr"===n&&o)return!0;return!1},processDataSourcesData:function(e){var t=e.data_sources,a=void 0===t?[]:t,r=e.source_type,n=e.isMember;return a.map((function(e){return function(e){var t=e._embedded||{},a=f.a.fetchSafeFromObject({path:["_links","self","href"],obj:e,default_value:""}),o=[];if("dataTap"===r){var i=t.label,s=void 0===i?{}:i,c=t.endpoint,l=void 0===c?{}:c,u=t.bdfs_root,p=void 0===u?{}:u,d=t.flags,m=void 0===d?{}:d,h=t.status,b=void 0===h?"":h,v=t.is_protected,y=void 0!==v&&v,g=l.browse_only,_=void 0!==g&&g,S=l.keytab,k=void 0===S?"":S,O=l.type,E=void 0===O?"":O,j=l.host,D=void 0===j?"":j,w=l.port,C=void 0===w?"":w,T=l.backup_host,P=void 0===T?"":T,A=l.kdc_data,R=void 0===A?[]:A,N=l.cldb,F=void 0===N?[]:N,x=l.secure,M=void 0!==x&&x,I=l.cluster_name,U=void 0===I?"":I,L=l.ticket,B=void 0===L?"":L,H=l.ticket_type,K=void 0===H?"":H,q=l.ticket_user,V=void 0===q?"":q,G=l.impersonation_enabled,z=void 0!==G&&G,W=l.mapr_tenant_volume,J=void 0!==W&&W,Y=s.name,$=void 0===Y?"":Y,Q=m.read_only,Z=void 0!==Q&&Q,X=p.path_from_endpoint||"",ee=!!R.find((function(e){return e.host}));o=[JSON.stringify({name:$,id:a,browse_only:_,keytab:k,source_type:r}),"mapr"===E?F.join(","):D,X,JSON.stringify({source_type:r,type:E,path:X,port:C,backup_host:P,browse_only:_,kerberos_protected:ee,keytab:k,read_only:Z,secure:M,cluster_name:U,ticket:B,ticket_type:K,ticket_user:V,impersonation_enabled:z,mapr_tenant_volume:J}),b,JSON.stringify({source_type:r,id:a,name:$,type:E,is_protected:y})]}else{var te=t.mountspec,ae=void 0===te?{}:te,re=t.status,ne=void 0===re?{}:re,oe=ae.mount_name,ie=ae.host,se=ae.type,ce=ae.export_path,le=ae.read_only;o=[JSON.stringify({name:oe,id:a,browse_only:!1,keytab:!1,source_type:r}),ie,ce,JSON.stringify({source_type:r,type:se,path:ce,read_only:le}),ne.status||"",JSON.stringify({source_type:r,id:a,name:oe,type:se})]}return n&&o.pop(),o}(e)}))},liveUpdateDataSource:function(e,t){var a="fsMount"===t?Mb:Ib;return e.some((function(e){var r="fsMount"===t?f.a.fetchSafeFromObject({path:["_embedded","status","status"],obj:e,default:""}):f.a.fetchSafeFromObject({path:["_embedded","status"],obj:e,default:""});return a.includes(r)}))},sourceTypeLabel:{fsMount:"FsMount",dataTap:"DataTap",datasource:"Data Source"}};function Lb(e){return(Lb="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Bb(e){return function(e){if(Array.isArray(e))return Hb(e)}(e)||function(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||function(e,t){if(!e)return;if("string"==typeof e)return Hb(e,t);var a=Object.prototype.toString.call(e).slice(8,-1);"Object"===a&&e.constructor&&(a=e.constructor.name);if("Map"===a||"Set"===a)return Array.from(e);if("Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a))return Hb(e,t)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Hb(e,t){(null==t||t>e.length)&&(t=e.length);for(var a=0,r=new Array(t);a<t;a++)r[a]=e[a];return r}function Kb(e,t){for(var a=0;a<t.length;a++){var r=t[a];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function qb(e,t,a){return t&&Kb(e.prototype,t),a&&Kb(e,a),e}function Vb(e,t){return(Vb=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Gb(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=Jb(e);if(t){var n=Jb(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return zb(this,a)}}function zb(e,t){return!t||"object"!==Lb(t)&&"function"!=typeof t?Wb(e):t}function Wb(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Jb(e){return(Jb=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var Yb=Ub.sourceTypeLabel,$b=void 0===Yb?"":Yb,Qb=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Vb(e,t)}(a,e);var t=Gb(a);function a(e){var r;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,a),(r=t.call(this,e)).deleteDataSource=r.deleteDataSource.bind(Wb(r)),r.deleteDataSourceList=r.deleteDataSourceList.bind(Wb(r)),r.getDataSourcesTableSettings=r.getDataSourcesTableSettings.bind(Wb(r)),r.nameColRenderer=r.nameColRenderer.bind(Wb(r)),r.actionRenderer=r.actionRenderer.bind(Wb(r)),r.bdDeleteDialog=n.a.createRef(),r.timeout=null,r.state={sourceType:$b[r.props.source_type]},r}return qb(a,null,[{key:"getMeta",value:function(){return{title:"".concat(w.APP_TITLE.CP," | Manage DataTaps"),link:[{rel:"canonical",href:"".concat(w.serverUrl).concat(w.views.managek8sDataTaps.url)}],meta:[{charset:"utf-8"},{name:"description",content:"Manage DataTaps"}],pageTitle:"DataTaps"}}}]),qb(a,[{key:"componentWillUnmount",value:function(){clearTimeout(this.timeout)}},{key:"deleteDataSourceList",value:function(e){var t=this,a=e.selected_rows,r=this.props.data;a.data.map((function(e){var a=e.dataIndex,n=JSON.parse(r[a][0]),o=n.name,i=n.id,s=n.source_type;t.deleteDataSource({name:o,id:i,source_type:s})}))}},{key:"deleteDataSource",value:function(e){var t=this,a=e.name,r=e.id,o=e.source_type,i=this.props.fetchDataSources,s=this.state.sourceType;R({apiurl:r,method:w.method.DELETE}).then((function(e){f.a.isHttpStatusOk(e.status)?(_n({msg:"".concat(s," '").concat(a,"' successfully deleted"),variant:"success"}),t.timeout=setTimeout((function(){i({source_type:o})}),200)):_n({msg:"Exception occured while deleting ".concat(s),variant:"error"})})).catch((function(e){var t=f.a.parseAxiosError({error:e}),r=n.a.createElement("div",null,n.a.createElement(st.a,{variant:"caption"},"Failed to delete the ".concat(s," '").concat(a,"'")),n.a.createElement(st.a,{variant:"caption"},t));_n({msg:r,variant:"error"})}))}},{key:"nameColRenderer",value:function(e){var t=this.props,a=t.kubernetes_access,r=t.disableDataSourceBrowse,o=this.state.sourceType,i=JSON.parse(e),s=i.id,c=i.name,l=i.browse_only,u=i.keytab,p=i.source_type;if(r)return n.a.createElement(n.a.Fragment,null,n.a.createElement(st.a,{variant:"body2"},c),n.a.createElement(st.a,{variant:"caption"},"(".concat("dataTap"===p?"dtap://":"/bd-fs-mnt/").concat(c,")")));var d="".concat(o," is not configured with a Kerberos keytab to support browsing."),f=a?"k8sDataSource":"dataSource";return l&&!u?n.a.createElement(ka,{title:d,variant:"info"},n.a.createElement(st.a,{variant:"body2"},c)):n.a.createElement(lo.a,{to:w.views[f].makeUrl({id:s,source_type:p}),className:"link"},c)}},{key:"actionRenderer",value:function(e){var t=this,a=this.props.kubernetes_access,r=this.state.sourceType,o=JSON.parse(e),i=o.source_type,s=o.is_protected,c=o.id,l=o.name,u=o.type,p=a?"k8sCreateEditDataSource":"createEditDataSource";return"dataTap"===i&&s||"bind"===u?"":n.a.createElement("div",{className:"row-action-btns"},n.a.createElement(ka,{title:"Edit",variant:"primary"},n.a.createElement(lo.a,{to:w.views[p].editUrl({id:c,source_type:i}),className:"link"},n.a.createElement("span",{className:"icon icon-rect-link icon-pencil3"}))),n.a.createElement(ka,{title:"Delete",variant:"error"},n.a.createElement("span",{className:"icon icon-rect-link icon-trash2",onClick:function(){var e={callback:t.deleteDataSource,context:{id:c,name:l,source_type:i},title:"Delete ".concat(r," (").concat(l,")"),description:"Confirm Deletion. This action cannot be undone."};t.bdDeleteDialog.current.handleOpen(e)}})))}},{key:"getDataSourcesTableSettings",value:function(){var e=this,t=this.props,a=t.isMember,r=t.data,o=t.createDataSourceUrl,i=t.createBtnLabel,s=a?"none":"multiple",c=[{name:"Name",options:{filter:!0,customBodyRender:this.nameColRenderer}},{name:"Host",options:{filter:!0}},{name:"Path",options:{filter:!0}},{name:"Details",options:{filter:!0,customBodyRender:function(e){var t=JSON.parse(e),a=t.type,r=t.port,o=void 0===r?"":r,i=t.backup_host,s=void 0===i?"":i,c=t.browse_only,l=void 0!==c&&c,u=t.read_only,p=void 0!==u&&u,d=t.kerberos_protected,f=void 0!==d&&d,m=t.keytab,h=void 0===m?"":m,b=t.secure,v=t.cluster_name,y=t.ticket,g=t.ticket_type,_=t.ticket_user,S=t.impersonation_enabled,k=t.mapr_tenant_volume,O="mapr"===a&&b,E="mapr"===a?"CLDB Port":"Port",j="servicewithimpersonation"===g?"service with impersonation":g;return n.a.createElement("div",null,n.a.createElement(st.a,{variant:"body2"},"Type: ",a),o?n.a.createElement(st.a,{variant:"body2"},E,": ",o):"","mapr"===a?v&&n.a.createElement(st.a,{variant:"body2"},"Cluster Name: ",v):"",O?n.a.createElement(n.a.Fragment,null,y?n.a.createElement(st.a,{variant:"body2"},"Ticket File: ",y):"",_?n.a.createElement(st.a,{variant:"body2"},"Ticket User: ",_):"",g?n.a.createElement(st.a,{variant:"body2"},"Ticket Type: ",j):"",n.a.createElement(st.a,{variant:"body2"},"MapR Tenant Volume: ",k?"true":"false"),n.a.createElement(st.a,{variant:"body2"},"Impersonation Enabled: ",S?"true":"false")):"",s?n.a.createElement(st.a,{variant:"body2"},"Standby NameNode Host: ",s):"",f?n.a.createElement(n.a.Fragment,null,n.a.createElement(st.a,{variant:"body2"},"Kerberos Protected"),l?n.a.createElement(n.a.Fragment,null,n.a.createElement(st.a,{variant:"body2"},"Passthrough"),h?"":n.a.createElement(st.a,{variant:"body2"},"Browsing not supported")):n.a.createElement(st.a,{variant:"body2"},"Proxy")):"",n.a.createElement(st.a,{variant:"body2"},"Read Only: ",p?"true":"false"))}}},{name:"Status",options:{filter:!0,customBodyRender:function(e){return n.a.createElement(Qa,{status:e,title:e})}}}].concat(Bb(a?[]:[{name:"Actions",options:{filter:!0,customBodyRender:this.actionRenderer}}])),l={customToolbar:function(){return a?"":n.a.createElement("div",{className:"tableActionButtons"},n.a.createElement(Ue.a,{variant:"contained",color:"primary",component:lo.a,to:o},i))},customToolbarSelect:function(t){return n.a.createElement("div",{className:"tableActionButtonsSelected"},n.a.createElement(Ue.a,{variant:"contained",color:"secondary",onClick:function(){var a={callback:e.deleteDataSourceList,context:{selected_rows:t},title:"Delete selected data sources(s)",description:"Confirm Deletion. This action cannot be undone."};e.bdDeleteDialog.current.handleOpen(a)}},"Delete"))},selectableRows:s};return a||(l.isRowSelectable=function(e,t){if(t){var a=t[t.length-1],r=JSON.parse(a),n=r.is_protected,o=void 0!==n&&n,i=r.source_type,s=r.type;return"fsMount"===i?"bind"!==s:!o}return!1}),{columns:c,data:r,options:l}}},{key:"render",value:function(){var e=this.getDataSourcesTableSettings();return n.a.createElement(n.a.Fragment,null,n.a.createElement(sa,e),n.a.createElement(no,{ref:this.bdDeleteDialog}))}}]),a}(r.Component);!function(e,t,a){t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a}(Qb,"propTypes",{fetchDataSources:u.a.func,data:u.a.array.isRequired,kubernetes_access:u.a.bool,isMember:u.a.bool,createDataSourceUrl:u.a.string,createBtnLabel:u.a.string,source_type:u.a.string,disableDataSourceBrowse:u.a.bool});var Zb=Qb;function Xb(e){return(Xb="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function ev(e){return function(e){if(Array.isArray(e))return tv(e)}(e)||function(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||function(e,t){if(!e)return;if("string"==typeof e)return tv(e,t);var a=Object.prototype.toString.call(e).slice(8,-1);"Object"===a&&e.constructor&&(a=e.constructor.name);if("Map"===a||"Set"===a)return Array.from(e);if("Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a))return tv(e,t)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function tv(e,t){(null==t||t>e.length)&&(t=e.length);for(var a=0,r=new Array(t);a<t;a++)r[a]=e[a];return r}function av(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function rv(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?av(Object(a),!0).forEach((function(t){pv(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):av(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function nv(e,t){for(var a=0;a<t.length;a++){var r=t[a];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function ov(e,t,a){return t&&nv(e.prototype,t),a&&nv(e,a),e}function iv(e,t){return(iv=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function sv(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=uv(e);if(t){var n=uv(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return cv(this,a)}}function cv(e,t){return!t||"object"!==Xb(t)&&"function"!=typeof t?lv(e):t}function lv(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function uv(e){return(uv=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function pv(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}var dv=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&iv(e,t)}(a,e);var t=sv(a);function a(e){var r;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,a),pv(lv(r=t.call(this,e)),"CancelToken",T.a.CancelToken),r.fetchDataSources=r.fetchDataSources.bind(lv(r)),r.timeouts={},r.fetchData={},r}return ov(a,null,[{key:"getMeta",value:function(){return{title:"".concat(w.APP_TITLE.ML_OPS," | Manage Data Sources"),link:[{rel:"canonical",href:"".concat(w.serverUrl).concat(w.views.manageDataSources.url)}],meta:[{charset:"utf-8"},{name:"description",content:"Manage Data Sources"}],pageTitle:"Data Sources"}}}]),ov(a,[{key:"componentDidMount",value:function(){this.fetchDataSources({source_type:"all"})}},{key:"componentWillUnmount",value:function(){var e=this,t=Object.keys(this.timeouts),a=Object.keys(this.fetchData);t.length&&t.map((function(t){return clearTimeout(e.timeouts[t])})),a.length&&a.map((function(t){return e.fetchData[t].cancel("component unmounted")}))}},{key:"fetchDataSources",value:function(e){var t=this,a=e.source_type,r=this.props.dispatch;if(["all","dataTap"].includes(a)){this.fetchData.dataTap=this.CancelToken.source();var n=this.fetchData.dataTap.token;r(Q(rv(rv({},oe.DATATAP_DATA),{},{cancelToken:n}))).then((function(){delete t.fetchData.dataTap;var e=t.props.dataTap_list;Ub.liveUpdateDataSource(e,"dataTap")&&(t.timeouts.dataTap=setTimeout((function(){t.fetchDataSources({source_type:"dataTap"})}),5e3))}))}if(["all","fsMount"].includes(a)){this.fetchData.fsMount=this.CancelToken.source();var o=this.fetchData.fsMount.token;r(Q(rv(rv({},oe.FSMOUNT_DATA),{},{cancelToken:o}))).then((function(){delete t.fetchData.fsMount;var e=t.props.fsMount_list;Ub.liveUpdateDataSource(e,"fsMount")&&(t.timeouts.fsMount=setTimeout((function(){t.fetchDataSources({source_type:"fsMount"})}),5e3))}))}}},{key:"render",value:function(){var e=this.props,t=e.kubernetes_access,r=e.dataTap_list,o=e.fsMount_list,i=e.isMember,s=e.disableDataSourceBrowse,c=a.getMeta(),l=Ub.processDataSourcesData({data_sources:r,isMember:i,source_type:"dataTap"}),u=Ub.processDataSourcesData({data_sources:o,isMember:i,source_type:"fsMount"});return n.a.createElement("div",{className:"ManageDataSourcePage"},n.a.createElement(Al.a,{title:c.title,description:c.description,link:c.link,meta:c.meta}),n.a.createElement(Nt,{title:c.pageTitle}),n.a.createElement(Zb,{data:[].concat(ev(l),ev(u)),kubernetes_access:t,isMember:i,fetchDataSources:this.fetchDataSources,createDataSourceUrl:w.views.createEditDataSource.url,createBtnLabel:"Add Data Source",source_type:"datasource",disableDataSourceBrowse:s}))}}]),a}(r.Component);pv(dv,"propTypes",{dispatch:u.a.func.isRequired,dataTap_list:u.a.array,fsMount_list:u.a.array,kubernetes_access:u.a.bool,isMember:u.a.bool,disableDataSourceBrowse:u.a.bool});var fv=Object(s.b)((function(e){var t=e.stats_data,a=(t=void 0===t?{}:t).session_data,r=(a=void 0===a?{}:a).role_name,n=void 0===r?"":r,o=a.current_tenant_data,i=void 0===o?{}:o,s=a.disableDataSourceBrowse,c=void 0===s||s,l=e.page_data,u=void 0===l?{}:l,p=f.a.fetchSafeFromObject({path:["dataTap_list","_embedded","data_connectors"],obj:u,default_value:[]}),d=f.a.fetchSafeFromObject({path:["fsMount_list","_embedded","filesystems"],obj:u,default_value:[]}),m=f.a.fetchSafeFromObject({path:["features","kubernetes_access"],obj:i,default_value:!1});return{isMember:n===w.ROLE_NAME.MEMBER,kubernetes_access:m,dataTap_list:p,fsMount_list:d,disableDataSourceBrowse:c}}))(dv);function mv(e){return(mv="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function hv(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function bv(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?hv(Object(a),!0).forEach((function(t){Ev(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):hv(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function vv(e,t){for(var a=0;a<t.length;a++){var r=t[a];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function yv(e,t,a){return t&&vv(e.prototype,t),a&&vv(e,a),e}function gv(e,t){return(gv=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function _v(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=Ov(e);if(t){var n=Ov(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return Sv(this,a)}}function Sv(e,t){return!t||"object"!==mv(t)&&"function"!=typeof t?kv(e):t}function kv(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Ov(e){return(Ov=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Ev(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}var jv=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&gv(e,t)}(a,e);var t=_v(a);function a(e){var r;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,a),Ev(kv(r=t.call(this,e)),"CancelToken",T.a.CancelToken),r.fetchDataSources=r.fetchDataSources.bind(kv(r)),r.source=null,r.timeout=null,r}return yv(a,null,[{key:"getMeta",value:function(){return{title:"".concat(w.APP_TITLE.CP," | Manage DataTaps"),link:[{rel:"canonical",href:"".concat(w.serverUrl).concat(w.views.managek8sDataTaps.url)}],meta:[{charset:"utf-8"},{name:"description",content:"Manage DataTaps"}],pageTitle:"DataTaps"}}}]),yv(a,[{key:"componentDidMount",value:function(){this.fetchDataSources()}},{key:"componentWillUnmount",value:function(){this.source&&this.source.cancel("component unmounted"),this.timeout&&clearTimeout(this.timeout)}},{key:"fetchDataSources",value:function(){var e=this,t=this.props.dispatch;this.source=this.CancelToken.source();var a=this.source.token;t(Q(bv(bv({},oe.DATATAP_DATA),{},{cancelToken:a}))).then((function(){e.source=null;var t=e.props.dataTap_list;Ub.liveUpdateDataSource(t,"dataTap")&&(e.timeout=setTimeout((function(){e.fetchDataSources()}),5e3))}))}},{key:"render",value:function(){var e=this.props,t=e.kubernetes_access,r=e.dataTap_list,o=e.isMember,i=e.disableDataSourceBrowse,s=a.getMeta(),c=Ub.processDataSourcesData({data_sources:r,isMember:o,source_type:"dataTap"});return n.a.createElement("div",{className:"ManageDataSourcePage"},n.a.createElement(Al.a,{title:s.title,description:s.description,link:s.link,meta:s.meta}),n.a.createElement(Nt,{title:s.pageTitle}),n.a.createElement(Zb,{data:c,kubernetes_access:t,isMember:o,fetchDataSources:this.fetchDataSources,createDataSourceUrl:w.views.k8sCreateEditDataSource.makeUrl({source_type:"dataTap"}),createBtnLabel:"Add DataTap",source_type:"dataTap",disableDataSourceBrowse:i}))}}]),a}(r.Component);Ev(jv,"propTypes",{dispatch:u.a.func.isRequired,dataTap_list:u.a.array,kubernetes_access:u.a.bool,isMember:u.a.bool,disableDataSourceBrowse:u.a.bool});var Dv=Object(s.b)((function(e){var t=e.stats_data,a=(t=void 0===t?{}:t).session_data,r=(a=void 0===a?{}:a).role_name,n=void 0===r?"":r,o=a.current_tenant_data,i=void 0===o?{}:o,s=a.disableDataSourceBrowse,c=void 0===s||s,l=e.page_data,u=void 0===l?{}:l,p=f.a.fetchSafeFromObject({path:["dataTap_list","_embedded","data_connectors"],obj:u,default_value:[]}),d=f.a.fetchSafeFromObject({path:["features","kubernetes_access"],obj:i,default_value:!1});return{isMember:n===w.ROLE_NAME.MEMBER,kubernetes_access:d,dataTap_list:p,disableDataSourceBrowse:c}}))(jv);function wv(e){return(wv="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Cv(e,t){for(var a=0;a<t.length;a++){var r=t[a];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Tv(e,t,a){return t&&Cv(e.prototype,t),a&&Cv(e,a),e}function Pv(e,t){return(Pv=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Av(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=Fv(e);if(t){var n=Fv(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return Rv(this,a)}}function Rv(e,t){return!t||"object"!==wv(t)&&"function"!=typeof t?Nv(e):t}function Nv(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Fv(e){return(Fv=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var xv=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Pv(e,t)}(a,e);var t=Av(a);function a(e){var r;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,a),(r=t.call(this,e)).fetchDataSources=r.fetchDataSources.bind(Nv(r)),r.timeout=null,r}return Tv(a,null,[{key:"getMeta",value:function(){return{title:"".concat(w.APP_TITLE.CP," | Manage Filesystem Mounts"),link:[{rel:"canonical",href:"".concat(w.serverUrl).concat(w.views.managek8sDataTaps.url)}],meta:[{charset:"utf-8"},{name:"description",content:"Manage Filesystem Mounts"}],pageTitle:"FsMounts"}}}]),Tv(a,[{key:"componentDidMount",value:function(){this.fetchDataSources()}},{key:"componentWillUnmount",value:function(){clearTimeout(this.timeout)}},{key:"fetchDataSources",value:function(){var e=this,t=this;(0,this.props.dispatch)(Q(oe.FSMOUNT_DATA)).then((function(){var a=e.props.fsMount_list;Ub.liveUpdateDataSource(a,"fsMount")&&(e.timeout=setTimeout((function(){t.fetchDataSources()}),5e3))}))}},{key:"render",value:function(){var e=this.props,t=e.kubernetes_access,r=e.fsMount_list,o=e.isMember,i=e.disableDataSourceBrowse,s=a.getMeta(),c=Ub.processDataSourcesData({data_sources:r,isMember:o,source_type:"fsMount"});return n.a.createElement("div",{className:"ManageDataSourcePage"},n.a.createElement(Al.a,{title:s.title,description:s.description,link:s.link,meta:s.meta}),n.a.createElement(Nt,{title:s.pageTitle}),n.a.createElement(Zb,{data:c,kubernetes_access:t,isMember:o,fetchDataSources:this.fetchDataSources,createDataSourceUrl:w.views.k8sCreateEditDataSource.makeUrl({source_type:"fsMount"}),createBtnLabel:"Add FsMount",source_type:"fsMount",disableDataSourceBrowse:i}))}}]),a}(r.Component);!function(e,t,a){t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a}(xv,"propTypes",{dispatch:u.a.func.isRequired,fsMount_list:u.a.array,kubernetes_access:u.a.bool,isMember:u.a.bool,disableDataSourceBrowse:u.a.bool});var Mv=Object(s.b)((function(e){var t=e.stats_data,a=(t=void 0===t?{}:t).session_data,r=(a=void 0===a?{}:a).role_name,n=void 0===r?"":r,o=a.current_tenant_data,i=void 0===o?{}:o,s=a.disableDataSourceBrowse,c=void 0===s||s,l=e.page_data,u=void 0===l?{}:l,p=f.a.fetchSafeFromObject({path:["fsMount_list","_embedded","filesystems"],obj:u,default_value:[]}),d=f.a.fetchSafeFromObject({path:["features","kubernetes_access"],obj:i,default_value:!1});return{isMember:n===w.ROLE_NAME.MEMBER,kubernetes_access:d,fsMount_list:p,disableDataSourceBrowse:c}}))(xv);function Iv(e){return(Iv="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Uv(e,t){for(var a=0;a<t.length;a++){var r=t[a];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Lv(e,t,a){return t&&Uv(e.prototype,t),a&&Uv(e,a),e}function Bv(e,t){return(Bv=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Hv(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=Vv(e);if(t){var n=Vv(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return Kv(this,a)}}function Kv(e,t){return!t||"object"!==Iv(t)&&"function"!=typeof t?qv(e):t}function qv(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Vv(e){return(Vv=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var Gv=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Bv(e,t)}(a,e);var t=Hv(a);function a(e){var r;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,a),(r=t.call(this,e)).state={id:"",source_type:""},r.fetchDataSource=r.fetchDataSource.bind(qv(r)),r}return Lv(a,null,[{key:"getMeta",value:function(e){var t=e?"k8sDataSource":"dataSource";return{title:"HPE ".concat(e?"K8s":"ML Ops"," | Manage Data Source"),link:[{rel:"canonical",href:"".concat(w.serverUrl).concat(w.views[t].url)}],meta:[{charset:"utf-8"},{name:"description",content:"Manage Data Source"}]}}}]),Lv(a,[{key:"componentDidMount",value:function(){var e=this.props.location,t=lf.a.parse(e.search),a=t.id,r=t.source_type;this.setState({id:a,source_type:r}),this.fetchDataSource({id:a})}},{key:"fetchDataSource",value:function(e){var t=e.id;(0,this.props.dispatch)(Q({apiUrl:t,propVal:"data_source"}))}},{key:"render",value:function(){var e=this.props,t=e.page_data,r=void 0===t?{}:t,o=e.stats_data,i=void 0===o?{}:o,s=e.kubernetes_access,c=a.getMeta(s),l=r.data_source,u=void 0===l?{}:l,p=this.state,d=p.id,m=p.source_type,h="dataTap"===m?["_embedded","label","name"]:["_embedded","mountspec","mount_name"],b="dataTap"===m?["_embedded","endpoint","type"]:["_embedded","mountspec","type"],v="dataTap"===m?["_embedded","flags","read_only"]:["_embedded","mountspec","read_only"],y=f.a.fetchSafeFromObject({path:h,obj:u,default_value:""}),g=f.a.fetchSafeFromObject({path:b,obj:u,default_value:""}),_=f.a.fetchSafeFromObject({path:["_embedded","endpoint","kdc_data"],obj:u,default_value:{}}),S="hdfs"===g&&!f.a.isEmptyObject(_),k=i.g_install,O=void 0===k?{}:k,E=Ub.isDataSourceLocal({data_source:u,g_install:O}),j=f.a.fetchSafeFromObject({path:v,obj:u,default_value:!1}),D=f.a.fetchSafeFromObject({path:["session_data","disableDataSourceBrowse"],obj:i,default_value:!0});return n.a.createElement("div",{className:"DataSourcePage"},n.a.createElement(Al.a,{title:c.title,description:c.description,link:c.link,meta:c.meta}),n.a.createElement(Nt,{title:"Data Source Browser"}),!D&&n.a.createElement(n.a.Fragment,null,d.length&&m.length&&y?n.a.createElement(pi,{source:d,source_type:m,path:"/",useFolderActions:!0,name:y,type:g,isKerberized:S,is_local:E,isReadOnly:j}):n.a.createElement(ls,null)))}}]),a}(r.Component);!function(e,t,a){t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a}(Gv,"propTypes",{classes:u.a.object,dispatch:u.a.func.isRequired,stats_data:u.a.object,page_data:u.a.object,location:u.a.object,kubernetes_access:u.a.bool});var zv=d()(he()((function(){}),{name:"App"}),Object(s.b)((function(e){var t=e.stats_data,a=void 0===t?{}:t,r=e.page_data;return{stats_data:a,page_data:void 0===r?{}:r}})))(Gv);function Wv(e){return(Wv="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Jv(e,t){for(var a=0;a<t.length;a++){var r=t[a];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Yv(e,t,a){return t&&Jv(e.prototype,t),a&&Jv(e,a),e}function $v(e,t){return($v=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Qv(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=ey(e);if(t){var n=ey(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return Zv(this,a)}}function Zv(e,t){return!t||"object"!==Wv(t)&&"function"!=typeof t?Xv(e):t}function Xv(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function ey(e){return(ey=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function ty(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function ay(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?ty(Object(a),!0).forEach((function(t){ry(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):ty(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function ry(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}var ny={servicewithimpersonation:"Service With Impersonation",service:"Service",user:"User",tenant:"Tenant"},oy=er({path:["datasource"]}),iy=Ub.sourceTypeLabel,sy=w.views,cy=function(e,t){var a=iy[e],r={title:"",type:"object",properties:{keytab:{type:"string",format:"data-url",title:"Keytab File",description:oy.keytabUploadDescription,error_msg:oy.keytabUploadErrMsg},client_principal:{type:"string",title:"Client Principal",description:oy.clientPrincipleDescription,error_msg:oy.clientPrincipleErrMsg}}},n={title:"",type:"object",properties:{keytab:{type:"string",title:"Keytab File",description:oy.keytabExistingDescription,error_msg:oy.keytabExistingErrMsg},client_principal:{type:"string",title:"Client Principal",description:oy.clientPrincipleDescription,error_msg:oy.clientPrincipleErrMsg}}},o={title:"",type:"object",properties:{keytab_source:{type:"string",title:"Keytab Source",description:oy.keytabSourceDescription,enum:["Upload Keytab file","Use Existing"],default:"Upload Keytab file"}},dependencies:{keytab_source:{oneOf:[{properties:{keytab_source:{enum:["Upload Keytab file"]},keytab_upload_info:r}},{properties:{keytab_source:{enum:["Use Existing"]},keytab_info:n}}]}}},i={title:"",type:"object",properties:{username:{type:"string",title:"Username",default:"hdfs",description:oy.usernameDescription,error_msg:oy.usernameErrMsg}}},s={title:"",type:"object",properties:{ticket:{type:"string",format:"data-url",title:"Ticket File",description:oy.ticketUploadDescription,bd_required:!0}}},c={title:"",type:"object",properties:{ticket:{type:"string",title:"Ticket File",description:oy.ticketExistingDescription,bd_required:!0}}},l={title:"",type:"object",properties:{ticket_source_options:{title:"",type:"object",properties:{ticket_source:{type:"string",title:"Ticket Source",description:oy.ticketSourceDescription,enum:["Upload Ticket file","Use Existing"],default:"Upload Ticket file"}},dependencies:{ticket_source:{oneOf:[{properties:{ticket_source:{enum:["Upload Ticket file"]},ticket_upload_info:s}},{properties:{ticket_source:{enum:["Use Existing"]},ticket_info:c}}]}}},ticket_user:{type:"string",title:"Ticket User",description:oy.maprTicketUserDesc,bd_required:!0},ticket_type:{type:"string",title:"Ticket Type",enum:["Service With Impersonation","Service","User","Tenant"],description:oy.maprTicketTypeDesc,default:"Service With Impersonation",bd_required:!0},impersonation_enabled:{type:"boolean",title:"Enable Impersonation",default:!1,description:oy.userImpersonationDesc},mapr_tenant_volume:{type:"boolean",title:"MapR Tenant Volume",default:!1,description:oy.maprTenantVolDesc}}};switch(t){case"nfs":return{title:"",type:"object",properties:{host:{type:"string",title:"Host",description:oy.hostNFSDescription,bd_required:!0},export_path:{type:"string",title:"Share",description:oy.shareDescription(a),bd_required:!0},read_only:{type:"boolean",title:"Read Only",default:!1,description:oy.readOnlyDescription(a)}}};case"mapr":return{title:"",type:"object",properties:{cluster_name:{type:"string",title:"Cluster Name",description:oy.maprClusterNameDesc,bd_required:!0},cldb:{type:"string",title:"CLDB Hosts",description:oy.cldbHostDesc,bd_required:!0},port:{type:"string",title:"CLDB Port",description:oy.cldbPortDesc},path_from_endpoint:{type:"string",title:"Mount Path",description:oy.pathDescription(a)},secure:{type:"boolean",title:"MapR Secure",default:!0,description:oy.readOnlyDescription(a)},maprSecureSchema:l}};case"maprSecure":return l;case"passthrough":return{title:"",type:"object",properties:{keytab_file_browsing:{type:"string",title:"Use Keytab File for Browsing",description:oy.keytabFileBrowsingDescription,enum:["No","Yes"],default:"No"}}};case"keytab":return o;case"kerb":return{title:"",type:"object",properties:{host:{type:"string",title:"KDC Host",default:"",description:oy.KDCHostDescription},port:{type:"number",title:"KDC Port",description:oy.KDCPortDescription},service_id:{type:"string",title:"HDFS Service ID",default:"hdfs",description:oy.serviceIdDescription},realm:{type:"string",title:"Realm",description:oy.realmDescription},access_method:{type:"string",title:"Access Method",description:oy.accessMethodDescription,enum:["Proxy","Passthrough"],default:"Proxy"},proxySchema:o}};case"nonKerb":return i;case"hdfs":return{title:"",type:"object",properties:{host:{type:"string",title:"Host",description:oy.hostHDFSDescription,bd_required:!0},read_only:{type:"boolean",title:"Read Only",default:!1,description:oy.readOnlyDescription(a)},backup_host:{type:"string",title:"Standby NameNode Host",description:oy.standbyHostDescription},port:{type:"string",title:"Port",description:oy.portDescription},path_from_endpoint:{type:"string",title:"Path",description:oy.pathDescription(a),error_msg:oy.pathErrMsg},kerb_protected:{type:"string",title:"Kerberos Protected",enum:["No","Yes"],description:oy.kerberosDescription,default:"No"},nonKerbSchema:i}}}},ly=function(e){var t=["NFS","HDFS","MAPR"],a="NFS",r={nfsSchema:cy(e,"nfs")},n=iy[e];if("fsMount"===e)t=["NFS"];else if("dataTap"===e){t=["HDFS","MAPR"],a="HDFS",r={hdfsSchema:cy(e,"hdfs")}}return{type:"object",properties:ay({label:{title:"Label",type:"object",properties:{name:{type:"string",title:"Name",default:"",description:oy.nameDescription(n),bd_required:!0},description:{type:"string",title:"Description",default:"",description:oy.datasourceDescription}}},datasource_type:{type:"string",title:"File System Type",enum:t,default:a,description:oy.sourceTypeDescription(n)}},r)}},uy=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&$v(e,t)}(a,e);var t=Qv(a);function a(e){var r;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,a),(r=t.call(this,e)).convertFormData=r.convertFormData.bind(Xv(r)),r.convertAPIData=r.convertAPIData.bind(Xv(r)),r.submitForm=r.submitForm.bind(Xv(r)),r.submitRESTAPI=r.submitRESTAPI.bind(Xv(r)),r.validateForm=r.validateForm.bind(Xv(r)),r.onChangeForm=r.onChangeForm.bind(Xv(r)),r.validateClbdHost=r.validateClbdHost.bind(Xv(r)),r.ipFqdnTest=r.ipFqdnTest.bind(Xv(r));var n=r.props.location,o=lf.a.parse(n.search),i=o.id,s=void 0===i?"":i,c=o.source_type,l=void 0===c?"datasource":c;return r.state={dataSourceSchema:ly(l),dataSourceUISchema:{},submitted:!1,formLoaded:!1,submitDisabled:!1,id:s,source_type:l},r.form={formData:{}},r}return Yv(a,null,[{key:"getMeta",value:function(e,t,a){var r=a?"Update":"Add New",n=e?"k8sCreateEditDataSource":"createEditDataSource",o=e?"Container Platform":"ML Ops",i=iy[t],s="".concat(r," ").concat(i);return{title:"HPE ".concat(o," | ").concat(s),link:[{rel:"canonical",href:"".concat(w.serverUrl).concat(w.views[n].url)}],meta:[{charset:"utf-8"},{name:"description",content:s}],pageTitle:s}}}]),Yv(a,[{key:"componentDidMount",value:function(){var e=this.props,t=e.dispatch,a=e.page_data,r=this.state.id,n=this;t(x(Q(oe.DATATAP_DATA),Q(oe.FSMOUNT_DATA))),r?t(Q({apiUrl:r,propVal:"current_datasource"})).then((function(){n.form.formData=n.convertAPIData(n.props.page_data.current_datasource),n.setState({formLoaded:!0})})):a.current_datasource=void 0}},{key:"componentWillUnmount",value:function(){this.props.page_data.current_datasource=void 0,this.setState({dataSourceUISchema:{},dataSourceSchema:{},formLoaded:!1}),this.form.formData={}}},{key:"convertAPIData",value:function(e){var t={};if(!e)return t;var a=e._embedded,r=this.state,n=r.dataSourceUISchema,o=r.source_type;if(n.datasource_type={"ui:readonly":!0},"dataTap"===o){var i=a.endpoint,s=a.bdfs_root,c=i.cluster_name?"MAPR":"HDFS",l="MAPR"===c?"maprSchema":"hdfsSchema";if(t.datasource_type=c,t.label=a.label,t[l]=i,t[l].path_from_endpoint=s.path_from_endpoint,"MAPR"===c&&(i.cldb&&(t.maprSchema.cldb=i.cldb.toString()),t.maprSchema.port=i.port?i.port:"7222"),"MAPR"===c&&i.secure){var u=i.ticket_type.toLowerCase().replace(/\s/g,""),p={ticket:i.ticket};t.maprSchema.maprSecureSchema={ticket_user:i.ticket_user,ticket_type:ny[u],impersonation_enabled:i.impersonation_enabled,mapr_tenant_volume:i.mapr_tenant_volume,ticket_source_options:{ticket_source:"Use Existing",ticket_info:p}}}if(i.kdc_data){t.hdfsSchema.kerb_protected="Yes",t.hdfsSchema.kerbSchema={host:i.kdc_data[0].host,port:i.kdc_data[0].port,service_id:i.service_id,realm:i.realm,access_method:i.browse_only?"Passthrough":"Proxy"};var d={keytab:i.keytab,client_principal:i.client_principal};i.browse_only?t.hdfsSchema.kerbSchema.passthroughSchema={keytab_file_browsing:i.keytab&&i.client_principal?"Yes":"No",keytab_source:"Use Existing",keytab_info:d}:t.hdfsSchema.kerbSchema.proxySchema={keytab_source:"Use Existing",keytab_info:d}}a.flags&&(t[l].read_only=a.flags.read_only)}else{var f=a.mountspec;t.datasource_type="NFS",t.nfsSchema=f,t.label={name:f.mount_name}}return t}},{key:"convertFormData",value:function(e,t){var a={},r=e.label,n=void 0===r?{}:r,o=n.name;if("NFS"===e.datasource_type){var i=e.nfsSchema;a.type="nfs",a.mount_name=o,i.read_only?a.read_only=!0:a.read_only=!1,a.host=i.host,a.export_path=i.export_path}else if("MAPR"===e.datasource_type){var s=e.maprSchema,c={type:"mapr"},l={};if(a.flags={read_only:!!s.read_only},s.cluster_name&&(c.cluster_name=s.cluster_name),s.port&&(c.port=s.port),s.cldb&&(c.cldb=s.cldb.replace(/\s/g,"").split(",")),c.secure=!!s.secure,c.mapr_tenant_volume=!1,c.impersonation_enabled=!1,s.secure){var u=s.maprSecureSchema;"Upload Ticket file"===u.ticket_source_options.ticket_source?c.ticket=t:c.ticket=u.ticket_source_options.ticket_info.ticket,u.ticket_type&&(c.ticket_type=u.ticket_type.toLowerCase().replace(/\s/g,"")),u.ticket_user&&(c.ticket_user=u.ticket_user),u.mapr_tenant_volume&&(c.mapr_tenant_volume=!0),u.impersonation_enabled&&(c.impersonation_enabled=!0)}s.path_from_endpoint&&(l.path_from_endpoint=s.path_from_endpoint),a.label=n,a.endpoint=c,a.bdfs_root=l}else{var p=e.hdfsSchema,d={type:"hdfs"},f={};if(d.host=p.host,p.backup_host&&(d.backup_host=p.backup_host),p.port&&(d.port=p.port),p.path_from_endpoint&&(f.path_from_endpoint=p.path_from_endpoint),p.read_only?a.flags={read_only:!0}:a.flags={read_only:!1},"No"===p.kerb_protected)d.username=p.username;else{var m=p.kerbSchema,h=[];h.push({host:m.host,port:m.port}),d.kdc_data=h,d.realm=m.realm,d.service_id=m.service_id,"Passthrough"===m.access_method?d.browse_only=!0:d.browse_only=!1;var b=void 0;if("Proxy"===m.access_method)b=m.proxySchema;else{var v=m.passthroughSchema;"Yes"===v.keytab_file_browsing&&(b=v.passthrough_keytab_source)}b?"Upload Keytab file"===b.keytab_source?(d.keytab=t,d.client_principal=b.keytab_upload_info.client_principal):(d.keytab=b.keytab_info.keytab,d.client_principal=b.keytab_info.client_principal):(d.keytab="",d.client_principal="")}a.label=n,a.endpoint=d,a.bdfs_root=f}return a}},{key:"submitRESTAPI",value:function(e,t){var a,r=this,o=this.props.page_data,i=this.state.source_type,s=e.datasource_type,c=iy[i],l=this.convertFormData(e,t),u=f.a.fetchSafeFromObject({path:["current_datasource"],obj:o,default_value:void 0}),p=lf.a.parse(location.search);this.setState({submitDisabled:!0}),u?(a=p.id,"NFS"===s&&(a+="/mountspec")):a="NFS"===s?w.apiurl.FILESYSTEMS:w.apiurl.DCO,R({method:u?w.method.PUT:w.method.POST,apiurl:a,data:l}).then((function(){_n({msg:"Successfully ".concat(u?"updated":"created"," ").concat(c," ").concat(e.label.name),variant:"success"}),r.form.formData={},r.setState({submitted:!0,submitDisabled:!1})})).catch((function(t){r.setState({submitDisabled:!1});var a=f.a.parseAxiosError({error:t}),o="Failed to ".concat(u?"update":"create"," ").concat(c," ( ").concat(e.label.name," )");_n({msg:n.a.createElement(ns,{errors:[o,a]}),variant:"error"}),r.deleteUploadedFile()}))}},{key:"deleteUploadedFile",value:function(){var e=document.querySelector("input[type=file]");if(e&&e.files.length){var t=new FormData;t.append("user_file",e.files[0]),Xo({op:w.op.KEYTAB_ACTION_DELETE,formData:t})}}},{key:"validateNFS",value:function(e,t){var a=e.nfsSchema,r=this.state.source_type,n=iy[r];a&&(a.host&&(Fl.ip.test(a.host)||Fl.fqdn.test(a.host))||t.nfsSchema.host.addError(oy.hostErrMsg(n)),a.export_path&&Fl.path_name.test(a.export_path)||t.nfsSchema.export_path.addError(oy.shareErrMsg(n)))}},{key:"validateHDFS",value:function(e,t){var a=e.hdfsSchema,r=this.state.source_type,n=iy[r],o=cy(r,"nonKerb");a&&(a.host||t.hdfsSchema.host.addError(oy.hostErrMsg(n)),"/"===a.path_from_endpoint&&t.hdfsSchema.path_from_endpoint.addError(oy.pathErrMsg),"Yes"===a.kerb_protected&&a.kerbSchema?(a.kerbSchema.host||t.hdfsSchema.kerbSchema.host.addError(oy.KDCHostErrMsg),a.kerbSchema.service_id||t.hdfsSchema.kerbSchema.service_id.addError(oy.serviceIdErrMsg),a.kerbSchema.realm||t.hdfsSchema.kerbSchema.realm.addError(oy.realmErrMsg)):"No"===a.kerb_protected&&o&&(a.nonKerbSchema.username||t.hdfsSchema.nonKerbSchema.username.addError(oy.usernameErrMsg)))}},{key:"ipFqdnTest",value:function(e){var t=e.split(".")[0];return!(isNaN(t)?Fl.fqdn.test(e):Fl.ip.test(e))}},{key:"validateClbdHost",value:function(e){var t=this;if(!e)return!0;var a=e.split(",");return a.length>1?a.some((function(e){return t.ipFqdnTest(e)})):this.ipFqdnTest(e)}},{key:"validateMAPR",value:function(e,t){var a=e.maprSchema;if(a&&(a.cluster_name||t.maprSchema.cluster_name.addError(oy.clusterNameErrMsg),this.validateClbdHost(a.cldb)&&t.maprSchema.cldb.addError(oy.cldbHostErrMsg),"/"===a.path_from_endpoint&&t.maprSchema.path_from_endpoint.addError(oy.pathErrMsg),a.secure)){var r=a.maprSecureSchema.ticket_source_options;a.maprSecureSchema.ticket_type||t.maprSchema.maprSecureSchema.ticket_type.addError(oy.ticketTypeErrMsg),a.maprSecureSchema.ticket_user||t.maprSchema.maprSecureSchema.ticket_user.addError(oy.ticketUserErrMsg),"Use Existing"===r.ticket_source&&(r.ticket_info.ticket||t.maprSchema.maprSecureSchema.ticket_source_options.ticket_info.ticket.addError(oy.ticketErrMsg)),"Upload Ticket file"===r.ticket_source&&(r.ticket_upload_info.ticket||t.maprSchema.maprSecureSchema.ticket_source_options.ticket_upload_info.ticket.addError(oy.ticketUploadErrMsg))}}},{key:"validateForm",value:function(e,t){var a=e.label,r=void 0===a?{}:a,n=e.datasource_type,o=r.name,i=this.props.page_data,s=this.state.source_type,c=f.a.fetchSafeFromObject({path:["dataTap_list","_embedded","data_connectors"],obj:i,default_value:[]}),l=f.a.fetchSafeFromObject({path:["fsMount_list","_embedded","filesystems"],obj:i,default_value:[]}),u=f.a.fetchSafeFromObject({path:["current_datasource"],obj:i,default_value:void 0}),p=iy[s];if(!u||"NFS"===n&&u._embedded.mountspec.mount_name!==o||["HDFS","MAPR"].includes(n)&&u._embedded.label.name!==o){(function(e,t,a){if(e)for(var r=0;r<e.length;r++)if(e[r]._embedded.label.name===a)return!0;if(t)for(var n=0;n<t.length;n++)if(t[n]._embedded.mountspec.mount_name===a)return!0;return!1})(c,l,o)&&t.label.name.addError(oy.nameDuplicate(p))}if(!o||!Fl.path_name.test(o)){var d=o?oy.invalidNameChars:oy.nameRequired(p);t.label.name.addError(d)}return"NFS"===e.datasource_type?this.validateNFS(e,t):"HDFS"===e.datasource_type?this.validateHDFS(e,t):this.validateMAPR(e,t),t}},{key:"submitForm",value:function(e){var t=e.formData,a=e.errors,r=this;if(this.form.formData=t,!a.length){var o=document.querySelector("input[type=file]");if(o&&o.files.length){var i="MAPR"===this.form.formData.datasource_type?"ticket":"keytab",s=function(e){var t=n.a.createElement(n.a.Fragment,null,n.a.createElement(st.a,{variant:"caption"},"Failed to upload the ".concat(i," file")),n.a.createElement(st.a,{variant:"caption"},e.target.response));_n({msg:t,variant:"error"})},c=new FormData;c.append("user_file",o.files[0]),Xo({op:w.op.KEYTAB_ACTION_CREATE,formData:c,events:{onReadyStateChange:function(e){4===e.target.readyState&&(e.target.status>=200&&e.target.status<=207?r.submitRESTAPI(r.form.formData,o.files[0].name):s(e))},onError:function(e){s(e),r.deleteUploadedFile()}}})}else this.submitRESTAPI(t,void 0)}}},{key:"onChangeForm",value:function(e){var t=this.state,a=t.dataSourceSchema,r=t.source_type,n=f.a.deepClone(a),o=e.formData,i=e.errorSchema;if(this.form.formData=o,!o.datasource_type)return n.properties.datasource_type.default="NFS",n.properties.nfsSchema=cy(r,"nfs"),void this.setState({dataSourceSchema:n});if("HDFS"===o.datasource_type&&(n.properties.nfsSchema||n.properties.maprSchema))return n.properties.label.properties.description.hidden=!1,n.properties.datasource_type.default="HDFS",delete n.properties.nfsSchema,delete n.properties.maprSchema,n.properties.hdfsSchema=cy(r,"hdfs"),f.a.isEmptyObject(i)||(delete i.nfsSchema,delete i.maprSchema),void this.setState({dataSourceSchema:n});if("NFS"===o.datasource_type&&(n.properties.hdfsSchema||n.properties.maprSchema))return n.properties.label.properties.description.hidden=!0,n.properties.datasource_type.default="NFS",delete n.properties.hdfsSchema,delete n.properties.maprSchema,n.properties.nfsSchema=cy(r,"nfs"),f.a.isEmptyObject(i)||(delete i.hdfsSchema,delete i.maprSchema),void this.setState({dataSourceSchema:n});if("MAPR"===o.datasource_type&&(n.properties.nfsSchema||n.properties.hdfsSchema))return n.properties.label.properties.description.hidden=!1,n.properties.datasource_type.default="MAPR",delete n.properties.hdfsSchema,delete n.properties.nfsSchema,n.properties.maprSchema=cy(r,"mapr"),f.a.isEmptyObject(i)||(delete i.nfsSchema,delete i.hdfsSchema),void this.setState({dataSourceSchema:n});if("NFS"!==o.datasource_type)if("MAPR"!==o.datasource_type){var s=a.properties.hdfsSchema.properties;if("Yes"===o.hdfsSchema.kerb_protected&&s.nonKerbSchema)return s.kerb_protected.default="Yes",delete s.nonKerbSchema,!f.a.isEmptyObject(i)&&delete i.hdfsSchema.nonKerbSchema,s.kerbSchema=cy(r,"kerb"),n.properties.hdfsSchema.properties=s,void this.setState({dataSourceSchema:n});if("No"===o.hdfsSchema.kerb_protected&&s.kerbSchema)return s.kerb_protected.default="No",delete s.kerbSchema,!f.a.isEmptyObject(i)&&delete i.hdfsSchema.kerbSchema,s.nonKerbSchema=cy(r,"nonKerb"),n.properties.hdfsSchema.properties=s,void this.setState({dataSourceSchema:n});if("No"!==o.hdfsSchema.kerb_protected){var c=a.properties.hdfsSchema.properties.kerbSchema.properties;if("Proxy"===o.hdfsSchema.kerbSchema.access_method&&c.passthroughSchema)return c.access_method.default="Proxy",delete c.passthroughSchema,!f.a.isEmptyObject(i)&&delete i.hdfsSchema.kerbSchema.passthroughSchema,c.proxySchema=cy(r,"keytab"),n.properties.hdfsSchema.properties.kerbSchema.properties=c,void this.setState({dataSourceSchema:n});if("Passthrough"===o.hdfsSchema.kerbSchema.access_method&&c.proxySchema)return c.access_method.default="Passthrough",delete c.proxySchema,!f.a.isEmptyObject(i)&&delete i.hdfsSchema.kerbSchema.proxySchema,c.passthroughSchema=cy(r,"passthrough"),n.properties.hdfsSchema.properties.kerbSchema.properties=c,void this.setState({dataSourceSchema:n});if("Proxy"!==o.hdfsSchema.kerbSchema.access_method){var l=a.properties.hdfsSchema.properties.kerbSchema.properties.passthroughSchema.properties;return"No"===o.hdfsSchema.kerbSchema.passthroughSchema.keytab_file_browsing&&l.passthrough_keytab_source?(l.keytab_file_browsing.default="No",delete l.passthrough_keytab_source,!f.a.isEmptyObject(i)&&delete i.hdfsSchema.kerbSchema.passthroughSchema.passthrough_keytab_source,n.properties.hdfsSchema.properties.kerbSchema.properties.passthroughSchema.properties=l,void this.setState({dataSourceSchema:n})):"Yes"!==o.hdfsSchema.kerbSchema.passthroughSchema.keytab_file_browsing||l.passthrough_keytab_source?void 0:(l.keytab_file_browsing.default="Yes",l.passthrough_keytab_source=cy(r,"keytab"),n.properties.hdfsSchema.properties.kerbSchema.properties.passthroughSchema.properties=l,void this.setState({dataSourceSchema:n}))}}}else{var u=a.properties.maprSchema.properties;o.maprSchema.secure&&!u.maprSecureSchema?(u.maprSecureSchema=cy(r,"maprSecure"),n.properties.maprSchema.properties=u,this.setState({dataSourceSchema:n})):!o.maprSchema.secure&&u.maprSecureSchema&&(delete u.maprSecureSchema,!f.a.isEmptyObject(i)&&delete i.maprSchema.maprSecureSchema,n.properties.maprSchema.properties=u,this.setState({dataSourceSchema:n}))}else a.properties.label.properties.description.hidden=!0}},{key:"render",value:function(){var e=this.props.kubernetes_access,t=this.state,r=t.source_type,o=t.id,i=a.getMeta(e,r,o),s=this.state,c=s.submitted,l=s.formLoaded,u=s.dataSourceSchema,p=s.dataSourceUISchema,d=s.submitDisabled,f=lf.a.parse(location.search);if(c){var m={fsMount:sy.managek8sFsMounts.url,dataTap:sy.managek8sDataTaps.url},h=e?m[r]:sy.manageDataSources.url;if(h)return n.a.createElement(Cl.a,{to:h})}return n.a.createElement("div",{className:"CreateEditDataSourcePage"},n.a.createElement(Al.a,{title:i.title,description:i.description,link:i.link,meta:i.meta}),n.a.createElement(Nt,{title:i.pageTitle}),f&&f.id&&!l?n.a.createElement(ls,null):n.a.createElement(En,{form_schema:u,ui_schema:p,formData:this.form.formData,form_id:"create-edit-datasource",submitter:this.submitForm,onChange:this.onChangeForm,validate:c?null:this.validateForm,submitDisabled:d}))}}]),a}(r.Component);ry(uy,"propTypes",{dispatch:u.a.func.isRequired,page_data:u.a.object,location:u.a.object,kubernetes_access:u.a.bool});var py=d()(he()((function(){return{}}),{name:"App"}),Object(s.b)((function(e){var t=e.stats_data,a=void 0===t?{}:t,r=e.page_data;return{stats_data:a,page_data:void 0===r?{}:r,kubernetes_access:f.a.fetchSafeFromObject({path:["session_data","current_tenant_data","features","kubernetes_access"],obj:a,default_value:!1})}})))(uy);function dy(e){return(dy="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function fy(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function my(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?fy(Object(a),!0).forEach((function(t){ky(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):fy(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function hy(e,t){for(var a=0;a<t.length;a++){var r=t[a];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function by(e,t,a){return t&&hy(e.prototype,t),a&&hy(e,a),e}function vy(e,t){return(vy=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function yy(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=Sy(e);if(t){var n=Sy(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return gy(this,a)}}function gy(e,t){return!t||"object"!==dy(t)&&"function"!=typeof t?_y(e):t}function _y(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Sy(e){return(Sy=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function ky(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}var Oy=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&vy(e,t)}(a,e);var t=yy(a);function a(e){var r;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,a),ky(_y(r=t.call(this,e)),"CancelToken",T.a.CancelToken),ky(_y(r),"dataUpdates",{}),r.fetchModels=r.fetchModels.bind(_y(r)),r.deleteModel=r.deleteModel.bind(_y(r)),r.deleteModelList=r.deleteModelList.bind(_y(r)),r.fetchK8sModels=r.fetchK8sModels.bind(_y(r)),r.fetchTenantsUserList=r.fetchTenantsUserList.bind(_y(r)),r.getUserNameById=r.getUserNameById.bind(_y(r)),r.deleteK8sModel=r.deleteK8sModel.bind(_y(r)),r.bdDeleteDialog=n.a.createRef(),r.state={k8sModelListFetched:!1,modelListFetched:!1,usersDataFetched:!1},r}return by(a,null,[{key:"getMeta",value:function(){return{title:"".concat(w.APP_TITLE.ML_OPS," | Models Page"),link:[{rel:"canonical",href:"".concat(w.serverUrl).concat(w.views.models.url)}],meta:[{charset:"utf-8"},{name:"description",content:"Manage Models"}]}}}]),by(a,[{key:"componentDidMount",value:function(){var e=this.props.isTenantK8sMlOps;!e&&this.fetchModels(),e&&this.fetchK8sModels(),e&&this.fetchTenantsUserList()}},{key:"componentWillUnmount",value:function(){var e=this;Object.keys(this.dataUpdates).map((function(t){e.dataUpdates[t].cancel("component unmounted")}))}},{key:"fetchModels",value:function(){var e=this,t=this.props.dispatch;this.dataUpdates.model=this.CancelToken.source(),t(Q(my(my({},oe.MODEL_DATA),{},{cancelToken:this.dataUpdates.model.token}))).then((function(){delete e.dataUpdates.model,e.setState({modelListFetched:!0})}))}},{key:"fetchK8sModels",value:function(){var e=this,t=this.props,a=t.dispatch,r=t.k8sTenantNamespace,n=t.k8sAuthPort;this.dataUpdates.k8sModel=this.CancelToken.source(),a(Q(my(my({},oe.K8S_CONFIG_MAP({namespace:r,port:n,propVal:"k8s_model_list",params:{"kubedirector.hpe.com/cmType":"model"}})),{},{cancelToken:this.dataUpdates.k8sModel.token}))).then((function(){delete e.dataUpdates.k8sModel,e.setState({k8sModelListFetched:!0})}))}},{key:"fetchTenantsUserList",value:function(){var e=this,t=this.props,a=t.dispatch,r=t.currentTenantId;this.dataUpdates.userList=this.CancelToken.source(),a(Q(my(my({},oe.TENANT_USER_DATA(r)),{},{cancelToken:this.dataUpdates.userList.token}))).then((function(){delete e.dataUpdates.userList,e.setState({usersDataFetched:!0})}))}},{key:"getUserNameById",value:function(e){var t=this.props.usersDict;if(t[e])return t[e].name}},{key:"deleteModelList",value:function(e){var t=this;e.selected_rows.data.map((function(e){var a=e.rowData,r=JSON.parse(a[a.length-1]),n=r.model_id,o=void 0===n?"":n,i=r.name,s=void 0===i?"":i;t.deleteModel({model_id:o,name:s})}))}},{key:"deleteModel",value:function(e){var t=this,a=this.props.isTenantK8sMlOps,r=e.model_id,n=e.name;a?this.deleteK8sModel(r,n):R({apiurl:r,method:w.method.DELETE}).then((function(){t.fetchModels(),_n({msg:"Model ( ".concat(n," ) successfully deleted"),variant:"success"})})).catch((function(){_n({msg:"Failed to delete the model ".concat(n),variant:"error"})}))}},{key:"deleteK8sModel",value:function(e,t){var a=this,r=this.props.k8sAuthPort;R({apiurl:e,method:w.method.DELETE,timeout:w.settings.long_timeout,port:r}).then((function(){a.fetchK8sModels(),_n({msg:"Model ( ".concat(t," ) successfully deleted"),variant:"success"})})).catch((function(e){var a=f.a.fetchSafeFromObject({path:["response","data","message"],obj:e,default_value:""}),r=n.a.createElement(ns,{errors:["Failed to delete the model ".concat(t),a]});_n({msg:r,variant:"error"})}))}},{key:"callBack",value:function(e){"success"===e.variant&&this.fetchModels()}},{key:"getModelTableSettings",value:function(){var e=this,t=this.props,a=t.isTenantK8sMlOps,r=t.k8sModels,o=t.models,i=[{name:"Model Name",options:{filter:!0}},{name:"Model Version",options:{filter:!0}},{name:"Description",options:{filter:!0}},{name:"Details",options:{filter:!0,customBodyRender:function(e){var t=e.created_time,a=void 0===t?"":t,r=e.created_by_user_name,o=void 0===r?"admin":r,i=e.model_location,s=void 0===i?"":i,c=e.scoring_script,l=void 0===c?"":c,u=e.training_environment,p=void 0===u?"":u,d=e.namespace,f=void 0===d?"":d;return n.a.createElement("div",{className:"py-2"},a?n.a.createElement(St.Typography,{variant:"body1"},"Created At: ",a.format(w.settings.time_format)):"",o?n.a.createElement(St.Typography,{variant:"body1"},"Created By: ",o):"",s?n.a.createElement(St.Typography,{variant:"body1"},"Model: ",s):"",l?n.a.createElement(St.Typography,{variant:"body1"},"Scoring Script: ",l):"",p?n.a.createElement(St.Typography,{variant:"body1"},"Training Environment: ",p):"",f?n.a.createElement(St.Typography,{variant:"body1"},"Tenant Namespace: ",f):"")}}},{name:"Actions",options:{filter:!1,customBodyRender:function(t){var r=JSON.parse(t),o=r.model_id,i=r.name;return n.a.createElement("div",{className:"row-action-btns"},n.a.createElement(ka,{title:"Edit",variant:"primary"},n.a.createElement(lo.a,{to:w.views.createEditModel.editUrl({id:o}),className:"link"},n.a.createElement("span",{className:"icon icon-rect-link icon-pencil3"}))),n.a.createElement(ka,{title:"Delete",variant:"error"},n.a.createElement("span",{className:"icon icon-rect-link icon-trash2",onClick:function(){var t={callback:e.deleteModel,context:{model_id:o,name:i},title:"Delete model ("+i+")",description:"Confirm Deletion. This action cannot be undone"};e.bdDeleteDialog.current.handleOpen(t)}})),a?"":n.a.createElement(ka,{title:"Deploy",variant:"primary"},n.a.createElement(lo.a,{to:w.views.createEditDeployment.deployFromModelUrl({model_id:o}),className:"link"},n.a.createElement("span",{className:"icon icon-rect-link icon-diamond3"}))))}}}];return{columns:i,data:a?r.reduce((function(t,a){var r,n=a.data,o=void 0===n?{}:n,i=a.metadata,s=void 0===i?{}:i,c=f.a.fetchSafeFromObject({path:["model-version"],obj:o,default_value:""}),l=f.a.fetchSafeFromObject({path:["scoring-path"],obj:o,default_value:""}),u=o.name,p=void 0===u?"":u,d=o.path,m=void 0===d?"":d,h=o.description,b=void 0===h?"":h,v=o.training_environment,y=void 0===v?"":v,g=s.creationTimestamp,_=void 0===g?"":g,S=s.namespace,k=void 0===S?"":S,O=s.labels,E=void 0===O?{}:O,j=s.selfLink,D=void 0===j?"":j,w=f.a.fetchSafeFromObject({path:["createdBy"],obj:E,default_value:""}),C=e.getUserNameById(w);return r={created_time:Fc()(_),created_by_user_name:C,model_location:m,scoring_script:l,training_environment:y,namespace:k},t.push([p,c,b,r,JSON.stringify({model_id:D,name:p})]),t}),[]):o.reduce((function(e,t){var a,r=t.created_time,n=void 0===r?"":r,o=t.created_by_user_name,i=void 0===o?"":o,s=t.model_location,c=void 0===s?"":s,l=t.scoring_script,u=void 0===l?"":l,p=t.training_environment,d=void 0===p?"":p,m=t.label,h=void 0===m?{}:m,b=h.name,v=void 0===b?"":b,y=h.description,g=void 0===y?"":y,_=f.a.fetchSafeFromObject({path:["_links","self","href"],obj:t,default_value:""}),S=f.a.fetchSafeFromObject({path:["version"],obj:t,default_value:{}});return a={created_time:Fc.a.unix(n),created_by_user_name:i,model_location:c,scoring_script:u,training_environment:d},e.push([v,S,g,a,JSON.stringify({model_id:_,name:v})]),e}),[]),title:"",options:{customToolbar:function(){return n.a.createElement("div",{className:"tableActionButtons"},n.a.createElement(Ue.a,{variant:"contained",color:"primary",component:lo.a,to:w.views.createEditModel.url},"Register New Model"))},customToolbarSelect:function(t){return n.a.createElement("div",{className:"tableActionButtonsSelected"},n.a.createElement(Ue.a,{variant:"contained",color:"secondary",onClick:function(){var a={callback:e.deleteModelList,context:{selected_rows:t},title:"Delete selected model(s)",description:"Confirm Deletion. This action cannot be undone"};e.bdDeleteDialog.current.handleOpen(a)}},"Delete"))}}}}},{key:"render",value:function(){var e=a.getMeta(),t=this.getModelTableSettings();return n.a.createElement("div",{className:"ModelsPage"},n.a.createElement(Al.a,{title:e.title,description:e.description,link:e.link,meta:e.meta}),n.a.createElement(Nt,{title:"Model Management"}),n.a.createElement(sa,t),n.a.createElement(no,{ref:this.bdDeleteDialog}))}}]),a}(r.Component);ky(Oy,"propTypes",{dispatch:u.a.func.isRequired,isTenantK8sMlOps:u.a.bool,k8sTenantNamespace:u.a.string,k8sAuthPort:u.a.number,k8sModels:u.a.array,models:u.a.array,currentTenantId:u.a.string,usersDict:u.a.object});var Ey=Object(s.b)((function(e){var t=e.stats_data,a=void 0===t?{}:t,r=e.page_data,n=void 0===r?{}:r,o=a.session_data,i=(o=void 0===o?"":o).tenant,s=void 0===i?"":i,c=f.a.fetchSafeFromObject({path:["session_data","current_tenant_data","features"],obj:a,default_value:{}}),l=c.ml_project,u=void 0!==l&&l,p=c.kubernetes_access;return{isTenantK8sMlOps:u&&(void 0!==p&&p),k8sTenantNamespace:f.a.fetchSafeFromObject({path:["session_data","current_tenant_data","namespace"],obj:a,default_value:""}),k8sAuthPort:f.a.fetchSafeFromObject({path:["session_data","current_tenant_data","k8s_auth_port"],obj:a,default_value:null}),k8sModels:f.a.fetchSafeFromObject({path:["k8s_model_list","items"],obj:n,default_value:[]}),models:f.a.fetchSafeFromObject({path:["model_list","_embedded","models"],obj:n,default_value:[]}),currentTenantId:s,usersDict:f.a.fetchSafeFromObject({path:["tenant_users","_embedded","users"],obj:n,default_value:[]}).reduce((function(e,t){var a=f.a.fetchSafeFromObject({path:["_embedded","label","name"],obj:t,default_value:""});return e[f.a.fetchSafeFromObject({path:w.pathToID,obj:t,default_value:""}).split("/").pop()]={name:a},e}),{})}}))(Oy);function jy(e){return(jy="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Dy(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function wy(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?Dy(Object(a),!0).forEach((function(t){xy(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):Dy(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function Cy(e,t){for(var a=0;a<t.length;a++){var r=t[a];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Ty(e,t,a){return t&&Cy(e.prototype,t),a&&Cy(e,a),e}function Py(e,t){return(Py=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Ay(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=Fy(e);if(t){var n=Fy(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return Ry(this,a)}}function Ry(e,t){return!t||"object"!==jy(t)&&"function"!=typeof t?Ny(e):t}function Ny(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Fy(e){return(Fy=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function xy(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}var My=er({path:["modelForm"]}),Iy={type:"object",properties:{label:{title:"Label",type:"object",properties:{name:{type:"string",title:"Name",default:"",description:My.modelNameDescription,bd_required:!0},description:{type:"string",title:"Description",default:"",description:My.modelDescripttion}}},version:{type:"string",title:"Model Version",description:My.versionDescription,bd_required:!0},model_location:{name:"model_location",type:"string",title:"Path to Model Repo",description:My.modelPathDescription,bd_required:!0},scoring_script:{name:"scoring_script",type:"string",title:"Path to Scoring Script",description:My.scoringPathDescription},input_parameter_file:{name:"input_parameter_file",type:"string",title:"Path to Input Parameter JSON",description:My.inputParamFilePathDescription,hidden:!0},inference_bootstrap_script:{name:"inference_bootstrap_script",type:"string",title:"Path to Bootstrap Script",description:My.inferenceScriptPathDescription,hidden:!0},training_data:{name:"training_data",type:"string",title:"Path to Training Data",description:My.trainingDataDescription,hidden:!0},training_environment:{type:"string",title:"Trained on Environment",description:My.trainingEnvironmentDescription}}},Uy=function(e,t){var a=e.k8sTenantNamespace,r=void 0===a?"":a,n=t.split("/").pop(),o={type:"object",properties:{data:{title:"",type:"object",properties:{label:{title:"Label",type:"object",properties:{name:{type:"string",title:"Name",default:"",description:My.modelNameDescription,bd_required:!0},description:{type:"string",title:"Model Info",default:"",description:My.modelNameDescription}}},"model-version":{type:"string",title:"Model Version",description:My.versionDescription,bd_required:!0},path:{name:"path",type:"string",title:"Path to Model Repo",description:My.modelPathDescription,bd_required:!0},"scoring-path":{name:"scoring-path",type:"string",title:"Path to Scoring Script",description:My.scoringPathDescription},training_environment:{type:"string",title:"Trained on Environment",description:My.trainingEnvironmentDescription}}},metadata:{title:"",type:"object",properties:{labels:{title:"",type:"object",properties:{"kubedirector.hpe.com/cmType":{type:"string",title:"CM Type",default:"model",bd_disabled:!0,hidden:!0},createdBy:{type:"string",title:"Created By",default:n,bd_disabled:!0,hidden:!0}}},name:{type:"string",title:"ConfigMap Name",default:"",description:My.modelNameDescription,bd_disabled:!0,hidden:!0},namespace:{type:"string",title:"Tenant Namespace",default:r,description:My.modelNameDescription,bd_disabled:!0,bd_required:!0}}},apiVersion:{type:"string",title:"Api Version",default:"v1",bd_disabled:!0,hidden:!0},kind:{type:"string",title:"Kind",default:"ConfigMap",bd_disabled:!0,hidden:!0}}};return o},Ly=["model_location","scoring_script","input_parameter_file","inference_bootstrap_script","training_data"],By=["path","scoring-path"],Hy=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Py(e,t)}(a,e);var t=Ay(a);function a(e){var r;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,a),xy(Ny(r=t.call(this,e)),"CancelToken",T.a.CancelToken),xy(Ny(r),"fetchData",{}),xy(Ny(r),"browseWidget",(function(e){var t=r.props.classes,a="browse-"+e.id,o=e.schema.name;return n.a.createElement("div",{className:t.formControl},n.a.createElement(Qr.a,{id:e.id,name:e.name,className:t.control,variant:"outlined",value:e.value,placeholder:e.placeholder,disabled:e.disabled,required:e.required,type:"text"}),n.a.createElement(Ue.a,{htmlFor:o,id:a,type:"button",variant:"contained",color:"primary",onClick:r.handlePopoverOpen.bind(Ny(r))},"Browse"))})),r.submitForm=r.submitForm.bind(Ny(r)),r.validateForm=r.validateForm.bind(Ny(r)),r.handlePopoverClose=r.handlePopoverClose.bind(Ny(r)),r.browseSelectHandler=r.browseSelectHandler.bind(Ny(r)),r.submitRESTAPI=r.submitRESTAPI.bind(Ny(r)),r.submitKubeCtlAPI=r.submitKubeCtlAPI.bind(Ny(r)),r.addComfigMapName=r.addComfigMapName.bind(Ny(r)),r.convertAPIData=r.convertAPIData.bind(Ny(r)),r.fetchEpicModelData=r.fetchEpicModelData.bind(Ny(r)),r.fetchK8sModelData=r.fetchK8sModelData.bind(Ny(r)),r.fetchFsMountData=r.fetchFsMountData.bind(Ny(r)),r.fetchProjectRepoData=r.fetchProjectRepoData.bind(Ny(r)),r.isModelConflict=r.isModelConflict.bind(Ny(r)),r.state={formData:{},anchorlEl:null,popoverOpen:!1,anchorRect:{},modelSchema:r.props.isTenantK8sMlOps?Uy(r.props.currentTenantData,r.props.currentUserId):Iy,modelUISchema:r.getUiSchema(),k8sModelListFetched:!1},r.bdFormRef=n.a.createRef(),r.isEditModel=!1,r}return Ty(a,null,[{key:"getMeta",value:function(e){var t="".concat(e?"Update":"Register"," Model");return{title:"".concat(w.APP_TITLE.ML_OPS," | Register or Update Model"),link:[{rel:"canonical",href:"".concat(w.serverUrl).concat(w.views.createEditModel.url)}],meta:[{charset:"utf-8"},{name:"description",content:"Register or Update model."}],pageTitle:t}}}]),Ty(a,[{key:"getUiSchema",value:function(){for(var e=this.props.isTenantK8sMlOps,t=e?{metadata:{},data:{label:{name:{"ui:autofocus":!0}}}}:{label:{name:{"ui:autofocus":!0}}},a=e?By:Ly,r=0;r<a.length;r++)e?t.data[a[r]]={"ui:options":{name:a[r]},"ui:widget":this.browseWidget}:t[a[r]]={"ui:options":{name:a[r]},"ui:widget":this.browseWidget};return t}},{key:"componentDidMount",value:function(){var e=this,t=this.props,a=t.location,r=t.dispatch,n=t.currentTenantData,o=t.isTenantK8sMlOps,i=n.k8sAuthPort,s=void 0===i?null:i,c=lf.a.parse(a.search);this.isEditModel=c&&c.id,!o&&this.fetchEpicModelData(),this.fetchProjectRepoData(),this.fetchFsMountData(),o&&this.fetchK8sModelData(),this.isEditModel&&(o?r(Q({apiUrl:c.id,port:s,propVal:"current_k8s_model"})).then((function(){var t=e.props.current_k8s_model,a=e.convertAPIData(t);e.setState({formData:a})})):r(Q({apiUrl:c.id,propVal:"current_model"})).then((function(){var t=e.props.current_model;e.setState({formData:t})})))}},{key:"componentWillUnmount",value:function(){var e=this;(0,this.props.dispatch)($("current_model"));var t=Object.keys(this.fetchData);t.length&&t.forEach((function(t){return e.fetchData[t].cancel("component unmounted")}))}},{key:"handlePopoverOpen",value:function(e){var t=f.a.fetchSafeFromObject({path:["current","state","formData"],obj:this.bdFormRef,default_value:{}});e.preventDefault();var a=e.currentTarget,r=a.getBoundingClientRect();this.setState({popoverOpen:!this.state.popoverOpen,anchorEl:a,anchorRect:{x:r.x,y:r.y,width:r.width,height:r.height},formData:t})}},{key:"handlePopoverClose",value:function(){this.setState({popoverOpen:!1})}},{key:"convertAPIData",value:function(e){var t={},a=e.data,r=void 0===a?{}:a,n=e.metadata,o=void 0===n?{}:n;return e?(t.apiVersion=e.apiVersion,t.kind=e.kind,f.a.isEmptyObject(r)||(t.data={label:{name:r.name,description:r.description},"model-version":r["model-version"],path:r.path,"scoring-path":r["scoring-path"],training_environment:r.training_environment}),f.a.isEmptyObject(o)||(t.metadata={name:o.name,namespace:o.namespace,labels:{createdBy:o.labels.createdBy,"kubedirector.hpe.com/cmType":o.labels["kubedirector.hpe.com/cmType"]}}),t):t}},{key:"fetchEpicModelData",value:function(){var e=this,t=this.props.dispatch;this.fetchData.epicModel=this.CancelToken.source();var a=this.fetchData.epicModel.token;t(Q(wy(wy({},oe.MODEL_DATA),{},{cancelToken:a}))).then((function(){delete e.fetchData.epicModel}))}},{key:"fetchK8sModelData",value:function(){var e=this,t=this.props,a=t.dispatch,r=t.currentTenantData,n=r.k8sAuthPort,o=r.k8sTenantNamespace;this.fetchData.k8sModel=this.CancelToken.source();var i=this.fetchData.k8sModel.token;a(Q(wy(wy({},oe.K8S_CONFIG_MAP({namespace:o,port:n,propVal:"k8s_model_list",params:{"kubedirector.hpe.com/cmType":"model"}})),{},{cancelToken:i}))).then((function(){delete e.fetchData.k8sModel,e.setState({k8sModelListFetched:!0})}))}},{key:"fetchProjectRepoData",value:function(){var e=this,t=this.props,a=t.dispatch,r=t.tenantUrl;this.fetchData.projectRepo=this.CancelToken.source();var n=this.fetchData.projectRepo.token;a(Q(wy(wy({},oe.PROJECT_REPO_DATA(r)),{},{cancelToken:n}))).then((function(){delete e.fetchData.projectRepo}))}},{key:"fetchFsMountData",value:function(){var e=this,t=this.props.dispatch;this.fetchData.fsMount=this.CancelToken.source();var a=this.fetchData.fsMount.token;t(Q(wy(wy({},oe.FSMOUNT_DATA),{},{cancelToken:a}))).then((function(){delete e.fetchData.fsMount}))}},{key:"addComfigMapName",value:function(e){var t=e.data,a=(t=void 0===t?{}:t).name,r=void 0===a?"":a;f.a.setObjectProperty({path:["metadata","name"],value:r,schema:e})}},{key:"isModelConflict",value:function(e,t){var a=this;return e.find((function(e){var r="",n="";if(a.props.isTenantK8sMlOps){var o=e.data,i=void 0===o?{}:o;n=i.name,r=i["model-version"]}else{var s=e.label,c=void 0===s?{}:s,l=e.version,u=void 0===l?"":l;n=c.name,r=u}return r===t.modelVersion&&n===t.modelName}))}},{key:"validateK8sModel",value:function(e,t){var a=this.props,r=a.k8sModels,n=a.current_k8s_model,o=n.data,i=void 0===o?{}:o,s=i.name,c=i["model-version"],l=e.data,u=void 0===l?{}:l,p=u.path,d=void 0===p?"":p,m=f.a.fetchSafeFromObject({path:["model-version"],obj:u,default_value:""}),h=f.a.fetchSafeFromObject({path:["label","name"],obj:u,default_value:""});h?Fl.k8s_label.test(h)||t.data.label.name.addError(My.name.regExCheck):t.data.label.name.addError(My.name.required),d||t.data.path.addError(My.location.required),m||t.data["model-version"].addError(My.version.required);var b=h!==s||m!==c;if(f.a.isEmptyObject(n)||b){var v={modelVersion:m,modelName:h};this.isModelConflict(r,v)&&(t.data.label.name.addError(My.name.duplicate),t.data["model-version"].addError(My.version.duplicate))}}},{key:"validateEpicModel",value:function(e,t){var a=this.props,r=a.epicModels,n=a.current_model,o=e.label,i=(o=void 0===o?{}:o).name,s=void 0===i?"":i,c=e.version,l=void 0===c?"":c,u=e.model_location,p=void 0===u?"":u,d=n.version,m=void 0===d?"":d,h=n.label,b=(h=void 0===h?{}:h).name,v=void 0===b?"":b;s?Fl.k8s_label.test(s)||t.label.name.addError(My.name.regExCheck):t.label.name.addError(My.name.required),l||t.version.addError(My.version.required),p||t.model_location.addError(My.location.required);var y=s!==v||l!==m;if(f.a.isEmptyObject(n)||y){var g={modelVersion:l,modelName:s};this.isModelConflict(r,g)&&(t.label.name.addError(My.name.duplicate),t.version.addError(My.version.duplicate))}}},{key:"validateForm",value:function(e,t){return this.props.isTenantK8sMlOps?this.validateK8sModel(e,t):this.validateEpicModel(e,t),t}},{key:"submitKubeCtlAPI",value:function(e){var t=this,a=this.props.currentTenantData.k8sClusterId,r=void 0===a?"":a,o="create",i=w.method.POST,s=e.data,c=void 0===s?{}:s,l=c.label,u=void 0===l?{}:l;if(this.isEditModel){var p=!1;o="update";var d=this.props.current_k8s_model.data,m=d.name,h=void 0===m?"":m,b=d.description,v=void 0===b?"":b,y=u.name,g=void 0===y?"":y,_=u.description,S=void 0===_?"":_;for(var k in h===g&&v===S||(p=!0),c)"label"!==k&&c[k]!==d[k]&&(p=!0);if(!p)return void _n({msg:"Nothing to update",variant:"success"})}var O=f.a.deepClone(e);u&&(delete O.data.label,O.data=wy(wy({},O.data),u)),!this.isEditModel&&this.addComfigMapName(O);var E=JSON.stringify(O),j={kubectl_op:this.isEditModel?w.method.APPLY:w.method.CREATE,cluster_href:r,payload:E},D=f.a.isEmptyObject(O)?"":O.data.name;R({method:i,timeout:w.settings.long_timeout,op:"kubectl_action",data:j}).then((function(){_n({msg:"Successfully ".concat(o,"d model ( ").concat(D," )."),variant:"success"}),f.a.redirectTo({context:t.props,location:w.views.models.url})})).catch((function(e){var t=f.a.fetchSafeFromObject({path:["response","data","message"],obj:e,default_value:""}),a=n.a.createElement(ns,{errors:["Failed to ".concat(o," model ( ").concat(D," )."),t]});_n({msg:a,variant:"error"})}))}},{key:"submitRESTAPI",value:function(e){var t=this,a="create",r=e,o=w.method.POST,i=w.apiurl.MODEL,s=e.label.name;if(this.isEditModel){var c=this.props.current_model,l=!1;a="update";var u=[];for(var p in f.a.isEqual(c.label,e.label)||(u=[{op:"replace",path:"/label",value:e.label}],l=!0),e)"label"!==p&&e[p]!==c[p]&&(u.push({op:"replace",path:"/"+p,value:e[p]}),l=!0);if(!l)return void _n({msg:"Nothing to update",variant:"success"});o=w.method.PATCH,i=f.a.fetchSafeFromObject({path:["_links","self","href"],obj:c,default_value:""}),r=u,o=w.method.PATCH}R({method:o,apiurl:i,data:r}).then((function(){_n({msg:"Successfully ".concat(a,"d model ( ").concat(s," )"),variant:"success"}),f.a.redirectTo({context:t.props,location:w.views.models.url})})).catch((function(e){var t=f.a.parseAxiosError({error:e}),r=n.a.createElement(ns,{errors:["Failed to ".concat(a," model ( ").concat(s," )"),t]});_n({msg:r,variant:"error"})}))}},{key:"submitForm",value:function(e){var t=e.formData;e.errors.length||(this.props.isTenantK8sMlOps?this.submitKubeCtlAPI(t):this.submitRESTAPI(t))}},{key:"browseSelectHandler",value:function(e){var t=e.name,a=e.source,r=e.path,n=this.props.isTenantK8sMlOps;if(r&&"/"!==r){var o=this.state,i=o.formData,s=o.anchorEl,c=f.a.deepClone(i),l=s.getAttribute("for");n?(a.includes(w.apiurl.FILESYSTEMS)?c.data[l]="fsmount://":c.data[l]="repo://",c.data[l]+=t+r):(a.includes(w.apiurl.FILESYSTEMS)?c[l]="fsmount://":c[l]="repo://",c[l]+=t+r),this.setState({formData:c})}}},{key:"render",value:function(){var e=this.props,t=e.classes,r=e.project_repo,o=this.state,i=o.formData,s=o.anchorEl,c=o.popoverOpen,l=o.anchorRect,u=o.modelSchema,p=o.modelUISchema,d=a.getMeta(this.isEditModel),m=this.browseSelectHandler,h="";if(r){var b=f.a.fetchSafeFromObject({path:["_links","self","href"],obj:r,default_value:""}),v=(r._embedded||{}).mountspec,y=void 0===v?{}:v;h=n.a.createElement(pi,{key:b,source:b,source_type:"fsMount",path:"/",name:y.mount_name,type:"NFS",onClick:m})}return n.a.createElement("div",{className:"CreateEditModelPage"},n.a.createElement(Al.a,{title:d.title,description:d.description,link:d.link,meta:d.meta}),n.a.createElement(Nt,{title:d.pageTitle}),n.a.createElement(En,{form_schema:u,ui_schema:p,formData:i,form_id:"create-edit-model",submitter:this.submitForm,validate:this.validateForm,nodeRef:this.bdFormRef}),n.a.createElement(Ea.a,{open:c,anchorEl:s,anchorOrigin:{vertical:"center",horizontal:"right"},transformOrigin:{vertical:"center",horizontal:"left"},className:t.browser,classes:{paper:t.fileBrowser},animation:Oa.PopoverAnimationVertical,onClose:this.handlePopoverClose,style:{top:l.y||0,left:l.x+l.width}},"",h))}}]),a}(r.Component);xy(Hy,"propTypes",{classes:u.a.object.isRequired,dispatch:u.a.func.isRequired,project_repo:u.a.object,location:u.a.object,current_model:u.a.object,current_k8s_model:u.a.object,isTenantK8sMlOps:u.a.bool,currentUserId:u.a.string,currentTenantData:u.a.shape({k8sAuthPort:u.a.number,k8sTenantNamespace:u.a.string,k8sClusterId:u.a.string}).isRequired,k8sModels:u.a.array,epicModels:u.a.array,tenantUrl:u.a.string});var Ky=d()(he()(ar.a,{name:"App"}),Object(s.b)((function(e){var t,a,r=e.stats_data,n=void 0===r?{}:r,o=e.page_data,i=void 0===o?{}:o,s=f.a.fetchSafeFromObject({path:["project_repo"],obj:i,default_value:{}}),c=f.a.fetchSafeFromObject({path:["current_model"],obj:i,default_value:{}}),l=f.a.fetchSafeFromObject({path:["current_k8s_model"],obj:i,default_value:{}}),u=f.a.fetchSafeFromObject({path:["k8s_model_list","items"],obj:i,default_value:[]}),p=f.a.fetchSafeFromObject({path:["model_list","_embedded","models"],obj:i,default_value:[]}),d=f.a.fetchSafeFromObject({path:["session_data","current_tenant_data","features"],obj:n,default_value:{}}),m=d.ml_project,h=void 0!==m&&m,b=d.kubernetes_access,v=h&&(void 0!==b&&b),y=f.a.fetchSafeFromObject({path:["session_data","tenant"],obj:n});return{project_repo:s,current_model:c,current_k8s_model:l,isTenantK8sMlOps:v,currentUserId:f.a.fetchSafeFromObject({path:["session_data","user"],obj:n,default_value:""}).split("/").pop(),currentTenantData:(t=n.session_data,a=void 0===t?{}:t,{k8sAuthPort:f.a.fetchSafeFromObject({path:["current_tenant_data","k8s_auth_port"],obj:a,default_value:null}),k8sTenantNamespace:f.a.fetchSafeFromObject({path:["current_tenant_data","namespace"],obj:a,default_value:""}),k8sClusterId:f.a.fetchSafeFromObject({path:["current_tenant_data","k8s_cluster"],obj:a,default_value:""})}),k8sModels:u,epicModels:p,tenantUrl:y}})))(Hy);function qy(e){return(qy="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Vy(e,t){for(var a=0;a<t.length;a++){var r=t[a];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Gy(e,t,a){return t&&Vy(e.prototype,t),a&&Vy(e,a),e}function zy(e,t){return(zy=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Wy(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=$y(e);if(t){var n=$y(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return Jy(this,a)}}function Jy(e,t){return!t||"object"!==qy(t)&&"function"!=typeof t?Yy(e):t}function Yy(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function $y(e){return($y=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var Qy=er({path:["projectRepoTooltipMsg"]}),Zy={type:"object",properties:{mount_name:{type:"string",title:"Repo Name",description:Qy.mountNameDescription,bd_required:!0},type:{type:"string",title:"Type",enum:["nfs"],enumNames:["NFS"],default:"nfs",description:Qy.typeDescription,bd_required:!0,bd_disabled:!0},host:{type:"string",title:"NFS Host Name",description:Qy.hostDescription,bd_required:!0},export_path:{type:"string",title:"NFS Share",description:Qy.exportPathDescription,bd_required:!0}}},Xy=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&zy(e,t)}(a,e);var t=Wy(a);function a(e){var r;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,a),(r=t.call(this,e)).submitForm=r.submitForm.bind(Yy(r)),r.validateForm=r.validateForm.bind(Yy(r)),r.fetchProjectRepo=r.fetchProjectRepo.bind(Yy(r)),r.updateFormData=r.updateFormData.bind(Yy(r)),r.onProjectRepoFetched=r.onProjectRepoFetched.bind(Yy(r)),r.state={submitted:!1,projectRepoDataFetched:!1,repo_status:"loading",formSchema:Zy,formData:{},submitDisabled:!1},r.timer=null,r}return Gy(a,null,[{key:"getMeta",value:function(){return{title:"".concat(w.APP_TITLE.ML_OPS," | Create or Update Project Repo"),link:[{rel:"canonical",href:"".concat(w.serverUrl).concat(w.views.projectRepo.url)}],meta:[{charset:"utf-8"},{name:"description",content:"Create or Update Project Repo."}]}}}]),Gy(a,[{key:"componentDidMount",value:function(){this.fetchProjectRepo({updateData:!0})}},{key:"fetchProjectRepo",value:function(e){var t=this,a=e.updateData,r=void 0!==a&&a;clearTimeout(this.timer);var n=this.props,o=n.tenant,i=n.dispatch,s=this;o?i(Q(oe.PROJECT_REPO_DATA(o))).then((function(){r&&t.updateFormData(),s.setState({projectRepoDataFetched:!0},s.onProjectRepoFetched)})):this.timer=setTimeout((function(){return t.fetchProjectRepo({updateData:!1})}),5e3)}},{key:"updateFormData",value:function(){var e=this.state.formSchema,t=this.props.project_repo;if(!f.a.isEmptyObject(t)){var a=f.a.fetchSafeFromObject({path:["_embedded","mountspec"],obj:t,default_value:{}}),r=a.mount_name,n=void 0===r?"":r,o=a.host,i=void 0===o?"":o,s=a.export_path,c=void 0===s?"":s,l=a.type,u=void 0===l?"":l,p=a.force,d=void 0!==p&&p,m={mount_name:n,host:i,type:u,export_path:c};n&&(e.properties.mount_name.bd_disabled=!0),"bind"===u?(e.properties.type={type:"string",title:"Type",enum:["bind"],enumNames:["Bind"],default:"bind",description:Qy.typeDescription,bd_required:!0,bd_disabled:!0},e.properties.host.hidden=!0):(m.force=d,e.properties.force={type:"boolean",title:"Force?",default:!1,description:Qy.forceDescription}),this.setState({formData:m,formSchema:e})}}},{key:"onProjectRepoFetched",value:function(){var e=this,t=this.props,a=t.project_repo,r=t.dispatch,n=this.state.submitted,o=this.state,i=o.formSchema,s=void 0===i?{}:i,c=o.formData,l=void 0===c?{}:c,u=this.state.submitDisabled;if(f.a.isEmptyObject(a))delete s.properties.force,this.setState({submitted:!1,repo_status:"Not setup",formSchema:s});else{var p=f.a.fetchSafeFromObject({path:["_embedded","status","status"],obj:a,default_value:""}),d=f.a.fetchSafeFromObject({path:["_embedded","mountspec","host"],obj:a,default_value:""});if("bind"===f.a.fetchSafeFromObject({path:["_embedded","mountspec","type"],obj:a,default_value:""})&&(u=!0),["mounted","errors"].includes(p))u=!1;else{var m=l.force&&l.host===d?5:30;this.timer=setTimeout((function(){return e.fetchProjectRepo({updateData:!1})}),1e3*m),u=!0}this.setState({repo_status:p,submitDisabled:u}),n&&"mounted"===p&&this.setState({submitted:!0},(function(){r(I(L))}))}}},{key:"componentWillUnmount",value:function(){clearTimeout(this.timer)}},{key:"validateForm",value:function(e,t){var a=e.mount_name,r=e.host,n=e.export_path;return a||t.mount_name.addError(er({path:["project_repo","mount_name","required"]})),r&&(Fl.ip.test(r)||Fl.fqdn.test(r))||t.host.addError(er({path:["project_repo","host","required"]})),n&&Fl.path_name.test(n)||t.export_path.addError(er({path:["project_repo","export_path","required"]})),t}},{key:"submitForm",value:function(e){var t=e.formData,a=void 0===t?{}:t;if(!e.errors.length){var r=this.props,o=r.tenant,i=r.project_repo,s=this.state.timerId,c=this;a.read_only=!1;var l=f.a.fetchSafeFromObject({path:["_embedded","mountspec","export_path"],obj:i,default_value:""}),u=f.a.fetchSafeFromObject({path:["_embedded","mountspec","host"],obj:i,default_value:""});if(a.export_path===l&&a.host===u){return _n({msg:"There is nothing to update",variant:"success"}),!1}R({method:w.method.POST,apiurl:w.apiurl.PROJECT_REPO(o),data:a}).then((function(){c.setState({submitted:!0,formData:a}),clearTimeout(s),c.fetchProjectRepo({updateData:!0})})).catch((function(e){var t=f.a.parseAxiosError({error:e}),r=n.a.createElement("div",null,n.a.createElement(st.a,{variant:"caption"},"Failed to create/update project repository ( ",a.mount_name," )"),n.a.createElement(st.a,{variant:"caption"},t));_n({msg:r,variant:"error"})}))}}},{key:"render",value:function(){var e=this.props,t=e.classes,r=e.project_repo,o=e.disableDataSourceBrowse,i=e.role_name,s=a.getMeta(),c=this.state,l=c.submitted,u=c.projectRepoDataFetched,p=c.repo_status,d=c.formData,m=void 0===d?{}:d,h=c.formSchema,b=c.submitDisabled,v="errors"===p?f.a.fetchSafeFromObject({path:["_embedded","status","error_info"],obj:r,default_value:""}):"";return n.a.createElement("div",{className:"CreateEditProjectRepoPage"},n.a.createElement(Al.a,{title:s.title,description:s.description,link:s.link,meta:s.meta}),n.a.createElement("div",{className:t.titeWrapper},n.a.createElement(Nt,{title:"Project Repository"}),n.a.createElement(Qa,{status:p,title:p,tooltip:v})),u?n.a.createElement(En,{form_schema:h,ui_schema:{mount_name:{"ui:autofocus":!0}},formData:m,form_id:"create-edit-project-repo",submitter:this.submitForm,validate:l?null:this.validateForm,readOnly:"Admin"!==i,submitDisabled:b}):"",u&&"mounted"===p&&n.a.createElement("div",{className:t.ProjectBrowser},n.a.createElement(pi,{source:f.a.fetchSafeFromObject({path:["_links","self","href"],obj:r,default_value:""}),source_type:"fsMount",path:"/",useFolderActions:!0,name:r._embedded.mountspec.mount_name,type:"NFS",browseDisabled:o})))}}]),a}(r.Component);!function(e,t,a){t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a}(Xy,"propTypes",{classes:u.a.object.isRequired,dispatch:u.a.func.isRequired,tenant:u.a.string,role_name:u.a.string,project_repo:u.a.object,disableDataSourceBrowse:u.a.bool});var eg=d()(he()((function(e){return{titeWrapper:{display:"flex",justifyContent:"space-between",marginBottom:2*e.spacing.unit},ProjectBrowser:{marginTop:6*e.spacing.unit}}}),{name:"CreateEditProjectRepoPage"}),Object(s.b)((function(e){var t=e.stats_data,a=(t=void 0===t?{}:t).session_data,r=(a=void 0===a?{}:a).tenant,n=void 0===r?"":r,o=a.disableDataSourceBrowse,i=void 0===o||o,s=e.page_data,c=(s=void 0===s?{}:s).project_repo;return{tenant:n,project_repo:void 0===c?{}:c,disableDataSourceBrowse:i}})))(Xy);function tg(e){return(tg="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function ag(){return(ag=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var r in a)Object.prototype.hasOwnProperty.call(a,r)&&(e[r]=a[r])}return e}).apply(this,arguments)}function rg(e,t){for(var a=0;a<t.length;a++){var r=t[a];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function ng(e,t,a){return t&&rg(e.prototype,t),a&&rg(e,a),e}function og(e,t){return(og=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function ig(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=lg(e);if(t){var n=lg(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return sg(this,a)}}function sg(e,t){return!t||"object"!==tg(t)&&"function"!=typeof t?cg(e):t}function cg(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function lg(e){return(lg=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function ug(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}var pg=w.clusterTypes.training,dg=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&og(e,t)}(a,e);var t=ig(a);function a(e){var r;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,a),ug(cg(r=t.call(this,e)),"timeout",null),r.fetchClusterData=r.fetchClusterData.bind(cg(r)),r}return ng(a,null,[{key:"getMeta",value:function(){return{title:"".concat(w.APP_TITLE.ML_OPS," | Trainings"),link:[{rel:"canonical",href:"".concat(w.serverUrl).concat(w.views.trainings.url)}],meta:[{charset:"utf-8"},{name:"description",content:"Manage Training Clusters."}]}}}]),ng(a,[{key:"componentDidMount",value:function(){var e=this.props.dispatch;this.fetchClusterData(),e(Q(oe.CATALOG_DATA))}},{key:"componentWillUnmount",value:function(){clearTimeout(this.timeout)}},{key:"fetchClusterData",value:function(){var e=this,t=this;(0,this.props.dispatch)(Q(oe.CLUSTER_DATA)).then((function(){var a=t.props.page_data,r=(a=void 0===a?{}:a).cluster_list,n=void 0===r?{}:r,o=Kf.filterSelectedClusterType({cluster_list:n,CLUSTER_TYPE:pg});Kf.liveUpdateClusters(o)&&(e.timeout=setTimeout((function(){t.fetchClusterData()}),3e4))}))}},{key:"render",value:function(){var e=a.getMeta(),t=this.props,r=t.page_data,o=(r=void 0===r?{}:r).catalog_list,i=void 0===o?{}:o,s=r.cluster_list,c=void 0===s?{}:s,l=t.stats_data,u=(l=void 0===l?{}:l).session_data,p=void 0===u?{}:u,d=p.role_name,f=void 0===d?"":d,m=Kf.filterSelectedClusterType({cluster_list:c,CLUSTER_TYPE:pg});return n.a.createElement("div",{className:"TrainingPage"},n.a.createElement(Al.a,{title:e.title,description:e.description,link:e.link,meta:e.meta}),n.a.createElement(Nt,{title:"Training"}),n.a.createElement(Lm,ag({catalog_list:i,clusters:m,role_name:f,CLUSTER_TYPE:pg,fetchClusterData:this.fetchClusterData},p)))}}]),a}(r.Component);ug(dg,"propTypes",{classes:u.a.object.isRequired,dispatch:u.a.func.isRequired,stats_data:u.a.object,page_data:u.a.object});var fg=d()(he()(qf,{name:"App"}),Object(s.b)((function(e){var t=e.stats_data,a=void 0===t?{}:t,r=e.page_data;return{stats_data:a,page_data:void 0===r?{}:r}})))(dg);function mg(e){return(mg="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function hg(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function bg(e,t){for(var a=0;a<t.length;a++){var r=t[a];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function vg(e,t){return(vg=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function yg(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=_g(e);if(t){var n=_g(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return gg(this,a)}}function gg(e,t){return!t||"object"!==mg(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function _g(e){return(_g=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var Sg=w.clusterTypes.training,kg=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&vg(e,t)}(i,e);var t,a,r,o=yg(i);function i(){return hg(this,i),o.apply(this,arguments)}return t=i,r=[{key:"getMeta",value:function(){return{title:"".concat(w.APP_TITLE.ML_OPS," | Create or Update Training Clusters"),link:[{rel:"canonical",href:"".concat(w.serverUrl).concat(w.views.createEditTraining.url)}],meta:[{charset:"utf-8"},{name:"description",content:"Create or Update training clusters."}]}}}],(a=[{key:"componentDidMount",value:function(){var e=this.props,t=e.dispatch,a=e.location,r=e.stats_data,n=yh.getClusterCreateParams({location:a}),o=f.a.fetchSafeFromObject({path:["session_data","tenant"],obj:r,default_value:{}});yh.fetchCommonClusterCreateData({dispatch:t,id:n.id}),t(Q(oe.PROJECT_REPO_DATA(o)))}},{key:"componentWillUnmount",value:function(){var e=this.props.dispatch;yh.clearPageDataCurrentCluster({dispatch:e})}},{key:"render",value:function(){var e=i.getMeta(),t=this.props,a=t.page_data,r=(a=void 0===a?{}:a).catalog_list,o=void 0===r?{}:r,s=a.cluster_list,c=void 0===s?{}:s,l=a.flavor_list,u=void 0===l?{}:l,p=a.current_cluster,d=void 0===p?{}:p,m=a.cluster_nodes,h=void 0===m?{}:m,b=a.hosts_tags,v=void 0===b?{}:b,y=a.project_repo,g=void 0===y?void 0:y,_=t.stats_data,S=void 0===_?{}:_,k=f.a.fetchSafeFromObject({path:["lock_data","locked"],obj:S,default_value:!1}),O=f.a.fetchSafeFromObject({path:["session_data","current_tenant_data","kdc_type"],obj:S,default_value:""}),E=f.a.fetchSafeFromObject({path:["_embedded","tags"],obj:v,default_value:[]}),j=f.a.fetchSafeFromObject({path:["session_data","current_tenant_data","constraints_supported"],obj:S,default_value:!1}),D=yh.getClusterCreateParams({location}),w=D.id,C=void 0===w?"":w,T=D.operation,P=T.split("_"),A="".concat(f.a.capitalize(P[0])," Training ").concat(f.a.capitalize(P[1])),R=!f.a.isEmptyObject(o)&&!f.a.isEmptyObject(u)&&!f.a.isEmptyObject(v);return R&&C&&(R=!f.a.isEmptyObject(d)),n.a.createElement("div",{className:"CreateEditTrainingPage"},n.a.createElement(Al.a,{title:e.title,description:e.description,link:e.link,meta:e.meta}),n.a.createElement(Nt,{title:A}),R&&g&&!k?n.a.createElement(Ah,{CLUSTER_TYPE:Sg,operation:T,cluster_list:c,flavor_list:u,catalog_list:o,cluster_data:d,cluster_nodes:h,tags:E,constraints_supported:j,project_repo:g,tenantKDC:O}):n.a.createElement(Ia,null,k?n.a.createElement(st.a,null,"System is in lockdown mode. You will not be able to create the cluster. Contact your site administrator."):n.a.createElement(ls,null)))}}])&&bg(t.prototype,a),r&&bg(t,r),i}(r.Component);!function(e,t,a){t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a}(kg,"propTypes",{classes:u.a.object.isRequired,dispatch:u.a.func.isRequired,stats_data:u.a.object,page_data:u.a.object,location:u.a.object});var Og=d()(he()((function(){return{}}),{name:"App"}),Object(s.b)((function(e){var t=e.stats_data,a=void 0===t?{}:t,r=e.page_data;return{stats_data:a,page_data:void 0===r?{}:r}})))(kg);function Eg(e){return(Eg="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function jg(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function Dg(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?jg(Object(a),!0).forEach((function(t){Fg(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):jg(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function wg(e,t){for(var a=0;a<t.length;a++){var r=t[a];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Cg(e,t,a){return t&&wg(e.prototype,t),a&&wg(e,a),e}function Tg(e,t){return(Tg=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Pg(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=Ng(e);if(t){var n=Ng(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return Ag(this,a)}}function Ag(e,t){return!t||"object"!==Eg(t)&&"function"!=typeof t?Rg(e):t}function Rg(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Ng(e){return(Ng=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Fg(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}var xg=er({path:["sourceControlTooltipMsg"]}),Mg=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Tg(e,t)}(a,e);var t=Pg(a);function a(e){var r;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,a),(r=t.call(this,e)).state={sourceControlSchema:{},formData:{}},r.fetchGitHubRepo=r.fetchGitHubRepo.bind(Rg(r)),r.onChangeSourceControlService=r.onChangeSourceControlService.bind(Rg(r)),r.onFormChange=r.onFormChange.bind(Rg(r)),r.submitForm=r.submitForm.bind(Rg(r)),r.validateSourceControlForm=r.validateSourceControlForm.bind(Rg(r)),r}return Cg(a,null,[{key:"getMeta",value:function(){return{title:"".concat(w.APP_TITLE.ML_OPS," | Source Control Page"),link:[{rel:"canonical",href:"".concat(w.serverUrl).concat(w.views.sourceControl.url)}],meta:[{charset:"utf-8"},{name:"description",content:"Add GitHub Repo"}]}}}]),Cg(a,[{key:"componentDidMount",value:function(){this.fetchGitHubRepo()}},{key:"validateSourceControlForm",value:function(e,t){if("github"===e.source_control_service){var a=e.credentials_spec,r=void 0===a?{}:a;if(!f.a.isEmptyObject(r)){var n=r.user_name,o=void 0===n?"":n,i=r.user_email,s=void 0===i?"":i,c=r.repository_url,l=void 0===c?"":c,u=r.branch_name,p=void 0===u?"":u,d=r.access_token,m=void 0===d?"":d;o&&Fl.user_name.test(o)||t.credentials_spec.user_name.addError(er({path:["sourceControl","invalid_name"]})),s&&Fl.email_address.test(s)||t.credentials_spec.user_email.addError(er({path:["sourceControl","invalid_email"]})),l&&Fl.url.test(l)||t.credentials_spec.repository_url.addError(er({path:["sourceControl","invalid_url"]})),p||t.credentials_spec.branch_name.addError(er({path:["sourceControl","invalid_branch_name"]})),!m&&t.credentials_spec.access_token&&t.credentials_spec.access_token.addError(er({path:["sourceControl","invalid_access_token"]}))}}return t}},{key:"fetchGitHubRepo",value:function(){var e=this,t=this.props,a=t.stats_data,r=t.dispatch,n=f.a.fetchSafeFromObject({path:["session_data","tenant"],obj:a});r(Q(oe.SOURCE_CONTROL_DATA(n))).then((function(){var t=e.getFormDataFromSourceControl();e.getSourceControlSchema(t)}))}},{key:"getSourceControlSchema",value:function(e){var t=e.source_control_service,a={type:"object",properties:{source_control_service:{type:"string",enum:["github","none"],default:"none",title:"Source Control",description:xg.sourceControlServiceDescription,bd_required:!0}},required:["source_control_service"],default:t||"none"};this.setState({sourceControlSchema:a,formData:e}),this.onChangeSourceControlService()}},{key:"onChangeSourceControlService",value:function(){var e=this.state,t=e.sourceControlSchema,a=e.formData;if("github"===a.source_control_service){var r=this.props.page_data,n=r.source_control,o=(n=void 0===n?{}:n).credentials_spec,i=(o=void 0===o?{}:o).branch_name,s=o.repository_url,c=o.user_email,l=o.user_name,u=o.access_token,p=r.working_dir,d=void 0===p?"":p;t.properties=Dg(Dg({},t.properties),{},{working_dir:{type:"string",title:"Working Directory",default:d||"",description:xg.workingDirDescription},credentials_spec:{type:"object",title:"Credentials",properties:{repository_url:{type:"string",title:"Repository URL",default:s||"",description:xg.repoUrlDescription,bd_required:!0},access_token:{type:"string",title:"Access Token",default:u||"",description:xg.accessTokenDescription,bd_required:!0,bd_widget:"password"},branch_name:{type:"string",title:"Branch Name",default:i||"",description:xg.branchNameDescription,bd_required:!0},user_name:{type:"string",title:"User Name",default:l||"",description:xg.userNameDescription,bd_required:!0},user_email:{type:"string",title:"User Email",default:c||"",description:xg.userEmailDescription,bd_required:!0}}}})}else delete t.properties.working_dir,delete t.properties.credentials_spec,delete a.working_dir,delete a.credentials_spec;this.setState({sourceControlSchema:t,formData:a})}},{key:"getFormDataFromSourceControl",value:function(){var e=f.a.fetchSafeFromObject({path:["page_data","source_control"],obj:this.props,default_value:{}}),t=e.source_control_service,a=void 0===t?"none":t,r=e.working_dir,n=void 0===r?"":r,o=e.credentials_spec,i=void 0!==o&&o,s={source_control_service:a};return i&&(s.credentials_spec=i,s.working_dir=n),s}},{key:"onFormChange",value:function(e){var t=document.activeElement,a=xl(t);if(a&&a.includes("_source_control_service")){var r=e.formData,n=void 0===r?{}:r;this.setState({formData:n}),this.onChangeSourceControlService()}}},{key:"submitForm",value:function(e){var t=this,a=e.formData,r=e.errors,o=this.props.stats_data,i=f.a.fetchSafeFromObject({path:["session_data","tenant"],obj:o});r.length||R({method:w.method.PUT,apiurl:w.apiurl.SOURCE_CONTROL(i),data:a}).then((function(){_n({msg:"".concat(er({path:["sourceControl","update_success"]})),variant:"success"}),t.fetchGitHubRepo()})).catch((function(e){var t=f.a.parseAxiosError({error:e}),a=n.a.createElement("div",null,n.a.createElement(st.a,{variant:"caption"},er({path:["sourceControl","update_failure"]})),n.a.createElement(st.a,{variant:"caption"},t));_n({msg:a,variant:"error"})}))}},{key:"render",value:function(){var e=this.state,t=e.sourceControlSchema,r=e.formData,o=a.getMeta(),i=!1,s=this.props.stats_data.session_data,c=(s=void 0===s?{}:s).role_name;return"Admin"!==(void 0===c?"":c)&&(i=!0),n.a.createElement("div",{className:"SourceControlPage"},n.a.createElement(Al.a,{title:o.title,description:o.description,link:o.link,meta:o.meta}),n.a.createElement(Nt,{title:"Project Source Control Page"}),n.a.createElement(En,{form_schema:t,formData:r,form_id:"sourceControlForm",submitter:this.submitForm,onChange:this.onFormChange,validate:this.validateSourceControlForm,readOnly:i}))}}]),a}(r.Component);Fg(Mg,"propTypes",{stats_data:u.a.object,page_data:u.a.object,dispatch:u.a.func.isRequired,session_data:u.a.object,classes:u.a.object.isRequired});var Ig=d()(he()((function(){return{}}),{name:"App"}),Object(s.b)((function(e){var t=e.stats_data,a=void 0===t?{}:t,r=e.page_data;return{stats_data:a,page_data:void 0===r?{}:r}})))(Mg);function Ug(e){return(Ug="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Lg(e,t){for(var a=0;a<t.length;a++){var r=t[a];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Bg(e,t){return(Bg=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Hg(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=Vg(e);if(t){var n=Vg(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return Kg(this,a)}}function Kg(e,t){return!t||"object"!==Ug(t)&&"function"!=typeof t?qg(e):t}function qg(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Vg(e){return(Vg=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var Gg=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Bg(e,t)}(i,e);var t,a,r,o=Hg(i);function i(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),(t=o.call(this,e)).copyAuthToken=t.copyAuthToken.bind(qg(t)),t}return t=i,(a=[{key:"copyAuthToken",value:function(){var e=this.props.service,t=(void 0===e?{}:e).auth_token;t&&void 0!==t&&(f.a.copyToClipboard(t),_n({msg:"Auth token copied to clipboard",variant:"success"}))}},{key:"render",value:function(){var e=this.props,t=e.service,a=void 0===t?{}:t,r=e.isolated,o=void 0!==r&&r,i=e.classes,s=a.name,c=void 0===s?"":s,l=a.url,u=void 0===l?"":l,p=a.is_dashboard,d=void 0!==p&&p,f=a.auth_token,m=void 0===f?"":f,h=null,b="Auth Token: ".concat(m,"\n            Click to copy to clipboard");return h=d?o?n.a.createElement(ka,{title:"Service dashboard is not accessible when cluster is in isolated mode."},n.a.createElement(st.a,{color:"primary",variant:"caption"},c)):u?n.a.createElement("a",{href:u,target:"blank",className:i.link},c):"":n.a.createElement(st.a,null,n.a.createElement("span",{className:i.bold},c," :")," ",u),n.a.createElement(Ia,null,h,m?n.a.createElement(ka,{title:b},n.a.createElement(st.a,{variant:"caption",onClick:this.copyAuthToken,className:i.dpInline}," ","[Auth Token]")):"")}}])&&Lg(t.prototype,a),r&&Lg(t,r),i}(r.Component);!function(e,t,a){t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a}(Gg,"propTypes",{service:u.a.object.isRequired,isolated:u.a.bool,classes:u.a.object});var zg=he()((function(e){return{bold:{fontWeight:400},link:{textDecoration:"none",color:e.palette.primary.main},dpInline:{display:"inline",cursor:"pointer"}}}))(Gg);function Wg(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function Jg(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?Wg(Object(a),!0).forEach((function(t){Yg(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):Wg(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function Yg(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}var $g=er({path:["clusterNodeTooltipMsg"]}),Qg={type:"object",properties:{reason:{type:"string",default:"Node Services Update",hidden:!0},operation:{type:"string",default:"services_update",hidden:!0},change_spec:{type:"object",properties:{}}}},Zg=function(e){var t=e.filteredNodes,a=e.action,r=e.proxy_present,n={},o=[],i=[];["update_service","delete_service"].includes(a)&&t.map((function(e){e.services.map((function(e){o.includes(e.id)||(o.push(e.id),i.push(e))}))}));var s=o.length?o[0]:"",c=i.find((function(e){return e.id===s})),l=e_({service:c,action:a,proxy_present:r}),u={type:"string",title:"Service ID",default:s,description:$g.serviceIdDescription,bd_required:!0};if(o.length&&(u.enum=o),["add_service","delete_service"].includes(a)){var p=Xg(t,a,s);n={nodes:{type:"array",items:{type:"string",enum:p.enumNodeItems,enumNames:p.enumNodeNames},title:"Node(s)",uniqueItems:!0,default:[],description:$g.nodesDescription,bd_required:!0}}}return{type:"object",properties:Jg(Jg({id:u},l),n)}},Xg=function(e,t,a){var r=[],n=[],o=e.reduce((function(e,r){if("add_service"===t||r.services.find((function(e){return e.id===a}))){var n=f.a.fetchSafeFromObject({path:["_links","self","href"],obj:r,default_value:""});e.push({id:n.split("?")[0],name:"".concat(r.fqdn," (").concat(r.role,")")})}return e}),[]);return f.a.bdSort(o,["name"]).map((function(e){var t=e.id,a=e.name;r.push(t),n.push(a)})),{enumNodeItems:r,enumNodeNames:n}},e_=function(e){var t=e.service,a=void 0===t?{}:t,r=e.action,n=e.proxy_present;if("delete_service"===r)return{};var o=a.exported_service,i=void 0===o?"":o,s=a.label,c=(s=void 0===s?{}:s).name,l=void 0===c?"":c,u=s.description,p=void 0===u?"":u,d=a.endpoint,f=(d=void 0===d?{}:d).port,m=void 0===f?"":f,h=d.loadbalanced,b=void 0!==h&&h,v=d.auth_token,y=void 0!==v&&v,g=d.is_dashboard,_=void 0!==g&&g,S=d.path,k=void 0===S?"":S,O=d.url_scheme,E=_?{path:{type:"string",title:"Path",default:k},url_scheme:{type:"string",title:"Protocol",default:void 0===O?"http":O,enum:["http","https"]}}:{};return{exported_service:{type:"string",title:"Exported Service",default:i,description:$g.exportedServiceDescription},label:{type:"object",properties:{name:{type:"string",title:"Service Name",default:l,description:$g.serviceNameDescription,bd_required:!0},description:{type:"string",title:"Service Description",default:p,description:$g.serviceDescription}}},endpoint:{type:"object",properties:Jg({port:{type:"string",title:"Port",default:m,description:$g.portDescription,bd_required:!0},loadbalanced:{type:"boolean",title:"LoadBalanced",default:b,description:$g.loadbalancedDescription,bd_disabled:!n,checkbox_label:n?"":$g.gatewayHostWarning},auth_token:{type:"boolean",title:"Enable Auth Token",default:!!y,description:$g.authTokenDescription},is_dashboard:{type:"boolean",title:"Dashboard",default:_,description:$g.dashboardDescription}},E)}}},t_={processNodeServicesWithEndpointType:function(e){var t=e.nodes,a=e.endpoint_type,r=e.intended_categories,n={},o="public"===a;return t.map((function(e){var t=[],a=e.fqdn,i=void 0===a?"":a,s=e.public_ip,c=void 0===s?"":s,l=e.private_ip,u=void 0===l?"":l,p=e.role,d=void 0===p?"":p,f=e.services,m=o?c:u||c;(void 0===f?[]:f).map((function(e){var a,n=e.endpoint,s=(n=void 0===n?{}:n).proxy_host,c=void 0===s?"":s,l=n.proxy_port,u=void 0===l?"":l,p=n.proxy_scheme,f=void 0===p?"":p,h=n.port,b=void 0===h?"":h,v=n.url_scheme,y=void 0===v?"":v,g=n.path,_=void 0===g?"":g,S=n.is_dashboard,k=void 0!==S&&S,O=n.auth_token,E=void 0===O?"":O,j=e.label,D=(j=void 0===j?{}:j).name,C=void 0===D?"":D,T=e.id,P=void 0===T?"":T,A=e.exported_service,R=void 0===A?"":A;if(!Object.keys(w.clusterTypes).map((function(e){return w.clusterTypes[e]})).includes(R)||r.includes(R)){var N=o&&c?c:m,F=o&&u||b,x=o?f||y:y||"",M=x?"".concat(x,"://"):"",I="ssh"===P?" -p ".concat(F):":".concat(F),U=_?/^\//g.test(_)?_:"/".concat(_):"";a="".concat(M).concat(N).concat(I).concat(U),t.push({fqdn:i,node_ip:m,role:d,id:P,name:C,url:a,exported_service:R,is_dashboard:k,auth_token:E})}})),n[i]=t})),n},downloadEndpoints:function(e){var t=e.cluster_data,a=e.nodeServices,r=e.endpoint_opts,n=e.endpoint_type,o=f.a.fetchSafeFromObject({path:["label","name"],obj:t,default_value:""}),i=r.length>1?f.a.capitalize(n):"",s="Cluster_".concat(o,"_Services").concat(i?"_".concat(i):"","_Endpoints.csv"),c="Cluster Name, ".concat(o);c+="\r\n\nNode Name,Node IP,Node Role,Service ID,Service Name,Exported Service,Service".concat(i?" ".concat(i):""," Endpoints"),Object.keys(a).map((function(e){a[e].map((function(e){var t=e.fqdn,a=void 0===t?"":t,r=e.node_ip,n=void 0===r?"":r,o=e.role,i=void 0===o?"":o,s=e.id,l=void 0===s?"":s,u=e.name,p=void 0===u?"":u,d=e.exported_service,f=void 0===d?"":d,m=e.url,h=void 0===m?"":m;c+="\r\n".concat(a,",").concat(n,",").concat(i,",").concat(l,",").concat(p,",").concat(f,",").concat(h)}))}));f.a.downloadOrSaveData(c,s,"text/csv")},getDefaultClusterServiceFormSpec:function(e){var t=e.action,a=void 0===t?"":t,r=e.cluster_data,n=void 0===r?{}:r,o=e.filteredNodes,i=void 0===o?[]:o,s=e.proxy_present,c=void 0!==s&&s,l=Qg,u=f.a.fetchSafeFromObject({path:["_links","self","href"],obj:n,default_value:""});if(a){var p=f.a.fetchSafeFromObject({path:["properties","change_spec","properties"],obj:l,default_value:{}});if(p.action={type:"string",default:a,hidden:!0},!f.a.isEmptyObject(n)){var d=f.a.fetchSafeFromObject({path:["nodegroup","catalog_entry_label","name"],obj:n,default_value:""}),m=[1],h=[d];n.dependent_nodegroups&&n.dependent_nodegroups.map((function(e){var t=f.a.fetchSafeFromObject({path:["catalog_entry_label","name"],obj:e,default_value:""});m.push(parseInt(e.id,10)),h.push(t)})),p.nodegroup_id={type:"number",enum:m,enumNames:h,default:1,title:"Nodegroup",hidden:1===m.length};var b=Zg({filteredNodes:i,action:a,proxy_present:c});p.update_spec=b}}return{Title:er({path:["clusterNodeService",a,"title"]}),name:er({path:["clusterNodeService",a,"name"]}),description:er({path:["clusterNodeService",a,"description"]}),method_actions:[{method:w.method.POST,action:w.apiurl.CLUSTER_CHANGE_TASK(u),data:"FORM_DATA"}],serviceFormSchema:l,serviceUISchema:{},success_msg:er({path:["clusterNodeService",a,"success_msg"]}),error_msg:er({path:["clusterNodeService",a,"error_msg"]})}},validateForm:function(e,t,a){var r=f.a.fetchSafeFromObject({path:["change_spec","update_spec"],obj:e,default_value:{}}),n=f.a.fetchSafeFromObject({path:["change_spec","update_spec"],obj:t,default_value:{}});if(!f.a.isEmptyObject(n)){var o=r.nodes,i=void 0===o?"":o,s=r.id,c=void 0===s?"":s,l=r.exported_service,u=void 0===l?"":l,p=r.label,d=(p=void 0===p?{}:p).name,m=void 0===d?"":d,h=r.endpoint,b=(h=void 0===h?{}:h).port,v=void 0===b?"":b;"update_service"!==a&&(i.length||n.nodes.addError(er({path:["clusterNodeService","nodes","required"]}))),c.length||n.id.addError(er({path:["clusterNodeService","id","required"]})),c&&!Fl.name.test(c)&&n.id.addError(er({path:["clusterNodeService","id","validName"]})),c.length>72&&n.id.addError(er({path:["clusterNodeService","id","maxLength"]})),"delete_service"!==a&&(u&&!Fl.exported_service.test(u)&&n.exported_service.addError(er({path:["clusterNodeService","exported_service","validName"]})),m.length||n.label.name.addError(er({path:["clusterNodeService","name","required"]})),c&&!Fl.name.test(m)&&n.label.name.addError(er({path:["clusterNodeService","name","validName"]})),m.length>72&&n.label.name.addError(er({path:["clusterNodeService","name","maxLength"]})),(!v||!Fl.port.test(v)||parseInt(v,10)>65536)&&n.endpoint.port.addError(er({path:["clusterNodeService","port"]})))}return t},getNodeSelectionItems:Xg,preProcessNodeServiceData:function(e){var t=e.change_spec,a=void 0===t?{}:t,r=a.update_spec,n=void 0===r?{}:r,o=a.action,i=void 0===o?"":o;return!n.exported_service&&delete n.exported_service,"delete_service"===i&&(delete n.label,delete n.endpoint),e}};function a_(e){return(a_="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function r_(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function n_(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?r_(Object(a),!0).forEach((function(t){d_(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):r_(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function o_(){return(o_=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var r in a)Object.prototype.hasOwnProperty.call(a,r)&&(e[r]=a[r])}return e}).apply(this,arguments)}function i_(e,t){for(var a=0;a<t.length;a++){var r=t[a];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function s_(e,t){return(s_=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function c_(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=p_(e);if(t){var n=p_(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return l_(this,a)}}function l_(e,t){return!t||"object"!==a_(t)&&"function"!=typeof t?u_(e):t}function u_(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function p_(e){return(p_=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function d_(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}var f_=er({path:["clusterNodeTooltipMsg"]}),m_=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&s_(e,t)}(i,e);var t,a,r,o=c_(i);function i(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),(t=o.call(this,e)).state={endpoint_opts:[],endpoint_type:"private",formSpec:t_.getDefaultClusterServiceFormSpec({}),service_action:"",filteredNodes:[]},t.setEndpointSelections=t.setEndpointSelections.bind(u_(t)),t.downloadEndpoints=t.downloadEndpoints.bind(u_(t)),t.onFormChange=t.onFormChange.bind(u_(t)),t.invokeServiceUpdateModal=t.invokeServiceUpdateModal.bind(u_(t)),t.getFilteredNodes=t.getFilteredNodes.bind(u_(t)),t.onChangeNodeGroupId=t.onChangeNodeGroupId.bind(u_(t)),t.processNodes=t.processNodes.bind(u_(t)),t.onChangeServiceId=t.onChangeServiceId.bind(u_(t)),t.onChangeIsDashboard=t.onChangeIsDashboard.bind(u_(t)),t.callBack=t.callBack.bind(u_(t)),t.serviceUpdateModalFormRef=n.a.createRef(),t}return t=i,(a=[{key:"componentDidMount",value:function(){this.setEndpointSelections()}},{key:"setEndpointSelections",value:function(){var e=this,t=this.props,a=t.cluster_nodes,r=void 0===a?{}:a,n=t.updateNodeServices;if(f.a.isEmptyObject(r))setTimeout((function(){e.setEndpointSelections()}),1e3);else{var o=f.a.fetchSafeFromObject({path:["_embedded","nodes"],obj:r,default_value:[]}),i=["private"];o.length&&o.some((function(e){return e.services.find((function(e){return e.endpoint.proxy_host}))?(i=["public","private"],!0):e.public_ip?(i=e.private_ip?["public","private"]:["public"],!0):void 0})),this.setState({endpoint_opts:i,endpoint_type:i[0]},(function(){n(i[0])}))}}},{key:"downloadEndpoints",value:function(){var e=this.state,t=e.endpoint_opts,a=e.endpoint_type,r=this.props,n=r.cluster_data,o=void 0===n?{}:n,i=r.nodeServices,s=void 0===i?{}:i;t_.downloadEndpoints({cluster_data:o,nodeServices:s,endpoint_opts:t,endpoint_type:a})}},{key:"getNodesTableSettings",value:function(){var e=this,t=this.props,a=t.cluster_nodes,r=void 0===a?{}:a,o=t.cluster_data,i=void 0===o?{}:o,s=t.nodeServices,c=void 0===s?{}:s;return{columns:[{name:"Name",options:{filter:!0}},{name:"Distribution",options:{filter:!0,customBodyRender:function(e){var t=JSON.parse(e),a=t.label,r=(a=void 0===a?{}:a).name,o=void 0===r?"":r,i=t.state,s=void 0===i?"":i;return n.a.createElement(Ia,null,n.a.createElement(st.a,{variant:"body1"},o),"uninstall pending"===s?n.a.createElement(st.a,{variant:"caption"},"(deprecated)"):"")}}},{name:"Role",options:{filter:!0}},{name:"Instance IP",options:{filter:!0,customBodyRender:function(e){var t=JSON.parse(e),a=t.public_ip,r=void 0===a?"":a,o=t.private_ip,i=void 0===o?"":o;return n.a.createElement(Ia,null,i?n.a.createElement(st.a,{variant:"body1"},i):"",r?n.a.createElement(st.a,{variant:"body1",color:"primary"},r):"")}}},{name:"Services",options:{filter:!0,customBodyRender:function(e){var t=JSON.parse(e),a=t.services,r=void 0===a?[]:a,o=t.isolated,i=void 0!==o&&o,s=[],c=[];return r.map((function(e){e.is_dashboard?s.push(e):c.push(e)})),n.a.createElement(Ia,null,s.length?s.map((function(e){return n.a.createElement(zg,o_({service:e,isolated:i},{key:e.id}))})).reduce((function(e,t){return[e,", ",t]})):"",c.length?c.map((function(e){return n.a.createElement(zg,o_({service:e,isolated:i},{key:e.id}))})):"")}}}],data:f.a.fetchSafeFromObject({path:["_embedded","nodes"],obj:r,default_value:[]}).reduce((function(e,t){var a=t.fqdn,r=void 0===a?"":a,n=t.catalog_entry_label,o=void 0===n?{}:n,s=t.catalog_entry_state,l=void 0===s?{}:s,u=t.public_ip,p=void 0===u?"":u,d=t.private_ip,f=void 0===d?"":d,m=t.role,h=void 0===m?"":m,b=c[r]||[];return e.push([r,JSON.stringify({label:o,state:l}),h,JSON.stringify({public_ip:p,private_ip:f}),JSON.stringify({services:b,isolated:i.isolated})]),e}),[]),options:{customToolbar:function(){var t=e.state,a=t.endpoint_opts,r=t.endpoint_type,o=e.props,i=o.cluster_data,s=void 0===i?{}:i,c=o.updateNodeServices,l=s.status,u=!["ready","stopped","error"].includes(l);return n.a.createElement("div",{className:"tableActionButtons"},a.length&&a.length>1?n.a.createElement(_t,{variant:"outlined",color:"default",title:"".concat(f.a.capitalize(r)," Endpoints"),menuList:a.map((function(t){return{label:"".concat(f.a.capitalize(t)," Endpoints"),onClick:function(){e.setState({endpoint_type:t},(function(){c(t)}))}}}))}):"",n.a.createElement(_t,{variant:"contained",color:"primary",title:"Actions",operation:"clusterActions",disabled:u,menuList:[{icon:"icon-download2",label:"Download".concat(a.length>1?" ".concat(f.a.capitalize(r)):""," Endpoints"),onClick:e.downloadEndpoints},{icon:"icon-plus",label:er({path:["clusterNodeService","add_service","title"]}),onClick:function(){e.invokeServiceUpdateModal("add_service")}},{icon:"icon-pencil3",label:er({path:["clusterNodeService","update_service","title"]}),onClick:function(){e.invokeServiceUpdateModal("update_service")}},{icon:"icon-trash2",label:er({path:["clusterNodeService","delete_service","title"]}),onClick:function(){e.invokeServiceUpdateModal("delete_service")}}]}))},selectableRows:"none"}}}},{key:"invokeServiceUpdateModal",value:function(e){var t=this,a=this.props,r=a.cluster_data,n=void 0===r?{}:r,o=a.proxy_present,i=this.getFilteredNodes({}),s=t_.getDefaultClusterServiceFormSpec({action:e,cluster_data:n,filteredNodes:i,proxy_present:o});this.setState({formSpec:s,service_action:e,filteredNodes:i},(function(){t.serviceUpdateModalFormRef.current.openModal()}))}},{key:"callBack",value:function(e){var t=e.variant,a=this.state.endpoint_type;if("success"===t){var r=this.props.fetchCurrentClusterData,n=void 0===r?null:r;n&&n(a)}}},{key:"onFormChange",value:function(e){var t=this.state.service_action,a=e.formData,r=document.activeElement,n=xl(r);n&&(n.includes("_nodegroup_id")?(this.serviceUpdateModalFormRef.current.updateStateFormData({formData:a}),this.onChangeNodeGroupId(),this.onChangeServiceId()):n.includes("update_spec_id")&&["update_service","delete_service"].includes(t)?(this.serviceUpdateModalFormRef.current.updateStateFormData({formData:a}),"delete_service"===t?this.processNodes():this.onChangeServiceId()):n.includes("_is_dashboard")&&(this.serviceUpdateModalFormRef.current.updateStateFormData({formData:a}),this.onChangeIsDashboard()))}},{key:"getFilteredNodes",value:function(e){var t=e.formData,a=void 0===t?{}:t,r=this.props.cluster_nodes,n=void 0===r?{}:r,o=f.a.fetchSafeFromObject({path:["_embedded","nodes"],obj:n,default_value:[]}),i=f.a.fetchSafeFromObject({path:["change_spec","nodegroup_id"],obj:a,default_value:1});return o.filter((function(e){return parseInt(e.nodegroup_id,10)===i}))}},{key:"onChangeNodeGroupId",value:function(){var e=this,t=this.state,a=t.formSpec,r=void 0===a?{}:a,n=t.service_action,o=void 0===n?"":n,i=f.a.fetchSafeFromObject({path:["state","formData"],obj:this.serviceUpdateModalFormRef.current,default_value:{}}),s=this.getFilteredNodes({formData:i});this.setState({filteredNodes:s},(function(){if("add_service"!==o){var t=r.serviceFormSchema,a=f.a.fetchSafeFromObject({path:["state","formData"],obj:e.serviceUpdateModalFormRef.current,default_value:{}}),n=[];s.map((function(e){e.services.map((function(e){n.includes(e.id)||n.push(e.id)}))})),f.a.fetchSafeFromObject({path:["properties","change_spec","properties","update_spec","properties","id"],obj:t,default_value:{}}).enum=n,f.a.fetchSafeFromObject({path:["change_spec","update_spec"],obj:a,default_value:{}}).id=n[0],e.setState({formSpec:n_(n_({},r),{},{serviceFormSchema:t})},(function(){e.serviceUpdateModalFormRef.current.updateStateFormData({formData:a}),"delete_service"===o&&e.processNodes()}))}else e.processNodes()}))}},{key:"processNodes",value:function(){var e=this.state,t=e.formSpec,a=void 0===t?{}:t,r=e.filteredNodes,n=void 0===r?[]:r,o=e.service_action,i=void 0===o?"":o,s=a.serviceFormSchema,c=f.a.fetchSafeFromObject({path:["state","formData"],obj:this.serviceUpdateModalFormRef.current,default_value:{}}),l=f.a.fetchSafeFromObject({path:["change_spec","update_spec","id"],obj:c,default_value:""}),u=t_.getNodeSelectionItems(n,i,l),p=u.enumNodeItems,d=u.enumNodeNames,m=f.a.fetchSafeFromObject({path:["properties","change_spec","properties","update_spec","properties","nodes"],obj:s,default_value:{}});m.items.enum=p,m.items.enumNames=d,f.a.fetchSafeFromObject({path:["change_spec","update_spec"],obj:c,default_value:{}}).nodes=[],this.setState({formSpec:n_(n_({},a),{},{serviceFormSchema:s})}),this.serviceUpdateModalFormRef.current.updateStateFormData({formData:c})}},{key:"onChangeServiceId",value:function(){var e=this.state.filteredNodes,t=void 0===e?[]:e,a=f.a.fetchSafeFromObject({path:["state","formData"],obj:this.serviceUpdateModalFormRef.current,default_value:{}}),r=f.a.fetchSafeFromObject({path:["change_spec","update_spec"],obj:a,default_value:{}}),n={};t.some((function(e){return e.services.some((function(e){if(e.id===r.id)return n=e,!0}))}));var o=n,i=o.exported_service,s=void 0===i?"":i,c=o.label,l=void 0===c?{}:c,u=o.endpoint,p=(u=void 0===u?{}:u).port,d=void 0===p?"":p,m=u.loadbalanced,h=void 0!==m&&m,b=u.auth_token,v=void 0!==b&&b,y=u.is_dashboard,g=void 0!==y&&y,_=u.path,S=void 0===_?"":_,k=u.url_scheme,O=void 0===k?"":k;r.exported_service=s,r.label=l,r.endpoint={port:d,loadbalanced:h,auth_token:!!v,is_dashboard:g,path:S,url_scheme:O},this.serviceUpdateModalFormRef.current.updateStateFormData({formData:a})}},{key:"onChangeIsDashboard",value:function(){var e=this.state.formSpec,t=void 0===e?{}:e,a=t.serviceFormSchema,r=f.a.fetchSafeFromObject({path:["state","formData"],obj:this.serviceUpdateModalFormRef.current,default_value:{}}),n=f.a.fetchSafeFromObject({path:["change_spec","update_spec","endpoint"],obj:r,default_value:{}}),o=f.a.fetchSafeFromObject({path:["properties","change_spec","properties","update_spec","properties","endpoint","properties"],obj:a,default_value:{}}),i=n.is_dashboard,s=void 0!==i&&i,c=n.path,l=void 0===c?"":c,u=n.url_scheme,p=void 0===u?"http":u;s?(o.path={type:"string",title:"Path",default:l,description:f_.pathDescription},o.url_scheme={type:"string",title:"Protocol",default:p,enum:["http","https"],description:f_.protocolDescription}):(delete o.path,delete o.url_scheme,delete n.path,delete n.url_scheme),this.setState({formSpec:n_(n_({},t),{},{serviceFormSchema:a})}),this.serviceUpdateModalFormRef.current.updateStateFormData({formData:r})}},{key:"render",value:function(){var e=this.state,t=e.formSpec,a=(t=void 0===t?{}:t).method_actions,r=t.Title,o=t.name,i=t.description,s=t.serviceFormSchema,c=t.serviceUISchema,l=t.success_msg,u=t.error_msg,p=e.service_action,d=void 0===p?"":p,f=this.getNodesTableSettings();return n.a.createElement(Ia,null,n.a.createElement(sa,f),n.a.createElement(Jn,{form_id:"manageNodeServiceForm",Title:n.a.createElement(st.a,{variant:"h2"},r),name:o,description:i,form_schema:s,ui_schema:c,method_actions:a,success_msg:l,failure_msg:u,callBack:this.callBack,preProcessData:t_.preProcessNodeServiceData,validate:function(e,t){return t_.validateForm(e,t,d)},onChange:this.onFormChange,ref:this.serviceUpdateModalFormRef}))}}])&&i_(t.prototype,a),r&&i_(t,r),i}(r.Component);d_(m_,"propTypes",{classes:u.a.object.isRequired,cluster_nodes:u.a.object,cluster_data:u.a.object,fetchCurrentClusterData:u.a.func,updateNodeServices:u.a.func,proxy_present:u.a.bool,nodeServices:u.a.object});var h_=he()(qf)(m_);function b_(e){return(b_="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function v_(e){return function(e){if(Array.isArray(e))return y_(e)}(e)||function(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||function(e,t){if(!e)return;if("string"==typeof e)return y_(e,t);var a=Object.prototype.toString.call(e).slice(8,-1);"Object"===a&&e.constructor&&(a=e.constructor.name);if("Map"===a||"Set"===a)return Array.from(e);if("Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a))return y_(e,t)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function y_(e,t){(null==t||t>e.length)&&(t=e.length);for(var a=0,r=new Array(t);a<t;a++)r[a]=e[a];return r}function g_(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function __(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?g_(Object(a),!0).forEach((function(t){w_(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):g_(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function S_(e,t){for(var a=0;a<t.length;a++){var r=t[a];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function k_(e,t){return(k_=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function O_(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=D_(e);if(t){var n=D_(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return E_(this,a)}}function E_(e,t){return!t||"object"!==b_(t)&&"function"!=typeof t?j_(e):t}function j_(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function D_(e){return(D_=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function w_(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}var C_=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&k_(e,t)}(i,e);var t,a,r,o=O_(i);function i(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),w_(j_(t=o.call(this,e)),"CancelToken",T.a.CancelToken),w_(j_(t),"source",null),t.state={dataFetching:!0,hosts_list:[],service_groups:[]},t.fetchData=t.fetchData.bind(j_(t)),t.processNagiosSettings=t.processNagiosSettings.bind(j_(t)),t.onClickRefreshData=t.onClickRefreshData.bind(j_(t)),t.refreshButton=t.refreshButton.bind(j_(t)),t}return t=i,(a=[{key:"componentDidMount",value:function(){var e=this.props.isVirtualCluster;this.processNagiosSettings(),e?this.setState({dataFetching:!1}):this.fetchData()}},{key:"componentWillUnmount",value:function(){this.source&&this.source.cancel("Component unmounted")}},{key:"fetchData",value:function(){var e=this;this.source=this.CancelToken.source();var t=this.props,a=t.dispatch,r=t.hosts,n=void 0===r?[]:r,o=t.cluster,i=void 0===o?"":o;a(Q(__(__({},oe.NAGIOS_DATA({host_type:"k8s_hosts",cluster:i?i.split("/").pop():"",filter:n,fresh:!0})),{},{cancelToken:this.source.token}))).then((function(){e.source=null,e.setState({dataFetching:!1},e.processNagiosSettings)}))}},{key:"processNagiosSettings",value:function(){var e={},t=[],a=[],r=this.props,n=r.isVirtualCluster,o=void 0!==n&&n,i=r.servicesData,s=void 0===i?[]:i,c=r.nagios_data,l=void 0===c?{}:c,u=r.hosts,p=void 0===u?[]:u;(o?s:l.k8s_hosts||[]).map((function(a){if(!f.a.isEmptyObject(a)&&(!p.length||p.includes(a.host_name))){t.push(a);var r=a.service_list;(void 0===r?[]:r).map((function(t){var a=t.servicegroup,r=void 0===a?"":a,n=t.service_description,o=void 0===n?"":n;Object.keys(e).includes(r)||(e[r]=[]),e[r].includes(o)||e[r].push(o)}))}})),Object.keys(e).map((function(t){a.push({group_name:t,members:e[t]})})),this.setState({service_groups:a,hosts_list:t})}},{key:"getNagiosTableSettings",value:function(){var e=this,t=this.state,a=t.service_groups,r=void 0===a?[]:a,o=t.hosts_list,i=void 0===o?[]:o,s=this.props.classes,c=r.reduce((function(e,t){var a=t.members;return(void 0===a?[]:a).map((function(t){e.push({name:t,options:{filter:!1,customBodyRender:function(e){var t=JSON.parse(e),a=t.current_state,r=void 0===a?"NA":a,o=t.last_check,i=void 0===o?"":o,c=t.next_check,l=void 0===c?"":c,u=t.service_description,p=void 0===u?"":u,d=t.servicegroup,f=void 0===d?"":d,m="",h="";switch(r){case"NA":m="N/A",h="disabled";break;case"0":m="OK",h="success";break;case"1":m="WARNING",h="warning";break;case"2":m="ERROR",h="error";break;default:m="UNKNOWN",h="disabled"}return n.a.createElement(xa,{title:n.a.createElement(Ni,{variant:h}),direction:"top"},n.a.createElement("div",{className:"header"},n.a.createElement(st.a,{variant:"caption"},n.a.createElement("span",{className:s.bold},"STATUS :")," ",m)),n.a.createElement("div",{className:"content"},r>-1?n.a.createElement(Ia,null,n.a.createElement(st.a,{variant:"caption"},n.a.createElement("span",{className:s.bold},"Group :")," ",f),n.a.createElement(st.a,{variant:"caption"},n.a.createElement("span",{className:s.bold},"Name :")," ",p),n.a.createElement(st.a,{variant:"caption"},n.a.createElement("span",{className:s.bold},"Last Checked Time :")," ",Fc.a.unix(i).format("HH:mm:SS")),n.a.createElement(st.a,{variant:"caption"},n.a.createElement("span",{className:s.bold},"Next Check Time :")," ",Fc.a.unix(l).format("HH:mm:SS"))):n.a.createElement(st.a,{variant:"caption"},"Service is not enabled on this host")))}}})})),e}),[]);return{columns:[{name:"Name",options:{filter:!1}}].concat(v_(c),[{name:"Actions",options:{filter:!1,customBodyRender:function(){return e.refreshButton()}}}]),data:i.reduce((function(e,t){var a=t.host_name,n=void 0===a?"":a,o=t.service_list,i=void 0===o?[]:o,s=r.reduce((function(e,t){var a=t.members;return(void 0===a?[]:a).map((function(t){var a=i.find((function(e){return e.service_description===t})),r=a||{};e.push(JSON.stringify(r))})),e}),[]);return e.push([n].concat(v_(s),[n])),e}),[]),options:{selectableRows:"none"}}}},{key:"onClickRefreshData",value:function(){this.setState({dataFetching:!0},this.fetchData)}},{key:"refreshButton",value:function(){var e=this.props.classes,t=this.state.dataFetching;return n.a.createElement("div",{className:e.refreshActionWrapper},t?n.a.createElement("span",{className:"icon icon-sync icon-spin"}):n.a.createElement("span",{className:"icon icon-sync",onClick:this.onClickRefreshData}))}},{key:"render",value:function(){var e=this.props,t=e.classes,a=e.nagios_data,r=void 0===a?{}:a,o=this.state.dataFetching,i=this.getNagiosTableSettings();return n.a.createElement(n.a.Fragment,null,o&&n.a.createElement(ls,{status:"".concat(f.a.isEmptyObject(r)?"Fetching":"Updating"," nagios data")}),n.a.createElement("div",{className:t.table},n.a.createElement(sa,i)))}}])&&S_(t.prototype,a),r&&S_(t,r),i}(r.Component);w_(C_,"propTypes",{classes:u.a.object.isRequired,dispatch:u.a.func,servicesData:u.a.array,nagios_data:u.a.object,isVirtualCluster:u.a.bool,hosts:u.a.array,cluster:u.a.string});var T_=he()((function(){return{table:{position:"relative"},bold:{fontWeight:400}}}))(C_);function P_(e){return(P_="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function A_(e,t){for(var a=0;a<t.length;a++){var r=t[a];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function R_(e,t){return(R_=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function N_(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=M_(e);if(t){var n=M_(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return F_(this,a)}}function F_(e,t){return!t||"object"!==P_(t)&&"function"!=typeof t?x_(e):t}function x_(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function M_(e){return(M_=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var I_=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&R_(e,t)}(i,e);var t,a,r,o=N_(i);function i(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),(t=o.call(this,e)).state={status:"",log:""},t.fetchNodeLog=t.fetchNodeLog.bind(x_(t)),t}return t=i,(a=[{key:"componentDidMount",value:function(){this.fetchNodeLog()}},{key:"fetchNodeLog",value:function(){var e=this,t=this.props,a=t.node,r=t.actionScriptID,n="".concat(r,"/node_status/").concat(a.name);R({apiurl:n}).then((function(t){var a=t.data,r=(a=void 0===a?{}:a).log,n=void 0===r?"":r,o=a.status,i=void 0===o?"":o;if(e.setState({log:n,status:i}),"running"===i){var s=setTimeout((function(){e.fetchNodeLog()}),5e3);e.setState({timerId:s})}})).catch((function(){_n({msg:"Failed to fetch log for node ".concat(a.fqdn),variant:"error"})}))}},{key:"componentWillUnmount",value:function(){var e=this.state.timerId;clearTimeout(e)}},{key:"render",value:function(){var e=this.state,t=e.status,a=void 0===t?"":t,r=e.log,o=void 0===r?"":r,i=this.props,s=i.node,c=(s=void 0===s?{}:s).fqdn,l=void 0===c?"":c,u=i.expanded,p=void 0!==u&&u,d=i.classes;return n.a.createElement(Yi,{header:n.a.createElement(Ia,null,n.a.createElement(St.Typography,{variant:"h6",className:"title"},l),n.a.createElement(Qa,{status:a,title:f.a.capitalize(a)})),icon:"icon-chevron-down",placement:"start",expanded:p},n.a.createElement(St.Typography,{variant:"caption",className:d.preserveWhitespace},o))}}])&&A_(t.prototype,a),r&&A_(t,r),i}(r.Component);!function(e,t,a){t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a}(I_,"propTypes",{classes:u.a.object,node:u.a.object,actionScriptID:u.a.string,expanded:u.a.bool});var U_=he()(qf)(I_);function L_(e){return(L_="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function B_(){return(B_=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var r in a)Object.prototype.hasOwnProperty.call(a,r)&&(e[r]=a[r])}return e}).apply(this,arguments)}function H_(e,t){for(var a=0;a<t.length;a++){var r=t[a];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function K_(e,t){return(K_=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function q_(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=z_(e);if(t){var n=z_(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return V_(this,a)}}function V_(e,t){return!t||"object"!==L_(t)&&"function"!=typeof t?G_(e):t}function G_(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function z_(e){return(z_=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var W_={info:{Title:function(e){return"Action script source: ".concat(e)},name:"ActionScript details",description:"Modal showing details about ActionScript command and files"},log:{Title:"Per-Node ActionScript results",name:"ActionScript logs",description:"Modal showing ActionScript logs"}},J_=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&K_(e,t)}(i,e);var t,a,r,o=q_(i);function i(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),function(e,t,a){t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a}(G_(t=o.call(this,e)),"handleOpen",(function(e){var a=e.modalType,r=e.data,n=void 0===r?{}:r;t.setState({modalType:a,data:n},(function(){t.bdModalChildRef.current.handleOpen()}))})),t.state={modalType:"info",data:{}},t.handleOpen=t.handleOpen.bind(G_(t)),t.handleClose=t.handleClose.bind(G_(t)),t.bdModalChildRef=n.a.createRef(),t}return t=i,(a=[{key:"handleClose",value:function(){}},{key:"render",value:function(){var e=this.state,t=e.modalType,a=void 0===t?"":t,r=e.data,o=(r=void 0===r?{}:r).source,i=void 0===o?"":o,s=r.cmd,c=void 0===s?"":s,l=r.args,u=void 0===l?"":l,p=r.files,d=void 0===p?[]:p,f=r.nodes,m=void 0===f?[]:f,h=r.actionScriptID,b=void 0===h?"":h,v="log"===a,y=v?W_[a].Title:W_[a].Title(i),g=he()(qf)((function(e){var t=e.classes;return c?n.a.createElement(Ia,null,n.a.createElement(St.Typography,{variant:"h3"},"Scripts"),n.a.createElement(St.Typography,{variant:"caption",className:t.preserveWhitespace},c)):""}));return n.a.createElement(In,{ref:this.bdModalChildRef,onModalClose:this.handleClose,name:W_[a].name,description:W_[a].description,Title:n.a.createElement(St.Typography,{variant:"h3",color:"primary"},y),footerCloseBtn:!0},v?n.a.createElement(Ia,null,m.map((function(e,t){return n.a.createElement(U_,B_({key:t},{node:e,actionScriptID:b,expanded:0===t}))}))):n.a.createElement(Ia,null,n.a.createElement(g,null),u?n.a.createElement(Ia,null,n.a.createElement(St.Typography,{variant:"h3"},"Arguments"),n.a.createElement(St.Typography,{variant:"caption"},u)):"",d.length?n.a.createElement(Ia,null,n.a.createElement(St.Typography,{variant:"h3"},"Files"),d.map((function(e){return n.a.createElement(St.Typography,{variant:"caption",key:e.name},e.name)}))):""))}}])&&H_(t.prototype,a),r&&H_(t,r),i}(r.Component);function Y_(e){return(Y_="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function $_(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function Q_(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?$_(Object(a),!0).forEach((function(t){nS(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):$_(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function Z_(e,t){for(var a=0;a<t.length;a++){var r=t[a];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function X_(e,t){return(X_=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function eS(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=rS(e);if(t){var n=rS(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return tS(this,a)}}function tS(e,t){return!t||"object"!==Y_(t)&&"function"!=typeof t?aS(e):t}function aS(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function rS(e){return(rS=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function nS(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}var oS=er({path:["actionScript"]}),iS=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&X_(e,t)}(i,e);var t,a,r,o=eS(i);function i(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),(t=o.call(this,e)).state={actionScriptFormSchema:{},actionScriptUISchema:{"ui:order":["label","source","dependent_scripts","nodegroup_id","roles","as_root"]}},t.getActionScriptsTableSettings=t.getActionScriptsTableSettings.bind(aS(t)),t.deleteActionScript=t.deleteActionScript.bind(aS(t)),t.deleteActionScriptList=t.deleteActionScriptList.bind(aS(t)),t.onFormChange=t.onFormChange.bind(aS(t)),t.onChangeBootstrapActionNodegroupID=t.onChangeBootstrapActionNodegroupID.bind(aS(t)),t.onChangeScriptSource=t.onChangeScriptSource.bind(aS(t)),t.onChangeRunAsRoot=t.onChangeRunAsRoot.bind(aS(t)),t.modalFormSubmitter=t.modalFormSubmitter.bind(aS(t)),t.ActionScriptsModalChildRef=n.a.createRef(),t.bdDeleteDialogRef=n.a.createRef(),t.CreateActionScripFormRef=n.a.createRef(),t}return t=i,(a=[{key:"componentDidMount",value:function(){var e=this,t=this.props,a=t.cluster_data,r=t.session_data.is_cluster_superuser,n=nh(a),o=oh(a),i=eh({},n,o,r),s=th(i);this.CreateActionScripFormRef.current.updateStateFormData({formData:s}),this.setState({actionScriptFormSchema:i},(function(){e.onChangeScriptSource()}))}},{key:"componentWillUnmount",value:function(){localStorage.removeItem("actionScriptList")}},{key:"getActionScriptsTableSettings",value:function(){var e=this,t=this.props.action_scripts,a=void 0===t?{}:t,r=f.a.fetchSafeFromObject({path:["_embedded","action_histories"],obj:a,default_value:[]});return{columns:[{name:"ActionScript Name",options:{filter:!0,customBodyRender:function(t){var a=JSON.parse(t),r=a.name,o=a.source,i=a.cmd,s=a.args,c=a.files,l=a.classes;return n.a.createElement(st.a,{className:l.link,onClick:function(){e.ActionScriptsModalChildRef.current.handleOpen({data:{source:o,cmd:i,args:s,files:c},modalType:"info"})}},r)}}},{name:"User",options:{filter:!0}},{name:"Start Time",options:{filter:!0}},{name:"End Time",options:{filter:!0}},{name:"Run Time",options:{filter:!0}},{name:"Action Status",options:{filter:!0,customBodyRender:function(e){return n.a.createElement(Qa,{status:e,title:f.a.capitalize(e)})}}},{name:"Actions",options:{filter:!0,customBodyRender:function(t){var a=JSON.parse(t),r=a._links,o=(r=void 0===r?{}:r).self,i=(o=void 0===o?{}:o).href,s=void 0===i?"":i,c=a.nodes,l=void 0===c?[]:c,u=a.status,p=void 0===u?"":u,d=a.end_time,f=void 0===d?"":d;return n.a.createElement("div",{className:"row-action-btns"},"running"===p?n.a.createElement(ka,{title:"Kill Action",variant:"error"},n.a.createElement("span",{className:"icon icon-rect-link icon-cross2",onClick:function(){e.deleteActionScript(a,!0)}})):"",n.a.createElement(ka,{title:"Logs",variant:"info"},n.a.createElement("span",{className:"icon icon-rect-link icon-cli",onClick:function(){e.ActionScriptsModalChildRef.current.handleOpen({data:{nodes:l,actionScriptID:s},modalType:"log"})}})),"running"!==p&&f?n.a.createElement(ka,{title:"Delete Action",variant:"error"},n.a.createElement("span",{className:"icon icon-rect-link icon-trash2",onClick:function(){e.deleteActionScript(a)}})):"")}}}],data:this.getData(),options:{customToolbar:function(){return n.a.createElement("div",{className:"tableActionButtons"},n.a.createElement(Ue.a,{variant:"contained",color:"primary",onClick:function(){e.CreateActionScripFormRef.current.openModal()}},n.a.createElement("span",{className:"icon icon-run"})," Run New ActionScript"))},customToolbarSelect:function(t){return n.a.createElement("div",{className:"tableActionButtonsSelected"},n.a.createElement(Ue.a,{variant:"contained",color:"secondary",onClick:function(){var a={callback:e.deleteActionScriptList,context:{selected_rows:t,action_histories:r},title:"Delete selected ActionScript(s)",description:"Confirm deletion. This action cannot be undone."};e.bdDeleteDialogRef.current.handleOpen(a)}},n.a.createElement("span",{className:"icon icon-trash2"})," Delete ActionScripts"))},isRowSelectable:function(e,t){if(t){var a=t[5],r=t[4];return!("running"===a||!r)}return!1}}}}},{key:"getData",value:function(){var e=[],t=this.props,a=t.action_scripts,r=void 0===a?{}:a,n=t.classes;return f.a.fetchSafeFromObject({path:["_embedded","action_histories"],obj:r,default_value:[]}).map((function(t){var a=t.label,r=(a=void 0===a?{}:a).name,o=void 0===r?"":r,i=a.description,s=void 0===i?"":i,c=t.cmd,l=void 0===c?"":c,u=t.args,p=void 0===u?"":u,d=t.files,m=void 0===d?[]:d,h=t.user_name,b=void 0===h?"":h,v=t.as_root,y=void 0!==v&&v,g=t.start_time,_=void 0===g?"":g,S=t.end_time,k=void 0===S?"":S,O=t.run_time,E=void 0===O?"":O,j=t.status,D=void 0===j?"":j;e.push([JSON.stringify({name:o,source:s,cmd:l,args:p,files:m,classes:n}),"".concat(b).concat(y?" (As Root)":""),_?Fc.a.unix(_).format("ddd MMM DD YYYY HH:mm:ss"):"",k?Fc.a.unix(k).format("ddd MMM DD YYYY HH:mm:ss"):"",E?f.a.convertToHHMMSS(E):"",D,JSON.stringify(t)])})),e}},{key:"deleteActionScriptList",value:function(e){var t=this,a=e.selected_rows,r=e.action_histories;a.data.map((function(e){var a=e.dataIndex;t.deleteActionScript(r[a])}))}},{key:"deleteActionScript",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],a=this.props,r=a.classes,o=a.fetchActionScripts,i=e._links,s=i.self,c=(s=void 0===s?{}:s).href,l=void 0===c?"":c,u=i.action_task,p=(u=void 0===u?{}:u).href,d=void 0===p?"":p,m=e.label.name,h=void 0===m?"":m;R({apiurl:t?d:l,method:w.method.DELETE}).then((function(){o(),_n({msg:"ActionScript '".concat(h,"' successfully ").concat(t?"killed":"deleted"),variant:"success"})})).catch((function(e){var a=f.a.parseAxiosError({error:e}),o=n.a.createElement(Ia,null,n.a.createElement(st.a,null,"Failed to ",t?"kill":"delete",' the ActionScript "',h,'"'),n.a.createElement(st.a,{className:r.preserveWhitespace},a));_n({msg:o,variant:"error"})}))}},{key:"onFormChange",value:function(e){var t=e.formData,a=document.activeElement,r=xl(a);r&&(r.includes("_nodegroup_id")?(this.CreateActionScripFormRef.current.updateStateFormData({formData:t}),this.onChangeBootstrapActionNodegroupID()):r.includes("_source")?(this.CreateActionScripFormRef.current.updateStateFormData({formData:t}),this.onChangeScriptSource()):r.includes("_as_root")&&(this.CreateActionScripFormRef.current.updateStateFormData({formData:t}),this.onChangeRunAsRoot()))}},{key:"onChangeBootstrapActionNodegroupID",value:function(){var e=this.state.actionScriptFormSchema,t=this.props.cluster_data,a=f.a.fetchSafeFromObject({path:["state","formData"],obj:this.CreateActionScripFormRef.current,default_value:{}}),r=f.a.fetchSafeFromObject({path:["properties","roles"],obj:e,default_value:{}}),n=a.nodegroup_id,o=oh(t,void 0===n?1:n);r.items={type:"string",enum:o},r.default=[],a.roles=[],this.setState({actionScriptFormSchema:e}),this.CreateActionScripFormRef.current.updateStateFormData({formData:a})}},{key:"onChangeScriptSource",value:function(){var e=this.state,t=e.actionScriptFormSchema,a=e.actionScriptUISchema,r=f.a.fetchSafeFromObject({path:["state","formData"],obj:this.CreateActionScripFormRef.current,default_value:{}}),n=ah({formSchema:t.properties,bootstrap_action:r,uiSchema:a}),o=n.formSchema,i=void 0===o?{}:o,s=n.uiSchema,c=void 0===s?{}:s;t.properties=i,this.setState({actionScriptFormSchema:t,actionScriptUISchema:c})}},{key:"onChangeRunAsRoot",value:function(){var e=this.state.actionScriptFormSchema,t=f.a.fetchSafeFromObject({path:["state","formData"],obj:this.CreateActionScripFormRef.current,default_value:{}}),a=sh({formSchema:e.properties,bootstrap_action:t}).formSchema,r=void 0===a?{}:a;e.properties=r,this.setState({actionScriptFormSchema:e})}},{key:"modalFormSubmitter",value:function(e){var t=e.method_actions,a=e.data,r=e.modalSubmitCallback,n=this.props.cluster_data,o=document.querySelectorAll("input[type=file]"),i=f.a.fetchSafeFromObject({path:["label","name"],obj:n,default_value:""}),s=f.a.fetchSafeFromObject({path:["label","name"],obj:a,default_value:""});ih(o,s,i).then((function(e){R({method:t[0].method,apiurl:t[0].action,data:Q_(Q_({},a),e)}).then((function(e){r("success",e)})).catch((function(e){r("error",e)}))})).catch((function(e){r("error",e)}))}},{key:"render",value:function(){var e=this.props,t=e.fetchActionScripts,a=e.cluster_data,r=this.state,o=r.actionScriptFormSchema,i=r.actionScriptUISchema,s=this.getActionScriptsTableSettings(),c=f.a.fetchSafeFromObject({path:["_links","self","href"],obj:a,default_value:""});return n.a.createElement(Ia,null,n.a.createElement(sa,s),n.a.createElement(J_,{ref:this.ActionScriptsModalChildRef}),n.a.createElement(no,{ref:this.bdDeleteDialogRef}),n.a.createElement(Jn,{form_id:"CreateActionScripForm",Title:n.a.createElement("div",null,n.a.createElement(st.a,{variant:"h3"},oS.title),n.a.createElement(st.a,{variant:"caption"},oS.subTitle)),name:oS.ariaName,description:oS.ariaDescription,form_schema:o,ui_schema:i,method_actions:[{method:w.method.POST,action:w.apiurl.CREATE_ACTION_SCRIPT(c),data:"FORM_DATA"}],success_msg:oS.successMessage,failure_msg:oS.failureMessage,callBack:t,validate:function(e,t){return rh(e,t)},modalFormSubmitter:this.modalFormSubmitter,onChange:this.onFormChange,ref:this.CreateActionScripFormRef}))}}])&&Z_(t.prototype,a),r&&Z_(t,r),i}(r.Component);nS(iS,"propTypes",{classes:u.a.object.isRequired,action_scripts:u.a.object,fetchActionScripts:u.a.func.isRequired,cluster_data:u.a.object.isRequired,session_data:u.a.object.isRequired});var sS=he()(qf)(iS);function cS(e){return(cS="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function lS(e){return function(e){if(Array.isArray(e))return uS(e)}(e)||function(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||function(e,t){if(!e)return;if("string"==typeof e)return uS(e,t);var a=Object.prototype.toString.call(e).slice(8,-1);"Object"===a&&e.constructor&&(a=e.constructor.name);if("Map"===a||"Set"===a)return Array.from(e);if("Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a))return uS(e,t)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function uS(e,t){(null==t||t>e.length)&&(t=e.length);for(var a=0,r=new Array(t);a<t;a++)r[a]=e[a];return r}function pS(e,t){for(var a=0;a<t.length;a++){var r=t[a];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function dS(e,t){return(dS=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function fS(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=hS(e);if(t){var n=hS(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return mS(this,a)}}function mS(e,t){return!t||"object"!==cS(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function hS(e){return(hS=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var bS=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&dS(e,t)}(i,e);var t,a,r,o=fS(i);function i(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),(t=o.call(this,e)).state={},t}return t=i,(a=[{key:"componentDidMount",value:function(){}},{key:"getClusterHistoryTableSettings",value:function(){var e=this.props,t=e.cluster_histories,a=(t=void 0===t?{}:t)._embedded,r=(a=void 0===a?{}:a).change_histories,o=void 0===r?[]:r,i=e.cluster_data,s=void 0===i?{}:i,c=e.flavor_list,l=void 0===c?{}:c,u=e.cluster_nodes,p=void 0===u?{}:u,d=f.a.fetchSafeFromObject({path:["_embedded","flavor"],obj:l,default_value:[]}),m=f.a.fetchSafeFromObject({path:["_embedded","nodes"],obj:p,default_value:[]}),h=s.created_by_user_name,b=void 0===h?"":h,v=s.created_time,y=void 0===v?"":v,g=[{name:"Operation",options:{filter:!0}},{name:"User",options:{filter:!0}},{name:"Details",options:{filter:!0,customBodyRender:function(e){if(e){var t=JSON.parse(e),a=t.reason,r=void 0===a?"":a,o=t.operation,i=void 0===o?"":o,s=t.change_spec,c=void 0===s?{}:s,l=t.flavors,u=void 0===l?[]:l,p=t.nodes,d=yS({operation:i,change_spec:c,flavors:u,nodes:void 0===p?[]:p});return n.a.createElement(Ia,null,r?n.a.createElement(st.a,{variant:"body1"},"Reason : ",r):"",i?n.a.createElement(st.a,{variant:"body1"},"Operation : ",i):"",d.map((function(e,t){var a=e.label,r=void 0===a?"":a,o=e.value,i=void 0===o?"":o;return n.a.createElement(st.a,{variant:"body1",key:t},r," : ",i)})))}return""}}},{name:"Started At",options:{filter:!0}},{name:"Completed At",options:{filter:!0}}],_=[];return o.sort((function(e,t){return e.end_time>t.end_time})),o.map((function(e){var t=e.reason,a=void 0===t?"":t,r=e.operation,n=void 0===r?"":r,o=e.user_name,i=void 0===o?"":o,s=e.change_spec,c=void 0===s?{}:s,l=e.start_time,u=void 0===l?"":l,p=e.end_time,h=void 0===p?"":p;_.push([f.a.capitalize(n.replace(/_/g," ")),i,JSON.stringify({reason:a,operation:n,change_spec:c,flavors:d,nodes:m}),u?Fc.a.unix(u).format("ddd MMM DD YYYY HH:mm:ss"):"Unknown (Pre EPIC 3.0)",h?Fc.a.unix(h).format("ddd MMM DD YYYY HH:mm:ss"):""])})),_.push(["Cluster Created",b||"Unknown (Pre EPIC 3.0)","","",y?Fc.a.unix(y).format("ddd MMM DD YYYY HH:mm:ss"):"Unknown (Pre EPIC 3.0)"]),{columns:g,data:_,options:{selectableRows:"none"}}}},{key:"render",value:function(){var e=this.getClusterHistoryTableSettings();return n.a.createElement(sa,e)}}])&&pS(t.prototype,a),r&&pS(t,r),i}(r.Component);!function(e,t,a){t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a}(bS,"propTypes",{classes:u.a.object.isRequired,cluster_histories:u.a.object,flavor_list:u.a.object,cluster_nodes:u.a.object,cluster_data:u.a.object});var vS=he()((function(){return{bold:{fontWeight:400}}}))(bS),yS=function(e){var t=e.operation,a=e.change_spec,r=e.flavors,n=e.nodes,o=[];switch(t){case"reconfigure":var i=a.label,s=(i=void 0===i?{}:i).name,c=void 0===s?"":s,l=i.description,u=void 0===l?"":l,p=a.nodegroup,d=(p=void 0===p?{}:p).role_configs,m=void 0===d?[]:d,h=a.dependent_nodegroups,b=void 0===h?[]:h,v=a.add_dependent_nodegroups,y=void 0===v?[]:v,g=a.remove_dependent_nodegroups,_=void 0===g?[]:g,S=a.debug,k=void 0!==S&&S,O=a.isolated,E=void 0!==O&&O,j=a.two_phase_delete,D=void 0!==j&&j;c&&o.push({label:"Name",value:c}),u&&o.push({label:"Description",value:u}),m.map((function(e){var t=gS({role:e,flavors:r});o.push.apply(o,lS(t))})),b.length&&(o.push({label:"Dependent Node Role(s) Updated"}),b.map((function(e){var t=e.id,a=void 0===t?"":t,n=e.role_configs,i=void 0===n?[]:n;o.push({label:"Nodegroup ID",value:a}),i.map((function(e){var t=gS({role:e,flavors:r});o.push.apply(o,lS(t))}))}))),y.length&&(o.push({label:"Dependent Node(s) Added"}),y.map((function(e){var t=e.id,a=void 0===t?"":t,n=e.role_configs,i=void 0===n?[]:n;o.push({label:"Nodegroup ID",value:a}),i.map((function(e){var t=gS({role:e,flavors:r});o.push.apply(o,lS(t))}))}))),_.length&&(o.push({label:"Dependent Node(s) Removed"}),o.push({label:"Nodegroup ID(s)",value:_.join(", ")})),Object.keys(a).indexOf("debug")>-1&&o.push({label:"Debug",value:k?"True":"False"}),Object.keys(a).indexOf("isolated")>-1&&o.push({label:"Isolated",value:E?"True":"False"}),Object.keys(a).indexOf("two_phase_delete")>-1&&o.push({label:"Two Phase Delete",value:D?"True":"False"});break;case"service_state_change":var w=a.service_name,C=void 0===w?"":w,T=a.service_state,P=void 0===T?"":T,A=a.fqdn,R=void 0===A?"":A;o.push({label:"Service name",value:C}),o.push({label:"Service state",value:P}),o.push({label:"Node FQDN",value:R});break;case"power_op":var N=a.action,F=void 0===N?"":N,x=a.nodes,M=void 0===x?[]:x;if(F&&o.push({label:"Action",value:F}),"reboot"===F&&M.length){var I=_S({nodeIds:M,nodes:n});o.push({label:"Node(s)",value:I.join(", ")})}break;case"services_update":var U=a.action,L=void 0===U?"":U,B=a.nodegroup_id,H=void 0===B?"":B,K=a.update_spec,q=(K=void 0===K?{}:K).id,V=void 0===q?"":q,G=K.label,z=(G=void 0===G?{}:G).name,W=void 0===z?"":z,J=G.description,Y=void 0===J?"":J,$=K.endpoint,Q=($=void 0===$?{}:$).port,Z=void 0===Q?"":Q,X=$.loadbalanced,ee=void 0!==X&&X,te=$.auth_token,ae=void 0!==te&&te,re=$.is_dashboard,ne=void 0!==re&&re,oe=$.path,ie=void 0===oe?"":oe,se=$.url_scheme,ce=void 0===se?"":se,le=K.nodes,ue=void 0===le?[]:le;if(L&&o.push({label:"Action",value:f.a.capitalize(L.replace(/_/g," "))}),H&&o.push({label:"Nodegroup ID",value:H}),V&&o.push({label:"Service ID",value:H}),W&&o.push({label:"Service Name",value:W}),Y&&o.push({label:"Service Description",value:Y}),Z&&o.push({label:"Port",value:Z}),ee&&o.push({label:"LoadBalanced",value:ee?"True":"False"}),ae&&o.push({label:"Auth Token",value:ae?"True":"False"}),ne&&o.push({label:"Dashboard",value:ne?"True":"False"}),ne&&(ie&&o.push({label:"Path",value:ie}),ce&&o.push({label:"Protocol",value:ce})),ue.length){var pe=_S({nodeIds:ue,nodes:n});o.push({label:"Node(s)",value:pe.join(", ")})}break;case"services_migrate":var de=a.action,fe=void 0===de?"":de,me=a.nodegroup_id,he=void 0===me?"":me,be=a.update_spec,ve=(be=void 0===be?{}:be).id,ye=void 0===ve?"":ve,ge=be.src_node,_e=void 0===ge?"":ge,Se=be.dst_cluster,ke=void 0===Se?"":Se,Oe=be.dst_service_id,Ee=void 0===Oe?"":Oe,je=be.dst_node,De=void 0===je?"":je;if(fe&&o.push({label:"Action",value:f.a.capitalize(fe.replace(/_/g," "))}),he&&o.push({label:"Nodegroup ID",value:he}),ye&&o.push({label:"Source Service ID",value:ye}),_e){var we=[];we.length||we.push(_e);var Ce=_S({nodeIds:we,nodes:n});o.push({label:"Source Node",value:Ce.join(", ")})}ke&&o.push({label:"Destination Cluster",value:ke}),Ee&&o.push({label:"Destination Service ID",value:Ee}),De&&o.push({label:"Destination Node",value:De});break;case"migrate_op":var Te=a.action,Pe=void 0===Te?"":Te,Ae=a.nodes,Re=void 0===Ae?[]:Ae;if(Pe&&o.push({label:"Action",value:Pe}),Re.length){var Ne=_S({nodeIds:Re,nodes:n});o.push({label:"Node(s)",value:Ne.join(", ")})}break;default:Object.keys(a).map((function(e){var t="object"===cS(a[e])?JSON.stringify(a[e],null,2):a[e];"object"===cS(t)&&o.push({label:f.a.capitalize(e),value:t})}))}return o},gS=function(e){var t=e.role,a=e.flavors,r=[],n=t.role_id,o=void 0===n?"":n,i=t.node_count,s=void 0===i?"":i,c=t.flavor_name,l=void 0===c?"":c,u=t.flavor,p=void 0===u?{}:u,d=t.node_fqdns_to_remove,m=void 0===d?[]:d,h=l||f.a.fetchSafeFromObjectArray({arr:a,path:["_links","self","href"],match:f.a.fetchSafeFromObject({path:["_links","self","href"],obj:p,default_value:""}),get:["label","name"],default_value:""});return r.push({label:"".concat(f.a.capitalize(o)," Nodes"),value:"".concat(s).concat(h?"/".concat(h):"")}),m.length&&r.push({label:"FQDNs Removed",value:m.join(", ")}),r},_S=function(e){var t=e.nodeIds,a=e.nodes,r=[];return t.map((function(e){a.some((function(t){if(f.a.fetchSafeFromObject({path:["_links","self","href"],obj:t,default_value:""}).split("?")[0]===e)return r.push(t.fqdn),!0}))})),r};function SS(e){return(SS="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function kS(){return(kS=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var r in a)Object.prototype.hasOwnProperty.call(a,r)&&(e[r]=a[r])}return e}).apply(this,arguments)}function OS(e,t){for(var a=0;a<t.length;a++){var r=t[a];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function ES(e,t){return(ES=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function jS(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=CS(e);if(t){var n=CS(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return DS(this,a)}}function DS(e,t){return!t||"object"!==SS(t)&&"function"!=typeof t?wS(e):t}function wS(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function CS(e){return(CS=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var TS=er({path:["updateAttachments"]}),PS=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&ES(e,t)}(i,e);var t,a,r,o=jS(i);function i(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),(t=o.call(this,e)).invokeClusterOp=t.invokeClusterOp.bind(wS(t)),t.getMenuList=t.getMenuList.bind(wS(t)),t.clusterOperationModalRef=n.a.createRef(),t.bdModalFormChildRef=n.a.createRef(),t}return t=i,(a=[{key:"shouldComponentUpdate",value:function(e){return f.a.fetchSafeFromObject({path:["cluster_data","status"],obj:this.props})!==f.a.fetchSafeFromObject({path:["cluster_data","status"],obj:e})||!f.a.isEqual(e.attachmentNames,this.props.attachmentNames)}},{key:"invokeClusterOp",value:function(e){var t=this.props,a=t.cluster_data,r=void 0===a?{}:a,n=t.fetchCurrentClusterData,o=r.nodegroup,i=(o=void 0===o?{}:o).intended_categories,s=void 0===i?[]:i,c=r._links,l=(c=void 0===c?{}:c).self,u=(l=void 0===l?{}:l).href,p=void 0===u?"":u,d=r.label,f=void 0===d?{}:d,m=s[0],h=m.split("/")[1],b=Kf.getViewKey({CLUSTER_TYPE:m});if("edit"===e)window.location.href=Kf.getClusterActionUrl({cluster_id:p,cluster_type:h,action:"edit"});else{var v={};"start"!==e&&"stop"!==e&&"reboot"!==e||(v={callback:Kf.clusterPowerOps,context:{cluster_info:{cluster_id:p,label:f},action:e,callback:n},title:"",description:"Confirm '".concat(e,"' action  for ").concat(b," '").concat(f.name||"","'")}),"delete"===e&&(v={callback:Kf.deleteSelectedCluster,context:{cluster:r,callback:n,category:m},title:"Delete selected ".concat(b),description:"Confirm deletion. This action cannot be undone."}),this.clusterOperationModalRef.current.handleOpen(v)}}},{key:"getMenuList",value:function(){var e=this,t=this.props.cluster_data,a=void 0===t?{}:t,r=a.status,n=a.nodegroup,o=(n=void 0===n?{}:n).intended_categories,i=void 0===o?[]:o,s=a._links,c=(s=void 0===s?{}:s).self,l=(c=void 0===c?{}:c).href,u=void 0===l?"":l,p=i[0].split("/")[1],d=Kf.clusterHasNodes(a);return Kf.getClusterActionButtons({status:r,hasNodes:d,cluster_id:u,cluster_type:p}).filter((function(e){return["start","stop","edit","reboot","delete","attach"].includes(e.action)})).map((function(t){var a=t.action;return{icon:t.icon,label:t.title,onClick:function(){"attach"===a?e.bdModalFormChildRef.current.openModal():e.invokeClusterOp(a)}}}))}},{key:"render",value:function(){var e=this.props,t=e.cluster_data,a=void 0===t?{}:t,r=e.attachmentNames,o=void 0===r?{}:r,i=a.status,s=a.nodegroup,c=(s=void 0===s?{}:s).intended_categories,l=void 0===c?[]:c,u=a._links,p=(u=void 0===u?{}:u).self,d=(p=void 0===p?{}:p).href,m=void 0===d?"":d,h=TS.title,b=TS.name,v=TS.description,y=TS.success_msg,g=void 0===y?"":y,_=TS.failure_msg,S=void 0===_?"":_,k=!["ready","stopped","error"].includes(i),O=this.getMenuList(),E=l[0],j=f.a.fetchSafeFromObject({path:[E,"id"],obj:Kf.attachSupportList,default_value:""}),D=Kf.getUpdateAttachmentFormData({cluster:a,attachmentNames:o,CLUSTER_TYPE:E});return n.a.createElement(Ia,null,n.a.createElement(_t,{variant:"contained",color:"primary",title:"Cluster Operations",operation:"clusterOp",disabled:k,menuList:O}),n.a.createElement(no,{ref:this.clusterOperationModalRef}),Object.keys(Kf.attachSupportList).includes(E)?n.a.createElement(Jn,kS({form_id:"updateAttachments",Title:n.a.createElement(st.a,{variant:"h2"},h(j)),name:b(j),description:v(j),method_actions:[{method:w.method.POST,action:w.apiurl.CLUSTER_CHANGE_TASK(m),data:"FORM_DATA"}]},D,{success_msg:g,failure_msg:S,callBack:this.updateClusterData,ref:this.bdModalFormChildRef})):"")}}])&&OS(t.prototype,a),r&&OS(t,r),i}(r.Component);!function(e,t,a){t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a}(PS,"propTypes",{classes:u.a.object.isRequired,cluster_data:u.a.object,operation:u.a.string,fetchCurrentClusterData:u.a.func,attachmentNames:u.a.object});var AS=he()(qf)(PS);function RS(e){return(RS="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function NS(e,t){for(var a=0;a<t.length;a++){var r=t[a];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function FS(e,t,a){return t&&NS(e.prototype,t),a&&NS(e,a),e}function xS(e,t){return(xS=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function MS(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=LS(e);if(t){var n=LS(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return IS(this,a)}}function IS(e,t){return!t||"object"!==RS(t)&&"function"!=typeof t?US(e):t}function US(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function LS(e){return(LS=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function BS(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}var HS=[{label:"Node(s) Info",key:"nodesInfo"},{label:"ActionScript(s)",key:"actionScripts"},{label:"ServiceStatus",key:"serviceStatus"},{label:"Cluster Histories",key:"clusterHistories"}],KS=["services","catalog_entry"],qS=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&xS(e,t)}(a,e);var t=MS(a);function a(e){var r;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,a),BS(US(r=t.call(this,e)),"timeout",null),BS(US(r),"actionScriptTimeout",null);var n=r.props.location,o=lf.a.parse(n.search).id,i=void 0===o?"":o;return r.state={cluster_id:i,CLUSTER_TYPE:"",attachmentNames:{},nodesDataFetched:!1,nagiosFetched:!1,nodeServices:{}},r.fetchCurrentClusterData=r.fetchCurrentClusterData.bind(US(r)),r.fetchClusterNodes=r.fetchClusterNodes.bind(US(r)),r.fetchActionScripts=r.fetchActionScripts.bind(US(r)),r.cleanupPageData=r.cleanupPageData.bind(US(r)),r.fetchAttachmentNames=r.fetchAttachmentNames.bind(US(r)),r.fetchClusterHistories=r.fetchClusterHistories.bind(US(r)),r.updateNodeServices=r.updateNodeServices.bind(US(r)),r}return FS(a,null,[{key:"getMeta",value:function(){return{title:"".concat(w.APP_TITLE.ML_OPS," | Cluster Dashboard"),link:[{rel:"canonical",href:"".concat(w.serverUrl).concat(w.views.aimlClusterDashboard.url)}],meta:[{charset:"utf-8"},{name:"description",content:"Cluster dashboard"}]}}}]),FS(a,[{key:"componentDidMount",value:function(){var e=this,t=this.props.dispatch,a=this.state.cluster_id;this.fetchCurrentClusterData(),this.fetchActionScripts(),t(Q(oe.FLAVOR_DATA)),t(Q(oe.CLUSTER_NAGIOS_DATA(a))).then((function(){e.setState({nagiosFetched:!0})}))}},{key:"componentWillUnmount",value:function(){clearTimeout(this.timeout),clearTimeout(this.actionScriptTimeout),this.cleanupPageData()}},{key:"cleanupPageData",value:function(){var e=this.props.dispatch;["current_cluster","cluster_nodes","cluster_nagios","action_scripts","cluster_histories"].map((function(t){return e($(t))}))}},{key:"fetchCurrentClusterData",value:function(e){var t=this,a=this.props.dispatch,r=this.state,n=r.cluster_id,o=r.CLUSTER_TYPE;a(Q(oe.CURRENT_CLUSTER_DATA(n))).then((function(){var a=t.props.page_data,r=(a=void 0===a?{}:a).current_cluster,n=void 0===r?{}:r;if(f.a.isEmptyObject(n)){clearTimeout(t.timeout),t.cleanupPageData();var i=Kf.getViewKey({CLUSTER_TYPE:o});window.location.href=w.views[i].url}else{var s=f.a.fetchSafeFromObject({path:["nodegroup","intended_categories",0],obj:n,default_value:""});t.setState({CLUSTER_TYPE:s},(function(){Object.keys(Kf.attachSupportList).includes(s)&&t.fetchAttachmentNames()})),t.fetchClusterHistories(),t.fetchClusterNodes(e),Kf.liveUpdateClusters([n])&&(t.timeout=setTimeout((function(){t.fetchCurrentClusterData(e)}),3e4))}}))}},{key:"fetchClusterNodes",value:function(e){var t=this;this.setState({nodesDataFetched:!1},(function(){var a=t.props.dispatch,r=t.state.cluster_id;t.fetchClusterHistories(),a(Q(oe.CLUSTER_NODE_DATA(r,KS))).then((function(){t.setState({nodesDataFetched:!0},(function(){t.updateNodeServices(e)}))}))}))}},{key:"fetchClusterHistories",value:function(){var e=this.props.dispatch,t=this.state.cluster_id;e(Q(oe.CLUSTER_HISTORY_DATA(t)))}},{key:"fetchActionScripts",value:function(){var e=this;clearTimeout(this.actionScriptTimeout);var t=this,a=this.props.dispatch,r=this.state.cluster_id;a(Q(oe.ACTION_SCRIPT_DATA(r))).then((function(){f.a.fetchSafeFromObject({path:["page_data","action_scripts","_embedded","action_histories"],obj:t.props,default_value:[]}).find((function(e){return["starting","running","killing"].includes(e.status)}))&&(e.actionScriptTimeout=setTimeout((function(){t.fetchActionScripts()}),15e3))}))}},{key:"fetchAttachmentNames",value:function(){var e=this,t="AIML/Deployment"===this.state.CLUSTER_TYPE,a=t?w.apiurl.MODEL:w.apiurl.CLUSTER;R({apiurl:a}).then((function(a){var r={};t?r=f.a.fetchSafeFromObject({path:["data","_embedded","models"],obj:a,default_value:[]}).reduce((function(e,t){var a=f.a.fetchSafeFromObject({path:["_links","self","href"],obj:t,default_value:""}),r=f.a.fetchSafeFromObject({path:["label","name"],obj:t,default_value:""});return a&&r&&(e[a]="".concat(r,", ").concat(t.version)),e}),{}):r=f.a.fetchSafeFromObject({path:["data","_embedded","clusters"],obj:a,default_value:[]}).reduce((function(e,t){if(f.a.fetchSafeFromObject({path:["nodegroup","intended_categories"],obj:t,default_value:[]}).includes("AIML/Training")){var a=f.a.fetchSafeFromObject({path:["_links","self","href"],obj:t,default_value:""}),r=f.a.fetchSafeFromObject({path:["label","name"],obj:t,default_value:""});a&&r&&(e[a]=r)}return e}),{});e.setState({attachmentNames:r})})).catch((function(){setTimeout((function(){e.fetchAttachmentNames()}),3e4)}))}},{key:"updateNodeServices",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"private",t=this,a=this.state.nodesDataFetched,r=this.props.page_data,n=(r=void 0===r?{}:r).cluster_nodes,o=void 0===n?{}:n,i=r.current_cluster,s=void 0===i?{}:i;if(a){var c=f.a.fetchSafeFromObject({path:["_embedded","nodes"],obj:o,default_value:[]}),l=f.a.fetchSafeFromObject({path:["nodegroup","intended_categories"],obj:s,default_value:[]}),u=t_.processNodeServicesWithEndpointType({nodes:c,endpoint_type:e,intended_categories:l});this.setState({nodeServices:u})}else setTimeout((function(){t.updateNodeServices(e)}),100)}},{key:"render",value:function(){var e=this,t=a.getMeta(),r=this.state,o=r.attachmentNames,i=r.nodesDataFetched,s=r.nagiosFetched,c=r.nodeServices,l=this.props,u=l.page_data,p=void 0===u?{}:u,d=l.stats_data,m=void 0===d?{}:d,h=l.location,b=l.classes,v=m.session_data,y=void 0===v?{}:v,g=p.current_cluster,_=void 0===g?{}:g,S=p.cluster_nodes,k=void 0===S?{}:S,O=p.cluster_nagios,E=(O=void 0===O?{}:O).hosts_list,j=void 0===E?[]:E,D=p.cluster_histories,w=void 0===D?{}:D,C=p.flavor_list,T=void 0===C?{}:C,P=p.action_scripts,A=void 0===P?{}:P,R=_.label,N=(R=void 0===R?{}:R).name,F=void 0===N?"":N,x=R.description,M=void 0===x?"":x,I=_.nodegroup,U=(I=void 0===I?{}:I).intended_categories,L=void 0===U?[]:U,B=_.status,H=void 0===B?"":B,K=_.status_message,q=void 0===K?"":K,V=_.error_info,G=void 0===V?"":V,z=Kf.getStatusLabelOptions({status:H,status_message:q,error_info:G}),W=n.a.createElement("span",{className:b.clusterStatus},n.a.createElement(Qa,z)),J=f.a.fetchSafeFromObject({path:["g_install","proxy_present"],obj:m,default_value:!1}),Y=HS.map((function(t){return n.a.createElement("div",{key:t.key},"nodesInfo"===t.key?n.a.createElement(h_,{cluster_nodes:k,cluster_data:_,proxy_present:J,nodesDataFetched:i,nodeServices:c,fetchCurrentClusterData:e.fetchCurrentClusterData,updateNodeServices:e.updateNodeServices}):"","serviceStatus"===t.key?s?n.a.createElement(T_,{servicesData:j,isVirtualCluster:!0,lazyLoad:!1}):n.a.createElement(ls,null):"","actionScripts"===t.key?n.a.createElement(sS,{action_scripts:A,cluster_data:_,fetchActionScripts:e.fetchActionScripts,session_data:y}):"","clusterHistories"===t.key?n.a.createElement(vS,{cluster_histories:w,cluster_data:_,flavor_list:T,cluster_nodes:k}):"")}));return n.a.createElement("div",{className:"ClusterPage"},n.a.createElement(Al.a,{title:t.title,description:t.description,link:t.link,meta:t.meta}),F?n.a.createElement(Ia,null,n.a.createElement(Nt,{title:F,subComponent:W,subTitle:"[".concat(L.join(","),"] ").concat(M)}),n.a.createElement(AS,{cluster_data:_,attachmentNames:o,fetchCurrentClusterData:this.fetchCurrentClusterData}),n.a.createElement(_o,{tabs:HS,tabContents:Y,location:h})):n.a.createElement(ls,null))}}]),a}(r.Component);BS(qS,"propTypes",{classes:u.a.object.isRequired,dispatch:u.a.func.isRequired,stats_data:u.a.object,page_data:u.a.object,location:u.a.object});var VS=d()(he()(qf,{name:"App"}),Object(s.b)((function(e){var t=e.stats_data,a=void 0===t?{}:t,r=e.page_data;return{stats_data:a,page_data:void 0===r?{}:r}})))(qS),GS=a(246),zS=a.n(GS),WS=a(66),JS=a.n(WS),YS=a(97),$S=a.n(YS);function QS(e){return(QS="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function ZS(e,t){for(var a=0;a<t.length;a++){var r=t[a];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function XS(e,t){return(XS=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function ek(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=rk(e);if(t){var n=rk(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return tk(this,a)}}function tk(e,t){return!t||"object"!==QS(t)&&"function"!=typeof t?ak(e):t}function ak(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function rk(e){return(rk=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function nk(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}var ok=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&XS(e,t)}(i,e);var t,a,r,o=ek(i);function i(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),nk(ak(t=o.call(this,e)),"triggerCallback",(function(e){var a=e.userId,r=e.userName,n=e.userTenants,o=t.props.userClickCallback;o&&o({userId:a,userName:r,userTenants:n})})),nk(ak(t),"handleClick",(function(e,a){var r=a.id,n=void 0===r?"":r,o=a.name,i=void 0===o?"":o,s=a.tenants,c=void 0===s?{}:s,l=a.isExternal,u=void 0!==l&&l,p=a.isServiceAccount,d=void 0!==p&&p,f=a.isGroupAddedUser,m=void 0!==f&&f;if(m)return!1;t.triggerCallback({userId:n,userName:i,userTenants:c,isExternal:u,isServiceAccount:d,isGroupAddedUser:m}),t.setState({selectedUserId:n,selectedUsername:i})})),nk(ak(t),"isUserSelected",(function(e){return t.state.selectedUserId===e})),nk(ak(t),"getUserRoleInTenant",(function(e){var a=t.props,r=a.currentTenantId,n=void 0===r?"":r,o=a.rolesData,i=void 0===o?{}:o,s=e[n];if(s&&s.roleId){var c=s.roleId;return i[c]&&i[c].name}return""})),nk(ak(t),"getBadgeValue",(function(e){var a=t.props.currentSessionRole;if(e&&!f.a.isEmptyObject(e))switch(a){case"Admin":return t.getUserRoleInTenant(e).charAt(0);default:return Object.keys(e).length}return""})),t.state={selectedUserId:"",selectedUsername:""},t.userTenantsLookup={},t}return t=i,(a=[{key:"render",value:function(){var e=this,t=this.props.usersMapping,a=void 0===t?{}:t;return n.a.createElement(Ve.a,null,n.a.createElement(Se.a,{className:"userAssignmentList",subheader:n.a.createElement($S.a,{component:"div",className:se()("list-sub-header")},"USERS",n.a.createElement(Ws,{value:Object.keys(a).length,color:"primary"}))},Object.keys(a).map((function(t){return n.a.createElement(Ee.a,{key:f.a.uniqueKey(a[t].name),className:se()("list-item",{"list-item--disabled":a[t].isGroupAddedUser}),button:!0,selected:e.isUserSelected(a[t].id),onClick:function(r){return e.handleClick(r,a[t])}},n.a.createElement(zS.a,null,n.a.createElement("span",{className:se()("icon icon-user",{"list-item--disabled":a[t].isGroupAddedUser})})),n.a.createElement(JS.a,{className:se()({"list-item--disabled":a[t].isGroupAddedUser}),primary:"".concat(a[t].name," ").concat(a[t].additionalName)}),n.a.createElement(Ws,{value:e.getBadgeValue(a[t].tenants),color:e.isUserSelected(a[t].id)?"primary":"default"}))}))))}}])&&ZS(t.prototype,a),r&&ZS(t,r),i}(r.Component);nk(ok,"propTypes",{currentSessionRole:l.string,currentTenantId:l.string,rolesData:Object(l.shape)({}),usersMapping:Object(l.shape)({}).isRequired,userClickCallback:l.func});var ik=ok;function sk(e){return(sk="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function ck(e,t){for(var a=0;a<t.length;a++){var r=t[a];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function lk(e,t){return(lk=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function uk(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=fk(e);if(t){var n=fk(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return pk(this,a)}}function pk(e,t){return!t||"object"!==sk(t)&&"function"!=typeof t?dk(e):t}function dk(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function fk(e){return(fk=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function mk(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}var hk=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&lk(e,t)}(i,e);var t,a,r,o=uk(i);function i(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),mk(dk(t=o.call(this,e)),"triggerCallback",(function(e){var a=e.tenantId,r=e.tenantName,n=e.tenantType,o=t.props.tenantClickCallback;o&&o({tenantId:a,tenantName:r,tenantType:n})})),mk(dk(t),"getUserRoleInTenant",(function(e){var a=t.props,r=a.userTenantsData,n=void 0===r?{}:r,o=a.rolesData,i=void 0===o?{}:o,s=n[e.id];return s&&s.roleId?i[s.roleId].name:""})),mk(dk(t),"sortTenantsData",(function(e){var t=e.tenantsData,a=e.userTenantsDataLength,r=e.userTenantsData;if(!a)return t;var n={};for(var o in r)t[o]&&(n[o]=t[o]);return Object.assign(n,t)})),mk(dk(t),"handleClick",(function(e,a){var r=a.id,n=void 0===r?"":r,o=a.name,i=void 0===o?"":o,s=a.tenant_type,c=void 0===s?"":s,l=n;t.triggerCallback({tenantId:l,tenantName:i,tenantType:c}),t.setState({selectedTenantId:l})})),mk(dk(t),"resetSelectedTenant",(function(){t.state.selectedTenantId.length&&t.setState({selectedTenantId:""})})),t.state={selectedTenantId:""},t}return t=i,(a=[{key:"render",value:function(){var e=this,t=this.props,a=t.tenantsData,r=void 0===a?{}:a,o=t.userTenantsData,i=void 0===o?{}:o,s=Object.keys(r).length,c=Object.keys(i).length,l=this.sortTenantsData({tenantsData:r,userTenantsDataLength:c,userTenantsData:i});return n.a.createElement(Ve.a,null,n.a.createElement(Se.a,{className:"userAssignmentList",subheader:n.a.createElement($S.a,{component:"div",className:se()("list-sub-header")},"TENANTS",n.a.createElement(Ws,{value:s-c,color:"primary"}))},Object.keys(l).map((function(t){return n.a.createElement(Ee.a,{key:f.a.uniqueKey(l[t].name),className:se()("list-item",{"list-item--active":e.getUserRoleInTenant(l[t])}),button:!0,selected:e.state.selectedTenantId===l[t].id,onClick:function(a){return e.handleClick(a,l[t])}},n.a.createElement(Ws,{value:e.getUserRoleInTenant(l[t]).charAt(0),color:"primary"}),n.a.createElement(JS.a,{primary:l[t].name}))}))))}}])&&ck(t.prototype,a),r&&ck(t,r),i}(r.Component);mk(hk,"propTypes",{tenantsData:Object(l.shape)({}),userTenantsData:Object(l.shape)({}),rolesData:Object(l.shape)({}),tenantClickCallback:l.func});var bk=hk,vk=a(247),yk=a.n(vk),gk=a(248),_k=a.n(gk);function Sk(e){return(Sk="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function kk(e,t){for(var a=0;a<t.length;a++){var r=t[a];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Ok(e,t){return(Ok=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Ek(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=wk(e);if(t){var n=wk(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return jk(this,a)}}function jk(e,t){return!t||"object"!==Sk(t)&&"function"!=typeof t?Dk(e):t}function Dk(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function wk(e){return(wk=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Ck(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}var Tk=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Ok(e,t)}(i,e);var t,a,r,o=Ek(i);function i(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),Ck(Dk(t=o.call(this,e)),"getId",(function(e){return f.a.fetchSafeFromObject({path:["id"],obj:e,default_value:{}})})),Ck(Dk(t),"getContentMessageText",(function(){var e=t.props,a=e.selectedUserData,r=void 0===a?{}:a,n=e.selectedTenantData,o=void 0===n?{}:n,i="Please select a User from Users list to edit their Tenancies",s="Please select a Tenancy from Tenants list to manage the User's Role";return r.name||o.name?s:i})),Ck(Dk(t),"triggerCallback",(function(e){var a=e.roleId,r=e.roleName,n=e.roleDescription,o=t.props.roleChangeCallback;o&&o({roleId:a,roleName:r,roleDescription:n})})),Ck(Dk(t),"handleChange",(function(e){var a=e.target.value,r=t.props.rolesData,n=(r=void 0===r?{}:r)[a],o=(n=void 0===n?{}:n).id,i=void 0===o?"":o,s=n.name,c=void 0===s?"":s,l=n.description,u=void 0===l?"":l;t.triggerCallback({roleId:i,roleName:c,roleDescription:u}),t.setState({selectedRoleId:a})})),Ck(Dk(t),"resetSelectedRole",(function(){t.setState({selectedRoleId:""})})),t.state={selectedRoleId:""},t}return t=i,(a=[{key:"componentDidUpdate",value:function(e){var t=this.props.selectedTenantData.id!==e.selectedTenantData.id,a=this.props.selectedUserData.id!==e.selectedUserData.id,r=Object.keys(this.props.selectedUserData.tenants).length!==Object.keys(e.selectedUserData.tenants).length;(t||a||r)&&this.setState({selectedRoleId:""})}},{key:"render",value:function(){var e=this.props,t=e.currentSessionRole,a=void 0===t?"":t,r=e.rolesData,o=void 0===r?{}:r,i=e.selectedUserData,s=void 0===i?{}:i,c=e.selectedTenantData,l=void 0===c?{}:c,u=e.currentRole,p=void 0===u?{}:u,d=e.actionElement,m=p.id||this.state.selectedRoleId,h=l.name||"Admin"===a&&s.name;return n.a.createElement(Ve.a,null,n.a.createElement(Se.a,{className:"userAssignmentList",subheader:n.a.createElement($S.a,{component:"div",className:se()("list-sub-header","list--gutter")},s.name&&n.a.createElement(JS.a,{className:se()("list--no-gutter"),secondary:s.name}),l.name&&n.a.createElement(JS.a,{className:se()("list--no-gutter"),secondary:l.name}),s.name&&!h&&n.a.createElement(JS.a,{className:se()("list--no-gutter"),secondary:"Select a tenant to edit user role"}))},n.a.createElement("div",{className:se()("list-content")},!h&&n.a.createElement("div",{className:se()("list-content-message")},n.a.createElement(JS.a,{secondary:this.getContentMessageText()})),h&&n.a.createElement(Hr.a,{component:"fieldset"},n.a.createElement($S.a,{component:"div"},"MANAGE TENANT ROLE"),n.a.createElement(_k.a,{"aria-label":"Role",name:"userRoles",value:m,onChange:this.handleChange},Object.values(o).map((function(e){return n.a.createElement(Ir.a,{key:f.a.uniqueKey(e.name),value:e.id,control:n.a.createElement(yk.a,null),label:e.name,disabled:!s.name||!!p.id})})))),d)))}}])&&kk(t.prototype,a),r&&kk(t,r),i}(r.Component);Ck(Tk,"propTypes",{currentSessionRole:l.string,rolesData:Object(l.shape)({}),selectedUserData:Object(l.shape)({}),selectedTenantData:Object(l.shape)({}),currentRole:Object(l.shape)({}),roleChangeCallback:l.func,actionElement:l.node});var Pk=Tk;function Ak(e){return(Ak="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Rk(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function Nk(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?Rk(Object(a),!0).forEach((function(t){Bk(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):Rk(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function Fk(e,t){for(var a=0;a<t.length;a++){var r=t[a];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function xk(e,t){return(xk=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Mk(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=Lk(e);if(t){var n=Lk(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return Ik(this,a)}}function Ik(e,t){return!t||"object"!==Ak(t)&&"function"!=typeof t?Uk(e):t}function Uk(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Lk(e){return(Lk=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Bk(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}var Hk="Admin",Kk=[Hk,"Member"],qk=["k8s","docker"],Vk=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&xk(e,t)}(i,e);var t,a,r,o=Mk(i);function i(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),Bk(Uk(t=o.call(this,e)),"fetchPageData",(function(){var e=t.props.dispatch;t.fetchUserData(),e(x(Q(oe.TENANT_DATA_V1),Q(oe.ROLE_DATA)))})),Bk(Uk(t),"setUserTenants",(function(e){var a=e.result,r=e.userId,n=t.props,o=n.tenants_mapping_data,i=void 0===o?{}:o,s=n.current_tenant_id,c=void 0===s?"":s;if(t.state.usersMapping[r]){var l=f.a.fetchSafeFromObject({path:["data","_embedded","tenants"],obj:a,default_value:[]}).reduce((function(e,t){var a=Nk({},e),r=f.a.fetchSafeFromObject({path:["_links","self","href"],obj:t,default_value:""}),n=f.a.fetchSafeFromObject({path:["_embedded"],obj:t,default_value:{}}),o=n.tenant_type,s=void 0===o?"":o,c=n.role,l=void 0===c?"":c,u=n.label,p=void 0===u?{}:u;return qk.includes(s)&&i[r]&&(a[r]=Nk({id:r,tenant_type:s,roleId:l},p)),a}),{});t.setState({usersMapping:Nk(Nk({},t.state.usersMapping),{},Bk({},r,Nk(Nk({},t.state.usersMapping[r]),{},{tenants:l})))},(function(){if(t.state.selectedUser.id){var e=Nk(Nk({},t.state.selectedUser),{},{tenants:l});switch(t.props.current_session_role){case Hk:if(t.state.selectedTenant.id){var a={id:t.state.usersMapping[r].tenants[c]?t.state.usersMapping[r].tenants[c].roleId:""};t.resetPageState({selectedUser:e,selectedTenantRole:a})}break;default:t.resetPageState({selectedUser:e}),t.tenantListElement.current.resetSelectedTenant()}}}))}})),Bk(Uk(t),"fetchUserTenants",(function(e){var a=w.apiurl.USER_TENANTS(e);R({apiurl:a}).then((function(a){return t.setUserTenants({result:a,userId:e})})).catch((function(){t.timeout[e]=setTimeout((function(){t.fetchUserTenants(e)}),100)}))})),Bk(Uk(t),"fetchUserData",(function(){(0,t.props.dispatch)(Q(oe.USER_DATA)).then((function(){var e=t.props.users_mapping_data,a=void 0===e?{}:e;t.setState({usersMapping:JSON.parse(JSON.stringify(a))});for(var r=0,n=Object.keys(a);r<n.length;r++){var o=n[r];t.fetchUserTenants(o)}}))})),Bk(Uk(t),"handleUserClick",(function(e){var a=e.userId,r=e.userName,n=e.userTenants,o=t.props,i=o.current_session_role,s=void 0===i?"":i,c=o.current_tenant_id,l=void 0===c?"":c,u={id:a,name:r,tenants:n};if(s===Hk){var p={id:f.a.fetchSafeFromObject({path:["usersMapping",a,"tenants",l,"roleId"],obj:t.state,default_value:""})};t.resetPageState({selectedUser:u,selectedTenantRole:p})}else t.tenantListElement.current.resetSelectedTenant(),t.resetPageState({selectedUser:u})})),Bk(Uk(t),"handleTenantClick",(function(e){var a=e.tenantId,r=e.tenantName,n=t.state.selectedUser;t.setState({selectedTenant:{id:a,name:r},selectedTenantRole:{id:n.tenants[a]?n.tenants[a].roleId:""},selectedRole:{id:""}})})),Bk(Uk(t),"handleRoleChange",(function(e){var a=e.roleId;t.setState({selectedRole:{id:a}})})),Bk(Uk(t),"updateRole",(function(){var e=t.state,a=e.selectedUser,r=e.selectedTenant,o=e.selectedTenantRole,i=e.selectedRole,s={user:a.id,operation:"",role:""};o.id?(s.operation="revoke",s.role=o.id):(s.operation="assign",s.role=i.id);var c=w.apiurl.TENANT_USERS(r.id);R({apiurl:c,data:s,method:"put"}).then((function(){var e="Role '".concat(t.props.roles_mapping_data[s.role].name,"' successfully ").concat("assign"===s.operation?"assigned":"revoked"," to user '").concat(a.name,"'.");_n({msg:e,variant:"success"}),t.fetchUserTenants(a.id)})).catch((function(e){var r=f.a.parseAxiosError({error:e}),o="Failed to ".concat(s.operation," role '").concat(t.props.roles_mapping_data[s.role].name,"' to user '").concat(a.name,"'.");_n({msg:n.a.createElement(ns,{errors:[o,r]}),variant:"error"})}))})),Bk(Uk(t),"actionButtonStatus",(function(e){var a={isVisible:!1,isDisabled:!0,text:""};switch(a.text=e?t.actionButtonsText.remove:t.actionButtonsText.save,t.props.current_session_role){case Hk:a.isVisible=t.state.selectedUser.id,a.isDisabled=!t.state.selectedUser.id||!t.state.selectedTenantRole.id&&!t.state.selectedRole.id;break;default:a.isVisible=t.state.selectedTenant.id,a.isDisabled=!t.state.selectedUser.id||!t.state.selectedTenant.id||!t.state.selectedTenantRole.id&&!t.state.selectedRole.id}return a})),Bk(Uk(t),"resetPageState",(function(e){var a=e.selectedUser,r=e.selectedTenant,n=e.selectedTenantRole,o=e.selectedRole,i=t.props,s=i.current_session_role,c=void 0===s?"":s,l=i.current_tenant_id,u=void 0===l?"":l,p=i.tenants_mapping_data,d=void 0===p?{}:p,m={selectedUser:{id:"",name:"",tenants:{}},selectedTenant:{id:"",name:""},selectedTenantRole:{id:""},selectedRole:{id:""}};c===Hk&&(m.selectedTenant={id:u,name:f.a.fetchSafeFromObject({path:[u,"name"],obj:d,default_value:""})}),t.setState({selectedUser:a||m.selectedUser,selectedTenant:r||m.selectedTenant,selectedTenantRole:n||m.selectedTenantRole,selectedRole:o||m.selectedRole})})),t.tenantListElement=n.a.createRef(),t.timeout={},t.actionButtonsText={remove:"Remove from this Tenant",save:"Save"},t.state={selectedUser:{id:"",name:"",tenants:{}},selectedTenant:{id:"",name:""},selectedTenantRole:{id:""},selectedRole:{id:""},usersMapping:{}},t}return t=i,r=[{key:"getMeta",value:function(e){return{title:"HPE ".concat(e?"Container Platform":"ML Ops"," | User Assignment"),link:[{rel:"canonical",href:"".concat(w.serverUrl).concat(e?w.views.assignK8sUser.url:w.views.assignAimlUser.url)}],meta:[{charset:"utf-8"},{name:"description",content:"User assignment page."}]}}}],(a=[{key:"componentDidMount",value:function(){this.fetchPageData()}},{key:"componentWillUnmount",value:function(){var e=this;Object.keys(this.timeout).map((function(t){return clearTimeout(e.timeout[t])}))}},{key:"render",value:function(){var e=this.state,t=e.selectedUser,a=e.selectedTenant,r=e.selectedTenantRole,o=this.props,s=o.kubernetes_access,c=void 0!==s&&s,l=o.current_session_role,u=void 0===l?"":l,p=o.current_tenant_id,d=void 0===p?"":p,f=o.roles_mapping_data,m=void 0===f?{}:f,h=o.tenants_mapping_data,b=void 0===h?{}:h,v=i.getMeta(c),y=this.actionButtonStatus(r.id);return n.a.createElement("div",{className:"UserAssignmentPage"},n.a.createElement(Al.a,{title:v.title,description:v.description,link:v.link,meta:v.meta}),n.a.createElement(Nt,{title:"Users Assignment"}),n.a.createElement(bc.a,{container:!0,spacing:24},n.a.createElement(bc.a,{item:!0,xs:12,md:!0},n.a.createElement(ik,{currentSessionRole:u,currentTenantId:d,rolesData:m,usersMapping:this.state.usersMapping,userClickCallback:this.handleUserClick})),u!==Hk&&n.a.createElement(bc.a,{item:!0,xs:12,md:!0},n.a.createElement(bk,{ref:this.tenantListElement,tenantsData:b,userTenantsData:t.tenants,rolesData:m,tenantClickCallback:this.handleTenantClick})),n.a.createElement(bc.a,{item:!0,xs:12,md:!0},n.a.createElement(Pk,{currentSessionRole:u,rolesData:m,selectedUserData:t,selectedTenantData:a,currentRole:r,roleChangeCallback:this.handleRoleChange,actionElement:y.isVisible&&n.a.createElement(Ue.a,{variant:"contained",color:"primary",onClick:this.updateRole,disabled:y.isDisabled},y.text)}))))}}])&&Fk(t.prototype,a),r&&Fk(t,r),i}(r.Component);Bk(Vk,"propTypes",{current_session_role:l.string.isRequired,current_tenant_id:l.string.isRequired,total_users_count:l.number.isRequired,roles_mapping_data:Object(l.shape)({}).isRequired,users_mapping_data:Object(l.shape)({}).isRequired,tenants_mapping_data:Object(l.shape)({}).isRequired,kubernetes_access:l.bool,dispatch:l.func.isRequired});var Gk=Object(s.b)((function(e){var t=e.stats_data,a=void 0===t?{}:t,r=e.page_data,n=void 0===r?{}:r,o=a.session_data,i=void 0===o?{}:o,s=i.role_name,c=void 0===s?"":s,l=i.tenant,u=void 0===l?"":l,p=i.current_tenant_data,d=(p=void 0===p?{}:p).k8s_cluster,m=void 0===d?"":d,h=i.current_tenant_data,b=void 0===h?{}:h,v=n.user_list,y=void 0===v?{}:v,g=n.tenant_list_v1,_=void 0===g?{}:g,S=n.role_list,k=void 0===S?{}:S,O=function(e,t){var a=Nk({},e),r=t.is_external,n=void 0!==r&&r,o=t.is_service_account,i=void 0!==o&&o,s=t.is_group_added_user,c=void 0!==s&&s,l=f.a.fetchSafeFromObject({path:["_links","self","href"],obj:t,default_value:{}}),u=c?"(Group Added)":"";return a[l]=Nk(Nk({id:l},t.label),{},{additionalName:u,isExternal:n,isServiceAccount:i,isGroupAddedUser:c}),a},E=f.a.fetchSafeFromObject({path:["_embedded","roles"],obj:k,default_value:[]}),j=f.a.fetchSafeFromObject({path:["_embedded","users"],obj:y,default_value:[]}),D=f.a.fetchSafeFromObject({path:["_embedded","tenants"],obj:_,default_value:[]});E=E.filter((function(e){return Kk.includes(e.label.name)})),j=j.filter((function(e){return!e.is_service_account})),D=c===Hk?[b]:D.filter((function(e){return"k8s_admin"!==e.tenant_type&&e.k8s_cluster===m}));var w=j.reduce(O,{}),C=E.reduce(O,{}),T=D.reduce(O,{});return{current_session_role:c,current_tenant_id:u,total_users_count:j.length,roles_mapping_data:C,users_mapping_data:w,tenants_mapping_data:T}}))(Vk);function zk(e){return(zk="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Wk(e,t){for(var a=0;a<t.length;a++){var r=t[a];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Jk(e,t){return(Jk=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Yk(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=Qk(e);if(t){var n=Qk(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return $k(this,a)}}function $k(e,t){return!t||"object"!==zk(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Qk(e){return(Qk=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var Zk=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Jk(e,t)}(i,e);var t,a,r,o=Yk(i);function i(e){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),o.call(this,e)}return t=i,(a=[{key:"render",value:function(){var e=this.props,t=e.alert,a=void 0===t?{}:t,r=e.classes,o=a.current_state,i=void 0===o?"":o,s=a.line,c=void 0===s?"":s,l=a.timestamp,u=void 0===l?"":l,p="";switch(i){case"OK":p="success";break;case"WARNING":p="warning";break;case"CRITICAL":p="error";break;default:p="disabled"}return n.a.createElement("div",null,n.a.createElement(Ni,{variant:p})," ",n.a.createElement(st.a,{className:r.alertText,variant:"caption"},"[",Fc.a.unix(u).format("ddd MMM DD YYYY HH:mm:ss"),"] ",c))}}])&&Wk(t.prototype,a),r&&Wk(t,r),i}(r.Component);!function(e,t,a){t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a}(Zk,"propTypes",{classes:u.a.object.isRequired,alert:u.a.object});var Xk=he()((function(){return{alertText:{display:"inline",verticalAlign:"middle"}}}))(Zk);function eO(e){return(eO="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function tO(e,t){for(var a=0;a<t.length;a++){var r=t[a];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function aO(e,t){return(aO=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function rO(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=iO(e);if(t){var n=iO(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return nO(this,a)}}function nO(e,t){return!t||"object"!==eO(t)&&"function"!=typeof t?oO(e):t}function oO(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function iO(e){return(iO=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var sO=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&aO(e,t)}(i,e);var t,a,r,o=rO(i);function i(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),(t=o.call(this,e)).state={activePage:1,dataFetching:!0,itemsCountPerPage:25},t.fetchData=t.fetchData.bind(oO(t)),t}return t=i,(a=[{key:"componentDidMount",value:function(){this.fetchData()}},{key:"fetchData",value:function(){var e=this,t=this.props,a=t.dispatch,r=t.hosts;a(Q(oe.NAGIOS_ALERTS({filter:r}))).then((function(){e.setState({dataFetching:!1})}))}},{key:"render",value:function(){var e=this,t=this.props.nagios_alerts,a=void 0===t?[]:t,r=this.state,o=r.activePage,i=r.itemsCountPerPage,s=(o-1)*i,c=s+i,l=a.length,u=l>5,p=u?a.slice(s,c):a;return n.a.createElement("div",{style:{position:"relative"}},u&&n.a.createElement(ms,{activePage:o,itemsCountPerPage:i,totalItemCount:l,onPageChange:function(t){e.setState({activePage:t})},onItemsCountPerPageChange:function(t){e.setState({itemsCountPerPage:t})}}),p.map((function(e,t){return n.a.createElement(Xk,{alert:e,key:f.a.uniqueKey(t)})})))}}])&&tO(t.prototype,a),r&&tO(t,r),i}(r.Component);!function(e,t,a){t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a}(sO,"propTypes",{dispatch:u.a.func.isRequired,hosts:u.a.array,nagios_alerts:u.a.array});var cO=Object(s.b)((function(e){var t=e.page_data,a=(t=void 0===t?{}:t).nagios_alerts;return{nagios_alerts:void 0===a?[]:a}}))(sO);function lO(e){return(lO="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function uO(){return(uO=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var r in a)Object.prototype.hasOwnProperty.call(a,r)&&(e[r]=a[r])}return e}).apply(this,arguments)}function pO(e){return function(e){if(Array.isArray(e))return dO(e)}(e)||function(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||function(e,t){if(!e)return;if("string"==typeof e)return dO(e,t);var a=Object.prototype.toString.call(e).slice(8,-1);"Object"===a&&e.constructor&&(a=e.constructor.name);if("Map"===a||"Set"===a)return Array.from(e);if("Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a))return dO(e,t)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function dO(e,t){(null==t||t>e.length)&&(t=e.length);for(var a=0,r=new Array(t);a<t;a++)r[a]=e[a];return r}function fO(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function mO(e,t){for(var a=0;a<t.length;a++){var r=t[a];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function hO(e,t){return(hO=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function bO(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=gO(e);if(t){var n=gO(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return vO(this,a)}}function vO(e,t){return!t||"object"!==lO(t)&&"function"!=typeof t?yO(e):t}function yO(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function gO(e){return(gO=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function _O(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}var SO=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&hO(e,t)}(i,e);var t,a,r,o=bO(i);function i(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),(t=o.call(this,e)).state={cluster:"*",host:"*",time_range:"hour",applicable_metrics:[],applicable_graphs:[],applicable_hosts:[],hostsByCluster:{},grid:0,selections:{},hasApplicableHosts:!1},t.updateMetricDescriptors=t.updateMetricDescriptors.bind(yO(t)),t.handleChangeSelection=t.handleChangeSelection.bind(yO(t)),t.updateQuerySelections=t.updateQuerySelections.bind(yO(t)),t.updateApplicableHosts=t.updateApplicableHosts.bind(yO(t)),t.gethostsByCluster=t.gethostsByCluster.bind(yO(t)),t}return t=i,(a=[{key:"componentDidMount",value:function(){this.updateMetricDescriptors(),this.gethostsByCluster()}},{key:"gethostsByCluster",value:function(){var e=this,t=this.props.k8shosts,a=!1,r=(void 0===t?[]:t).reduce((function(e,t){if("configured"!==t.status)return e;a=!0;var r=t.cluster_id,n=void 0===r?"":r,o=t.hostname,i=void 0===o?"":o,s=t.ipaddr,c=void 0===s?"":s,l=t.sysinfo,u=(l=void 0===l?{}:l).gpu,p=(u=void 0===u?{}:u).gpu_count,d=void 0===p?0:p;return Object.keys(e).includes(n)||(e[n]=[]),e[n].push({hostname:i,ipaddr:c,gpu_count:d}),e}),{});this.setState({hostsByCluster:r,hasApplicableHosts:a},(function(){e.updateApplicableHosts()}))}},{key:"updateMetricDescriptors",value:function(){var e=this.props.metrics_params,t=w.applicable_graphs({graph:"system"}),a=4===t.length?6:4;if(f.a.isEmptyObject(e))setTimeout(this.updateMetricDescriptors,500);else{var r=Sd({graph:"system",metrics_params:e,applicable_graphs:t});this.setState({applicable_metrics:r,applicable_graphs:t,grid:a})}}},{key:"handleChangeSelection",value:function(e,t){var a=this,r="cluster"===t,n=_O({},t,e);r&&(n.host="*"),this.setState(function(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?fO(Object(a),!0).forEach((function(t){_O(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):fO(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}({},n),(function(){r?a.updateApplicableHosts():a.updateQuerySelections()}))}},{key:"updateQuerySelections",value:function(){var e=this.state,t=e.host,a=e.time_range,r=e.applicable_hosts.filter((function(e){return"*"===t||"top_cpu_hosts"===t||"top_memory_hosts"===t||t===e.hostname})),n={selected_objs:r,time_range:a,filter:!0,agg_type:function(e,t){return"top_cpu_hosts"===e||"top_memory_hosts"===e?e:t.length<=10?"node":"total_avg"}(t,r)};this.setState({selections:n})}},{key:"updateApplicableHosts",value:function(){var e=this,t="Site Admin"===this.props.role_name,a=this.state,r=a.cluster,n=a.hostsByCluster,o=Object.keys(n),i=o.length?f.a.getColorList(o.length):[],s=o.reduce((function(e,a,o){if(!t||"*"===r||r===a){var s=n[a];if(s.length){var c=f.a.getColorList(s.length,t?i[o]:"");s.map((function(t,a){t.color=c[a],e.push(t)}))}}return e}),[]);this.setState({applicable_hosts:s},(function(){e.updateQuerySelections()}))}},{key:"render",value:function(){var e=this.props,t=e.title,a=e.classes,r=e.clusterNames,o=e.role_name,i=this.state,s=i.applicable_graphs,c=i.applicable_metrics,l=i.grid,u=i.cluster,p=i.host,d=i.time_range,m=i.selections,h=i.applicable_hosts,b=i.hasApplicableHosts;return n.a.createElement("div",{className:a.monitoring},t?n.a.createElement(st.a,{variant:"h2",className:a.contentTitle},t):"",b?n.a.createElement("div",{className:a.chartContainer},n.a.createElement("div",{className:a.chartSelectors},"Site Admin"===o?n.a.createElement(Hr.a,{className:a.selectWrapper},n.a.createElement(nc,{value:u,onChange:this.handleChangeSelection,name:"cluster",className:a.select,items:[{val:"*",title:"All Kubernetes Clusters"}].concat(pO(Object.keys(r).map((function(e){return{val:e,title:r[e]}}))))})):"",n.a.createElement(Hr.a,{className:a.selectWrapper},n.a.createElement(nc,{value:p,onChange:this.handleChangeSelection,name:"host",className:a.select,items:[{val:"*",title:"All Kubernetes Hosts"},{val:"top_cpu_hosts",title:"Top 10 Kubernetes Hosts by CPU Utilization"},{val:"top_memory_hosts",title:"Top 10 Kubernetes Hosts by Memory Usage"}].concat(pO(h.map((function(e){return{val:e.hostname,title:e.hostname}}))))})),n.a.createElement(Hr.a,{className:a.selectWrapper},n.a.createElement(nc,{value:d,onChange:this.handleChangeSelection,name:"time_range",className:a.select,items:pO(w.TIME_RANGES)}))),f.a.isEmptyObject(m)?n.a.createElement(ls,null):n.a.createElement(bc.a,{className:a.charts,container:!0,spacing:16},s.map((function(e){return n.a.createElement(Nd,uO({type:"system_chart"},c.find((function(t){return t.id===e})),m,{grid:l,key:e}))})))):n.a.createElement(Hp.a,{className:a.well},n.a.createElement(qp.a,null,n.a.createElement(st.a,{variant:"body1"},"Charts will be available once kubernetes hosts / cluster is configured."))))}}])&&mO(t.prototype,a),r&&mO(t,r),i}(r.Component);_O(SO,"propTypes",{classes:u.a.object,k8shosts:u.a.array,metrics_params:u.a.object,clusterNames:u.a.object,title:u.a.string,role_name:u.a.string});var kO=he()(yp)(SO);function OO(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function EO(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?OO(Object(a),!0).forEach((function(t){jO(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):OO(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function jO(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}var DO=w.RESOURCE_TYPES,wO=function(e){var t=e.nodes,a=e.namespaces,r=e.afterKey,n=void 0===r?{}:r,o=t.length?t.join(" OR "):"*",i=a.length?a.join(" OR "):"*",s=f.a.isEmptyObject(n)?{}:{after:EO({},n)};return{query:{bool:{must:[{query_string:{query:"metricset.module:kubernetes",analyze_wildcard:!0}},{query_string:{query:"metricset.name:container OR state_container OR state_pod",analyze_wildcard:!0}},{query_string:{query:"kubernetes.node.name: ".concat(o),analyze_wildcard:!0}},{query_string:{query:"kubernetes.namespace: ".concat(i),analyze_wildcard:!0}},{range:{"@timestamp":{gte:"now-12m",lte:"now-2m",format:"epoch_millis"}}}],must_not:[]}},size:0,_source:{excludes:[]},aggs:{Pages:{composite:EO(EO({size:60},s),{},{sources:[{UsagePeriod:{date_histogram:{field:"@timestamp",interval:"12m"}}},{Node:{terms:{field:"kubernetes.node.name"}}}]}),aggs:{Namespace:{terms:{field:"kubernetes.namespace",size:1e4,min_doc_count:2,order:{_key:"desc"}},aggs:{Pod:{terms:{field:"kubernetes.pod.name",size:1e4,min_doc_count:2,order:{_key:"desc"}},aggs:{Mem_Limit_Bytes:{avg:{field:"kubernetes.container.memory.limit.bytes"}},Mem_Request_Bytes:{avg:{field:"kubernetes.container.memory.request.bytes"}},CPU_Limit_Cores:{avg:{field:"kubernetes.container.cpu.limit.cores",script:{lang:"painless",source:"Math.round(_value / params.scale) * params.scale",params:{scale:.001}}}},CPU_Request_Cores:{avg:{field:"kubernetes.container.cpu.request.cores",script:{lang:"painless",source:"Math.round(_value / params.scale) * params.scale",params:{scale:.001}}}},RootFs_Capacity_Bytes:{avg:{field:"kubernetes.container.rootfs.capacity.bytes"}},RootFs_Available_Bytes:{avg:{field:"kubernetes.container.rootfs.available.bytes"}},RootFs_Used_Bytes:{avg:{field:"kubernetes.container.rootfs.used.bytes"}}}},NS_Count_Pod_Running:{scripted_metric:{init_script:"state.pods_running = new HashMap()",map_script:"if (doc['kubernetes.pod.status.phase'].value == 'running') state.pods_running.put(doc['kubernetes.pod.name'].value, 1)",combine_script:"return state",reduce_script:"HashSet running_pods = new HashSet(); for (s in states) {running_pods.addAll(s.pods_running.keySet())} return running_pods.size()"}},NS_Total_Mem_Limit_Bytes:{sum_bucket:{buckets_path:"Pod>Mem_Limit_Bytes"}},NS_Total_Mem_Request_Bytes:{sum_bucket:{buckets_path:"Pod>Mem_Request_Bytes"}},NS_Total_CPU_Limit_Cores:{sum_bucket:{buckets_path:"Pod>CPU_Limit_Cores"}},NS_Total_CPU_Request_Cores:{sum_bucket:{buckets_path:"Pod>CPU_Request_Cores"}},NS_Total_RootFs_Capacity_Bytes:{sum_bucket:{buckets_path:"Pod>RootFs_Capacity_Bytes"}},NS_Total_RootFs_Available_Bytes:{sum_bucket:{buckets_path:"Pod>RootFs_Available_Bytes"}},NS_Total_RootFs_Used_Bytes:{sum_bucket:{buckets_path:"Pod>RootFs_Used_Bytes"}}}},All_NS_Total_Mem_Limit_Bytes:{sum_bucket:{buckets_path:"Namespace>NS_Total_Mem_Limit_Bytes"}},All_NS_Total_Mem_Request_Bytes:{sum_bucket:{buckets_path:"Namespace>NS_Total_Mem_Request_Bytes"}},All_NS_Total_CPU_Limit_Cores:{sum_bucket:{buckets_path:"Namespace>NS_Total_CPU_Limit_Cores"}},All_NS_Total_CPU_Request_Cores:{sum_bucket:{buckets_path:"Namespace>NS_Total_CPU_Request_Cores"}},All_NS_Total_RootFs_Capacity_Bytes:{sum_bucket:{buckets_path:"Namespace>NS_Total_RootFs_Capacity_Bytes"}},All_NS_Total_RootFs_Available_Bytes:{sum_bucket:{buckets_path:"Namespace>NS_Total_RootFs_Available_Bytes"}},All_NS_Total_RootFs_Used_Bytes:{sum_bucket:{buckets_path:"Namespace>NS_Total_RootFs_Used_Bytes"}}}}}}},CO=function(e){var t=[DO.PERSISTENT.ID,DO.TENANT_STORAGE.ID],a=f.a.getColorList(Object.keys(DO).length),r=[];return Object.values(DO).forEach((function(n,o){if(n.ID===DO.GPU.ID)return!1;var i=!t.includes(n.id)||e;r.push({id:n.ID,label:n.TITLE,convert_gb:n.CONVERT_TO_GB,unit:n.UNIT,color:a[o],title:"".concat(n.TITLE," Used"),applicable:i})})),r};function TO(e){return(TO="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function PO(e,t){for(var a=0;a<t.length;a++){var r=t[a];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function AO(e,t){return(AO=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function RO(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=xO(e);if(t){var n=xO(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return NO(this,a)}}function NO(e,t){return!t||"object"!==TO(t)&&"function"!=typeof t?FO(e):t}function FO(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function xO(e){return(xO=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var MO=w.settings,IO=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&AO(e,t)}(i,e);var t,a,r,o=RO(i);function i(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),(t=o.call(this,e)).usageRenderer=t.usageRenderer.bind(FO(t)),t.handleChangeSelection=t.handleChangeSelection.bind(FO(t)),t.customToolbar=t.customToolbar.bind(FO(t)),t.state={quota_type:"tenant_quota"},t}return t=i,(a=[{key:"usageRenderer",value:function(e){var t=this.props.hasTenantStorageSet,a=[w.RESOURCE_TYPES.PERSISTENT.ID,w.RESOURCE_TYPES.TENANT_STORAGE.ID],r=JSON.parse(e),o=r.id,i=void 0===o?"":o,s=r.used,c=void 0===s?0:s,l=r.quota,u=r.cluster_total,p=r.convert_gb,d=void 0!==p&&p,m=r.quota_support;if(void 0===m||!m||!t&&a.includes(i))return"N/A";var h=this.getApplicableQuota({quota:l,id:i,cluster_total:u}),b=c&&h?f.a.roundNumber(100*Number(c)/h):0,v=c?d?f.a.roundNumber(c/d):c:0,y=h?d?f.a.roundNumber(h/d):h:0;return n.a.createElement("div",{style:{maxWidth:"10rem",textAlign:"center"}},n.a.createElement(Qs,{label:"".concat(b,"%"),progress:b}),n.a.createElement(st.a,null,v," / ",y))}},{key:"getApplicableQuota",value:function(e){var t=e.quota,a=e.id,r=e.cluster_total,n=this.props.total_quota;return"system_quota"===this.state.quota_type?n[a]:"number"===f.a.guessType(t)?t:a===w.RESOURCE_TYPES.TENANT_STORAGE.ID?n[a]:r}},{key:"handleChangeSelection",value:function(e){this.setState({quota_type:e.target.value})}},{key:"customToolbar",value:function(){var e=this.state.quota_type,t=this.props,a=t.classes,r=t.role_name;return n.a.createElement("div",{className:"tableActionButtons"},n.a.createElement(st.a,{variant:"caption",className:a.nowrap},"Show Usage against "),n.a.createElement(Hr.a,null,n.a.createElement(qr.a,{value:e,onChange:this.handleChangeSelection,name:"resource type",className:a.select,MenuProps:{classes:{paper:a.selectMenuList}}},n.a.createElement(lt.a,{value:"tenant_quota"},"Tenant Quota"),n.a.createElement(lt.a,{value:"system_quota"},"K8S Admin"===r?"Cluster Resources":"System Resources"))))}},{key:"getTableContents",value:function(){var e=this.props.k8sTenantsById;return{columns:[{name:"Tenant Name",options:{filter:!0}},{name:"Namespace",options:{filter:!0}},{name:"Cluster Name",options:{filter:!0}},{name:"Cores",options:{filter:!0,customBodyRender:this.usageRenderer}},{name:"Memory (GB)",options:{filter:!0,customBodyRender:this.usageRenderer}},{name:"Ephemeral Storage (GB)",options:{filter:!0,customBodyRender:this.usageRenderer}},{name:"Persistent Storage (GB)",options:{filter:!0,customBodyRender:this.usageRenderer}},{name:"Tenant Storage (GB)",options:{filter:!0,customBodyRender:this.usageRenderer}},{name:"Number of Running Pods",options:{filter:!0}}],data:Object.keys(e).reduce((function(t,a){var r=e[a],n=r.name,o=void 0===n?"":n,i=r.namespace,s=void 0===i?"":i,c=r.quota,l=void 0===c?{}:c,u=r.usage,p=void 0===u?{}:u,d=r.cluster_quota,f=void 0===d?{}:d,m=r.cluster_name,h=void 0===m?"":m,b=r.quota_support,v=void 0===b?{}:b,y=r.num_running_pods,g=void 0===y?0:y,_=p.cores,S=void 0===_?0:_,k=p.memory,O=void 0===k?0:k,E=p.ephemeral_storage,j=void 0===E?0:E,D=p.persistent_storage,C=void 0===D?0:D,T=p.tenant_storage,P=void 0===T?0:T;return t.push([o,s,h,JSON.stringify({id:w.RESOURCE_TYPES.CPU.ID,used:S,quota:l.cores,cluster_total:f.cores||0,quota_support:v.cores}),JSON.stringify({id:w.RESOURCE_TYPES.MEMORY.ID,used:O,quota:l.memory_gb*MO.MB_to_GB,cluster_total:f.memory||0,convert_gb:MO.MB_to_GB,quota_support:v.memory}),JSON.stringify({id:w.RESOURCE_TYPES.EPHEMERAL.ID,used:j,quota:l.disk_gb*MO.MB_to_GB,cluster_total:f.ephemeral_storage||0,convert_gb:MO.MB_to_GB,quota_support:v.ephemeral_storage}),JSON.stringify({id:w.RESOURCE_TYPES.PERSISTENT.ID,used:C,quota:l.persistent_storage_size_gb*MO.MB_to_GB,cluster_total:f.persistent_storage||0,convert_gb:MO.MB_to_GB,quota_support:v.persistent_storage}),JSON.stringify({id:w.RESOURCE_TYPES.TENANT_STORAGE.ID,used:P,quota:l.tenant_storage_gb*MO.MB_to_GB,cluster_total:f.tenant_storage||0,convert_gb:MO.MB_to_GB,quota_support:v.persistent_storage}),g]),t}),[]),options:{selectableRows:"none",customToolbar:this.customToolbar}}}},{key:"render",value:function(){var e=this.getTableContents();return n.a.createElement(sa,e)}}])&&PO(t.prototype,a),r&&PO(t,r),i}(r.Component);!function(e,t,a){t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a}(IO,"propTypes",{classes:u.a.object,k8sTenantsById:u.a.object,total_quota:u.a.object,totalPodsByTenantId:u.a.object,role_name:u.a.string,hasTenantStorageSet:u.a.bool});var UO=he()(yp)(IO);function LO(e){return(LO="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function BO(){return(BO=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var r in a)Object.prototype.hasOwnProperty.call(a,r)&&(e[r]=a[r])}return e}).apply(this,arguments)}function HO(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function KO(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?HO(Object(a),!0).forEach((function(t){YO(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):HO(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function qO(e,t){for(var a=0;a<t.length;a++){var r=t[a];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function VO(e,t){return(VO=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function GO(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=JO(e);if(t){var n=JO(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return zO(this,a)}}function zO(e,t){return!t||"object"!==LO(t)&&"function"!=typeof t?WO(e):t}function WO(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function JO(e){return(JO=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function YO(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}var $O=w.settings,QO=w.RESOURCE_TYPES,ZO=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&VO(e,t)}(i,e);var t,a,r,o=GO(i);function i(e){var t,a;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),a=o.call(this,e);var r=e.k8sTenantsById,n=e.hasTenantStorageSet;return a.CancelToken=T.a.CancelToken,a.dataUpdates={},a.timeouts={},a.fetchElasticData=a.fetchElasticData.bind(WO(a)),a.processElasticData=a.processElasticData.bind(WO(a)),a.fetchPersistentVolumeData=a.fetchPersistentVolumeData.bind(WO(a)),a.fetchPersistentVolumeDataFromAPI=a.fetchPersistentVolumeDataFromAPI.bind(WO(a)),a.setPersistentVolumeByClusterNamespace=a.setPersistentVolumeByClusterNamespace.bind(WO(a)),a.updatePersistentVolumeUsage=a.updatePersistentVolumeUsage.bind(WO(a)),a.fetchTenantStorageData=a.fetchTenantStorageData.bind(WO(a)),a.fetchTenantStorageDataFromApi=a.fetchTenantStorageDataFromApi.bind(WO(a)),a.updateTenantStorageUsage=a.updateTenantStorageUsage.bind(WO(a)),a.onClickRefreshData=a.onClickRefreshData.bind(WO(a)),a.getTenantIdFromNamespaceAndHostname=a.getTenantIdFromNamespaceAndHostname.bind(WO(a)),a.usageFields=CO(n),a.persistentVolume={},a.tenantStorage={},a.state={total_usage:(t={},YO(t,QO.CPU.ID,0),YO(t,QO.MEMORY.ID,0),YO(t,QO.GPU.ID,0),YO(t,QO.EPHEMERAL.ID,0),YO(t,QO.PERSISTENT.ID,0),YO(t,QO.TENANT_STORAGE.ID,0),t),k8sTenantsById:r,dataRefreshing:!1,fetchingTenantStorage:!1,lastRefreshed:0,refreshInProgress:!1},a}return t=i,(a=[{key:"componentDidMount",value:function(){var e=this.props.hasTenantStorageSet;this.fetchElasticData(),this.fetchPersistentVolumeData(),e&&this.fetchTenantStorageData()}},{key:"componentWillUnmount",value:function(){var e=this;Object.keys(this.timeouts).forEach((function(t){clearTimeout(e.timeouts[t])})),Object.keys(this.dataUpdates).forEach((function(t){e.dataUpdates[t].cancel("component unmounted")}))}},{key:"getTenantIdFromNamespaceAndHostname",value:function(e,t){var a=this.props,r=a.k8sTenantsById,n=a.hostClusterDict[t];return n&&Object.values(r).find((function(t){return t.namespace===e&&t.cluster===n})).id||""}},{key:"processElasticData",value:function(e){var t=this,a=this.state,r=a.total_usage,n=a.k8sTenantsById,o=f.a.deepClone(r),i=this.props.role_name,s=e.reduce((function(e,t){if(!t.key.Node)return e;var a=t.Namespace,r=void 0===a?{}:a,n=t.All_NS_Total_Mem_Limit_Bytes,o=void 0===n?{}:n,i=t.All_NS_Total_CPU_Limit_Cores,s=void 0===i?{}:i,c=t.All_NS_Total_RootFs_Used_Bytes,l=void 0===c?{}:c,u={memory:f.a.roundNumber(o.value/$O.B_to_MB,0)||0,cores:f.a.roundNumber(s.value,2)||0,ephemeral_storage:f.a.roundNumber(l.value/$O.B_to_MB,0)||0,namespace:r};if(e.hasOwnProperty(t.key.Node))return(u.memory>e[t.key.Node].memory||u.cores>e[t.key.Node].cores||u.ephemeral_storage>e[t.key.Node].ephemeral_storage)&&(e[t.key.Node]=u),e;var p={};return p[t.key.Node]=u,KO(KO({},e),p)}),{}),c=Object.values(s).reduce((function(e,t){return e.memory+=t.memory,e.cores+=t.cores,e.ephemeral_storage+=t.ephemeral_storage,e}),{memory:0,cores:0,ephemeral_storage:0});o[QO.MEMORY.ID]=f.a.roundNumber(c.memory),o[QO.CPU.ID]=f.a.roundNumber(c.cores,2),o[QO.EPHEMERAL.ID]=f.a.roundNumber(c.ephemeral_storage),this.setState({total_usage:o}),[w.ROLE_NAME.SITE_ADMIN,w.ROLE_NAME.K8S_ADMIN].includes(i)&&function(){var e=f.a.cloneWithDataReset(n,[{resourcePath:["usage",QO.CPU.ID],resetValue:0},{resourcePath:["usage",QO.MEMORY.ID],resetValue:0},{resourcePath:["usage",QO.EPHEMERAL.ID],resetValue:0},{resourcePath:["num_running_pods"],resetValue:0}]),a=function(a){var r=s[a].namespace.buckets;(void 0===r?[]:r).map((function(r){var n=r.NS_Total_Mem_Limit_Bytes,o=void 0===n?{}:n,i=r.NS_Total_CPU_Limit_Cores,s=void 0===i?{}:i,c=r.NS_Total_RootFs_Used_Bytes,l=void 0===c?{}:c,u=r.NS_Count_Pod_Running,p=void 0===u?{}:u,d=r.key,m=t.getTenantIdFromNamespaceAndHostname(d,a);if(m){var h=e[m],b=f.a.roundNumber(o.value/$O.B_to_MB,0)||0,v=f.a.roundNumber(s.value,2)||0,y=f.a.roundNumber(l.value/$O.B_to_MB,0)||0,g=p.value;if(h.usage){if(h.usage[QO.MEMORY.ID]?h.usage[QO.MEMORY.ID]+=b:h.usage[QO.MEMORY.ID]=b,h.usage[QO.CPU.ID]){var _=h.usage.cores;h.usage[QO.CPU.ID]=f.a.roundNumber(_+v,2)}else h.usage[QO.CPU.ID]=v;h.usage[QO.EPHEMERAL.ID]?h.usage[QO.EPHEMERAL.ID]+=y:h.usage[QO.EPHEMERAL.ID]=y}else{var S;h.usage=(YO(S={},QO.MEMORY.ID,b),YO(S,QO.CPU.ID,v),YO(S,QO.EPHEMERAL.ID,y),S)}h.num_running_pods?h.num_running_pods+=g:h.num_running_pods=g}}))};for(var r in s)a(r);t.setState({k8sTenantsById:e})}()}},{key:"fetchElasticData",value:function(){var e=this,t=this.state.k8sTenantsById,a=Object.values(t).map((function(e){return e.namespace}));if(a.length){this.dataUpdates.monitoring=this.CancelToken.source();var r=wO,n={nodes:[],namespaces:a},o=this.dataUpdates.monitoring.token;gd({cancelToken:o,inBuckets:[],queryFun:r,queryParams:n}).then((function(t){t.length>0&&(delete e.dataUpdates.monitoring,e.processElasticData(t))}),(function(t){T.a.isCancel(t)?f.a.bdLog(t):e.timeout=setTimeout(e.fetchElasticData,6e4)}))}}},{key:"setPersistentVolumeByClusterNamespace",value:function(e){var t=this,a=e.cluster,r=e.items;this.persistentVolume.clusterNamespace[a]={},r.forEach((function(e){var r=f.a.fetchSafeFromObject({path:["spec","claimRef","namespace"],obj:e,default_value:""}),n=f.a.fetchSafeFromObject({path:["spec","capacity","storage"],obj:e,default_value:0});n=parseInt(n),t.persistentVolume.totalUsed+=parseInt(n),t.persistentVolume.clusterNamespace[a][r]||(t.persistentVolume.clusterNamespace[a][r]=0),t.persistentVolume.clusterNamespace[a][r]+=n}))}},{key:"updatePersistentVolumeUsage",value:function(){var e=f.a.deepClone(this.state.k8sTenantsById),t=f.a.deepClone(this.state.total_usage);for(var a in t[QO.PERSISTENT.ID]=this.persistentVolume.totalUsed*$O.MB_to_GB,e){var r=e[a];r.usage[QO.PERSISTENT.ID]=this.persistentVolume.clusterNamespace[r.cluster][r.namespace]*$O.MB_to_GB||0}this.setState({total_usage:t,k8sTenantsById:e})}},{key:"fetchPersistentVolumeDataFromAPI",value:function(e){var t=this,a=e.port,r=e.cluster,n=w.apiurl.K8S_PVS;this.persistentVolume.fetchingCount+=1,this.dataUpdates.pvs=this.CancelToken.source(),R({apiurl:n,port:a,cancelToken:this.dataUpdates.pvs.token}).then((function(e){delete t.dataUpdates.pvs;var a=e.data,n=(a=void 0===a?{}:a).items,o=void 0===n?[]:n;t.persistentVolume.fetchingCountFinal+=1,t.setPersistentVolumeByClusterNamespace({cluster:r,items:o}),t.persistentVolume.fetchingCount===t.persistentVolume.fetchingCountFinal&&t.updatePersistentVolumeUsage()})).catch((function(e){T.a.isCancel(e)?f.a.bdLog(e):(t.persistentVolume.fetchingCountFinal+=1,t.persistentVolume.fetchingCount===t.persistentVolume.fetchingCountFinal&&t.updatePersistentVolumeUsage())}))}},{key:"fetchPersistentVolumeData",value:function(){var e=this.state.k8sTenantsById,t=[];for(var a in this.persistentVolume={clusterNamespace:{},totalUsed:0,fetchingCount:0,fetchingCountFinal:0},e){var r=e[a],n=r.cluster,o=r.port;!t.includes(n)&&o&&(this.fetchPersistentVolumeDataFromAPI({port:o,cluster:n}),t.push(n))}}},{key:"fetchTenantStorageDataFromApi",value:function(e){var t=this,a=this.state.dataRefreshing;this.dataUpdates[e]=this.CancelToken.source();var r=w.apiurl.TENANT_STORAGE_DATA(e,a);R({apiurl:r,cancelToken:this.dataUpdates[e].token}).then((function(a){delete t.dataUpdates[e],t.tenantStorage.fetchingCountFinal+=1;var r=a.data,n=(r=void 0===r?{}:r).tenant_storage_mb,o=void 0===n?0:n,i=r.last_refresh_timestamp;t.tenantStorage.tenants[e]=o,t.tenantStorage.totalUsed+=o,i>t.tenantStorage.lastRefreshed&&(t.tenantStorage.lastRefreshed=i),t.tenantStorage.fetchingCount===t.tenantStorage.fetchingCountFinal&&t.updateTenantStorageUsage()})).catch((function(e){T.a.isCancel(e)?f.a.bdLog(e):(t.tenantStorage.fetchingCountFinal+=1,t.tenantStorage.fetchingCount===t.tenantStorage.fetchingCountFinal&&t.updateTenantStorageUsage())}))}},{key:"updateTenantStorageUsage",value:function(){var e=this.state,t=e.k8sTenantsById,a=e.total_usage,r=f.a.deepClone(t),n=f.a.deepClone(a),o=this.tenantStorage,i=o.tenants,s=o.totalUsed,c=o.lastRefreshed;for(var l in n[QO.TENANT_STORAGE.ID]=s,i)r[l].usage[QO.TENANT_STORAGE.ID]=i[l];this.setState({dataRefreshing:!1,lastRefreshed:c,total_usage:n,k8sTenantsById:r})}},{key:"fetchTenantStorageData",value:function(){this.tenantStorage={tenants:{},totalUsed:0,fetchingCount:0,fetchingCountFinal:0,lastRefreshed:0};var e=this.state.k8sTenantsById;for(var t in e){var a=e[t];f.a.fetchSafeFromObject({path:["quota_support","tenant_storage"],obj:a,default_value:!1})&&(this.tenantStorage.fetchingCount+=1,this.fetchTenantStorageDataFromApi(t))}this.tenantStorage.fetchingCount===this.tenantStorage.fetchingCountFinal&&(this.tenantStorage.fetchingCount?this.updateTenantStorageUsage():this.setState({dataRefreshing:!1}))}},{key:"onClickRefreshData",value:function(){var e=this,t=this.props,a=t.fetchData,r=t.hasTenantStorageSet;this.setState({dataRefreshing:!0},(function(){a([{name:"tenants",callBack:function(){e.fetchElasticData(),e.fetchPersistentVolumeData(),r?e.fetchTenantStorageData():e.setState({dataRefreshing:!1})}}])}))}},{key:"render",value:function(){var e=this.state,t=e.total_usage,a=e.k8sTenantsById,r=e.dataRefreshing,o=void 0!==r&&r,i=e.lastRefreshed,s=this.props,c=s.classes,l=s.role_name,u=s.total_quota,p=s.hasTenantStorageSet;return n.a.createElement(n.a.Fragment,null,f.a.isEmptyObject(a)?"":n.a.createElement("div",{className:c.refreshActionWrapper},o?n.a.createElement(n.a.Fragment,null,n.a.createElement(st.a,{className:c.padRight,variant:"caption"},"Refreshing Data..."),n.a.createElement("span",{className:"icon icon-sync icon-spin"})):n.a.createElement(n.a.Fragment,null,i?n.a.createElement(st.a,{className:c.padRight,variant:"caption"},"Last refreshed ",Fc.a.unix(i).format(w.settings.time_format)):"",n.a.createElement(st.a,{className:c.txtBtn,variant:"caption",onClick:this.onClickRefreshData},"Refresh Data ",n.a.createElement("span",{className:"icon icon-sync"})))),n.a.createElement("div",{className:c.list},this.usageFields.map((function(e){return n.a.createElement(Wt,BO({key:e.id,total:u[e.id]||0,used:t[e.id]||0},e))}))),n.a.createElement(st.a,{variant:"h2",className:c.pageSubtitle},"Tenants"),n.a.createElement(UO,{k8sTenantsById:a,total_quota:u,role_name:l,hasTenantStorageSet:p}))}}])&&qO(t.prototype,a),r&&qO(t,r),i}(r.Component);YO(ZO,"propTypes",{classes:u.a.object.isRequired,k8sTenants:u.a.array,clusterNames:u.a.object,totalResources:u.a.object,role_name:u.a.string,fetchData:u.a.func,k8sTenantsById:u.a.object,total_quota:u.a.object,k8shosts:u.a.array,hostClusterDict:u.a.object,hasTenantStorageSet:u.a.bool});var XO=he()(yp)(ZO),eE=function(e){var t=e.id,a=void 0===t?"":t,r=e.name,o=void 0===r?"":r,i=e.callback,s=void 0===i?null:i;R({apiurl:a,method:w.method.DELETE}).then((function(){_n({msg:"Started deletion process for the cluster ( ".concat(o," )."),variant:"success"}),s?s():f.a.bdLog("redirect to manage cluster page")})).catch((function(e){var t=f.a.parseAxiosError({error:e}),a=n.a.createElement(ns,{errors:["Failed to delete the cluster ".concat(o),t]});_n({msg:a,variant:"error"})}))},tE={getK8sClusterActionButtons:function(e){var t=e.status,a=e.id,r=e.hasHosts,n=e.imported,o=[{action:"delete",btn_type:"power_ops",icon:"icon-trash2",title:"Delete Kubernetes Cluster",variant:"error"},{action:"edit",btn_type:"link",icon:"icon-pencil3",title:"Edit Kubernetes Cluster",variant:"primary",url:void 0!==n&&n?g.a.k8sImportCluster.makeEditUrl({id:a}):g.a.k8sCreateCluster.makeEditUrl({id:a}),requireHosts:!0},{action:"dashboard",btn_type:"general_ops",icon:"icon-window",title:"Access Kubernetes Dashboard",variant:"info",requireHosts:!0},{action:"kubeconfig",btn_type:"general_ops",icon:"icon-download2",title:"Download Admin Kubeconfig",variant:"info",requireHosts:!0},{action:"log",btn_type:"general_ops",icon:"icon-cli",title:"Setup log info",variant:"info",requireNodes:!1},{action:"upgrade",btn_type:"upgrade",icon:"icon-arrow-up-circle",title:"Upgrade Kubernetes",variant:"info"},{action:"retry_upgrade",btn_type:"retry_upgrade",icon:"icon-sync",title:"Retry Kubernetes Upgrade on Failed Workers",variant:"info"},{action:"user",btn_type:"general_ops",icon:"icon-user",title:"Cluster Admin Users",variant:"info"},{action:"usergroup",btn_type:"general_ops",icon:"icon-users",title:"Update Cluster Admin External Groups",variant:"primary"}],i={delete:["ready","warning","error"],edit:["ready","warning"],dashboard:["ready","warning"],kubeconfig:["ready","warning"],log:["ready","warning","error"],upgrade:["ready","warning"],retry_upgrade:["ready","warning"],user:["ready","warning"],usergroup:["ready","warning"]};return o.filter((function(e){if(i[e.action].includes(t))return!e.requireHosts||r}))},k8sClusterPowerOps:function(e){var t=e.action,a=e.id,r=void 0===a?"":a,n=e.name,o=void 0===n?"":n,i=e.callback,s=void 0===i?null:i;switch(t){case"delete":eE({id:r,name:o,callback:s});break;default:_n({msg:"Action not supported",variant:"error"})}},deleteK8sCluster:eE,downloadK8sClusterRelatedFiles:function(e){var t=e.data,a=void 0===t?"":t,r=e.name,n=void 0===r?"":r,o=e.action,i=void 0===o?"":o,s=f.a.cleanString(n),c="log"===i?"setuplog":"admin_kubeconfig",l="".concat(s,"_").concat(c);if(a){f.a.downloadOrSaveData(a,l,"text/txt")}else _n({msg:"Data to download is empty",variant:"error"})},liveUpdateK8sCluster:function(e){var t=["creating","updating","deleting","upgrading"];return e.find((function(e){return t.includes(e.status)}))},sortK8sVersions:function(e){return Array.isArray(e)&&e.length?e.sort((function(e,t){for(var a=e.split("."),r=t.split("."),n=Math.min(a.length,r.length),o=0;o<n;++o){if(parseInt(a[o])<parseInt(r[o]))return 1;if(parseInt(a[o])>parseInt(r[o]))return-1}return 0})):[]},importedClusterTypesMap:{generic:"Generic",eks:"Elastic Kubernetes Service (EKS)"}};function aE(e){return(aE="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function rE(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function nE(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?rE(Object(a),!0).forEach((function(t){dE(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):rE(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function oE(e,t){for(var a=0;a<t.length;a++){var r=t[a];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function iE(e,t,a){return t&&oE(e.prototype,t),a&&oE(e,a),e}function sE(e,t){return(sE=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function cE(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=pE(e);if(t){var n=pE(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return lE(this,a)}}function lE(e,t){return!t||"object"!==aE(t)&&"function"!=typeof t?uE(e):t}function uE(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function pE(e){return(pE=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function dE(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}var fE=[{label:"Usage",key:"usage"},{label:"Load",key:"load"},{label:"Services Status",key:"services-status"},{label:"Alerts",key:"alerts"}],mE=w.settings.MB_to_GB,hE=w.RESOURCE_TYPES,bE=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&sE(e,t)}(a,e);var t=cE(a);function a(e){var r;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,a),(r=t.call(this,e)).CancelToken=T.a.CancelToken,r.dataUpdates={},r.fetchData=r.fetchData.bind(uE(r)),r.state={tenantsDataFetched:!1,k8sClusterDataFetched:!1,k8shostsFetched:!1,podsDataFetched:!1},r}return iE(a,null,[{key:"getMeta",value:function(){return{title:"".concat(w.APP_TITLE.CP," | Dashboard"),link:[{rel:"canonical",href:"".concat(w.serverUrl).concat(w.views.k8sDashboard.url)}],meta:[{charset:"utf-8"},{name:"description",content:"Kubernetes dashboard."}]}}}]),iE(a,[{key:"componentDidMount",value:function(){this.fetchData([{name:"k8sHosts"},{name:"tenants"},{name:"k8sClusters"},{name:"metricParams"}])}},{key:"componentWillUnmount",value:function(){for(var e in this.dataUpdates)this.dataUpdates[e].cancel("component unmounted")}},{key:"fetchData",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],a=this.props.dispatch,r=this;t.map((function(t){var n=t.name,o=void 0===n?"":n,i=t.callBack,s=void 0===i?null:i;e.dataUpdates[t]=e.CancelToken.source();var c=e.dataUpdates[t].token;switch(o){case"tenants":a(Q(nE(nE({},oe.TENANT_DATA),{},{cancelToken:c}))).then((function(){delete e.dataUpdates[t],r.setState({tenantsDataFetched:!0},(function(){s&&s()}))}));break;case"k8sClusters":a(Q(nE(nE({},oe.K8SCLUSTER_DATA(["stats"])),{},{cancelToken:c}))).then((function(){delete e.dataUpdates[t],r.setState({k8sClusterDataFetched:!0})}));break;case"k8sHosts":a(Q(nE(nE({},oe.K8SHOST_DATA),{},{cancelToken:c}))).then((function(){delete e.dataUpdates[t],r.setState({k8shostsFetched:!0}),s&&s()}));break;case"metricParams":a(Q(nE(nE({},oe.METRICS_PARAM_DATA),{},{cancelToken:c}))).then((function(){delete e.dataUpdates[t]}))}}))}},{key:"render",value:function(){var e=this,t=a.getMeta(),r=this.state,o=r.k8shostsFetched,i=r.tenantsDataFetched,s=r.k8sClusterDataFetched,c=this.props,l=c.dispatch,u=c.configDataAvailable,p=c.k8shosts,d=c.metrics_params,f=c.location,m=c.role_name,h=c.clusterNames,b=c.k8sTenantsById,v=c.hostFilters,y=c.nagios_data,g=c.nagios_alerts,_=c.hostClusterDict,S=c.total_quota,k=c.hasTenantStorageSet,O=fE.map((function(t){return n.a.createElement("div",{key:t.key},"usage"===t.key?o&&i&&s&&u?n.a.createElement(XO,{role_name:m,k8shosts:p,k8sTenantsById:b,clusterNames:h,hostClusterDict:_,total_quota:S,fetchData:e.fetchData,hasTenantStorageSet:k}):n.a.createElement(ls,null):"","load"===t.key?o&&s?n.a.createElement(kO,{k8shosts:p,metrics_params:d,role_name:m,clusterNames:h}):n.a.createElement(ls,null):"","services-status"===t.key?n.a.createElement(T_,{dispatch:l,nagios_data:y}):"","alerts"===t.key?o?n.a.createElement(cO,{hosts:v,dispatch:l,nagios_alerts:g}):n.a.createElement(ls,null):"")}));return n.a.createElement("div",{className:"K8sDashboardPage"},n.a.createElement(Al.a,{title:t.title,description:t.description,link:t.link,meta:t.meta}),n.a.createElement(Nt,{title:"Kubernetes Dashboard"}),n.a.createElement(_o,{tabs:fE,tabContents:O,location:f}))}}]),a}(r.Component);dE(bE,"propTypes",{dispatch:u.a.func.isRequired,k8shosts:u.a.array,hostFilters:u.a.array,nagios_data:u.a.object,nagios_alerts:u.a.array,metrics_params:u.a.object,location:u.a.object,role_name:u.a.string,clusterNames:u.a.object,k8sTenantsById:u.a.object,configDataAvailable:u.a.bool,total_quota:u.a.object,hostClusterDict:u.a.object,hasTenantStorageSet:u.a.bool});var vE=Object(s.b)((function(e){var t,a=e.stats_data,r=void 0===a?{}:a,n=e.page_data,o=(n=void 0===n?{}:n).k8shost_list,i=void 0===o?{}:o,s=n.metrics_params,c=void 0===s?{}:s,l=n.k8scluster_list,u=void 0===l?{}:l,p=n.tenant_list,d=void 0===p?{}:p,m=n.nagios_data,h=void 0===m?{}:m,b=n.nagios_alerts,v=void 0===b?[]:b,y=f.a.fetchSafeFromObject({path:["g_config_data_v1"],obj:r,default_value:{}}),g=f.a.fetchSafeFromObject({path:["_embedded","k8shosts"],obj:i,default_value:[]}),_=f.a.fetchSafeFromObject({path:["session_data","role_name"],obj:r,default_value:""}),S=f.a.fetchSafeFromObject({path:["_embedded","k8sclusters"],obj:u,default_value:[]}),k=f.a.fetchSafeFromObject({path:["_embedded","tenants"],obj:d,default_value:[]}),O=f.a.fetchSafeFromObject({path:["g_install","bdshared_storage_localfstype"],obj:r,default_value:""}),E=[],j=y.objects,D=(j=void 0===j?{}:j).total_tenant_storage,C=void 0===D?0:D,T=j.system_quota,P=void 0===T?[]:T,A=C*mE,R=(dE(t={},hE.CPU.ID,0),dE(t,hE.MEMORY.ID,0),dE(t,hE.GPU.ID,0),dE(t,hE.EPHEMERAL.ID,0),dE(t,hE.PERSISTENT.ID,A),dE(t,hE.TENANT_STORAGE.ID,A),t);P.length&&P.forEach((function(e){if(e.tenant_type===w.TENANT_TYPES.K8S){var t=e.cores,a=void 0===t?0:t,r=e.memory_gb,n=void 0===r?0:r,o=e.gpus,i=void 0===o?0:o,s=e.ephemeral_storage_size_gb,c=void 0===s?0:s;R[hE.CPU.ID]=a,R[hE.MEMORY.ID]=n*mE,R[hE.GPU.ID]=i,R[hE.EPHEMERAL.ID]=c*mE}}));var N={},F={};S.forEach((function(e){var t=e.imported,a=void 0!==t&&t,r=e.label,n=(r=void 0===r?{}:r).name,o=void 0===n?"":n,i=e.cluster_quota,s=(i=void 0===i?{}:i).cores,c=void 0===s?0:s,l=i.memory_gb,u=void 0===l?0:l,p=i.gpus,d=void 0===p?0:p,m=i.ephemeral_storage_size_gb,h=void 0===m?0:m,b=i.persistent_storage_size_gb,v=void 0===b?0:b,y=f.a.fetchSafeFromObject({path:w.pathToID,obj:e,default_value:""});if(y&&o){var g,_=o;if(!0===a){var S=f.a.fetchSafeFromObject({path:["type"],obj:e,default_value:""}),k=f.a.fetchSafeFromObject({path:[S],obj:tE.importedClusterTypesMap,default_value:"-"});_+=" (Imported ".concat(k," Cluster)")}N[y]=_,F[y]=(dE(g={},hE.CPU.ID,c),dE(g,hE.MEMORY.ID,u*mE),dE(g,hE.GPU.ID,d),dE(g,hE.EPHEMERAL.ID,h*mE),dE(g,hE.PERSISTENT.ID,v*mE),dE(g,hE.TENANT_STORAGE.ID,A),g)}}));var x={};g.map((function(e){var t=e.status,a=e.hostname,r=e.cluster_id,n=void 0===r?"":r;["ready","configured","configuring","config_error","unconfiguring","upgrading","upgrading_error"].includes(t)&&(E.push(a),x[a]=n)}));var M=k.reduce((function(e,t){if("k8s"===t.tenant_type){var a=t._links,r=void 0===a?{}:a,n=t.label,o=void 0===n?{}:n,i=t.tenant_enclosed_properties,s=(i=void 0===i?{}:i).namespace,c=void 0===s?"":s,l=i.k8s_auth_port,u=void 0===l?"":l,p=i.k8s_cluster,d=void 0===p?"":p,m=t.quota,h=void 0===m?{}:m,b=t.quota_support,v=(b=void 0===b?{}:b).disk_gb,y=void 0===v||v,g=b.gpus,_=void 0===g||g,S=b.persistent_storage_size_gb,k=void 0===S||S,O=b.tenant_storage_gb,E=void 0===O||O;if(c&&u){var j=f.a.fetchSafeFromObject({path:["self","href"],obj:r,default_value:""}),D=o.name||"";e[j]={id:j,name:D,namespace:c,quota:h,quota_support:{cores:!0,memory:!0,ephemeral_storage:y,gpus:_,persistent_storage:k,tenant_storage:E},port:u,cluster:d,cluster_name:N[d],cluster_quota:F[d],usage:{}}}}return e}),{});return{configDataAvailable:!f.a.isEmptyObject(y),hostFilters:E,metrics_params:c,role_name:_,clusterNames:N,k8sTenantsById:M,k8shosts:g,total_quota:R,nagios_data:h,nagios_alerts:v,hostClusterDict:x,hasTenantStorageSet:!!O}}))(bE),yE=a(155),gE=a.n(yE),_E=a(154),SE=a.n(_E),kE=a(125),OE=a.n(kE);function EE(e){return(EE="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function jE(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function DE(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?jE(Object(a),!0).forEach((function(t){xE(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):jE(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function wE(e){return function(e){if(Array.isArray(e))return CE(e)}(e)||function(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||function(e,t){if(!e)return;if("string"==typeof e)return CE(e,t);var a=Object.prototype.toString.call(e).slice(8,-1);"Object"===a&&e.constructor&&(a=e.constructor.name);if("Map"===a||"Set"===a)return Array.from(e);if("Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a))return CE(e,t)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function CE(e,t){(null==t||t>e.length)&&(t=e.length);for(var a=0,r=new Array(t);a<t;a++)r[a]=e[a];return r}function TE(e,t){for(var a=0;a<t.length;a++){var r=t[a];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function PE(e,t){return(PE=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function AE(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=FE(e);if(t){var n=FE(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return RE(this,a)}}function RE(e,t){return!t||"object"!==EE(t)&&"function"!=typeof t?NE(e):t}function NE(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function FE(e){return(FE=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function xE(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}var ME=er({path:["k8sCreateEditCluster"]}),IE=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&PE(e,t)}(i,e);var t,a,r,o=AE(i);function i(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),(t=o.call(this,e)).state={formSchema:LE(e.isEditView),formData:{},hostData:{},hostByOrginalRoleID:{masters:[],workers:[]},hostDataError:{isErrorState:!1,message:""}},t.updateAvailableHosts=t.updateAvailableHosts.bind(NE(t)),t.onHostSelection=t.onHostSelection.bind(NE(t)),t.validateForm=t.validateForm.bind(NE(t)),t.submitForm=t.submitForm.bind(NE(t)),t.bdFormStep1Ref=n.a.createRef(),t.searchQuerySuggestions=["vm01.host.name","!vm01.host.name","@tags:name=value","@tags:name!=value","@status:name","@status:!name"],t}return t=i,(a=[{key:"componentDidMount",value:function(){this.updateAvailableHosts()}},{key:"updateAvailableHosts",value:function(){var e=this,t=this,a=this.state.hostByOrginalRoleID,r=this.props,n=r.k8shosts,o=void 0===n?[]:n,i=r.dataFetched,s=r.formData,c=r.isEditView,l=r.current_k8scluster_data,u=s.k8shosts_config,p=void 0===u?[]:u;if(!i)return setTimeout(this.updateAvailableHosts,500),!1;var d=[],f=[];p.map((function(e){"master"===e.role?d.push.apply(d,wE(e.hosts)):f.push.apply(f,wE(e.hosts))}));var m={masters:{id:"masters",title:"Selected Hosts",placeholder:"Search",data:[]},workers:{id:"workers",title:"Selected Hosts",placeholder:"Search",data:[]},availableMasters:{id:"availableMasters",title:"Available Hosts",placeholder:"Search",data:[]},availableWorkers:{id:"availableWorkers",title:"Available Hosts",placeholder:"Search",data:[]}};if(c){var h=l.k8shosts_config;(void 0===h?[]:h).map((function(e){var t="master"===e.role?"masters":"workers";a[t].push(e.node)}))}o.map((function(t){var r=t.resources,n=void 0===r?"":r,o=t.hostname,i=void 0===o?"":o,s=t.status,c=void 0===s?"":s,l=t.path,u=void 0===l?"":l,p=t.tags,h={value:u,title:i,subTitle:n,tags:void 0===p?{}:p,status:c,filterBy:["title","tags","status"],disabled:"none"};d.includes(u)?m.masters.data.push(DE({},h)):f.includes(u)?m.workers.data.push(DE({},h)):e.addAvailableHost(h,m,a)})),this.setState({hostData:m,formData:s,hostByOrginalRoleID:a},(function(){t.onHostSelection({})}))}},{key:"addAvailableHost",value:function(e,t,a){var r=!1,n=!1;this.props.isEditView&&(a.masters.includes(e.value)&&(t.availableWorkers.data.push(DE(DE({},e),{},{disabled:"both"})),n=!0),a.workers.includes(e.value)&&(t.availableMasters.data.push(DE(DE({},e),{},{disabled:"both"})),r=!0)),!r&&t.availableMasters.data.push(e),!n&&t.availableWorkers.data.push(e)}},{key:"onHostSelection",value:function(e){var t=this,a=e.arrayData,r=this.state,n=r.formSchema,o=r.formData,i=r.hostData,s=r.hostByOrginalRoleID;if(a&&a.length){"masters"===a[1].id?i.masters=a[1]:i.workers=a[1];var c=a[0].data;i.availableMasters.data=[],i.availableWorkers.data=[],c.map((function(e){var a=e.subTitle,r=void 0===a?"":a,n=e.status,o=void 0===n?"":n,c=e.value,l=void 0===c?"":c,u=e.title,p=void 0===u?"":u,d=e.tags,f={subTitle:r,status:o,value:l,title:p,tags:void 0===d?{}:d,filterBy:["title","tags","status"],disabled:"none"};t.addAvailableHost(f,i,s)}))}var l=i.masters.data.map((function(e){return e.value})),u=i.availableMasters.data.map((function(e){return e.value})),p=i.workers.data.map((function(e){return e.value})),d=[].concat(wE(l),wE(u),wE(p)),m=f.a.fetchSafeFromObject({path:["current","state","formData"],obj:this.bdFormStep1Ref,default_value:o});m.k8shosts_config=[],["master","worker"].map((function(e,t){var a=f.a.fetchSafeFromObject({path:["properties","k8shosts_config","items",t,"properties","hosts"],obj:n,default_value:{}}),r=0===t?l:p,o=a.items;(void 0===o?{}:o).enum=d,a.default=r,m.k8shosts_config.push({role:e,hosts:r})})),this.setState({formSchema:n,formData:m,hostData:i})}},{key:"validateForm",value:function(e,t){var a=this,r=this.props,n=r.clusterNames,o=r.isEditView,i=e.label,s=(i=void 0===i?{}:i).name,c=void 0===s?"":s,l=e.k8shosts_config,u=void 0===l?[]:l;c.length>32?t.label.name.addError("Kubernetes cluster name should not be more than 32 characters long."):c.match(Fl.user_name)?!o&&n.includes(c)&&t.label.name.addError("Name already in use."):t.label.name.addError("Please provide valid name for Kubernetes cluster.");var p="";return u.map((function(e){if("master"===e.role){var t=e.hosts,r=void 0===t?[]:t;return r.length?(!f.a.isOddNumber(r.length)||r.length>5)&&(p="Master hosts should match odd counts of 1, 3, ...".concat(5,". Currently ").concat(r.length," host(s) selected."),a.setState({hostDataError:{isErrorState:!0,message:p}})):p="Please select at least one host for master.",!0}})),p&&t.k8shosts_config.addError(p),t}},{key:"submitForm",value:function(e){var t=e.formData,a=e.errors,r=this.props,n=r.updateFormData,o=r.step;a.length||n({data:t,step:o,nextStep:o+1})}},{key:"render",value:function(){var e=this.props,t=e.isEditView,a=e.classes,r=e.dataFetched,o=e.k8shosts,i=this.state,s=i.formSchema,c=i.formData,l=i.hostData,u=!t&&!o.length;return n.a.createElement(n.a.Fragment,null,r?n.a.createElement(n.a.Fragment,null,u?n.a.createElement(St.Typography,{className:a.warning,variant:"caption"},"Not enough host available to create cluster."):"",n.a.createElement(En,{form_schema:s,formData:c,form_id:"ClusterHostConfigurationForm",method:w.method.POST,action:"#",submitter:this.submitForm,nodeRef:this.bdFormStep1Ref,validate:this.validateForm,variant:"vanilla"},f.a.isEmptyObject(l)?n.a.createElement(ls,{status:"Processing hosts data"}):n.a.createElement(n.a.Fragment,null,n.a.createElement("div",{className:a.inputGroup},n.a.createElement("div",{className:a.labelGroup},n.a.createElement(nr,{id:"master_hosts",title:"Masters",required:!0}),n.a.createElement(lr,{title:ME.masterDescription})),n.a.createElement("div",{className:a.controlGroup},n.a.createElement(Us,{arrayData:[l.availableMasters,l.masters],onMoveItem:this.onHostSelection,searchQuerySuggestions:this.searchQuerySuggestions}),this.state.hostDataError.isErrorState&&n.a.createElement(St.Typography,{variant:"caption",color:"error"},this.state.hostDataError.message))),n.a.createElement("div",{className:a.inputGroup},n.a.createElement("div",{className:a.labelGroup},n.a.createElement(nr,{id:"worker_hosts",title:"Workers"}),n.a.createElement(lr,{title:ME.workerDescription})),n.a.createElement("div",{className:a.controlGroup},n.a.createElement(Us,{arrayData:[l.availableWorkers,l.workers],onMoveItem:this.onHostSelection,searchQuerySuggestions:this.searchQuerySuggestions})))),n.a.createElement("div",{className:a.footer},n.a.createElement(Ue.a,{type:"submit",variant:"contained",disabled:u,color:"primary"},"Next")))):n.a.createElement(ls,{status:"Fetching hosts data"}))}}])&&TE(t.prototype,a),r&&TE(t,r),i}(r.Component);xE(IE,"propTypes",{classes:u.a.object.isRequired,k8shosts:u.a.array,formData:u.a.object,k8s_versions:u.a.array,clusterNames:u.a.array,isEditView:u.a.bool,current_k8scluster_data:u.a.object,updateFormData:u.a.func,step:u.a.number,dataFetched:u.a.bool});var UE=he()(ar.a)(IE),LE=function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t="Updating this field is currently not supported.";return{type:"object",properties:DE(DE({label:{title:"Kubernetes Cluster Detail",type:"object",properties:{name:{type:"string",title:"Name",default:"",description:e?t:ME.labelNameDescription,bd_required:!0,bd_disabled:e},description:{type:"string",title:"Description",default:"",description:e?t:ME.labelDescriptionDescription,bd_disabled:e}}}},e&&{reason:{type:"string",title:"Reason",description:"Enter reason for reconfiguring cluster"}}),{},{k8shosts_config:{type:"array",title:"Host Configuration",bd_required:!0,canCollapse:!0,hidden:!0,items:[{type:"object",properties:{role:{type:"string",default:"master",hidden:!0},hosts:{type:"array",title:"Master",description:ME.masterDescription,default:[],items:{type:"string",enum:[]},uniqueItems:!0,bd_disabled:!0}}},{type:"object",properties:{role:{type:"string",default:"worker",hidden:!0},hosts:{type:"array",title:"Worker",description:ME.workerDescription,default:[],minItems:0,items:{type:"string",enum:[]},uniqueItems:!0,bd_disabled:!0}}}]}})}},BE=function(e){return{footer:{padding:"1rem .5rem ",marginTop:5*e.spacing.unit,display:"flex",justifyContent:"space-between"},prevBtn:{marginRight:2*e.spacing.unit}}};function HE(e){return(HE="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function KE(e,t){for(var a=0;a<t.length;a++){var r=t[a];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function qE(e,t){return(qE=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function VE(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=WE(e);if(t){var n=WE(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return GE(this,a)}}function GE(e,t){return!t||"object"!==HE(t)&&"function"!=typeof t?zE(e):t}function zE(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function WE(e){return(WE=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var JE=er({path:["k8sCreateEditCluster"]}),YE=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&qE(e,t)}(s,e);var t,a,o,i=VE(s);function s(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,s),(t=i.call(this,e)).validateForm=t.validateForm.bind(zE(t)),t.submitForm=t.submitForm.bind(zE(t)),t.handleBack=t.handleBack.bind(zE(t)),t.onChangeCerts=t.onChangeCerts.bind(zE(t)),t.bdFormStep2Ref=n.a.createRef(),t.state={formSchema:{},availableHosts:[],formData:{},certs:{}},t}return t=s,(a=[{key:"componentDidMount",value:function(){var e=this.props,t=e.isEditView,a=e.k8s_versions,r=e.formData,n=e.certs,o=void 0===n?{}:n,i=QE(t,a,this.onChangeCerts);if(t){var s=r.k8s_version;i.properties.k8s_version.enum=[s],i.properties.k8s_version.default=[s],o.root_ca_cert&&(i.properties.root_ca_cert.placeholder=JE.rootCaCertEditPlaceholder,i.properties.root_ca_key.placeholder=JE.rootCaKeyEditPlaceholder)}this.setState({formData:r,formSchema:i,certs:o})}},{key:"submitForm",value:function(e){var t=e.formData,a=e.errors,r=this.state.certs,n=this.props,o=n.updateFormData,i=n.step;a.length||o({data:{formData:t,certs:r},step:i,nextStep:i+1})}},{key:"handleBack",value:function(){var e=this.state,t=e.formData,a=e.certs,r=this.props,n=r.updateFormData,o=r.step;n({data:{formData:f.a.fetchSafeFromObject({path:["current","state","formData"],obj:this.bdFormStep2Ref,default_value:t}),certs:a},step:o,nextStep:o-1})}},{key:"onChangeCerts",value:function(e){var t=this.state.certs,a=e.filesInfo,r=void 0===a?[]:a,n=e.values,o=void 0===n?[]:n,i=e.id,s=o[0]||"",c=f.a.fetchSafeFromObject({path:[0,"content"],obj:r,default_value:""}),l=i.split("_clusterClusterHostConfiguration_").pop(),u=f.a.fetchSafeFromObject({path:["current","state","formData"],obj:this.bdFormStep2Ref,default_value:{}});t[l]=c,u[l]=s,this.setState({certs:t,formData:u})}},{key:"validateForm",value:function(e,t){var a=e.k8s_version,r=void 0===a?"":a,n=e.pod_network_range,o=void 0===n?"":n,i=e.service_network_range,s=void 0===i?"":i,c=e.pod_dns_domain,l=void 0===c?"":c,u=this.state.certs,p=(u=void 0===u?{}:u).root_ca_cert,d=u.root_ca_key;return r||t.k8s_version.addError("Please select Kubernetes version."),o&&!o.match(Fl.network_range)&&t.pod_network_range.addError("Please provide valid network range. It should be in 0.0.0.0/0 format."),s&&!s.match(Fl.network_range)&&t.service_network_range.addError("Please provide valid network range. It should be in 0.0.0.0/0 format."),l&&!l.match(Fl.valid_domain_name)&&t.pod_dns_domain.addError("Please provide valid DNS domain."),!p&&d&&t.root_ca_cert.addError(JE.rootCaCertError),p&&!d&&t.root_ca_key.addError(JE.rootCaKeyError),t}},{key:"render",value:function(){var e=this.props.classes,t=this.state,a=t.formSchema,o=t.formData,i=void 0===o?{}:o;return n.a.createElement(r.Fragment,null,a?n.a.createElement(En,{form_schema:a,formData:i,form_id:"ClusterHostConfigurationForm",method:w.method.POST,action:"#",submitter:this.submitForm,nodeRef:this.bdFormStep2Ref,validate:this.validateForm,variant:"vanilla"},n.a.createElement("div",{className:e.footer},n.a.createElement(Ue.a,{variant:"contained",color:"primary",className:e.prevBtn,onClick:this.handleBack},"Previous"),n.a.createElement(Ue.a,{type:"submit",variant:"contained",color:"primary"},"Next"))):n.a.createElement(ls,null))}}])&&KE(t.prototype,a),o&&KE(t,o),s}(r.Component);!function(e,t,a){t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a}(YE,"propTypes",{classes:u.a.object.isRequired,isEditView:u.a.bool,formData:u.a.object,updateFormData:u.a.func,step:u.a.number,k8s_versions:u.a.array,certs:u.a.object});var $E=he()(BE)(YE),QE=function(e,t,a){var r="Updating this field is currently not supported.";return{type:"object",properties:{k8s_version:{type:"string",title:"Kubernetes Version",default:t[0],enum:t,sort:!1,description:JE.k8sVersionDescription(e),bd_disabled:e,bd_required:!0},pod_network_range:{type:"string",title:"Pod Network Range",default:"10.192.0.0/12",description:e?r:JE.podNetworkRangeDescription,bd_disabled:e},service_network_range:{type:"string",title:"Service Network Range",default:"10.96.0.0/12",description:e?r:JE.serviceNetworkRangeDescription,bd_disabled:e},pod_dns_domain:{type:"string",title:"Pod DNS Domain",default:"cluster.local",description:e?r:JE.podDnsDomainDescription,bd_disabled:e},root_ca_cert:{type:"string",format:"data-url",title:JE.rootCaCertTitle,description:JE.rootCaCertDescription,bd_disabled:e,read:!0,bdOnChange:a},root_ca_key:{type:"string",format:"data-url",title:JE.rootCaKeyTitle,description:JE.rootCaKeyDescription,bd_disabled:e,read:!0,bdOnChange:a}}}};function ZE(e){return(ZE="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function XE(e,t){for(var a=0;a<t.length;a++){var r=t[a];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function ej(e,t){return(ej=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function tj(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=nj(e);if(t){var n=nj(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return aj(this,a)}}function aj(e,t){return!t||"object"!==ZE(t)&&"function"!=typeof t?rj(e):t}function rj(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function nj(e){return(nj=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var oj=er({path:["k8sCreateEditCluster"]}),ij=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&ej(e,t)}(i,e);var t,a,r,o=tj(i);function i(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),(t=o.call(this,e)).submitForm=t.submitForm.bind(rj(t)),t.handleBack=t.handleBack.bind(rj(t)),t.getAddonFormField=t.getAddonFormField.bind(rj(t)),t.bdFormStep3Ref=n.a.createRef(),t.state={formSchema:{},formData:{}},t}return t=i,(a=[{key:"componentDidMount",value:function(){var e=this.props,t=e.formData,a=void 0===t?{}:t,r=e.addons,n=void 0===r?{}:r,o={title:oj.applicationAddonsTitle,type:"object",properties:{addons:{type:"object",properties:{}}}};for(var i in n){var s=n[i],c=s.label,l=(c=void 0===c?{}:c).name,u=void 0===l?"":l,p=c.description,d=void 0===p?"":p,m=s.required,h=!0===(void 0!==m&&m),b=!0===f.a.fetchSafeFromObject({path:[i],obj:a,default_value:!1});o.properties.addons.properties[i]=this.getAddonFormField(u,d,h,b)}this.setState({formData:a,formSchema:o})}},{key:"getAddonFormField",value:function(e,t,a,r){var n=this.props,o=n.isImportClusterForm,i=void 0!==o&&o,s=n.isEditView;return{type:"boolean",title:e,description:t,default:r||a,bd_disabled:a||s&&(i||r)}}},{key:"handleBack",value:function(){var e=this.state.formData,t=this.props,a=t.updateFormData,r=t.step;a({data:f.a.fetchSafeFromObject({path:["current","state","formData"],obj:this.bdFormStep3Ref,default_value:e}),step:r,nextStep:r-1})}},{key:"submitForm",value:function(e){var t=e.formData,a=e.errors,r=this.props,n=r.updateFormData,o=r.step;a.length||n({data:t,step:o,nextStep:o+1})}},{key:"render",value:function(){var e=this.props.classes,t=this.state,a=t.formSchema,r=t.formData,o=void 0===r?{}:r;return n.a.createElement(n.a.Fragment,null,a?n.a.createElement(En,{form_schema:a,formData:o,form_id:"ClusterHostConfigurationForm",method:w.method.POST,action:"#",submitter:this.submitForm,nodeRef:this.bdFormStep3Ref,variant:"vanilla"},n.a.createElement("div",{className:e.footer},n.a.createElement(Ue.a,{variant:"contained",color:"primary",className:e.prevBtn,onClick:this.handleBack},"Previous"),n.a.createElement(Ue.a,{type:"submit",variant:"contained",color:"primary"},"Next"))):n.a.createElement(ls,null))}}])&&XE(t.prototype,a),r&&XE(t,r),i}(r.Component);!function(e,t,a){t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a}(ij,"propTypes",{classes:u.a.object.isRequired,formData:u.a.object,step:u.a.number,isEditView:u.a.bool,updateFormData:u.a.func,addons:u.a.object,isImportClusterForm:u.a.bool});var sj=he()(BE)(ij);function cj(e){return(cj="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function lj(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function uj(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?lj(Object(a),!0).forEach((function(t){vj(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):lj(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function pj(e,t){for(var a=0;a<t.length;a++){var r=t[a];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function dj(e,t){return(dj=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function fj(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=bj(e);if(t){var n=bj(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return mj(this,a)}}function mj(e,t){return!t||"object"!==cj(t)&&"function"!=typeof t?hj(e):t}function hj(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function bj(e){return(bj=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function vj(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}var yj=w.settings,gj=w.RESOURCE_TYPES,_j=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&dj(e,t)}(i,e);var t,a,r,o=fj(i);function i(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),(t=o.call(this,e)).state={selectedHosts:[],currentResources:{}},t.handleNavigation=t.handleNavigation.bind(hj(t)),t.getHostsTableSettings=t.getHostsTableSettings.bind(hj(t)),t}return t=i,(a=[{key:"componentDidMount",value:function(){var e,t=this.props,a=t.k8shosts,r=t.formData,n=[],o=(vj(e={},gj.CPU.ID,{title:"CPU",value:0,unit:""}),vj(e,gj.MEMORY.ID,{title:"Memory",value:0,unit:"GB",convert_gb:yj.MB_to_GB}),vj(e,gj.GPU.ID,{title:"GPU",value:0,unit:""}),vj(e,gj.EPHEMERAL.ID,{title:"Ephemeral Storage",value:0,unit:"GB",convert_gb:yj.MB_to_GB}),vj(e,gj.PERSISTENT.ID,{title:"Persistent Storage",value:0,unit:"GB",convert_gb:yj.MB_to_GB}),e);f.a.fetchSafeFromObject({path:["0","k8shosts_config"],obj:r,default_value:[]}).map((function(e){var t=e.role;e.hosts.map((function(e){var r=f.a.fetchSafeFromObjectArray({arr:a,path:["path"],match:e,default_value:{}});if(!f.a.isEmptyObject(r)){var i=r.cpu,s=r.memory,c=r.gpu,l=r.ephemeral,u=r.persistent;n.push(uj(uj({},r),{},{role:t})),o[gj.CPU.ID].value+=Number(i),o[gj.MEMORY.ID].value+=s,o[gj.GPU.ID].value+=c,o[gj.EPHEMERAL.ID].value+=l,o[gj.PERSISTENT.ID].value+=u}}))})),this.setState({selectedHosts:n,currentResources:o})}},{key:"handleNavigation",value:function(e){(0,this.props.updateFormData)({dataUpdated:!1,nextStep:e})}},{key:"getHostsTableSettings",value:function(){var e=this;return{columns:[{name:"Host",options:{filter:!0}},{name:"Role",options:{filter:!0}},{name:"CPU",options:{filter:!0}},{name:"Memory (GB)",options:{filter:!0}},{name:"GPU",options:{filter:!0}},{name:"Ephemeral (GB)",options:{filter:!0}},{name:"Persistent (GB)",options:{filter:!0}},{name:"Disks",options:{filter:!0,customBodyRender:function(e){var t=JSON.parse(e),a=t.ephemeral_disks,r=t.persistent_disks;return n.a.createElement(n.a.Fragment,null,a.length&&n.a.createElement(St.Typography,null,"Ephemeral Disks: ",a.join(", ")),r.length&&n.a.createElement(St.Typography,null,"Persistent Disks: ",r.join(", ")))}}}],data:this.state.selectedHosts.reduce((function(e,t){var a=t.hostname,r=void 0===a?"":a,n=t.role,o=void 0===n?"":n,i=t.cpu,s=void 0===i?0:i,c=t.memory,l=void 0===c?0:c,u=t.gpu,p=void 0===u?0:u,d=t.ephemeral_disks,m=void 0===d?[]:d,h=t.persistent_disks,b=void 0===h?[]:h,v=t.ephemeral,y=void 0===v?0:v,g=t.persistent,_=void 0===g?0:g;return e.push([r,o,s,f.a.roundNumber(l/yj.MB_to_GB),p,f.a.roundNumber(y/yj.MB_to_GB),f.a.roundNumber(_/yj.MB_to_GB),JSON.stringify({ephemeral_disks:m,persistent_disks:b})]),e}),[]),options:{selectableRows:"none",customToolbar:function(){return n.a.createElement("div",{className:"tableActionButtons"},n.a.createElement(Ue.a,{color:"primary",onClick:function(){return e.handleNavigation(0)}},"Update"))}}}}},{key:"render",value:function(){var e=this,t=this.props,a=t.classes,r=t.step,o=t.totalResources,i=this.state.currentResources,s=this.getHostsTableSettings(),c=f.a.getColorList(Object.keys(i).length);return n.a.createElement("div",{className:a.summary},n.a.createElement(St.Typography,{variant:"h3"},"Cluster Size",n.a.createElement(ka,{title:"selected resources out of total resources"},n.a.createElement("span",{className:se()("icon icon-question-circle",a.icon)}))),f.a.isEmptyObject(i)?"":n.a.createElement(dp.a,{className:a.list},Object.keys(i).map((function(e,t){return n.a.createElement(Wt,{key:e,title:i[e].title,used:i[e].value||0,total:o[e]||0,unit:i[e].unit,color:c[t],convert_gb:i[e].convert_gb||!1})}))),n.a.createElement(St.Typography,{variant:"h3"},"Selected Hosts"),n.a.createElement(sa,s),n.a.createElement("div",{className:a.footer},n.a.createElement(Ue.a,{variant:"contained",color:"primary",name:"previous-btn",onClick:function(){return e.handleNavigation(r-1)}},"Previous"),n.a.createElement(Ue.a,{variant:"contained",color:"primary",name:"submit-btn",onClick:function(){return e.handleNavigation(-1)}},"Submit")))}}])&&pj(t.prototype,a),r&&pj(t,r),i}(r.Component);vj(_j,"propTypes",{classes:u.a.object.isRequired,formData:u.a.object,updateFormData:u.a.func,step:u.a.number,k8shosts:u.a.array,totalResources:u.a.object});var Sj=he()((function(e){return{summary:{maxWidth:e.spacing.formWidth},footer:{padding:"1rem .5rem ",marginTop:5*e.spacing.unit,display:"flex",justifyContent:"space-between"},list:{marginBottom:"".concat(3*e.spacing.unit,"px !important"),width:"100%",justifyContent:"center"},icon:{fontSize:2*e.spacing.unit,paddingLeft:e.spacing.unit}}}))(_j);function kj(e){return(kj="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Oj(e){return function(e){if(Array.isArray(e))return Ej(e)}(e)||function(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||function(e,t){if(!e)return;if("string"==typeof e)return Ej(e,t);var a=Object.prototype.toString.call(e).slice(8,-1);"Object"===a&&e.constructor&&(a=e.constructor.name);if("Map"===a||"Set"===a)return Array.from(e);if("Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a))return Ej(e,t)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Ej(e,t){(null==t||t>e.length)&&(t=e.length);for(var a=0,r=new Array(t);a<t;a++)r[a]=e[a];return r}function jj(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function Dj(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?jj(Object(a),!0).forEach((function(t){Nj(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):jj(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function wj(e,t){for(var a=0;a<t.length;a++){var r=t[a];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Cj(e,t){return(Cj=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Tj(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=Rj(e);if(t){var n=Rj(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return Pj(this,a)}}function Pj(e,t){return!t||"object"!==kj(t)&&"function"!=typeof t?Aj(e):t}function Aj(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Rj(e){return(Rj=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Nj(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}var Fj=er({path:["AuthenticationForm"]}),xj={LDAP:"LDAP",AD:"Active Directory",NONE:"None"},Mj={None:"none",LDAPS:"ldaps",StartTLS:"starttls"},Ij={SEARCH:{VALUE:"search_bind",TITLE:"Search Bind"},DIRECT:{VALUE:"direct_bind",TITLE:"Direct Bind"}},Uj="service_location",Lj="external_group",Bj=["current","state","formData"],Hj=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Cj(e,t)}(i,e);var t,a,r,o=Tj(i);function i(e){var t;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),t=o.call(this,e);var a=e.formData;return t.includeExternalGroup=e.includeExternalGroup,t.submitForm=t.submitForm.bind(Aj(t)),t.validateForm=t.validateForm.bind(Aj(t)),t.onChangeForm=t.onChangeForm.bind(Aj(t)),t.onChangeCaCert=t.onChangeCaCert.bind(Aj(t)),t.checkForNtDomain=t.checkForNtDomain.bind(Aj(t)),t.onAddClick=t.onAddClick.bind(Aj(t)),t.onDropClick=t.onDropClick.bind(Aj(t)),t.handleBack=t.handleBack.bind(Aj(t)),t.bdFormRef=n.a.createRef(),t.cacert="",t.formData=a,t.state={formSchema:qj(a,e.isEditView,t.includeExternalGroup,t.onChangeCaCert,t.onAddClick,t.onDropClick)},t}return t=i,(a=[{key:"componentDidMount",value:function(){var e=this.props.certs,t=(void 0===e?{}:e).cacert,a=void 0===t?"":t;this.cacert=a}},{key:"componentDidUpdate",value:function(e){var t=this.props,a=t.formData,r=t.isEditView;if(!f.a.isEqual(a,e.formData)){var n=qj(a,r,this.includeExternalGroup,this.onChangeCaCert,this.onAddClick,this.onDropClick);this.setState({formSchema:n}),this.formData=a}}},{key:"validateForm",value:function(e,t){var a=this.props.isEditView,r=e.authType,n=void 0===r?"":r,o=e.auth_service_locations,i=void 0===o?[]:o,s=e.user_attribute,c=void 0===s?"":s,l=e.nt_domain_enabled,u=void 0!==l&&l,p=e.nt_domain,d=void 0===p?"":p,m=e.bind_type,h=void 0===m?"":m,b=e.base_dn,v=void 0===b?"":b,y=e.bind_dn,g=void 0===y?"":y,_=e.bind_pwd,S=void 0===_?"":_,k=e.verify_peer,O=void 0!==k&&k,E=e.security_protocol,j=void 0===E?"":E,D=e.cacert_filename,w=void 0===D?"":D;return a||n===xj.NONE||(i.forEach((function(e,a){if(f.a.isEmptyObject(e))t.auth_service_locations[a].addError(Fj.authServiceLocationsError);else{var r=e.host,n=void 0===r?"":r,o=e.port,i=void 0===o?"":o;n&&(Fl.fqdn.test(n)||Fl.ip.test(n))||t.auth_service_locations[a].addError(Fj.authServiceLocationsHostError),i&&Fl.port.test(i)||t.auth_service_locations[a].addError(Fj.authServiceLocationsPortError)}})),c||t.user_attribute.addError(Fj.userAttributeError),u&&!d&&t.nt_domain.addError(Fj.ntDomainError),h===Ij.SEARCH.VALUE&&(v||t.base_dn.addError(Fj.baseDnError),g&&!S&&t.bind_pwd.addError(Fj.bindPwdError)),j!==Mj.None&&(!O||this.cacert||w||t.cacert.addError(Fj.caCertError))),t}},{key:"handleBack",value:function(){var e=this.props,t=e.updateFormData,a=e.step;t({data:{formData:f.a.fetchSafeFromObject({path:["current","state","formData"],obj:this.bdFormRef,default_value:this.formData}),certs:{cacert:this.cacert}},step:a,nextStep:a-1})}},{key:"submitForm",value:function(e){var t=e.formData,a=e.errors;this.formData=t;var r=this.props,n=r.updateFormData,o=r.step;if(!a.length){var i=o+1;n({data:{formData:t,certs:{cacert:this.cacert}},step:o,nextStep:i})}}},{key:"onChangeForm",value:function(e){var t=e.formData;this.formData=t;var a=document.activeElement,r=xl(a);r&&(r.endsWith("bind_type")||r.endsWith("authType")||r.endsWith("nt_domain_enabled"))&&this.checkForNtDomain(t)}},{key:"checkForNtDomain",value:function(e){var t=this.state.formSchema,a=f.a.deepClone(t),r=e.bind_type,n=void 0===r?"":r,o=e.authType,i=void 0===o?"":o,s=e.nt_domain_enabled,c=void 0!==s&&s,l=n===Ij.DIRECT.VALUE&&i===xj.AD;a.definitions.nt_domain_enabled.hidden=!l;var u=l&&c;a.definitions.nt_domain.hidden=!u,a.definitions.nt_domain.bd_required=u,this.setState({formSchema:a})}},{key:"onChangeCaCert",value:function(e){var t=e.filesInfo,a=void 0===t?[]:t,r=e.values,n=(void 0===r?[]:r)[0]||"",o=f.a.fetchSafeFromObject({path:[0,"content"],obj:a,default_value:""}),i=f.a.fetchSafeFromObject({path:[0,"name"],obj:a,default_value:""}),s=f.a.fetchSafeFromObject({path:Bj,obj:this.bdFormRef,default_value:{}});s.cacert=n,s.cacert_filename=i,this.cacert=o,this.formData=s}},{key:"onAddClick",value:function(e){var t=this.state.formSchema,a=f.a.deepClone(t),r=f.a.fetchSafeFromObject({path:Bj,obj:this.bdFormRef,default_value:{}});if(e===Uj){var n=f.a.fetchSafeFromObject({path:["definitions","auth_service_locations"],obj:a,default_value:{}});f.a.isEmptyObject(n)||(n.items.push({$ref:"#/definitions/".concat(Uj)}),r.auth_service_locations.push({}))}else if(e===Lj){var o=f.a.fetchSafeFromObject({path:["definitions","external_groups"],obj:a,default_value:{}});f.a.isEmptyObject(o)||(o.items.push({$ref:"#/definitions/".concat(Lj)}),r.external_groups.push(""))}this.formData=r,this.setState({formSchema:a})}},{key:"onDropClick",value:function(e,t){var a=this.state.formSchema,r=f.a.deepClone(a),n=f.a.fetchSafeFromObject({path:Bj,obj:this.bdFormRef,default_value:{}});if(e===Uj){var o=f.a.fetchSafeFromObject({path:["definitions","auth_service_locations"],obj:r,default_value:{}});f.a.isEmptyObject(o)||(o.items.splice(t,1),n.auth_service_locations.splice(t,1))}else if(e===Lj){var i=f.a.fetchSafeFromObject({path:["definitions","external_groups"],obj:r,default_value:{}});f.a.isEmptyObject(i)||(i.items.splice(t,1),n.external_groups.splice(t,1))}this.formData=n,this.setState({formSchema:r})}},{key:"render",value:function(){var e=this.props,t=e.classes,a=e.isEditView,r=this.state.formSchema;return n.a.createElement(En,{form_schema:r,formData:this.formData,form_id:"AuthenticationForm",submitter:this.submitForm,onChange:this.onChangeForm,validate:a?null:this.validateForm,nodeRef:this.bdFormRef},n.a.createElement("div",{className:t.footer},n.a.createElement(Ue.a,{variant:"contained",color:"primary",className:t.prevBtn,onClick:this.handleBack},"Previous"),n.a.createElement(Ue.a,{type:"submit",variant:"contained",color:"primary"},"Next")))}}])&&wj(t.prototype,a),r&&wj(t,r),i}(r.Component);Nj(Hj,"propTypes",{classes:u.a.object,formData:u.a.object,isEditView:u.a.bool,includeExternalGroup:u.a.bool,updateFormData:u.a.func,step:u.a.number,certs:u.a.object,isK8sClusterForm:u.a.bool}),Nj(Hj,"defaultProps",{idEdit:!1,includeExternalGroup:!1,isK8sClusterForm:!1});var Kj=he()(BE)(Hj),qj=function(){var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},a=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=arguments.length>2&&void 0!==arguments[2]&&arguments[2],n=arguments.length>3?arguments[3]:void 0,o=arguments.length>4?arguments[4]:void 0,i=arguments.length>5?arguments[5]:void 0,s=t.auth_service_locations,c=void 0===s?[{}]:s,l=t.external_groups,u=void 0===l?[{}]:l,p=t.cacert_filename,d=void 0===p?"":p;return{type:"object",properties:{authType:{type:"string",title:Fj.typeTitle,description:Fj.typeDescription,enum:Object.values(xj),default:xj.NONE,sort:!1,bd_disabled:a}},dependencies:{authType:{oneOf:[{properties:{authType:{enum:[xj.NONE]}}},{properties:{authType:{enum:[xj.LDAP]},security_protocol:{$ref:"#/definitions/security_protocol"},auth_service_locations:{$ref:"#/definitions/auth_service_locations"},bind_type:{$ref:"#/definitions/bind_type"}}},{properties:{authType:{enum:[xj.AD]},security_protocol:{$ref:"#/definitions/security_protocol"},auth_service_locations:{$ref:"#/definitions/auth_service_locations"},bind_type:{$ref:"#/definitions/bind_type"}}}]},bind_type:{oneOf:[{properties:{bind_type:{enum:[Ij.SEARCH.VALUE]},user_attribute:{$ref:"#/definitions/user_attribute"},base_dn:{type:"string",title:Fj.baseDnTitle,description:Fj.baseDnDescription,placeholder:Fj.baseDnPlaceholder,bd_widget:"textarea",bd_required:!0,bd_disabled:a},bind_dn:{type:"string",title:Fj.bindDnTitle,description:Fj.bindDnDescription,placeholder:Fj.bindDnPlaceholder,bd_widget:"textarea",bd_disabled:a},bind_pwd:{type:"string",title:Fj.bindPwdTitle,description:Fj.bindPwdTitle,bd_widget:"password",bd_disabled:a}}},{properties:{bind_type:{enum:[Ij.DIRECT.VALUE]},nt_domain_enabled:{$ref:"#/definitions/nt_domain_enabled"},nt_domain:{$ref:"#/definitions/nt_domain"},user_attribute:{$ref:"#/definitions/user_attribute"},user_subtree:{type:"string",title:Fj.userSubtreeTitle,description:Fj.userSubtreeDescription,placeholder:Fj.userSubtreePlaceholder,bd_widget:"textarea",bd_disabled:a}}}]},security_protocol:{oneOf:[{properties:{security_protocol:{enum:[Mj.None]}}},{properties:{security_protocol:{enum:[Mj.LDAPS]},verify_peer:{$ref:"#/definitions/verify_peer"}}},{properties:{security_protocol:{enum:[Mj.StartTLS]},verify_peer:{$ref:"#/definitions/verify_peer"}}}]},verify_peer:{oneOf:[{properties:{verify_peer:{enum:[!0]},cacert:{type:"string",format:"data-url",title:Fj.caCertTitle,description:Fj.caCertDescription,bd_required:!0,bd_disabled:a,read:!0,placeholder:d,bdOnChange:n},cacert_filename:{type:"string",hidden:!0}}},{properties:{verify_peer:{enum:[!1]}}}]},auth_service_locations:{properties:Dj({},r&&{external_groups:{$ref:"#/definitions/external_groups"}})}},definitions:(e={},Nj(e,Uj,{type:"object",singleRow:!0,properties:{host:{type:"string",placeholder:Fj.authServiceLocationsHostPlaceholder,bd_disabled:a,width:"68%"},port:{type:"number",placeholder:Fj.authServiceLocationsPortPlaceholder,bd_disabled:a}}}),Nj(e,"security_protocol",{type:"string",title:Fj.securityProtocolTitle,description:Fj.securityProtocolDescription,enum:Object.values(Mj),enumNames:Object.keys(Mj),default:Mj.None,bd_required:!0,bd_disabled:a,sort:!1}),Nj(e,"auth_service_locations",{type:"array",title:Fj.authServiceLocationsTitle,description:Fj.authServiceLocationsDescription,items:Oj(c.map((function(){return{$ref:"#/definitions/".concat(Uj)}}))),canAdd:!a,addItemTitle:Fj.addServiceLocation,onAddClick:function(){return o(Uj)},onDropClick:function(e){return i(Uj,e)},bd_required:!0,bd_disabled:a}),Nj(e,"bind_type",{type:"string",title:Fj.bindTypeTitle,description:Fj.bindTypeDescription,enum:Object.values(Ij).map((function(e){return e.VALUE})),enumNames:Object.values(Ij).map((function(e){return e.TITLE})),default:Ij.SEARCH.VALUE,bd_required:!0,bd_disabled:a,sort:!1}),Nj(e,"user_attribute",{type:"string",title:Fj.userAttributeTitle,description:Fj.userAttributeDescription,placeholder:Fj.userAttributePlaceholder,bd_required:!0,bd_disabled:a}),Nj(e,"nt_domain_enabled",{type:"boolean",title:Fj.ntDomainEnabledTitle,description:Fj.ntDomainEnabledDescription,bd_disabled:a,hidden:!0}),Nj(e,"nt_domain",{type:"string",title:Fj.ntDomainTitle,description:Fj.ntDomainDescription,bd_disabled:a,hidden:!0}),Nj(e,"verify_peer",{type:"boolean",title:Fj.verifyPeerTitle,description:Fj.verifyPeerDescription,bd_disabled:a,default:!1}),Nj(e,"external_groups",{type:"array",title:Fj.externalGroupsTitle,description:Fj.externalGroupsDescription,items:Oj(u.map((function(){return{$ref:"#/definitions/".concat(Lj)}}))),canAdd:!a,addItemTitle:Fj.addExternalGroup,onAddClick:function(){return o(Lj)},onDropClick:function(e){return i(Lj,e)},bd_disabled:a}),Nj(e,Lj,{type:"string",placeholder:Fj.externalGroupPlaceholder,bd_widget:"textarea",default:"",bd_required:!0,bd_disabled:a}),e)}},Vj=function(e){var t=f.a.deepClone(e);if(!f.a.isEmptyObject(t)){delete t.reorder_after_failover;var a=t.host,r=void 0===a?"":a,n=t.port,o=void 0===n?"":n,i=t.type,s=void 0===i?"None":i;return t.authType=s,delete t.type,r&&(t.auth_service_locations&&t.auth_service_locations.length||(t.auth_service_locations=[{host:r,port:o}]),delete t.host,delete t.port),t}return{}};function Gj(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function zj(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?Gj(Object(a),!0).forEach((function(t){Wj(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):Gj(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function Wj(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}var Jj="Copy from Platform Authenticaiton",Yj=function(e){var t=e.isEditView,a=void 0!==t&&t,r=e.external_authentication,o=void 0===r?{}:r,i=e.classes,s=e.updateFormData,c=e.step,l=o.domains,u=void 0===l?[]:l,p=o.external_domains,d=void 0===p?{}:p,m=o.external_identity_server,h=void 0===m?{}:m,b=o.multiDomain,v=void 0!==b&&b,y=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=v?f.a.fetchSafeFromObject({path:["domains",e],obj:d,default_value:{}}):h,a=Vj(t);if(!f.a.isEmptyObject(a)){var r={formData:zj(zj({},a),{},{external_groups:[""]}),certs:{cacert:a.cacert||""}};s({data:r,step:c,nextStep:c})}},g=u.length?u.map((function(e){return{label:e,onClick:function(){return y(e)}}})):[];return n.a.createElement("div",{className:i.formHeader},n.a.createElement(st.a,{variant:"h5",className:i.title},"AD/LDAP configuration to be used by applications in the cluster"),!f.a.isEmptyObject(o)&&n.a.createElement(n.a.Fragment,null,v?n.a.createElement(_t,{variant:"contained",color:"primary",title:Jj,disabled:a,menuList:g}):n.a.createElement(Ue.a,{disabled:a,onClick:y,variant:"contained",color:"primary"},Jj)))};Yj.propTypes={classes:u.a.object.isRequired,isEditView:u.a.bool,external_authentication:u.a.object,updateFormData:u.a.func,step:u.a.number};var $j=he()((function(e){return{formHeader:{marginBottom:3*e.spacing.unit,width:"100%",maxWidth:e.spacing.formWidth,display:"flex",justifyContent:"space-between",alignItems:"center"},title:{display:"inline-block"}}}))(Yj);function Qj(e){return(Qj="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Zj(e,t){if(null==e)return{};var a,r,n=function(e,t){if(null==e)return{};var a,r,n={},o=Object.keys(e);for(r=0;r<o.length;r++)a=o[r],t.indexOf(a)>=0||(n[a]=e[a]);return n}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(r=0;r<o.length;r++)a=o[r],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(n[a]=e[a])}return n}function Xj(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function eD(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?Xj(Object(a),!0).forEach((function(t){cD(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):Xj(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function tD(e,t){for(var a=0;a<t.length;a++){var r=t[a];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function aD(e,t,a){return t&&tD(e.prototype,t),a&&tD(e,a),e}function rD(e,t){return(rD=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function nD(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=sD(e);if(t){var n=sD(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return oD(this,a)}}function oD(e,t){return!t||"object"!==Qj(t)&&"function"!=typeof t?iD(e):t}function iD(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function sD(e){return(sD=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function cD(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}var lD=w.settings,uD=w.RESOURCE_TYPES,pD=lD.MB_to_GB,dD="Host Configurations",fD="Cluster Configurations",mD="Application Configurations",hD="Authentication",bD="Summary",vD=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&rD(e,t)}(a,e);var t=nD(a);function a(e){var r;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,a),r=t.call(this,e);var n=e.location,o=yh.getClusterCreateParams({location:n}),i=o.id,s=void 0===i?"":i,c=o.operation,l=void 0===c?"create_cluster":c;return r.clusterId=s,r.isEditView="edit_cluster"===l,r.isDataFabricView=n.pathname.includes("create-edit-datafabric-cluster"),r.steps=[dD,fD,hD,mD,bD],r.CancelToken=T.a.CancelToken,r.timeout=null,r.dataUpdates={},r.hostUpdates={},r.certs={},r.state={k8sHostDataFetched:!1,hostTagsFetched:!1,currentClusterDataFetched:!r.isEditView,activeStep:0,formData:{},sysinfoUpdating:!0,applicable_k8s_hosts:[]},r.getMeta=r.getMeta.bind(iD(r)),r.updateFormData=r.updateFormData.bind(iD(r)),r.processData=r.processData.bind(iD(r)),r.processEditData=r.processEditData.bind(iD(r)),r.submitK8sClusterForm=r.submitK8sClusterForm.bind(iD(r)),r.getAddons=r.getAddons.bind(iD(r)),r.checkHostsForSysInfo=r.checkHostsForSysInfo.bind(iD(r)),r.fetchData=r.fetchData.bind(iD(r)),r.processApplicableHosts=r.processApplicableHosts.bind(iD(r)),r}return aD(a,[{key:"getMeta",value:function(e){return{title:"Kubernetes ".concat(e?"Edit Cluster":"Create Cluster"),link:[{rel:"canonical",href:"".concat(w.serverUrl).concat(w.views.k8sCreateCluster.url)}],meta:[{charset:"utf-8"},{name:"description",content:"Kubernetes Cluster Create/Edit Form"}]}}}]),aD(a,[{key:"componentDidMount",value:function(){this.isEditView&&this.fetchData([{name:"currentK8sCluster"}]),this.fetchData([{name:"hostTags"},{name:"k8sManifest"},{name:"k8sHosts",callBack:this.checkHostsForSysInfo},{name:"k8sCluster"}])}},{key:"componentWillUnmount",value:function(){for(var e in clearTimeout(this.timeout),this.hostUpdates)this.hostUpdates[e].cancel("component unmounted");for(var t in this.dataUpdates)this.dataUpdates[t].cancel("component unmounted")}},{key:"fetchData",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],a=this.props.dispatch;t.forEach((function(t){var r=t.name,n=void 0===r?"":r,o=t.callBack,i=void 0===o?null:o,s=t.params;e.dataUpdates[t]=e.CancelToken.source();var c=e.dataUpdates[t].token;switch(n){case"hostTags":a(Q(eD(eD({},oe.HOSTSTAGS),{},{cancelToken:c}))).then((function(){delete e.dataUpdates[t],e.setState({hostTagsFetched:!0})}));break;case"k8sManifest":a(Q(eD(eD({},oe.K8S_MANIFEST),{},{cancelToken:c}))).then((function(){delete e.dataUpdates[t]}));break;case"k8sHosts":a(Q(eD(eD({},oe.K8SHOST_DATA),{},{cancelToken:c}))).then((function(){delete e.dataUpdates[t],i&&i()}));break;case"currentK8sCluster":a(Q(eD(eD({},oe.CURRENT_K8SCLUSTER_DATA("".concat(e.clusterId,"?ext_auth_secret"))),{},{cancelToken:c}))).then((function(){delete e.dataUpdates[t];var a=e.props.current_k8scluster_data;e.updateFormData({data:a,nextStep:0});var r=f.a.fetchSafeFromObject({path:["label","name"],obj:a,default_value:""});e.setState({currentClusterName:r,currentClusterDataFetched:!0})}));break;case"k8sCluster":a(Q(eD(eD({},oe.K8SCLUSTER_DATA(["namespaces"])),{},{cancelToken:c}))).then((function(){delete e.dataUpdates[t];var a=e.props.k8sclusters.map((function(e){return f.a.fetchSafeFromObject({path:["label","name"],obj:e,default_value:""})}));e.setState({clusterNames:a})}));break;case"updateHost":var l=s.host_id;if(delete e.dataUpdates[t],!e.hostUpdates[l]){e.setState({sysinfoUpdating:!0}),e.hostUpdates[l]=e.CancelToken.source();var u=e.hostUpdates[l].token;a(Z(oe.UPDATE_K8SHOST_DATA_ITEM(l,u))).then((function(){delete e.hostUpdates[l],Object.keys(e.hostUpdates).length||e.setState({k8sHostDataFetched:!0},i)}))}}}))}},{key:"processApplicableHosts",value:function(){var e=this,t=this.props,a=t.hostsTags,r=t.k8shosts,n=a.reduce((function(e,t){var a=eD({},e),r=f.a.fetchSafeFromObject({path:w.pathToID,obj:t,default_value:""}),n=f.a.fetchSafeFromObject({path:["label","name"],obj:t,default_value:""});return a[r]={name:n},a}),{}),o=[];r.forEach((function(t){var r=t.status,i=void 0===r?"":r,s=t.hostname,c=void 0===s?"":s,l=t.sysinfo,u=void 0===l?{}:l,p=t.ephemeral_disks,d=void 0===p?[]:p,m=t.persistent_disks,h=void 0===m?[]:m,b=t.tags,v=void 0===b?[]:b,y=t.cluster_id,g=void 0===y?"":y;if("ready"===i||e.isEditView&&e.clusterId===g){var _=f.a.fetchSafeFromObject({path:w.pathToID,obj:t,default_value:""}),S=u.cpu,k=(S=void 0===S?{}:S).cpu_count,O=void 0===k?0:k,E=u.gpu,j=(E=void 0===E?{}:E).gpu_count,D=void 0===j?0:j,C=u.memory,T=(C=void 0===C?{}:C).mem_total,P=void 0===T?0:T,A=u.storage,R=void 0===A?[]:A,N={ephemeral:0,persistent:0},F=f.a.roundNumber(P/lD.B_to_MB,0);["ephemeral","persistent"].map((function(e){var t="ephemeral"===e?d:h;t.length&&t.map((function(t){var a=f.a.fetchSafeFromObjectArray({arr:R,path:["name"],match:t,get:["info","SizeBytes"],default_value:0}),r=f.a.roundNumber(a/lD.B_to_MB,0);N[e]+=r}))}));var x="[cpu: ".concat(O,", mem: ").concat(f.a.roundNumber(F/lD.MB_to_GB),"GB").concat(D?" gpu: "+D:"","]"),M={};a&&(M=function(e){var t=e.tags,a=e.hostsTagsMapping,r={};return f.a.isEmptyObject(a)||t.forEach((function(e){var t=a[e.tag_id].name;r[t]=e.tag_value})),r}({tags:v,hostsTagsMapping:n})),o.push(eD({resources:x,status:i,tags:M,path:_,hostname:c,ephemeral_disks:d,persistent_disks:h,cpu:O,memory:F,gpu:D},N))}})),this.setState({applicable_k8s_hosts:o,k8sHostDataFetched:!0})}},{key:"checkHostsForSysInfo",value:function(){var e=this,t=this.props.k8shosts,a=0;t.map((function(t){var r=f.a.fetchSafeFromObject({path:w.pathToID,obj:t,default_value:""}),n=t.status,o=t.sysinfo,i=t.cluster_id;r&&!o&&(e.isEditView&&e.clusterId===i||"ready"===n)&&(a++,e.fetchData([{name:"updateHost",params:{host_id:r},callBack:e.processApplicableHosts}]))})),a||this.processApplicableHosts()}},{key:"updateFormData",value:function(e){var t=e.data,a=e.dataUpdated,r=void 0===a||a,n=e.step,o=e.nextStep,i=this.state.formData,s=this.props.k8s_versions,c=void 0===s?[]:s,l=f.a.deepClone(i),u=f.a.deepClone(this.certs);if(r)if("number"===f.a.guessType(n)){switch(this.steps[n]){case fD:case hD:var p=t.formData,d=t.certs;u=eD(eD({},u),d),l[n]=p;break;default:l[n]=t}}else{var m=t.label,h=void 0===m?{}:m,b=t.k8shosts_config,v=void 0===b?[]:b,y=t.k8s_version,g=void 0===y?c[0]||"":y,_=t.pod_network_range,S=void 0===_?"10.192.0.0/12":_,k=t.service_network_range,O=void 0===k?"10.96.0.0/12":k,E=t.pod_dns_domain,j=void 0===E?"cluster.local":E,D=t.root_ca_cert,w=t.front_proxy_ca_cert,C=t.etcd_ca_cert,T=t.addons,P=void 0===T?[]:T,A=t.external_identity_server,R=void 0===A?{}:A,N=t.external_groups,F=void 0===N?[""]:N,x=v.reduce((function(e,t){var a=t.node,r=void 0===a?"":a,n=t.role,o=void 0===n?"":n;return e.some((function(e){e.role===o&&e.hosts.push(r)})),e}),[{role:"master",hosts:[]},{role:"worker",hosts:[]}]),M={};P.forEach((function(e){M[e]=!0})),u={root_ca_cert:D,front_proxy_ca_cert:w,etcd_ca_cert:C};var I=Vj(R);u.cacert=I.cacert||"",l={},this.steps.forEach((function(e,t){switch(e){case dD:l[t]={label:h,k8shosts_config:x};break;case fD:l[t]={k8s_version:g,pod_network_range:S,pod_dns_domain:j,service_network_range:O};break;case hD:l[t]=eD(eD({},I),{},{external_groups:F});break;case mD:l[t]={addons:M}}}))}this.certs=u,-1===o?this.setState({formData:l},this.submitK8sClusterForm):this.setState({formData:l,activeStep:o})}},{key:"submitK8sClusterForm",value:function(){var e=this,t=this.state.formData,a=this.processData(t),r=a.label.name,o=w.apiurl.K8SCLUSTER();if(this.isEditView&&(o=w.apiurl.K8S_CLUSTER_CHANGE_TASK(this.clusterId),!(a=this.processEditData(a))))return _n({msg:"Nothing to update",variant:"success"}),!1;R({method:w.method.POST,apiurl:o,data:a}).then((function(){_n({msg:"Successfully ".concat(e.isEditView?"updated":"created"," Kubernetes cluster ").concat(r),variant:"success"}),window.location.href=w.views.managek8sClusters.url})).catch((function(t){var a=f.a.parseAxiosError({error:t}),o=n.a.createElement(ns,{errors:["Failed to ".concat(e.isEditView?"update":"create"," Kubernetes cluster ").concat(r),a]});_n({msg:o,variant:"error"})}))}},{key:"processEditData",value:function(e){var t=this.props.current_k8scluster_data,a={},r=e.reason,n=void 0===r?"":r,o=e.k8shosts_config,i=void 0===o?[]:o,s=e.addons,c=void 0===s?[]:s,l=t.k8shosts_config,u=void 0===l?[]:l,p=t.addons,d=void 0===p?[]:p;if(delete e.reason,!f.a.isEqual(i,u)){var m=[],h=[];i.map((function(e){u.find((function(t){return t.node===e.node}))||m.push(e)})),u.map((function(e){i.find((function(t){return t.node===e.node}))||h.push(e.node)})),m.length&&(a.add_k8shosts_config=m),h.length&&(a.remove_k8shosts=h)}return f.a.isEqual(c,d)||(a.addons=c),!f.a.isEmptyObject(a)&&{operation:"reconfigure",change_spec:a,reason:n}}},{key:"processData",value:function(e){var t={};for(var a in e)if(this.steps[a]!==bD)if(this.steps[a]===hD){var r=e[a],n=r.authType,o=void 0===n?xj.NONE:n,i=r.nt_domain_enabled,s=void 0!==i&&i,c=r.nt_domain,l=void 0===c?"":c,u=r.external_groups,p=void 0===u?[]:u,d=Zj(r,["authType","nt_domain_enabled","nt_domain","external_groups"]);if(o!==xj.NONE){d.type=o,o===xj.AD&&d.bind_type===Ij.DIRECT&&(d.nt_domain_enabled=s,s&&(d.nt_domain=l));var m=d.auth_service_locations;1===m.length&&(d.host=m[0].host,d.port=m[0].port,delete d.auth_service_locations),Object.assign(t,{external_identity_server:d,external_groups:p.filter((function(e){return!!e}))})}}else Object.assign(t,e[a]);var h=t.k8shosts_config,b=t.addons,v=h.reduce((function(e,t){var a=t.role,r=t.hosts;return(void 0===r?[]:r).map((function(t){var r={role:a,node:t};e.push(r)})),e}),[]);if(t.k8shosts_config=v,!f.a.isEmptyObject(this.certs))for(var y in this.certs)"cacert"===y?this.certs.cacert?t.external_identity_server.cacert=this.certs.cacert:t.external_identity_server&&delete t.external_identity_server.cacert:t[y]=this.certs[y];return t.addons=this.getAddonList(b),t}},{key:"getAddonList",value:function(e){var t=[];for(var a in e)!0===e[a]&&t.push(a);return t}},{key:"getAddons",value:function(e,t){var a=f.a.fetchSafeFromObject({path:["1","k8s_version"],obj:e,default_value:""});if(a){var r=f.a.fetchSafeFromObject({path:["version_info",a,"addons"],obj:t,default_value:[]});return yh.getApplicableAddonsObj({k8s_manifest:t,addonIds:r})}return{}}},{key:"render",value:function(){var e=this.getMeta(this.isEditView),t=this.props,a=t.k8s_versions,r=t.k8s_manifest,o=t.current_k8scluster_data,i=t.external_authentication,s=t.totalResources,c=this.state,l=c.formData,u=c.clusterNames,p=c.currentClusterName,d=void 0===p?"":p,f=c.activeStep,m=c.k8sHostDataFetched,h=c.certs,b=c.currentClusterDataFetched,v=c.hostTagsFetched,y=c.applicable_k8s_hosts,g=this.getAddons(l,r);return n.a.createElement("div",{className:"K8sCreateEditClusterPage"},n.a.createElement(Al.a,{title:e.title,description:e.description,link:e.link,meta:e.meta}),n.a.createElement(Nt,{title:this.isEditView?"Edit Kubernetes Cluster ".concat(d):"Create Kubernetes Cluster"}),n.a.createElement(gE.a,{activeStep:f},this.steps.map((function(e){return n.a.createElement(SE.a,{key:e},n.a.createElement(OE.a,null,e))}))),this.steps[f]===dD&&n.a.createElement(n.a.Fragment,null,b?n.a.createElement(UE,{formData:l[f]||{},step:f,isEditView:this.isEditView,updateFormData:this.updateFormData,k8shosts:y||[],clusterNames:u,currentClusterName:d,dataFetched:m&&v,current_k8scluster_data:o}):n.a.createElement(ls,{status:"Fetching current cluster's data"})),this.steps[f]===fD&&n.a.createElement($E,{formData:l[f]||{},step:f,isEditView:this.isEditView,k8s_versions:a,updateFormData:this.updateFormData,certs:h}),this.steps[f]===hD&&n.a.createElement(n.a.Fragment,null,n.a.createElement($j,{isEditView:this.isEditView,external_authentication:i,updateFormData:this.updateFormData,step:f}),n.a.createElement(Kj,{formData:l[f]||{},step:f,isEditView:this.isEditView,updateFormData:this.updateFormData,includeExternalGroup:!0})),this.steps[f]===mD&&n.a.createElement(sj,{formData:l[f]||{},step:f,isEditView:this.isEditView,updateFormData:this.updateFormData,addons:g}),this.steps[f]===bD&&n.a.createElement(Sj,{formData:l||{},step:f,k8shosts:y||[],updateFormData:this.updateFormData,totalResources:s}))}}]),a}(r.Component);cD(vD,"propTypes",{classes:u.a.object.isRequired,current_k8scluster_data:u.a.object,dispatch:u.a.func.isRequired,location:u.a.object,k8shosts:u.a.array,k8sclusters:u.a.array,k8s_versions:u.a.array,k8s_manifest:u.a.object,hostsTags:u.a.array,external_authentication:u.a.object,totalResources:u.a.object});var yD=d()(he()((function(e){return{footer:{padding:"1rem .5rem ",marginTop:5*e.spacing.unit,display:"flex",justifyContent:"space-between",backgroundColor:e.palette.gray200},prevBtn:{marginRight:2*e.spacing.unit}}}),{name:"K8sCreateEditClusterPage"}),Object(s.b)((function(e){var t,a=e.stats_data,r=(a=void 0===a?{}:a).g_config_data,n=(r=void 0===r?{}:r).k8s_versions,o=void 0===n?[]:n,i=r._embedded,s=(i=void 0===i?{}:i).auth,c=void 0===s?{}:s,l=a.g_config_data_v1,u=void 0===l?{}:l,p=e.page_data,d=void 0===p?{}:p,m=f.a.fetchSafeFromObject({path:["k8shost_list","_embedded","k8shosts"],obj:d,default_value:[]}),h=f.a.fetchSafeFromObject({path:["k8scluster_list","_embedded","k8sclusters"],obj:d,default_value:[]}),b=f.a.fetchSafeFromObject({path:["k8s_manifest"],obj:d,default_value:{}}),v=f.a.fetchSafeFromObject({path:["hosts_tags","_embedded","tags"],obj:d,default_value:[]}),y=d.current_k8scluster_data||{},g=tE.sortK8sVersions(o),_=c.domains,S=void 0===_?[]:_,k=c.external_domains,O=void 0===k?{}:k,E=c.external_identity_server,j=void 0===E?{}:E,D={};f.a.isEmptyObject(j)?S.length&&(D={domains:S,external_domains:O,multiDomain:!0}):D={external_identity_server:j,multiDomain:!1};var C=u.objects,T=(C=void 0===C?{}:C).total_tenant_storage,P=void 0===T?0:T,A=C.system_quota,R=void 0===A?[]:A,N=P*pD,F=(cD(t={},uD.CPU.ID,0),cD(t,uD.MEMORY.ID,0),cD(t,uD.GPU.ID,0),cD(t,uD.EPHEMERAL.ID,0),cD(t,uD.PERSISTENT.ID,N),cD(t,uD.TENANT_STORAGE.ID,N),t);return R.length&&R.forEach((function(e){if(e.tenant_type===w.TENANT_TYPES.K8S){var t=e.cores,a=void 0===t?0:t,r=e.memory_gb,n=void 0===r?0:r,o=e.gpus,i=void 0===o?0:o,s=e.ephemeral_storage_size_gb,c=void 0===s?0:s;F[uD.CPU.ID]=a,F[uD.MEMORY.ID]=n*pD,F[uD.GPU.ID]=i,F[uD.EPHEMERAL.ID]=c*pD}})),{k8shosts:m,k8sclusters:h,k8s_versions:g,k8s_manifest:b,hostsTags:v,current_k8scluster_data:y,external_authentication:D,totalResources:F}})))(vD);function gD(e){return(gD="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function _D(){return(_D=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var r in a)Object.prototype.hasOwnProperty.call(a,r)&&(e[r]=a[r])}return e}).apply(this,arguments)}function SD(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function kD(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?SD(Object(a),!0).forEach((function(t){TD(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):SD(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function OD(e,t){for(var a=0;a<t.length;a++){var r=t[a];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function ED(e,t){return(ED=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function jD(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=CD(e);if(t){var n=CD(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return DD(this,a)}}function DD(e,t){return!t||"object"!==gD(t)&&"function"!=typeof t?wD(e):t}function wD(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function CD(e){return(CD=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function TD(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function PD(e){return function(e){if(Array.isArray(e))return AD(e)}(e)||function(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||function(e,t){if(!e)return;if("string"==typeof e)return AD(e,t);var a=Object.prototype.toString.call(e).slice(8,-1);"Object"===a&&e.constructor&&(a=e.constructor.name);if("Map"===a||"Set"===a)return Array.from(e);if("Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a))return AD(e,t)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function AD(e,t){(null==t||t>e.length)&&(t=e.length);for(var a=0,r=new Array(t);a<t;a++)r[a]=e[a];return r}var RD=er({path:["HostTable"]}),ND=er({path:["updateTagFormMsg"]}),FD=$l.HOSTS_DELETABLE_STATES,xD=void 0===FD?[]:FD,MD=$l.HOSTS_INSTALLABLE_STATES,ID=void 0===MD?[]:MD,UD=ID.filter((function(e){return"ready"!==e})),LD=[].concat(PD(ID),["configured","config_error"]),BD={Title:"",formSchema:{},methodActions:[{method:w.method.POST,action:"#",data:"FORM_DATA"}]},HD=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&ED(e,t)}(i,e);var t,a,r,o=jD(i);function i(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),(t=o.call(this,e)).CancelToken=T.a.CancelToken,t.timeouts={},t.state={selectableDisks:[],modalDiskData:[],updateTagform:BD,hostIndexes:[],filteredHostIndexes:[],sort:{colId:0,sortDirection:"asc"},searchText:"",page:0,rowsPerPage:10,rowsSelected:[]},t.clusterNameDict={},t.hostRoleDict={},t.host_updating={},t.getHostLabelOptions=t.getHostLabelOptions.bind(wD(t)),t.deleteK8sHostList=t.deleteK8sHostList.bind(wD(t)),t.deleteK8sHost=t.deleteK8sHost.bind(wD(t)),t.getTagNameById=t.getTagNameById.bind(wD(t)),t.closeEditDiskModal=t.closeEditDiskModal.bind(wD(t)),t.prepareModalDiskData=t.prepareModalDiskData.bind(wD(t)),t.onModalClose=t.onModalClose.bind(wD(t)),t.installK8sHostList=t.installK8sHostList.bind(wD(t)),t.installK8sHost=t.installK8sHost.bind(wD(t)),t.commissionDecommissionDataNode=t.commissionDecommissionDataNode.bind(wD(t)),t.updateHostTag=t.updateHostTag.bind(wD(t)),t.onAddTagClick=t.onAddTagClick.bind(wD(t)),t.onDropTagClick=t.onDropTagClick.bind(wD(t)),t.onChangeUpdateTagForm=t.onChangeUpdateTagForm.bind(wD(t)),t.preProcessUpdateTagData=t.preProcessUpdateTagData.bind(wD(t)),t.validateForm=t.validateForm.bind(wD(t)),t.onDiskSelection=t.onDiskSelection.bind(wD(t)),t.updateHostIndexes=t.updateHostIndexes.bind(wD(t)),t.updateFilteredHostIndexes=t.updateFilteredHostIndexes.bind(wD(t)),t.sortFilteredHostIndexes=t.sortFilteredHostIndexes.bind(wD(t)),t.onTableChange=t.onTableChange.bind(wD(t)),t.onRowsSelect=t.onRowsSelect.bind(wD(t)),t.getClusterNameByID=t.getClusterNameByID.bind(wD(t)),t.updateClusterNameDict=t.updateClusterNameDict.bind(wD(t)),t.updateHostRoleDict=t.updateHostRoleDict.bind(wD(t)),t.getHostInfoByID=t.getHostInfoByID.bind(wD(t)),t.onHostDataUpdated=t.onHostDataUpdated.bind(wD(t)),t.bdDialogRef=n.a.createRef(),t.bdModalEditDiskChildRef=n.a.createRef(),t.bdModalFormRef=n.a.createRef(),t.formData={},t}return t=i,(a=[{key:"componentDidMount",value:function(){"K8sHostPage"===this.props.page_name&&this.updateClusterNameDict(),this.updateHostRoleDict(),this.updateHostIndexes()}},{key:"componentWillUnmount",value:function(){for(var e in this.timeouts)clearTimeout(this.timeouts[e])}},{key:"componentDidUpdate",value:function(){this.state.hostIndexes.length!==this.props.k8sHosts.length&&this.updateHostIndexes()}},{key:"updateHostIndexes",value:function(){var e=this,t=this.props.k8sHosts,a=PD(Array(t.length).keys());this.setState({hostIndexes:a},(function(){e.updateFilteredHostIndexes()}))}},{key:"updateFilteredHostIndexes",value:function(){var e=this,t=this.state,a=t.searchText,r=t.hostIndexes,n=t.sort,o=this.props.k8sHosts,i=a?r.filter((function(e){var t=o[e];return JSON.stringify(t).includes(a)})):PD(r);this.setState({filteredHostIndexes:i},(function(){f.a.isEmptyObject(n)?e.processForHostDataUpdate():e.sortFilteredHostIndexes()}))}},{key:"sortFilteredHostIndexes",value:function(){var e=this,t=this.state,a=t.filteredHostIndexes,r=t.sort,n=this.props,o=n.k8sHosts,i="k8sClusterDashboardPage"===n.page_name,s=r.colId,c=r.sortDirection,l=PD(a),u=function(t){var a=t.status,r=void 0===a?"":a,n=t.status_message,o=void 0===n?"":n,i=t.storage_commission_status,s=void 0===i?"":i;return e.getHostLabelOptions({status:r,status_message:o,storage_commission_status:s}).title||""},p=l.sort((function(t,a){var r=o[t],n=o[a],l="".concat(r.ipaddr,"(").concat(n.hostname,")"),p="".concat(n.ipaddr,"(").concat(n.hostname,")");if([1,3,4,5].includes(s))switch(s){case 1:if(i){var d=f.a.fetchSafeFromObject({path:w.pathToID,obj:r,default_value:""}),m=f.a.fetchSafeFromObject({path:w.pathToID,obj:n,default_value:""});l=f.a.fetchSafeFromObject({path:[d,"role"],obj:e.hostRoleDict,default_value:""}),p=f.a.fetchSafeFromObject({path:[m,"role"],obj:e.hostRoleDict,default_value:""})}else l=JSON.stringify(r.tags),p=JSON.stringify(n.tags);break;case 3:i?(l=u(r),p=u(n)):(l=e.getClusterNameByID(r.cluster_id||""),p=e.getClusterNameByID(n.cluster_id||""));break;case 4:i||(l=r.k8s_version||"",p=n.k8s_version||"");break;case 5:i||(l=u(r),p=u(n))}return l.toLowerCase()<p.toLowerCase()?"asc"===c?-1:1:l.toLowerCase()>p.toLowerCase()?"asc"===c?1:-1:0}));this.setState({filteredHostIndexes:p},this.processForHostDataUpdate)}},{key:"updateClusterNameDict",value:function(){var e=this.props.k8sClusters;this.clusterNameDict=e.reduce((function(e,t){var a=kD({},e),r=f.a.fetchSafeFromObject({path:["_links","self","href"],obj:t,default_value:""}),n=f.a.fetchSafeFromObject({path:["label","name"],obj:t,default_value:""});if(!0===f.a.fetchSafeFromObject({path:["imported"],obj:t,default_value:!1})){var o=f.a.fetchSafeFromObject({path:["type"],obj:t,default_value:""}),i=f.a.fetchSafeFromObject({path:[o],obj:tE.importedClusterTypesMap,default_value:"-"});n+=" (Imported ".concat(i," Cluster)")}return a[r]=n,a}),{})}},{key:"getClusterNameByID",value:function(e){if(!e)return"Not Assigned";if(f.a.isEmptyObject(this.clusterNameDict)){this.updateClusterNameDict();var t=this.props.k8sClusters,a=f.a.fetchSafeFromObjectArray({arr:t,path:["_links","self","href"],match:e,get:[],default_value:{}}),r=a.label,n=(r=void 0===r?{}:r).name,o=void 0===n?"":n,i=a.imported,s=void 0!==i&&i,c=a.type,l=void 0===c?"":c,u=o;if(!0===s){var p=f.a.fetchSafeFromObject({path:[l],obj:tE.importedClusterTypesMap,default_value:"-"});u+=" (Imported ".concat(p," Cluster)")}return u}return this.clusterNameDict[e]||""}},{key:"updateHostRoleDict",value:function(){var e=this.props.k8sClusters;this.hostRoleDict=e.reduce((function(e,t){var a=kD({},e),r=f.a.fetchSafeFromObject({path:["k8shosts_config"],obj:t,default_value:[]}),n=!0===f.a.fetchSafeFromObject({path:["imported"],obj:t,default_value:!1});return r.map((function(e){var t=f.a.fetchSafeFromObject({path:["node"],obj:e,default_value:""}),r=f.a.fetchSafeFromObject({path:["role"],obj:e,default_value:""});a[t]={role:r,isClusterImported:n}})),a}),{})}},{key:"getHostInfoByID",value:function(e){return e?f.a.isEmptyObject(this.hostRoleDict)?(this.updateClusterNameDict(),this.hostRoleDict[e]||""):this.hostRoleDict[e]||"":""}},{key:"processForHostDataUpdate",value:function(){var e=this,t=this.state,a=t.page,r=t.rowsPerPage,n=t.filteredHostIndexes,o=this.props,i=o.k8sHosts,s=o.updateHostData,c=r*a,l=c+2*r;(n.length>r?n.slice(c,l):PD(n)).map((function(t){var a=i[t],r=f.a.fetchSafeFromObject({path:w.pathToID,obj:a,default_value:""});if(a.sysinfo){var n=$l.liveUpdateHostInterval(a,"k8s");n&&(e.timeouts[r]=setTimeout((function(){s(r,e.onHostDataUpdated,t)}),1e3*n))}else s(r,e.onHostDataUpdated,t)}))}},{key:"onHostDataUpdated",value:function(e,t,a){var r=this,n=this.props.updateHostData,o=this.state,i=o.page,s=o.rowsPerPage,c=o.filteredHostIndexes,l=s*i,u=l+2*s;if((c.length>s?c.slice(l,u):PD(c)).includes(a)){var p=$l.liveUpdateHostInterval(t,"k8s");p&&(this.timeouts[e]=setTimeout((function(){n(e,r.onHostDataUpdated,a)}),1e3*p))}}},{key:"onTableChange",value:function(e,t){var a=t.page,r=t.searchText,n=t.columns,o=t.rowsPerPage,i=t.selectedRows;switch(e){case"sort":var s={};n.some((function(e,t){var a=e.sortDirection,r=void 0===a?"":a;if("none"!==r)return s={colId:t,sortDirection:r},!0})),this.setState({sort:s,rowsSelected:[]},this.sortFilteredHostIndexes);break;case"changePage":this.setState({page:a,rowsSelected:[]},this.processForHostDataUpdate);break;case"changeRowsPerPage":this.setState({rowsPerPage:o,rowsSelected:[]},this.processForHostDataUpdate);break;case"search":this.setState({searchText:r,rowsSelected:[]},this.updateFilteredHostIndexes);break;case"rowsSelect":var c=i.data.map((function(e){return e.index}));this.setState({rowsSelected:c})}}},{key:"getTagNameById",value:function(e){var t=this.props.hostsTags,a=PD(void 0===t?[]:t);return f.a.fetchSafeFromObjectArray({arr:a,path:["_links","self","href"],match:e,get:["label","name"],default_value:e.split("/").pop()})}},{key:"getHostsTableSettings",value:function(){var e=this,t=this.state,a=t.page,r=t.rowsPerPage,o=t.searchText,i=t.filteredHostIndexes,s=t.sort,c=t.rowsSelected,l=this.props,u=l.k8sHosts,p=l.page_name,d=l.classes,m=l.disks_selection,h=l.role_name,b=l.tagsInfo,v="k8sClusterDashboardPage"===p,y=(void 0===b?{}:b).hostsTagsFetched,g=void 0!==y&&y,_=s.colId,S=s.sortDirection,k=a*r;return{columns:[{name:"Host",options:kD({filter:!0},0===_?{sortDirection:S}:{})}].concat(PD(v?[{name:"Role",options:kD({filter:!0},1===_?{sortDirection:S}:{})}]:[]),PD(v?[]:[{name:"Tags",options:kD(kD({filter:!0},1===_?{sortDirection:S}:{}),{},{customBodyRender:function(t){var a=JSON.parse(t);return n.a.createElement("div",{className:"py-2"},a.length?a.map((function(t){var a=t.tag_id,r=void 0===a?"":a,o=t.tag_value,i=void 0===o?"":o,s=e.getTagNameById(r);return n.a.createElement(st.a,{key:r},"".concat(s).concat(i?":":""," ").concat(i))})):"")}})}]),[{name:"Details",options:{sort:!1,filter:!1,customBodyRender:function(e){var t,a,r=JSON.parse(e),o=r.status,i=r.sysinfoAvailable,s=r.sysinfo,c=r.ephemeral_disks,l=r.persistent_disks,u=r.storage_commission_status,p=r.bds_network_publicinterface,d=r.classes,m=r.hostRole,h="unknown",b="unknown";return i&&(h=s.memory?f.a.roundNumber(s.memory.mem_total/w.settings.B_to_GB):"unknown",b=s.cpu?s.cpu.cpu_count:"unknown",t=s.gpu?s.gpu.gpu_count:"",a="configured"!==o&&s.keys&&s.keys.reported_worker_public_key?Nl()(s.keys.reported_worker_public_key):""),n.a.createElement("div",{className:"py-2 position-relative"},!v&&m?n.a.createElement(st.a,{variant:"body1"},"Role: ",m):"",n.a.createElement(st.a,{variant:"body1"},"Memory (GB): ",h),n.a.createElement(st.a,{variant:"body1"},"Cores : ",b),t?n.a.createElement(st.a,{variant:"body1"},"GPU Devices: ",t):"",p?n.a.createElement(st.a,{variant:"body1"},"Primary NIC: ",p):"",a?n.a.createElement(st.a,{variant:"body1"},"Fingerprint: ",a):"",u?n.a.createElement(st.a,{variant:"body1",className:d.hdfsStatus},"Persistent Storage Status:",n.a.createElement(st.a,{className:"Decommissioned"===u?d.decommissionedState:d.mLeft,variant:"caption"},u)):"",i?n.a.createElement(Ia,null,c&&c.length?n.a.createElement(st.a,{variant:"body1"},"Ephemeral Disks: ",c.toString()):"",l&&l.length?n.a.createElement(st.a,{variant:"body1"},"Persistent Disks: ",l.toString()):""):n.a.createElement(ls,{size:"1rem"}))}}}],PD(v?[]:[{name:"Cluster Name",options:kD({filter:!0},3===_?{sortDirection:S}:{})},{name:"Version",options:kD({filter:!0},4===_?{sortDirection:S}:{})}]),[{name:"Status",options:kD(kD({filter:!0},_===(v?3:5)?{sortDirection:S}:{}),{},{customBodyRender:function(t){var a=JSON.parse(t),r=e.getHostLabelOptions(a);return n.a.createElement(Qa,r)}})}],PD(v?[]:[{name:"Actions",options:{filter:!1,sort:!1,customBodyRender:function(t){var a=JSON.parse(t),r=a.host_id,o=a.status,i=a.ipaddr,s=a.hostname,c=a.storage_commission,l=a.storage_commission_status,u=a.sysinfoAvailable,p=a.isClusterImported,d=a.idx,f="Decommissioned"===l?"recommission":"decommission";if(!$l.isTransientStatus(o,l))return n.a.createElement("div",{className:"row-action-btns"},UD.includes(o)&&u&&n.a.createElement(ka,{title:"Edit Disks",variant:"primary"},n.a.createElement("span",{className:se()("icon","icon-rect-link","icon-pencil3"),onClick:function(){e.prepareModalDiskData(r),e.bdModalEditDiskChildRef.current.handleOpen()}})),["Normal","Error"].includes(l)&&n.a.createElement(ka,{title:"Decommission data node",variant:"warning"},n.a.createElement("span",{className:se()("icon","icon-rect-link","action-link","icon-unlink2"),onClick:function(){var t={callback:e.commissionDecommissionDataNode,context:{host_id:r,ipaddr:i,hostname:s,op:f,idx:d},title:"Decommission k8s host ("+i+")",description:RD.decommssionDescription};e.bdDialogRef.current.handleOpen(t)}})),"Decommissioned"===l&&n.a.createElement(ka,{title:"Recommission data node",variant:"warning"},n.a.createElement("span",{className:se()("icon","icon-rect-link","action-link","icon-link2"),onClick:function(){var t={callback:e.commissionDecommissionDataNode,context:{host_id:r,ipaddr:i,hostname:s,op:f,idx:d},title:"Recommission k8s host ("+i+")",description:RD.recommssionDescription};e.bdDialogRef.current.handleOpen(t)}})),xD.includes(o)&&!c&&n.a.createElement(ka,{title:"Delete",variant:"error"},n.a.createElement("span",{className:"icon icon-rect-link icon-trash2",onClick:function(){var t={callback:e.deleteK8sHost,context:{host_id:r,ipaddr:i,idx:d},title:"Delete k8s host ("+i+")",description:RD.deleteDescription};e.bdDialogRef.current.handleOpen(t)}})),g&&!p&&LD.includes(o)&&n.a.createElement(ka,{title:"Update Tag",variant:"success"},n.a.createElement("span",{className:"icon icon-rect-link icon-tag",onClick:function(){e.updateHostTag({host_id:r,idx:d})}})))}}}])),data:i.slice(k,k+r).map((function(t){var a=u[t]||{},r=a.ipaddr,n=void 0===r?"":r,o=a.hostname,i=void 0===o?"":o,s=a.status,c=void 0===s?"":s,l=a.sysinfo,p=void 0===l?{}:l,h=a.status_message,b=void 0===h?"":h,y=a.cluster_id,g=void 0===y?"":y,_=a.tags,S=void 0===_?[]:_,k=a.storage_commission,O=void 0!==k&&k,E=a.storage_commission_status,j=void 0===E?"":E,D=a.k8s_version,w=void 0===D?"Not Assigned":D,C=a.propinfo,T=(C=void 0===C?{}:C).bds_network_publicinterface,P=void 0===T?"":T,A="array"===f.a.guessType(p)||!f.a.isEmptyObject(p),R=f.a.fetchSafeFromObject({path:["_links","self","href"],obj:a,default_value:""}),N=f.a.fetchSafeFromObject({path:[R],obj:m,default_value:{}}),F=f.a.isEmptyObject(N),x=[],M=[];a.hasOwnProperty("storage_commission")?(x=a.persistent_disks,M=a.ephemeral_disks):(x=!F&&N.persistent_disks.map((function(e){return e?e.Name:""})),M=!F&&N.ephemeral_disks.map((function(e){return e?e.Name:""})));var I=e.getClusterNameByID(g),U=!1,L="";if(g){var B=e.getHostInfoByID(R);L=B.role,U=B.isClusterImported}return["".concat(n," ").concat(i?" ( ".concat(i," )"):"")].concat(PD(v?[L]:[]),PD(v?[]:[JSON.stringify(S)]),[JSON.stringify({status:c,sysinfoAvailable:A,sysinfo:p,ephemeral_disks:M,persistent_disks:x,storage_commission_status:j,bds_network_publicinterface:P,classes:d,hostRole:L})],PD(v?[]:[I]),PD(v?[]:[w]),[JSON.stringify({status:c,status_message:b,storage_commission_status:j})],PD(v?[]:[JSON.stringify({host_id:R,status:c,ipaddr:n,hostname:i,storage_commission:O,storage_commission_status:j,sysinfoAvailable:A,isClusterImported:U,idx:t})]))})),options:{customToolbar:function(){return v||"Site Admin"!==h?"":n.a.createElement("div",{className:"tableActionButtons"},n.a.createElement(Ue.a,{variant:"contained",color:"primary",disabled:!0,className:d.hostsActionBtns},"Install"),n.a.createElement(Ue.a,{variant:"contained",color:"primary",disabled:!0,className:d.hostsActionBtns},"Delete"))},customToolbarSelect:function(t){var a=e.props.classes,r=e.onRowsSelect(t);return n.a.createElement("div",{className:a.tableActionButtonsSelected},r.install?n.a.createElement(Ue.a,{variant:"contained",color:"primary",className:a.hostsActionBtns,onClick:function(){var a={callback:e.installK8sHostList,context:t,title:"Install selected host(s).",description:RD.installationConfirmation};e.bdDialogRef.current.handleOpen(a)}},"Install"):n.a.createElement(Ue.a,{variant:"contained",color:"primary",disabled:!0,className:a.hostsActionBtns},"Install"),r.delete?n.a.createElement(Ue.a,{variant:"contained",color:"secondary",className:a.hostsActionBtns,onClick:function(){var a={callback:e.deleteK8sHostList,context:t,title:"Delete selected host(s)",description:RD.deleteDescription};e.bdDialogRef.current.handleOpen(a)}},"Delete"):n.a.createElement(Ue.a,{variant:"contained",color:"primary",disabled:!0,className:a.hostsActionBtns},"Delete"))},selectableRows:v?"none":"multiple",page:a,rowsPerPage:r,searchText:o,count:i.length,search:o||i.length>10,serverSide:!0,onTableChange:this.onTableChange,rowsSelected:c}}}},{key:"onRowsSelect",value:function(e){var t={install:!0,delete:!0};return e.data.some((function(e){var a=JSON.parse(e.rowData[e.rowData.length-1]);if(t.install&&!UD.includes(a.status)&&(t.install=!1),t.delete&&($l.isTransientStatus(a.status,a.storage_commission_status)||a.storage_commission||!xD.includes(a.status))&&(t.delete=!1),!t.install&&!t.delete)return!0})),t}},{key:"getHostLabelOptions",value:function(e){var t=e.status,a=e.status_message,r=e.storage_commission_status,n={status:t,title:t};switch("Fetching HDFS Status"===r&&(n={title:"Fetching Storage Status",status:r}),"Decommissioning"===r&&(n={title:r,status:r}),t){case"bundle":n.title="running bundle";break;case"storage_pending":n.title="phase 1 of 2 completed",n.tooltip="Make any modifications to disk selections and then select Install to complete host setup";break;case"storage_configuring":n.title="storage configuring";break;case"nagios_mon_pending":n.title="nagios/monitoring pending";break;case"nagios_mon":n.title="nagios/monitoring configuring";break;case"storage_error":n.title="storage error",a&&(n.tooltip=a);break;case"keys_error":n.title="keys error",a&&(n.tooltip=a);break;case"storage_commission_status":n.title=r;break;case"upgrade_error":n.title="upgrade error",a&&(n.tooltip=a);break;case"config_error":n.title="config error",a&&(n.tooltip=a);break;case"prechecks_error":n.title="Prechecks error",a&&(n.tooltip=a);break;case"error":n.tooltip=a;break;default:n.title}return a&&(n.alert_title=a),n}},{key:"installK8sHostList",value:function(e){var t=this;e.data.some((function(e){var a=JSON.parse(e.rowData[e.rowData.length-1]),r=a.host_id,n=a.ipaddr,o=a.hostname,i=a.idx;t.installK8sHost({host_id:r,ipaddr:n,hostname:o,idx:i})}))}},{key:"installK8sHost",value:function(e){var t=this,a=e.host_id,r=e.ipaddr,o=e.hostname,i=e.idx,s=this.props,c=s.disks_selection,l=void 0===c?{}:c,u=s.updateHostData,p="".concat(r," (").concat(o,")"),d=f.a.fetchSafeFromObject({path:[a],obj:l,default_value:{}}),m={op:"storage",op_spec:{ephemeral_disks:d.ephemeral_disks.map((function(e){return e.Name})),persistent_disks:d.persistent_disks.map((function(e){return e.Name}))}};R({apiurl:a,method:w.method.POST,data:m}).then((function(){u(a,t.onHostDataUpdated,i),_n({msg:"Host installation process started successfully ( ".concat(p," )."),variant:"success"})})).catch((function(e){var t=f.a.parseAxiosError({error:e}),a=n.a.createElement(ns,{errors:["Failed to install the host ".concat(p),t]});_n({msg:a,variant:"error"})}))}},{key:"commissionDecommissionDataNode",value:function(e){var t=this,a=e.host_id,r=e.ipaddr,o=e.hostname,i=e.op,s=e.idx,c=this.props.updateHostData,l="".concat(r," (").concat(o,")"),u="decommission"===i?"decommission":"recommission",p={op:i};R({apiurl:a,method:w.method.POST,data:p}).then((function(){_n({msg:"Datanode ".concat(u," process started successfully for ").concat(l),variant:"success"}),c(a,t.onHostDataUpdated,s)})).catch((function(e){var t=f.a.parseAxiosError({error:e}),a=n.a.createElement(ns,{errors:["Failed to ".concat(u," the host ").concat(l),t]});_n({msg:a,variant:"error"})}))}},{key:"deleteK8sHostList",value:function(e){var t=this;e.data.forEach((function(e){var a=JSON.parse(e.rowData[e.rowData.length-1]),r=a.host_id,n=a.ipaddr,o=a.idx;t.deleteK8sHost({host_id:r,ipaddr:n,idx:o})}))}},{key:"deleteK8sHost",value:function(e){var t=this,a=e.host_id,r=e.ipaddr,o=e.idx,i=this.props.updateHostData;R({apiurl:a,method:w.method.DELETE}).then((function(){i(a,t.onHostDataUpdated,o),_n({msg:"Started deletion process for the host ( ".concat(r," )."),variant:"success"})})).catch((function(e){var t=f.a.parseAxiosError({error:e}),a=n.a.createElement(ns,{errors:["Failed to install the host ".concat(r),t]});_n({msg:a,variant:"error"})}))}},{key:"updateHostTag",value:function(e){var t=e.host_id,a=e.idx,r=this.props,o=r.k8sHosts,i=r.tagsInfo,s=o.find((function(e){return t===f.a.fetchSafeFromObject({path:["_links","self","href"],obj:e,default_value:""})})),c=s.ipaddr,l=void 0===c?"":c,u=s.hostname,p=void 0===u?"":u,d=s.tags,m=void 0===d?[]:d,h=i.tagItemSchema,b=i.tagItemDefaultData,v=i.tagOptions,y=i.tagValuesByID;if(v.length){m.length||(m=[b]);var g=m.reduce((function(e,t){var a=y[t.tag_id],r=JSON.parse(JSON.stringify(h));return r.properties.tag_value.suggestions=a?PD(a):[],e.push(r),e}),[]),_={type:"object",properties:{tags:{type:"array",title:"Tags",description:ND.tagsFieldDescription("kubernetes"),items:g,canAdd:!0,addItemTitle:"Tag",onAddClick:this.onAddTagClick,onDropClick:this.onDropTagClick}}};this.formData={tags:m};var S=n.a.createElement(st.a,{variant:"h2"},"Update tag for ",l,p?" (".concat(p,")"):"");this.setState({updateTagform:{Title:S,formSchema:_,methodActions:[{method:w.method.PATCH,action:t,data:"FORM_DATA"}],host_id:t,idx:a}}),this.bdModalFormRef.current.updateStateFormData({formData:this.formData}),this.bdModalFormRef.current.openModal()}else this.bdDialogRef.current.handleOpen({title:"Tags not available.",description:"Tags must be configured prior to adding them for kubernetes host(s)"})}},{key:"onAddTagClick",value:function(){var e=this,t=this.props.tagsInfo,a=this.state.updateTagform,r=a.formSchema,n=t.tagItemSchema,o=t.tagItemDefaultData;r.properties.tags.items.push(JSON.parse(JSON.stringify(n))),this.formData.tags.push(o);var i=kD(kD({},a),{},{formSchema:r});this.setState({updateTagform:i},(function(){e.bdModalFormRef.current.updateStateFormData({formData:e.formData})}))}},{key:"onDropTagClick",value:function(e){var t=this,a=this.state.updateTagform,r=a.formSchema,n=r.properties.tags.items.slice();n.splice(e,1),r.properties.tags.items=n,this.formData.tags.splice(e,1);var o=kD(kD({},a),{},{formSchema:r});this.setState({updateTagform:o},(function(){t.bdModalFormRef.current.updateStateFormData({formData:t.formData})}))}},{key:"onChangeUpdateTagForm",value:function(e){var t=e.formData;this.formData=t;var a=this.state.updateTagform,r=document.activeElement,n=xl(r);if(n&&n.endsWith("_tag_id")){var o=this.props.tagsInfo.tagValuesByID,i=n.split("_tag_id")[0].split("_").pop(),s=a.formSchema,c=f.a.deepClone(s),l=o[f.a.fetchSafeFromObject({path:["tags",i,"tag_id"],obj:t,default_value:""})];c.properties.tags.items.some((function(e,t){if(t===parseInt(i,10))return e.properties.tag_value.suggestions=PD(l),!0})),this.setState({updateTagform:kD(kD({},a),{},{formSchema:c})}),this.bdModalFormRef.current.updateStateFormData({formData:t})}}},{key:"validateForm",value:function(e,t){var a=e.tags;return a&&a.length&&(a.some((function(e){return e.tag_value&&!Fl.tag_value.test(e.tag_value)?(t.tags.addError(er({path:["HostAddValidation","tags","invalid_character"]})),!0):e.tag_id&&!e.tag_value?(t.tags.addError(er({path:["HostAddValidation","tags","value_required"]})),!0):void 0})),Il(a)&&t.tags.addError(er({path:["HostAddValidation","tags","duplicate"]}))),t}},{key:"preProcessUpdateTagData",value:function(e){return{op:"replace",path:"/tags",value:e.tags}}},{key:"closeEditDiskModal",value:function(){return this.bdModalEditDiskChildRef.current.handleClose()}},{key:"prepareModalDiskData",value:function(e){var t=this.props,a=t.disks_selection,r=t.isMaprInstallation,n=f.a.fetchSafeFromObject({path:[e],obj:a,default_value:{}}),o=$l.getDisksDataEditModal({host_id:e,currentDiskSelection:n,isMaprInstallation:r});this.setState({modalDiskData:o})}},{key:"onDiskSelection",value:function(e){var t=e.arrayData;t.map((function(e,t){1===t?e.data.map((function(e){"both"!==e.disabled&&(e.diskSize<150*w.settings.B_to_GB?e.disabled="both":e.diskSize<500*w.settings.B_to_GB&&(e.disabled="right"))})):e.data.map((function(e){e.disabled="none"}))})),this.setState({modalDiskData:t})}},{key:"onModalClose",value:function(e){if("close"!==e){var t=this.props.updateDiskSelection,a=this.bdModalEditDiskChildRef.current,r=f.a.fetchSafeFromObject({path:["props","children"],obj:a,default_value:[]}),n=f.a.fetchSafeFromObject({path:["props","arrayData"],obj:r,default_value:[]});n.some((function(e){var t=e.title,a=void 0===t?"":t,r=e.data;if("Ephemeral"===a)return(void 0===r?[]:r).length}))?t(n):_n({msg:"Failed to set the disk. Ephemeral disk selection should have at least one disk.",variant:"error"})}}},{key:"render",value:function(){var e=this,t=this.props,a=t.updateHostData,r=t.updateKey,o=void 0===r?0:r,i=this.state,s=i.modalDiskData,c=i.updateTagform,l=this.getHostsTableSettings(),u=n.a.createElement(Ue.a,{variant:"contained",color:"primary",onClick:this.closeEditDiskModal},"Set Disk"),p=n.a.createElement(Us,{arrayData:s,onMoveItem:this.onDiskSelection,searchQuerySuggestions:["dev/sdb..."]});return n.a.createElement(n.a.Fragment,null,n.a.createElement(sa,_D({},l,{key:o})),n.a.createElement(no,{ref:this.bdDialogRef}),n.a.createElement(In,{Title:n.a.createElement(st.a,{variant:"h2"},"Edit Disk Allocation"),name:"edit disk allocation",description:"modal to edit disk allocation",onModalClose:this.onModalClose,ref:this.bdModalEditDiskChildRef,actionButton:u,footerCloseBtn:!0},p),n.a.createElement(Jn,{form_id:"updateTagForm",Title:c.Title,name:ND.name||"",description:ND.description||"",formData:{},form_schema:c.formSchema,callBack:function(){a(c.host_id,e.onHostDataUpdated,c.idx)},success_msg:ND.successMessage||"",failure_msg:ND.failureMessage||"",validate:this.validateForm,preProcessData:this.preProcessUpdateTagData,method_actions:c.methodActions,onChange:this.onChangeUpdateTagForm,ref:this.bdModalFormRef}))}}])&&OD(t.prototype,a),r&&OD(t,r),i}(r.Component);TD(HD,"propTypes",{classes:u.a.object.isRequired,k8sClusterData:u.a.object,k8sHosts:u.a.array,k8sClusters:u.a.array,page_name:u.a.string,updateDiskSelection:u.a.func,disks_selection:u.a.object,hostsTags:u.a.array,role_name:u.a.string,isMaprInstallation:u.a.bool,tagsInfo:u.a.object,updateHostData:u.a.func,updateKey:u.a.number});var KD=he()((function(e){return{hostsActionBtns:{marginLeft:.5*e.spacing.unit},decommissionedState:{color:e.palette.warning.dark,marginLeft:.5*e.spacing.unit},hdfsStatus:{display:"flex",alignItems:"center"},mLeft:{marginLeft:.5*e.spacing.unit}}}))(HD);function qD(e){return(qD="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function VD(){return(VD=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var r in a)Object.prototype.hasOwnProperty.call(a,r)&&(e[r]=a[r])}return e}).apply(this,arguments)}function GD(e){return function(e){if(Array.isArray(e))return zD(e)}(e)||function(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||function(e,t){if(!e)return;if("string"==typeof e)return zD(e,t);var a=Object.prototype.toString.call(e).slice(8,-1);"Object"===a&&e.constructor&&(a=e.constructor.name);if("Map"===a||"Set"===a)return Array.from(e);if("Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a))return zD(e,t)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function zD(e,t){(null==t||t>e.length)&&(t=e.length);for(var a=0,r=new Array(t);a<t;a++)r[a]=e[a];return r}function WD(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function JD(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?WD(Object(a),!0).forEach((function(t){tw(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):WD(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function YD(e,t){for(var a=0;a<t.length;a++){var r=t[a];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function $D(e,t){return($D=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function QD(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=ew(e);if(t){var n=ew(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return ZD(this,a)}}function ZD(e,t){return!t||"object"!==qD(t)&&"function"!=typeof t?XD(e):t}function XD(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function ew(e){return(ew=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function tw(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}var aw=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&$D(e,t)}(i,e);var t,a,r,o=QD(i);function i(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),(t=o.call(this,e)).state={host:"*",time_range:"hour",applicable_metrics:[],applicable_graphs:[],grid:0,selections:{}},t.updateMetricDescriptors=t.updateMetricDescriptors.bind(XD(t)),t.handleChangeSelection=t.handleChangeSelection.bind(XD(t)),t.getQuerySelections=t.getQuerySelections.bind(XD(t)),t.getApplicableHosts=t.getApplicableHosts.bind(XD(t)),t}return t=i,(a=[{key:"componentDidMount",value:function(){this.updateMetricDescriptors()}},{key:"updateMetricDescriptors",value:function(){var e=this.props.metrics_params,t=w.applicable_graphs({graph:"system"}),a=4===t.length?6:4;if(f.a.isEmptyObject(e))setTimeout(this.updateMetricDescriptors,500);else{var r=Sd({graph:"system",metrics_params:e,applicable_graphs:t});this.setState({applicable_metrics:r,applicable_graphs:t,grid:a})}}},{key:"handleChangeSelection",value:function(e,t){var a=tw({},t,e);this.setState(JD({},a))}},{key:"getQuerySelections",value:function(e){var t=this.state,a=t.host,r=t.time_range,n=e.filter((function(e){return"*"===a||"top_cpu_hosts"===a||"top_memory_hosts"===a||a===e.hostname}));return{selected_objs:n,time_range:r,filter:!0,agg_type:function(e,t){return"top_cpu_hosts"===e||"top_memory_hosts"===e?e:t.length<=10?"node":"total_avg"}(a,n)}}},{key:"getApplicableHosts",value:function(){var e=[],t=this.props,a=t.k8shosts,r=void 0===a?[]:a,n=t.k8sClusterData,o=void 0===n?{}:n,i=f.a.fetchSafeFromObject({path:["_links","self","href"],obj:o,default_value:""});r.map((function(t){var a=t.cluster_id,r=void 0===a?"":a,n=t.hostname,o=void 0===n?"":n,s=t.ipaddr,c=void 0===s?"":s,l=t.status,u=void 0===l?"":l,p=t.sysinfo,d=(p=void 0===p?{}:p).gpu,f=(d=void 0===d?{}:d).gpu_count,m=void 0===f?0:f;i===r&&"configured"===u&&e.push({hostname:o,ipaddr:c,gpu_count:m})}));var s=f.a.getColorList(e.length);return e.map((function(e,t){return JD(JD({},e),{},{color:s[t]})}))}},{key:"render",value:function(){var e=this.props,t=e.title,a=e.classes,r=this.state,o=r.applicable_graphs,i=r.applicable_metrics,s=r.grid,c=r.time_range,l=r.host,u=this.getApplicableHosts(),p=this.getQuerySelections(u);return n.a.createElement("div",{className:a.monitoring},t?n.a.createElement(st.a,{variant:"h2",className:a.contentTitle},t):"",u.length?n.a.createElement("div",{className:a.chartContainer},n.a.createElement("div",{className:a.chartSelectors},n.a.createElement(Hr.a,{className:a.selectWrapper},n.a.createElement(nc,{value:l,onChange:this.handleChangeSelection,name:"host",className:a.select,items:[{val:"*",title:"All Kubernetes Hosts"},{val:"top_cpu_hosts",title:"Top 10 Kubernetes Hosts by CPU Utilization"},{val:"top_memory_hosts",title:"Top 10 Kubernetes Hosts by Memory Usage"}].concat(GD(u.map((function(e){return{val:e.hostname,title:e.hostname}}))))})),n.a.createElement(Hr.a,{className:a.selectWrapper},n.a.createElement(nc,{value:c,onChange:this.handleChangeSelection,name:"time_range",className:a.select,items:GD(w.TIME_RANGES)}))),n.a.createElement(bc.a,{className:a.charts,container:!0,spacing:16},o.map((function(e){return n.a.createElement(Nd,VD({type:"system_chart"},i.find((function(t){return t.id===e})),p,{grid:s,key:e}))})))):n.a.createElement(Hp.a,{className:a.well},n.a.createElement(qp.a,null,n.a.createElement(st.a,{variant:"body1"},"Cluster charts will be available once cluster is ready."))))}}])&&YD(t.prototype,a),r&&YD(t,r),i}(r.Component);tw(aw,"propTypes",{classes:u.a.object,k8shosts:u.a.array,k8sClusterData:u.a.object,metrics_params:u.a.object,title:u.a.string});var rw=he()(yp)(aw),nw=function(e){var t=e.dashboard_endpoint_access,a=e.classes,r=e.token64;return n.a.createElement(Ia,null,n.a.createElement(st.a,null,"Kubernetes dashboard url : ",t),n.a.createElement(st.a,{className:a.wrapText},"Authentication Token : ",r),n.a.createElement(st.a,{variant:"h6"},"Please ",n.a.createElement("span",{className:a.bold},'click on "Proceed to Kubernetes Dashboard"')," to open url in new tab"),n.a.createElement(st.a,{variant:"h6"},"If prompted, select token based authentication."),n.a.createElement(st.a,{variant:"h6"},"Auth token is already copied to clipboard. ",n.a.createElement("span",{className:a.bold},"right click and paste")," in input field for token and click on Sign In"))},ow=he()((function(){return{bold:{fontFamily:"MetricHPE-Web-Bold"},wrapText:{wordBreak:"break-all"}}}))(nw);nw.propTypes={dashboard_endpoint_access:u.a.string,token64:u.a.string,classes:u.a.object};var iw=function(e){var t=e.tenant_id,a=e.tenant_name,r=e.callback;t&&(r&&r({action:"deleting",tenant_id:t}),R({apiurl:t,method:w.method.DELETE}).then((function(){r&&r({action:"refresh",tenant_id:t}),_n({msg:"Delete operation successful for tenant ( ".concat(a," )"),variant:"success"})})).catch((function(){r&&r({action:"reset",tenant_id:t}),_n({msg:"Failed to delete the tenant ( ".concat(a," )"),variant:"error"})})))},sw={getK8sTenantsActionButtons:function(e){var t=e.tenant_data,a=e.isSiteAdmin,r=void 0!==a&&a,n=t.status,o=void 0===n?"":n,i=t.tenant_type,s=void 0===i?"":i,c=[];return["ready","initialized","warning"].includes(o)?(c.push({action:"UserList",icon:"icon-user",title:"Users",variant:"primary"}),r&&(c.push({action:"Edit",icon:"icon-pencil3",title:"Edit Tenant",variant:"primary"}),c.push({action:"Delete",icon:"icon-trash2",title:"Delete Tenant",variant:"error"}))):r&&"error"===o&&"k8s"===s&&c.push({action:"Delete",icon:"icon-trash2",title:"Delete Tenant",variant:"error"}),c},deleteSelectedTenantList:function(e){var t=e.selected_rows,a=e.tenants,r=e.callback;t.data.map((function(e){var t=e.dataIndex,n=a[t],o=f.a.fetchSafeFromObject({path:["_links","self","href"],obj:n,default_value:""}),i=f.a.fetchSafeFromObject({path:["label","name"],obj:n,default_value:""});iw({tenant_id:o,tenant_name:i,callback:r})}))},deleteSelectedTenant:iw,downloadKubeconfig:function(e){R({apiurl:w.apiurl.K8S_KUBECONFIG}).then((function(t){if(t.data){var a="".concat(f.a.convertValidDnsName(e),"_kubeconfig");f.a.downloadOrSaveData(t.data,a,"text/txt"),_n({msg:"Kubeconfig downloaded successfully",variant:"success"})}})).catch((function(){_n({msg:"Failed to download kubeconfig",variant:"error"})}))},getStatusesToLiveupdateK8sTenant:function(){return["creating","deleting","updating"]}};function cw(e){return(cw="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function lw(e,t){for(var a=0;a<t.length;a++){var r=t[a];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function uw(e,t){return(uw=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function pw(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=mw(e);if(t){var n=mw(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return dw(this,a)}}function dw(e,t){return!t||"object"!==cw(t)&&"function"!=typeof t?fw(e):t}function fw(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function mw(e){return(mw=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var hw=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&uw(e,t)}(i,e);var t,a,r,o=pw(i);function i(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),(t=o.call(this,e)).getMenuList=t.getMenuList.bind(fw(t)),t.invokeK8sClusterOps=t.invokeK8sClusterOps.bind(fw(t)),t.openK8sDashboard=t.openK8sDashboard.bind(fw(t)),t.k8sClusterOperationModalRef=n.a.createRef(),t}return t=i,(a=[{key:"shouldComponentUpdate",value:function(e){return f.a.fetchSafeFromObject({path:["cluster_data","status"],obj:this.props})!==f.a.fetchSafeFromObject({path:["cluster_data","status"],obj:e})}},{key:"invokeK8sClusterOps",value:function(e){var t=e.action,a=e.id,r=e.name,o=e.url,i=this.props,s=i.cluster_data,c=i.fetchCurrentClusterData,l=i.role_name,u=i.tenant,p="K8S Admin"===l;switch(t){case"dashboard":var d=s.dashboard_endpoint_access,m=void 0===d?"":d,h=s.dashboard_token,b=void 0===h?"":h;if(m&&b){var v=atob(b);f.a.copyToClipboard(v);var y=n.a.createElement(ow,{dashboard_endpoint_access:m,token64:v}),g={callback:this.openK8sDashboard,context:{dashboard_endpoint_access:m},title:"",description:y,btnSubmit:"Proceed to Kubernetes Dashboard"};this.k8sClusterOperationModalRef.current.handleOpen(g)}else _n({msg:"Failed to fetch kubernetes dashboard link",variant:"success"});break;case"kubeconfig":if(p)sw.downloadKubeconfig(u);else{var _=s.admin_kube_config,S=void 0===_?"":_;tE.downloadK8sClusterRelatedFiles({data:S,name:r,action:t})}break;case"delete":var k={callback:tE.deleteK8sCluster,context:{id:a,name:r,callback:c},title:'Delete selected "'.concat(r,'"'),description:"Confirm deletion. This action cannot be undone."};this.k8sClusterOperationModalRef.current.handleOpen(k);break;case"edit":window.location.href=o;break;default:_n({msg:"".concat(t," not implemented yet"),variant:"success"})}}},{key:"openK8sDashboard",value:function(e){var t=e.dashboard_endpoint_access;window.open(t,"_blank")}},{key:"getMenuList",value:function(){var e=this,t=this.props,a=t.cluster_data,r=void 0===a?{}:a,n="Site Admin"===t.role_name,o=r.status,i=r.k8shosts_config,s=void 0===i?[]:i,c=r.label,l=(c=void 0===c?{}:c).name,u=void 0===l?"":l,p=r._links,d=(p=void 0===p?{}:p).self,f=(d=void 0===d?{}:d).href,m=void 0===f?"":f,h=r.imported,b=r&&tE.getK8sClusterActionButtons({status:o,id:m,hasHosts:s.length,imported:h}),v=n?["edit","delete","dashboard","kubeconfig"]:["dashboard","kubeconfig"];return b.filter((function(e){return v.includes(e.action)})).map((function(t){var a=t.action,r=t.icon,n=t.title,o=t.url;return{icon:r,label:n,onClick:function(){e.invokeK8sClusterOps({action:a,id:m,name:u,url:o})}}}))}},{key:"render",value:function(){var e=this.props.cluster_data,t=(void 0===e?{}:e).status,a=!["ready","stopped","error","warning"].includes(t),r=this.getMenuList();return n.a.createElement(Ia,null,n.a.createElement(_t,{variant:"contained",color:"primary",title:"Cluster Operations",operation:"clusterOp",disabled:a,menuList:r}),n.a.createElement(no,{ref:this.k8sClusterOperationModalRef}))}}])&&lw(t.prototype,a),r&&lw(t,r),i}(r.Component);!function(e,t,a){t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a}(hw,"propTypes",{cluster_data:u.a.object,k8scluster_list:u.a.object,fetchCurrentClusterData:u.a.func,role_name:u.a.string,tenant:u.a.string});var bw=hw;function vw(e){return(vw="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function yw(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function gw(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?yw(Object(a),!0).forEach((function(t){ww(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):yw(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function _w(e,t){for(var a=0;a<t.length;a++){var r=t[a];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Sw(e,t,a){return t&&_w(e.prototype,t),a&&_w(e,a),e}function kw(e,t){return(kw=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Ow(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=Dw(e);if(t){var n=Dw(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return Ew(this,a)}}function Ew(e,t){return!t||"object"!==vw(t)&&"function"!=typeof t?jw(e):t}function jw(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Dw(e){return(Dw=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function ww(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}var Cw=[{label:"Host(s) Info",key:"hosts-info"},{label:"Load",key:"load"},{label:"Services Status",key:"services-status"},{label:"Alerts",key:"alerts"}],Tw=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&kw(e,t)}(a,e);var t=Ow(a);function a(e){var r;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,a),ww(jw(r=t.call(this,e)),"CancelToken",T.a.CancelToken),ww(jw(r),"timeouts",{}),ww(jw(r),"dataUpdates",{}),ww(jw(r),"hostUpdates",{}),r.state={clusterHostNames:[],clusterDataFetched:!1,hostDataFetched:!1,updateKey:0},r.fetchCurrentClusterData=r.fetchCurrentClusterData.bind(jw(r)),r.getCurrentClusterID=r.getCurrentClusterID.bind(jw(r)),r.filterClusterHosts=r.filterClusterHosts.bind(jw(r)),r.updateHostData=r.updateHostData.bind(jw(r)),r}return Sw(a,null,[{key:"getMeta",value:function(){return{title:"".concat(w.APP_TITLE.CP," | Cluster Dashboard"),link:[{rel:"canonical",href:"".concat(w.serverUrl).concat(w.views.k8sClusterDashboard.url)}],meta:[{charset:"utf-8"},{name:"description",content:"Kubernetes Cluster Dashboard"}]}}}]),Sw(a,[{key:"componentDidMount",value:function(){var e=this,t=this.props.dispatch;this.dataUpdates.metrics=this.CancelToken.source(),this.dataUpdates.hosts=this.CancelToken.source(),this.fetchCurrentClusterData(),t(Q(gw(gw({},oe.METRICS_PARAM_DATA),{},{cancelToken:this.dataUpdates.metrics.token}))).then((function(){delete e.dataUpdates.metrics})),t(Q(gw(gw({},oe.K8SHOST_DATA),{},{cancelToken:this.dataUpdates.hosts.token}))).then((function(){delete e.dataUpdates.hosts}))}},{key:"componentWillUnmount",value:function(){var e=this;Object.keys(this.timeouts).map((function(t){clearTimeout(e.timeouts[t])})),Object.keys(this.dataUpdates).map((function(t){e.dataUpdates[t].cancel("component unmounted")})),Object.keys(this.hostUpdates).map((function(t){e.hostUpdates[t].source.cancel("component unmounted")})),this.cleanupPageData()}},{key:"fetchCurrentClusterData",value:function(){var e=this,t=this.props,a=t.dispatch,r=t.role_name,n=this.getCurrentClusterID(),o=this;this.dataUpdates.cluster=this.CancelToken.source();var i=this.dataUpdates.cluster.token;a(Q(gw(gw({},oe.CURRENT_K8SCLUSTER_DATA(n)),{},{cancelToken:i}))).then((function(){delete e.dataUpdates.cluster,e.setState({clusterDataFetched:!0},(function(){var t=o.props.current_k8scluster_data,a=void 0===t?{}:t;f.a.isEmptyObject(a)?"Site Admin"===r?(clearTimeout(o.timeout),o.cleanupPageData(),window.location.href=w.views.managek8sClusters.url):window.location.href=w.views.logout.url:(e.filterClusterHosts(),tE.liveUpdateK8sCluster([a])&&(o.timeout=setTimeout((function(){o.fetchCurrentClusterData()}),3e4)))}))}))}},{key:"filterClusterHosts",value:function(){var e=this.props,t=e.current_k8scluster_data,a=void 0===t?{}:t,r=e.k8scluster_host_list,n=void 0===r?[]:r,o=e.k8shosts,i=e.dispatch;if(o.length){var s=a.k8shosts_config,c=void 0===s?[]:s;if(n.length!==c.length){var l=f.a.deepClone(o),u=[],p=[];c.map((function(e){var t=e.node,a=void 0===t?"":t;l.some((function(e){return a===f.a.fetchSafeFromObject({path:w.pathToID,obj:e})&&(p.push(e),u.push(e.hostname),!0)}))})),i(Y("k8scluster_host_list",p)),this.setState({clusterHostNames:u,hostDataFetched:!0})}}else setTimeout(this.filterClusterHosts,500)}},{key:"updateHostData",value:function(e,t,a){var r=this,n=this.props.dispatch;if(!this.hostUpdates[e]){this.hostUpdates[e]={source:this.CancelToken.source()};var o=f.a.fetchSafeFromObject({path:[e,"source","token"],obj:this.hostUpdates}),i=oe.UPDATE_CLUSTER_HOST(e,o);n(Z(i)).then((function(){delete r.hostUpdates[e],Object.keys(r.hostUpdates).length||r.setState({updateKey:r.state.updateKey+1});var n=r.props.k8shosts.find((function(t){return f.a.fetchSafeFromObject({path:w.pathToID,obj:t})===e}));n&&t&&t(e,n,a)}))}}},{key:"cleanupPageData",value:function(){var e=this.props.dispatch;["current_k8scluster_data","k8scluster_host_list"].map((function(t){return e($(t))}))}},{key:"getCurrentClusterID",value:function(){var e=this.props,t=e.role_name,a=e.current_tenant_data,r=e.location,n=lf.a.parse(r.search).id;if("Site Admin"===t)return void 0===n?"":n;var o=a.k8s_cluster;return void 0===o?"":o}},{key:"render",value:function(){var e=this,t=a.getMeta(),r=this.props,o=r.current_k8scluster_data,i=void 0===o?{}:o,s=r.k8scluster_host_list,c=void 0===s?{}:s,l=r.metrics_params,u=void 0===l?{}:l,p=r.classes,d=r.role_name,m=r.current_tenant_data,h=r.nagios_data,b=r.nagios_alerts,v=r.dispatch,y=this.state,g=y.clusterHostNames,_=void 0===g?[]:g,S=y.hostDataFetched,k=y.clusterDataFetched,O=y.updateKey,E=f.a.fetchSafeFromObject({path:["label","name"],obj:m,default_value:""}),j=f.a.fetchSafeFromObject({path:["label","name"],obj:i,default_value:""}),D=f.a.fetchSafeFromObject({path:w.pathToID,obj:i,default_value:""}),C=!0===f.a.fetchSafeFromObject({path:["imported"],obj:i,default_value:!1}),T=f.a.deepClone(Cw);C&&T.length>2&&T.splice(2);var P=T.map((function(t){return n.a.createElement("div",{key:t.key},"hosts-info"===t.key?k&&S?n.a.createElement(KD,{k8sHosts:c,k8sClusters:[i],role_name:d,page_name:"k8sClusterDashboardPage",updateHostData:e.updateHostData,updateKey:O}):n.a.createElement(ls,{status:"Fetching hosts data"}):"","load"===t.key?n.a.createElement(rw,{k8sClusterData:i,k8shosts:c,metrics_params:u}):"","services-status"===t.key?S?n.a.createElement(T_,{hosts:_,dispatch:v,cluster:D,nagios_data:h}):n.a.createElement(ls,{status:"Fetching hosts data"}):"","alerts"===t.key?S?n.a.createElement(cO,{hosts:_,dispatch:v,nagios_alerts:b}):n.a.createElement(ls,{status:"Fetching hosts data"}):"")}));return n.a.createElement("div",{className:p.K8sClusterDashboardPage},n.a.createElement(Al.a,{title:t.title,description:t.description,link:t.link,meta:t.meta}),n.a.createElement(Nt,{title:j}),n.a.createElement(bw,{cluster_data:i,classes:p,fetchCurrentClusterData:this.fetchCurrentClusterData,role_name:d,tenant:E}),n.a.createElement(Ia,null,n.a.createElement(_o,{tabs:T,tabContents:P,location})))}}]),a}(r.Component);ww(Tw,"propTypes",{classes:u.a.object.isRequired,dispatch:u.a.func.isRequired,current_k8scluster_data:u.a.object,k8shosts:u.a.array,metrics_params:u.a.object,location:u.a.object,role_name:u.a.string,current_tenant_data:u.a.object,nagios_data:u.a.object,nagios_alerts:u.a.array,k8scluster_host_list:u.a.array});var Pw=d()(he()((function(){return{K8sClusterDashboardPage:{overflow:"hidden"}}}),{name:"K8sClusterDashboardPage"}),Object(s.b)((function(e){var t=e.stats_data,a=void 0===t?{}:t,r=e.page_data,n=(r=void 0===r?{}:r).current_k8scluster_data,o=void 0===n?{}:n,i=r.k8shost_list,s=void 0===i?{}:i,c=r.metrics_params,l=void 0===c?{}:c,u=r.k8scluster_host_list,p=void 0===u?[]:u,d=r.nagios_alerts,m=void 0===d?[]:d,h=a.session_data,b=(h=void 0===h?{}:h).role_name,v=void 0===b?"":b,y=h.current_tenant_data,g=void 0===y?{}:y,_=f.a.fetchSafeFromObject({path:w.pathToID,obj:o,default_value:""}),S=f.a.fetchSafeFromObject({path:["page_data","nagios_data_".concat(_.split("/").pop())],obj:e,default_value:{}});return{role_name:v,current_tenant_data:g,current_k8scluster_data:o,k8shosts:f.a.fetchSafeFromObject({path:["_embedded","k8shosts"],obj:s,default_value:[]}),metrics_params:l,k8scluster_host_list:p,nagios_data:S,nagios_alerts:m}})))(Tw);function Aw(e){return(Aw="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Rw(e,t){for(var a=0;a<t.length;a++){var r=t[a];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Nw(e,t){return(Nw=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Fw(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=Iw(e);if(t){var n=Iw(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return xw(this,a)}}function xw(e,t){return!t||"object"!==Aw(t)&&"function"!=typeof t?Mw(e):t}function Mw(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Iw(e){return(Iw=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var Uw=er({path:["k8sImportEditCluster","clusterConfiguration"]}),Lw=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Nw(e,t)}(s,e);var t,a,o,i=Fw(s);function s(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,s),(t=i.call(this,e)).validateForm=t.validateForm.bind(Mw(t)),t.submitForm=t.submitForm.bind(Mw(t)),t.bdFormStepImportRef=n.a.createRef(),t.state={formSchema:{},formData:{}},t}return t=s,(a=[{key:"componentDidMount",value:function(){var e=this.props,t=e.isEditView,a=e.formData,r=Hw(t);this.setState({formData:a,formSchema:r})}},{key:"componentDidUpdate",value:function(e){var t=this.props,a=t.formData,r=t.clusterDataFetched;void 0!==r&&r&&!e.clusterDataFetched&&this.setState({formData:a})}},{key:"submitForm",value:function(e){var t=e.formData,a=e.errors,r=this.props,n=r.updateFormData,o=r.step;a.length||n({data:t,step:o,nextStep:o+1})}},{key:"validateForm",value:function(e,t){var a=this.props,r=a.clusterNames,n=a.isEditView,o=e.label,i=(o=void 0===o?{}:o).name,s=void 0===i?"":i,c=o.description,l=void 0===c?"":c,u=e.pod_dns_domain,p=void 0===u?"":u,d=e.sysadmin_data,f=(d=void 0===d?{}:d).server_url,m=void 0===f?"":f,h=d.bearer_token,b=void 0===h?"":h;return s?s.length>32?t.label.name.addError(Uw.validation.name.length):s.match(Fl.user_name)?r.includes(s)&&t.label.name.addError(Uw.validation.name.alreadyUsed):t.label.name.addError(Uw.validation.name.invalid):t.label.name.addError(Uw.validation.fieldRequired),l?l.match(Fl.user_name)||t.label.description.addError(Uw.validation.description.invalid):t.label.description.addError(Uw.validation.fieldRequired),p?p.match(Fl.valid_domain_name)||t.pod_dns_domain.addError(Uw.validation.pod_dns_domain.invalid):t.pod_dns_domain.addError(Uw.validation.fieldRequired),n||(m?m.match(Fl.url)?m.match(Fl.http)||t.sysadmin_data.server_url.addError(Uw.validation.server_url.http):t.sysadmin_data.server_url.addError(Uw.validation.server_url.invalid):t.sysadmin_data.server_url.addError(Uw.validation.fieldRequired),b||t.sysadmin_data.bearer_token.addError(Uw.validation.fieldRequired)),t}},{key:"render",value:function(){var e=this.props,t=e.classes,a=e.clusterDataFetched,o=void 0!==a&&a,i=this.state,s=i.formSchema,c=i.formData,l=void 0===c?{}:c;return n.a.createElement(r.Fragment,null,s?n.a.createElement(En,{form_schema:s,formData:l,form_id:"ImportClusterConfigurationForm",method:w.method.POST,action:"#",submitter:this.submitForm,nodeRef:this.bdFormStepImportRef,validate:this.validateForm,variant:"vanilla"},n.a.createElement("div",{className:t.footer},n.a.createElement(Ue.a,{type:"submit",variant:"contained",color:"primary",disabled:!o},"Next"))):n.a.createElement(ls,null))}}])&&Rw(t.prototype,a),o&&Rw(t,o),s}(r.Component);!function(e,t,a){t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a}(Lw,"propTypes",{classes:u.a.object.isRequired,formData:u.a.object,step:u.a.number,isEditView:u.a.bool,updateFormData:u.a.func,clusterNames:u.a.array,clusterDataFetched:u.a.bool});var Bw=he()(ar.a)(Lw),Hw=function(e){var t=[];for(var a in tE.importedClusterTypesMap)t.push({type:"string",title:tE.importedClusterTypesMap[a],enum:[a]});return{type:"object",properties:{label:{type:"object",properties:{name:{type:"string",title:"Name",description:e?Uw.updateNotSupported:Uw.nameDescription,bd_required:!0,bd_disabled:e},description:{type:"string",title:"Description",description:Uw.descriptionDescription,bd_required:!0}}},type:{type:"string",title:"Type",description:e?Uw.updateNotSupported:Uw.typeDescription,bd_required:!0,bd_disabled:e,default:Object.keys(tE.importedClusterTypesMap)[0],sort:!1,anyOf:t},pod_dns_domain:{type:"string",title:"Pod DNS Domain",description:Uw.pod_dns_domainDescription,bd_required:!0},sysadmin_data:{type:"object",properties:{server_url:{type:"string",title:"Server URL",description:e?Uw.updateNotSupported:Uw.server_urlDescription,bd_required:!e,bd_disabled:e},ca:{type:"string",title:"CA Certificate",description:Uw.caDescription,bd_widget:"textarea"},bearer_token:{type:"string",title:"Bearer Token",description:Uw.bearer_tokenDescription,bd_required:!e,bd_widget:"textarea"}}}}}};function Kw(e){return(Kw="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function qw(e,t){for(var a=0;a<t.length;a++){var r=t[a];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Vw(e,t){return(Vw=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Gw(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=Jw(e);if(t){var n=Jw(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return zw(this,a)}}function zw(e,t){return!t||"object"!==Kw(t)&&"function"!=typeof t?Ww(e):t}function Ww(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Jw(e){return(Jw=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var Yw=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Vw(e,t)}(i,e);var t,a,r,o=Gw(i);function i(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),(t=o.call(this,e)).handleNavigation=t.handleNavigation.bind(Ww(t)),t}return t=i,(a=[{key:"handleNavigation",value:function(e){var t=this.props;(0,t.updateFormData)({step:t.step,nextStep:e})}},{key:"render",value:function(){var e=this,t=this.props,a=t.classes,r=t.step,o=t.formData,i=t.addons,s=f.a.fetchSafeFromObject({path:["0"],obj:o,default_value:{}}),c=s.label,l=(c=void 0===c?{}:c).name,u=void 0===l?"":l,p=c.description,d=void 0===p?"":p,m=s.pod_dns_domain,h=void 0===m?"":m,b=s.type,v=void 0===b?"":b,y=s.sysadmin_data,g=(y=void 0===y?{}:y).server_url,_=void 0===g?"":g,S=y.ca,k=void 0===S?"":S,O=y.bearer_token,E=void 0===O?"":O,j=f.a.fetchSafeFromObject({path:[v],obj:tE.importedClusterTypesMap,default_value:""}),D=k?"added":"",w=E?"added":"",C=f.a.fetchSafeFromObject({path:["1","addons"],obj:o,default_value:{}}),T=[];for(var P in C)if(!0===C[P]){var A=f.a.fetchSafeFromObject({path:[P,"label","name"],obj:i,default_value:P});T.push(A)}return n.a.createElement("div",{className:a.summary},n.a.createElement("div",{className:a.details},n.a.createElement(St.Typography,{variant:"caption"},"Name: ",u),n.a.createElement(St.Typography,{variant:"caption"},"Description: ",d),n.a.createElement(St.Typography,{variant:"caption"},"DNS Domain: ",h),n.a.createElement(St.Typography,{variant:"caption"},"Type: ",j),n.a.createElement(St.Typography,{variant:"caption"},"Server Url: ",_),n.a.createElement(St.Typography,{variant:"caption"},"CA Certificate: ",D),n.a.createElement(St.Typography,{variant:"caption"},"Bearer Token: ",w),T.length>0&&n.a.createElement(St.Typography,{variant:"caption"},"Selected Addons: ",T.join(", "))),n.a.createElement("div",{className:a.footer},n.a.createElement(Ue.a,{variant:"contained",color:"primary",name:"previous-btn",onClick:function(){return e.handleNavigation(r-1)}},"Previous"),n.a.createElement(Ue.a,{variant:"contained",color:"primary",name:"submit-btn",onClick:function(){return e.handleNavigation(-1)}},"Submit")))}}])&&qw(t.prototype,a),r&&qw(t,r),i}(r.Component);!function(e,t,a){t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a}(Yw,"propTypes",{classes:u.a.object.isRequired,formData:u.a.object,updateFormData:u.a.func,step:u.a.number,addons:u.a.object});var $w=he()((function(e){return{summary:{maxWidth:e.spacing.formWidth},footer:{padding:"1rem .5rem ",marginTop:5*e.spacing.unit,display:"flex",justifyContent:"space-between"},details:{marginLeft:5*e.spacing.unit},icon:{fontSize:2*e.spacing.unit,paddingLeft:e.spacing.unit}}}))(Yw);function Qw(e){return function(e){if(Array.isArray(e))return Zw(e)}(e)||function(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||function(e,t){if(!e)return;if("string"==typeof e)return Zw(e,t);var a=Object.prototype.toString.call(e).slice(8,-1);"Object"===a&&e.constructor&&(a=e.constructor.name);if("Map"===a||"Set"===a)return Array.from(e);if("Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a))return Zw(e,t)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Zw(e,t){(null==t||t>e.length)&&(t=e.length);for(var a=0,r=new Array(t);a<t;a++)r[a]=e[a];return r}function Xw(e){return(Xw="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function eC(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function tC(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?eC(Object(a),!0).forEach((function(t){cC(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):eC(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function aC(e,t){for(var a=0;a<t.length;a++){var r=t[a];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function rC(e,t){return(rC=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function nC(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=sC(e);if(t){var n=sC(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return oC(this,a)}}function oC(e,t){return!t||"object"!==Xw(t)&&"function"!=typeof t?iC(e):t}function iC(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function sC(e){return(sC=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function cC(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}var lC={IMPORT:"Import Configurations",APPLICATION:"Application Configurations",SUMMARY:"Summary"},uC=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&rC(e,t)}(i,e);var t,a,r,o=nC(i);function i(e){var t;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),t=o.call(this,e);var a=e.location,r=yh.getClusterCreateParams({location:a}),n=r.id,s=void 0===n?"":n,c=r.operation,l=void 0===c?"create_cluster":c;return t.isEditView="edit_cluster"===l,t.state={id:s,activeStep:0,formData:{},clusterDataFetched:!1},t.getMeta=t.getMeta.bind(iC(t)),t.updateFormData=t.updateFormData.bind(iC(t)),t.processData=t.processData.bind(iC(t)),t.processEditData=t.processEditData.bind(iC(t)),t.submitImportClusterForm=t.submitImportClusterForm.bind(iC(t)),t.fetchK8sManifest=t.fetchK8sManifest.bind(iC(t)),t.fetchK8sClusterList=t.fetchK8sClusterList.bind(iC(t)),t}return t=i,(a=[{key:"getMeta",value:function(){return{title:"".concat(w.APP_TITLE.CP," | ").concat(this.isEditView?"Edit Kubernetes Cluster":"Import Kubernetes Cluster"),link:[{rel:"canonical",href:"".concat(w.serverUrl).concat(w.views.k8sImportCluster.url)}],meta:[{charset:"utf-8"},{name:"description",content:"Kubernetes Cluster Import/Edit Form"}]}}},{key:"componentDidMount",value:function(){this.fetchK8sManifest(),this.fetchK8sClusterList()}},{key:"fetchK8sManifest",value:function(){(0,this.props.dispatch)(Q(oe.K8S_MANIFEST))}},{key:"fetchK8sClusterList",value:function(){var e=this;(0,this.props.dispatch)(Q(oe.K8SCLUSTER_DATA())).then((function(){var t=e.props.k8scluster_list,a=e.state.id,r=void 0===a?"":a,n="",o={},i=[];t.map((function(t){var a=f.a.fetchSafeFromObject({path:["_links","self","href"],obj:t,default_value:{}}),s=f.a.fetchSafeFromObject({path:["label","name"],obj:t,default_value:{}});e.isEditView&&r===a?(n=s,o=t,e.updateFormData({data:t,nextStep:0})):i.push(s)})),e.setState({clusterDataFetched:!0,currentCluster:o,currentClusterName:n,clusterNames:i})}))}},{key:"updateFormData",value:function(e){var t=e.data,a=e.step,r=e.nextStep,n=this.state.formData,o=f.a.deepClone(n);if("number"===f.a.guessType(a))o[a]=t;else{var i=t.label,s=void 0===i?{}:i,c=t.pod_dns_domain,l=void 0===c?"cluster.local":c,u=t.sysadmin_data,p=void 0===u?{}:u,d=t.type,m=t.addons,h={};(void 0===m?[]:m).forEach((function(e){h[e]=!0})),o={0:{label:s,pod_dns_domain:l,sysadmin_data:p,type:d},1:{addons:h}}}-1===r?this.setState({formData:o},this.submitImportClusterForm):this.setState({formData:o,activeStep:r})}},{key:"getAddonList",value:function(e){var t=[];for(var a in e)!0===e[a]&&t.push(a);return t}},{key:"processData",value:function(e){var t=f.a.deepClone(e),a=tC(tC({},t[0]),t[1]),r=a.addons;return a.addons=this.getAddonList(r),a}},{key:"processEditData",value:function(e){var t=this.state.currentCluster,a=void 0===t?{}:t,r=[],n=e.label,o=void 0===n?{}:n,i=e.pod_dns_domain,s=void 0===i?"":i,c=e.sysadmin_data,l=void 0===c?{}:c,u=o.description,p=void 0===u?"":u,d=l.ca,f=void 0===d?"":d,m=l.bearer_token,h=void 0===m?"":m,b=a.label,v=void 0===b?{}:b,y=a.pod_dns_domain,g=void 0===y?"":y,_=v.description;return p!==(void 0===_?"":_)&&r.push({op:"replace",path:"/description",value:p,from:""}),s!==g&&r.push({op:"replace",path:"/pod_dns_domain",value:s,from:""}),""!==f&&r.push({op:"replace",path:"/ca",value:f,from:""}),""!==h&&r.push({op:"replace",path:"/bearer_token",value:h,from:""}),!!r.length&&r}},{key:"submitImportClusterForm",value:function(){var e=this,t=this.state,a=t.id,r=void 0===a?"":a,o=t.formData,i=this.processData(o),s=i.label.name,c=w.method.POST,l=w.apiurl.K8SCLUSTER_IMPORT;if(this.isEditView&&(c=w.method.PATCH,l=r,!(i=this.processEditData(i))))return _n({msg:"Nothing to update",variant:"success"}),!1;R({method:c,apiurl:l,data:i}).then((function(){_n({msg:"Successfully ".concat(e.isEditView?"updated":"imported"," Kubernetes cluster ").concat(s),variant:"success"}),f.a.redirectTo({context:e.props,location:"".concat(w.views.managek8sClusters.url)})})).catch((function(t){var a=f.a.parseAxiosError({error:t}),r=n.a.createElement(ns,{errors:["Failed to ".concat(e.isEditView?"update":"import"," Kubernetes cluster ").concat(s),a]});_n({msg:r,variant:"error"})}))}},{key:"render",value:function(){var e=this.getMeta(),t=this.props,a=t.steps,r=t.applicable_addons,o=this.state,i=o.formData,s=o.activeStep,c=o.clusterDataFetched,l=void 0!==c&&c,u=o.currentClusterName,p=void 0===u?"":u,d=o.clusterNames,f=void 0===d?[]:d;return n.a.createElement("div",{className:"K8sImportEditClusterPage"},n.a.createElement(Al.a,{title:e.title,description:e.description,link:e.link,meta:e.meta}),n.a.createElement(Nt,{title:this.isEditView?"Edit Imported Kubernetes Cluster ".concat(p):"Import Kubernetes Cluster"}),!l&&n.a.createElement(ls,null),n.a.createElement(gE.a,{activeStep:s},a.map((function(e){return n.a.createElement(SE.a,{key:e},n.a.createElement(OE.a,null,e))}))),a[s]===lC.IMPORT?n.a.createElement(Bw,{formData:i[s]||{},step:s,isEditView:this.isEditView,updateFormData:this.updateFormData,clusterNames:f,clusterDataFetched:l}):"",a[s]===lC.APPLICATION?n.a.createElement(sj,{formData:i[s]||{},step:s,isEditView:this.isEditView,updateFormData:this.updateFormData,addons:r,isImportClusterForm:!0}):"",a[s]===lC.SUMMARY?n.a.createElement($w,{formData:i||{},step:s,updateFormData:this.updateFormData,addons:r}):"")}}])&&aC(t.prototype,a),r&&aC(t,r),i}(r.Component);cC(uC,"propTypes",{classes:u.a.object.isRequired,dispatch:u.a.func.isRequired,location:u.a.object,k8scluster_list:u.a.array,steps:u.a.array,applicable_addons:u.a.object});var pC=d()(he()((function(e){return{footer:{padding:"1rem .5rem ",marginTop:5*e.spacing.unit,display:"flex",justifyContent:"space-between",backgroundColor:e.palette.gray200},prevBtn:{marginRight:2*e.spacing.unit}}}),{name:"K8sImportEditClusterPage"}),Object(s.b)((function(e){var t=e.page_data,a=void 0===t?{}:t,r=f.a.fetchSafeFromObject({path:["k8s_manifest"],obj:a,default_value:{}}),n=f.a.fetchSafeFromObject({path:["import_addons"],obj:r,default_value:[]}),o=f.a.fetchSafeFromObject({path:["k8scluster_list","_embedded","k8sclusters"],obj:a,default_value:[]}),i=yh.getApplicableAddonsObj({k8s_manifest:r,addonIds:n});return{k8scluster_list:o,applicable_addons:i,steps:function(e){var t=Object.keys(e).length;return Object.values(lC).reduce((function(e,a){return a===lC.APPLICATION&&0===t?Qw(e):[].concat(Qw(e),[a])}),[])}(i)}})))(uC),dC=function(e){var t=e.hostByRole,a=void 0===t?{}:t,r=e.k8sClusterHref,o=void 0===r?"":r;return n.a.createElement(n.a.Fragment,null,Object.keys(a).map((function(e){return n.a.createElement(Yi,{key:e,header:"".concat(e," (").concat(a[e].length,")"),icon:"icon-chevron-down",placement:"start",expanded:!1,noBackground:!0},a[e].length<=20?n.a.createElement(n.a.Fragment,null,a[e].map((function(e,t){return n.a.createElement(mC,{host:e,key:f.a.uniqueKey(t)})}))):n.a.createElement(n.a.Fragment,null,Array.from(Array(20).keys()).map((function(t){return n.a.createElement(mC,{host:a[e][t],key:f.a.uniqueKey(t)})})),n.a.createElement(st.a,{variant:"caption",style:{display:"inline"}},"".concat(a[e].length-20," more hosts, visit ")),n.a.createElement(lo.a,{to:g.a.k8sClusterDashboard.makeUrl({id:o}),className:"link"},"cluster dashboard"),n.a.createElement(st.a,{variant:"caption",style:{display:"inline"}}," for complete list")))})))},fC=dC,mC=function(e){var t=e.host,a=(t=void 0===t?{}:t).hostname,r=void 0===a?"":a,o=t.ipaddr,i=void 0===o?"":o;return n.a.createElement("div",null,n.a.createElement(xa,{title:r},n.a.createElement("div",{className:"header"},n.a.createElement(st.a,{variant:"h5"},"Host Detail")),n.a.createElement("div",{className:"content"},n.a.createElement(st.a,{variant:"body1"},"IP Address: ",i))))};function hC(e){return(hC="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function bC(){return(bC=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var r in a)Object.prototype.hasOwnProperty.call(a,r)&&(e[r]=a[r])}return e}).apply(this,arguments)}function vC(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function yC(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?vC(Object(a),!0).forEach((function(t){DC(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):vC(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function gC(e,t){for(var a=0;a<t.length;a++){var r=t[a];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function _C(e,t,a){return t&&gC(e.prototype,t),a&&gC(e,a),e}function SC(e,t){return(SC=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function kC(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=jC(e);if(t){var n=jC(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return OC(this,a)}}function OC(e,t){return!t||"object"!==hC(t)&&"function"!=typeof t?EC(e):t}function EC(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function jC(e){return(jC=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function DC(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}dC.propTypes={hostByRole:u.a.object,k8sClusterHref:u.a.string},mC.propTypes={host:u.a.object};var wC=w.views,CC=w.settings,TC=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&SC(e,t)}(a,e);var t=kC(a);function a(e){var r;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,a),DC(EC(r=t.call(this,e)),"getStatusLabelOptions",(function(e){var t=e.status,a=e.status_message,r={status:t,title:t};switch(t){case"delete_in_progress":r.title="deleting";break;case"ready":r.title="ready";break;case"config_error":r.title="error",r.tooltip="Configuration error";break;case"error":r.title="error"}return a&&(r.tooltip=a),r}));var o=f.a.fetchSafeFromObject({path:["location","pathname"],obj:e,default_value:""});return r.isDataFabricView=o.includes("manage-datafabric-cluster"),r.deleteK8sClusterList=r.deleteK8sClusterList.bind(EC(r)),r.getK8sClusterTableSettings=r.getK8sClusterTableSettings.bind(EC(r)),r.k8sClusterGeneralOps=r.k8sClusterGeneralOps.bind(EC(r)),r.fetchK8sClusters=r.fetchK8sClusters.bind(EC(r)),r.k8sClusterSetUpLogInfo=r.k8sClusterSetUpLogInfo.bind(EC(r)),r.downloadData=r.downloadData.bind(EC(r)),r.invokeUpgradeK8sClusterModal=r.invokeUpgradeK8sClusterModal.bind(EC(r)),r.getClusterUpgradeFormSchema=r.getClusterUpgradeFormSchema.bind(EC(r)),r.getFailedHostsList=r.getFailedHostsList.bind(EC(r)),r.refreshK8sManifest=r.refreshK8sManifest.bind(EC(r)),r.getK8sManifestLog=r.getK8sManifestLog.bind(EC(r)),r.upgradeFormValidator=r.upgradeFormValidator.bind(EC(r)),r.onAddUserGroupClick=r.onAddUserGroupClick.bind(EC(r)),r.onDropUserGroupClick=r.onDropUserGroupClick.bind(EC(r)),r.fetchTenantData=r.fetchTenantData.bind(EC(r)),r.k8sDialog=n.a.createRef(),r.bdModalChildRef=n.a.createRef(),r.bdModaFormlRef=n.a.createRef(),r.bdModalFormChildRef=n.a.createRef(),r.retryUpgrade=!1,r.CancelToken=T.a.CancelToken,r.source=null,r.timeout=null,r.state={modalData:{},kubernetesUpgradeFormSchema:{},upgradable_versions:[],id:"",k8s_version:"",k8ClustersDataFetched:!1,k8sHostsDataFetched:!1,tenantDataFetched:!1,form:{},submitDisabled:!1},r}return _C(a,null,[{key:"getMeta",value:function(e){var t=e?"manageDataFabricClusters":"managek8sClusters",a=wC[t].viewLabel;return{title:"".concat(w.APP_TITLE.CP," | ").concat(a),pageTitle:a,link:[{rel:"canonical",href:"".concat(w.serverUrl).concat(wC[t].url)}],meta:[{charset:"utf-8"},{name:"description",content:"Manage ".concat(a)}]}}}]),_C(a,[{key:"componentDidMount",value:function(){var e=this,t=this.props.dispatch;this.fetchK8sClusters(),this.fetchTenantData(),t(Q(oe.K8SHOST_DATA)).then((function(){e.setState({k8sHostsDataFetched:!0})})),t(Q(oe.ROLE_DATA))}},{key:"componentWillUnmount",value:function(){clearTimeout(this.timeout),this.source&&this.source.cancel("Component unmounted")}},{key:"fetchK8sClusters",value:function(){var e=this,t=this.props.dispatch;this.source=this.CancelToken.source(),t(Q(yC(yC({},oe.K8SCLUSTER_DATA(["stats"])),{},{cancelToken:this.source.token}))).then((function(){e.setState({k8ClustersDataFetched:!0});var t=e.props.k8sclusters;tE.liveUpdateK8sCluster(t)&&(e.timeout=setTimeout((function(){e.fetchK8sClusters()}),3e4))}))}},{key:"fetchTenantData",value:function(){var e=this;(0,this.props.dispatch)(Q(oe.TENANT_DATA_V1)).then((function(){e.setState({tenantDataFetched:!0})}))}},{key:"getK8sClusterTableSettings",value:function(){var e=this,t=this.props,a=t.k8sclusters,r=t.role_name,o=t.classes,i=t.hasTenantStorageSet;return{columns:[{name:"Cluster Name",options:{customBodyRender:function(e){var t=JSON.parse(e),a=t.name,r=t.k8sClusterHref,o=t.classes;return n.a.createElement(lo.a,{className:o.link,to:wC.k8sClusterDashboard.makeUrl({id:r})},a)}}},{name:"Version",options:{filter:!0}},{name:"Hosts",options:{sort:!1,customBodyRender:function(e){var t=JSON.parse(e),a=t.hostByRole,r=t.k8sClusterHref;return n.a.createElement(fC,{hostByRole:a,k8sClusterHref:r})}}},{name:"Type",options:{filter:!0}},{name:"Resources",options:{sort:!1,filter:!0,customBodyRender:function(e){var t=JSON.parse(e),a=t.cores,r=void 0===a?0:a,o=t.memory_gb,s=void 0===o?0:o,c=t.gpus,l=void 0===c?0:c,u=t.ephemeral_storage_size_gb,p=void 0===u?0:u,d=t.persistent_storage_size_gb,f=void 0===d?0:d,m=t.imported;return n.a.createElement(n.a.Fragment,null,n.a.createElement(st.a,{variant:"body1"},"CPU Cores: ".concat(r)),n.a.createElement(st.a,{variant:"body1"},"Memory (GB): ".concat(s)),n.a.createElement(st.a,{variant:"body1"},"GPUs: ".concat(l)),!(!0===m)&&n.a.createElement(st.a,{variant:"body1"},"Ephemeral Storage (GB): ".concat(p)),!(!0===m)&&n.a.createElement(st.a,{variant:"body1"},"Persistent Storage (GB): ".concat(i?f:"N/A")))}}},{name:"Details",options:{sort:!1,filter:!0,customBodyRender:function(e){var t=JSON.parse(e),a=t.created_by_user_name,r=t.created_time;return n.a.createElement(n.a.Fragment,null,r?n.a.createElement(st.a,{variant:"body1"},"Created At: ",Fc.a.unix(r).format(CC.time_format)):"",a?n.a.createElement(st.a,{variant:"body1"},"Created by: ",a):"")}}},{name:"Status",options:{filter:!0,customBodyRender:function(t){var a=JSON.parse(t),r=e.getStatusLabelOptions(a);return n.a.createElement(Qa,r)}}},{name:"Actions",options:{sort:!1,filter:!1,customBodyRender:function(t){var a=JSON.parse(t),o=a.name,i=a.id,s=a.status,c=a.hasHosts,l=a.k8s_version,u=a.imported,p=tE.getK8sClusterActionButtons({status:s,id:i,hasHosts:c,imported:u}),d=["warning"].includes(s)?e.getFailedHostsList(i,l):[],f="Site Admin"===r;return n.a.createElement("div",{className:"row-action-btns",id:i,name:o},p.map((function(t){var a=t.action,r=t.btn_type,c=t.icon,u=t.title,p=t.variant,m=t.url;return"power_ops"===r&&f?n.a.createElement(ka,{title:u,variant:p,key:c},n.a.createElement("span",{className:se()("icon","icon-rect-link",c),onClick:function(){var t={callback:tE.k8sClusterPowerOps,context:{action:a,id:i,name:o,callback:e.fetchK8sClusters},title:"",description:"Confirm '".concat(a,"' action  for k8s cluster '").concat(o,"'")};e.k8sDialog.current.handleOpen(t)}})):"link"===r&&f?n.a.createElement(ka,{title:u,variant:p,key:c},n.a.createElement(lo.a,{to:m},n.a.createElement("span",{className:se()("icon","icon-rect-link",c)}))):"general_ops"===r?n.a.createElement(ka,{title:u,variant:p,key:c},n.a.createElement("span",{className:se()("icon","icon-rect-link",c),onClick:function(){e.k8sClusterGeneralOps({action:a,id:i,name:o,title:u})}})):"upgrade"===r&&f||"retry_upgrade"===r&&d.length&&f?n.a.createElement(ka,{title:u,variant:p,key:c},n.a.createElement("span",{className:se()("icon","icon-rect-link",c),onClick:function(){e.invokeUpgradeK8sClusterModal({id:i,status:s,k8s_version:l,btn_type:r})}})):void 0})))}}}],data:a.reduce((function(t,a){var r=a.label,n=(r=void 0===r?{}:r).name,i=void 0===n?"":n,s=a.cluster_quota,c=void 0===s?{}:s,l=a.k8shosts_config,u=void 0===l?[]:l,p=a.k8s_version,d=void 0===p?"":p,m=a.imported,h=void 0!==m&&m,b=a.type,v=void 0===b?"":b,y=a.status,g=void 0===y?"":y,_=a.status_message,S=void 0===_?"":_,k=a.created_by_user_name,O=void 0===k?"":k,E=a.created_time,j=void 0===E?"":E,D=f.a.fetchSafeFromObject({path:w.pathToID,obj:a,default_value:""}),C=e.getHosts(u),T=f.a.fetchSafeFromObject({path:[v],obj:tE.importedClusterTypesMap,default_value:""});return!0===h&&(T+=" (Imported)"),t.push([JSON.stringify({k8sClusterHref:D,name:i,classes:o}),d,JSON.stringify({hostByRole:C,k8sClusterHref:D}),T,JSON.stringify(yC(yC({},c),{},{imported:h})),JSON.stringify({created_by_user_name:O,created_time:j}),JSON.stringify({status:g,status_message:S}),JSON.stringify({id:D,name:i,status:g,hasHosts:u.length,k8s_version:d,imported:h})]),t}),[]),options:{customToolbar:function(){return n.a.createElement("div",{className:"tableActionButtons"},e.isDataFabricView?n.a.createElement(Ue.a,{variant:"contained",color:"primary",component:lo.a,to:wC.createDataFabricCluster.url,className:o.CreateCluster},"Create DataFabric Cluster"):n.a.createElement(n.a.Fragment,null,n.a.createElement(Ue.a,{variant:"contained",color:"primary",onClick:e.refreshK8sManifest},"Refresh Kubernetes Manifest"),n.a.createElement(Ue.a,{variant:"contained",color:"primary",onClick:e.getK8sManifestLog},"Kubernetes Manifest Log"),n.a.createElement(Ue.a,{variant:"contained",color:"primary",component:lo.a,to:wC.k8sCreateCluster.url,className:o.CreateCluster},"Create Kubernetes Cluster"),n.a.createElement(Ue.a,{variant:"contained",color:"primary",component:lo.a,to:wC.k8sImportCluster.url,className:o.CreateCluster},"Import Kubernetes Cluster")))},customToolbarSelect:function(t){return n.a.createElement("div",{className:"{classes.tableActionButtonsSelected}"},n.a.createElement(Ue.a,{variant:"contained",color:"secondary",onClick:function(){var a={callback:e.deleteK8sClusterList,context:{selectedRows:t},title:"Delete selected Kubernetes cluster(s)",description:"Confirm Deletion. This action cannot be undone"};e.k8sDialog.current.handleOpen(a)}},"Delete"))},customSort:function(e,t,a){return 0===t?f.a.sortTableColumn({data:e,colIndex:t,order:a,parse:!0,sortBy:["name"]}):f.a.sortTableColumn({data:e,colIndex:t,order:a})}}}}},{key:"refreshK8sManifest",value:function(){var e=this.props.dispatch,t=w.apiurl.K8S_MANIFEST;R({apiurl:t,method:w.method.POST}).then((function(){_n({msg:"Kubernetes Manifest refreshed successfully",variant:"success"}),e(I({apiUrl:w.apiurl.CONFIG_V2,propVal:"g_config_data"}))})).catch((function(){_n({msg:"Failed to refresh Kubernetes Manifest",variant:"error"})}))}},{key:"getK8sManifestLog",value:function(){var e=this,t=this.props.classes,a=w.apiurl.K8S_MANIFEST_LOG;R({apiurl:a}).then((function(a){var r=a.data,o=(void 0===r?{}:r).logData,i=void 0===o?"":o,s={Title:n.a.createElement(st.a,{variant:"h4",className:t.dataTitle},"Kubernetes Manifest Log"),content:n.a.createElement(st.a,{variant:"caption",className:se()(t.preserveWhitespace,t.logDataContainer)},i)};e.setState({modalData:s},(function(){e.bdModalChildRef.current.handleOpen()}))})).catch((function(){_n({msg:"Failed to get Kubernetes Manifest Log",variant:"error"})}))}},{key:"getHosts",value:function(e){var t=this.props.k8shosts,a=void 0===t?[]:t,r={};return e.length&&a.length?(e.map((function(e){var t=e.node,n=void 0===t?"":t,o=e.role,i=void 0===o?"":o;Object.keys(r).includes(i)||(r[i]=[]);var s=a.find((function(e){return n===f.a.fetchSafeFromObject({path:["_links","self","href"],obj:e,default_value:""})}));r[i].push(s)})),f.a.orderBy(["master"],r)):r}},{key:"deleteK8sClusterList",value:function(e){var t=this;e.selectedRows.data.map((function(e){var a=e.rowData,r=a[a.length-1],n=JSON.parse(r),o=n.id,i=n.name;tE.deleteK8sCluster({id:o,name:i,callback:t.fetchK8sClusters})}))}},{key:"downloadData",value:function(e){var t=e.data,a=e.name,r=e.action;if(t)return function(){tE.downloadK8sClusterRelatedFiles({data:t,name:a,action:r})}}},{key:"k8sClusterSetUpLogInfo",value:function(e){var t=this,a=e.id,r=e.title,o=e.name,i=e.action,s=this.props.classes,c=w.apiurl.K8SCLUSTER_SETUP_LOG(a);R({apiurl:c}).then((function(e){var a=e.data,c=void 0===a?"":a,l={Title:n.a.createElement(n.a.Fragment,null,n.a.createElement(st.a,{variant:"h4",className:s.dataTitle},r),n.a.createElement(ka,{title:"Download Log",variant:"primary"},n.a.createElement(Ue.a,{color:"primary",size:"small",onClick:t.downloadData({data:c,name:o,action:i})},n.a.createElement("span",{className:"icon icon-download2 icon-rect-link"})))),name:"Setup log info",description:"Modal to display setup log info",content:n.a.createElement(st.a,{variant:"caption",className:se()(s.preserveWhitespace,s.logDataContainer)},e.data)};t.setState({modalData:l},(function(){t.bdModalChildRef.current.handleOpen()}))})).catch((function(e){_n({msg:"Failed to show ".concat(r,". ").concat(e),variant:"error"})}))}},{key:"k8sClusterGeneralOps",value:function(e){var t=e.action,a=e.id,r=e.name,o=e.title,i=this.props,s=i.k8sclusters,c=i.classes,l=f.a.fetchSafeFromObjectArray({arr:s,path:["_links","self","href"],match:a,default_value:{}});switch(t){case"dashboard":var u=l.dashboard_endpoint_access,p=void 0===u?"":u,d=l.dashboard_token,m=void 0===d?"":d;if(p&&m){var h=atob(m);f.a.copyToClipboard(h);var b=n.a.createElement(n.a.Fragment,null,n.a.createElement(st.a,null,"Kubernetes dashboard url : ",p),n.a.createElement(st.a,{className:c.wrapText},"Authentication Token : ",h),n.a.createElement(st.a,{variant:"h6"},"Please ",n.a.createElement("span",{className:c.bold},'click on "Proceed to Kubernetes Dashboard"')," to open url in new tab"),n.a.createElement(st.a,{variant:"h6"},"If prompted, select token based authentication."),n.a.createElement(st.a,{variant:"h6"},"Auth token is already copied to clipboard. ",n.a.createElement("span",{className:c.bold},"right click and paste")," in input field for token and click on Sign In")),v={callback:this.openK8sDashboard,context:{dashboard_endpoint_access:p},title:"",description:b,btnSubmit:"Proceed to Kubernetes Dashboard"};this.k8sDialog.current.handleOpen(v)}else _n({msg:"Failed to fetch kubernetes dashboard link",variant:"success"});break;case"kubeconfig":var y=l.admin_kube_config,g=void 0===y?"":y;tE.downloadK8sClusterRelatedFiles({data:g,name:r,action:t});break;case"log":this.k8sClusterSetUpLogInfo({id:a,title:o,name:r,action:t});break;case"user":this.redirectToClusterAdmin({id:a});break;case"usergroup":this.invokeUpdateClusterAdminUserGroupModal({id:a});break;default:_n({msg:"".concat(t," not implemented yet"),variant:"success"})}}},{key:"redirectToClusterAdmin",value:function(e){var t=e.id,a=this.props.clusterAdminByClusterId,r=f.a.fetchSafeFromObject({path:[t,"tenant_id"],obj:a,default_value:""});r?window.location.href=w.views.tenantUserList.makeUserListUrl({id:r}):_n({msg:"Failed to get id for Cluster Admin",variant:"error"})}},{key:"openK8sDashboard",value:function(e){var t=e.dashboard_endpoint_access;window.open(t,"_blank")}},{key:"getFailedHostsList",value:function(e,t){var a=this.props,r=a.k8sclusters,n=a.k8shosts.filter((function(a){var r=a.cluster_id,n=void 0===r?"":r,o=a.k8s_version;return e===n&&t!==(void 0===o?"":o)})),o=r.filter((function(t){var a=f.a.fetchSafeFromObject({path:["_links","self","href"],obj:t,default_value:""});return e===a})),i=o.length&&o[0].k8shosts_config,s=[];return i.map((function(e){n.find((function(t){var a=f.a.fetchSafeFromObject({path:["_links","self","href"],obj:t,default_value:""});e.node===a&&s.push(a)}))})),s}},{key:"invokeUpgradeK8sClusterModal",value:function(e){var t=this,a=e.id,r=e.status,o=e.k8s_version,i=e.btn_type,s=this.props.k8s_versions,c=this.state.submitDisabled,l="upgrade"===i,u=[];l||"warning"!==r||(u=this.getFailedHostsList(a,o));var p=s.includes(o)&&s.indexOf(o),d=s.slice(p+1);c=!(d.length||!l);var f=er({path:["k8sClusterUpgrade"]}),m=l?"".concat(f.title," (current version: ").concat(o,")"):"Retry ".concat(f.title," ( retry upgrade version: ").concat(o,")"),h={form_id:"upgradeK8sCluster",Title:n.a.createElement("div",null,n.a.createElement(st.a,{variant:"h2"},m),!d.length&&l?n.a.createElement(st.a,{variant:"caption"},f.subTitle):""),form_schema:this.getClusterUpgradeFormSchema({upgradable_versions:d,btn_type:i,upgradeFailedHosts:u,formMsg:f}),formMsg:f,callBack:this.fetchK8sClusters,validate:this.upgradeFormValidator,preProcessData:function(e){return AC(e,t)},method_actions:[{method:w.method.POST,action:w.apiurl.K8S_CLUSTER_CHANGE_TASK(a),data:"FORM_DATA"}]};this.setState({form:h,upgradable_versions:d,id:a,submitDisabled:c},(function(){t.bdModaFormlRef.current.openModal()}))}},{key:"getClusterUpgradeFormSchema",value:function(e){var t=e.upgradable_versions,a=e.btn_type,r=e.upgradeFailedHosts,n=e.formMsg,o=t.length,i={type:"object",properties:{worker_upgrade_percent:{type:"integer",title:"Upgrade Percentage",description:n.upgradePercentileDescription,bd_disabled:"upgrade"===a&&!o}}};return"upgrade"===a?(this.retryUpgrade=!1,i.properties=yC({k8s_upgrade_version:{type:"string",title:"Upgrade Version",description:n.k8sVersionDescription,uniqueItems:!0,enum:t,default:t[0],bd_required:!0,bd_disabled:!o}},i.properties)):(this.retryUpgrade=!0,i.properties=yC({retry_hosts:{type:"array",title:"Retry Upgrade Hosts",description:n.retryUpgradeHostsPaths,items:{type:"string",enum:r},default:r,hidden:!0}},i.properties)),i}},{key:"upgradeFormValidator",value:function(e,t){var a=e.worker_upgrade_percent;return"number"===f.a.guessType(a)&&(a<1||a>100)&&t.worker_upgrade_percent.addError("Please provide an integer between 1 and 100"),t}},{key:"getUserGroupSchema",value:function(){return{type:"object",properties:{role:{type:"string",default:this.props.k8sAdminRole,hidden:!0},group:{type:"string",placeholder:"ou=People,dc=example,dc=com",bd_widget:"textarea"}}}}},{key:"invokeUpdateClusterAdminUserGroupModal",value:function(e){var t=e.id,a=this,r=this.props,o=r.k8sAdminRole,i=r.clusterAdminByClusterId[t],s=i.tenant_id,c=void 0===s?"":s,l=i.external_user_groups,u=void 0===l?[]:l,p=this.getUserGroupSchema(),d=u.length,f={external_user_groups:d?u:[{role:o,group:""}]},m=Array(d||1).fill(p),h=er({path:["k8sClusterAdminUserGroupForm"]}),b={form_id:"updateClusterAdminUserGroup",Title:n.a.createElement(st.a,{variant:"h2"},h.title),formMsg:h,callBack:this.fetchTenantData,method_actions:[{method:w.method.PUT,action:w.apiurl.EXTERNAL_USER_GROUPS(c),data:"FORM_DATA"}],form_schema:{type:"object",properties:{external_user_groups:{type:"array",title:h.externalGroupTitle,items:m,canAdd:!0,addItemTitle:h.externalGroupAddItemTitle,onAddClick:this.onAddUserGroupClick,onDropClick:this.onDropUserGroupClick,description:h.externalGroupDescription}}},variant:"trim",preProcessData:function(e){return RC(e)}};this.setState({form:b},(function(){a.bdModaFormlRef.current.updateStateFormData({formData:f}),a.bdModaFormlRef.current.openModal()}))}},{key:"onAddUserGroupClick",value:function(){var e=this,t=this.props.k8sAdminRole,a=this.state.form,r=void 0===a?{}:a,n=r.form_schema,o=this.bdModaFormlRef.current.state.formData,i=this.getUserGroupSchema();n.properties.external_user_groups.items.push(i),o.external_user_groups.push({role:t,group:""}),this.setState({form:yC(yC({},r),{},{form_schema:n})},(function(){e.bdModaFormlRef.current.updateStateFormData({formData:o})}))}},{key:"onDropUserGroupClick",value:function(e){var t=this.state.form,a=void 0===t?{}:t,r=a.form_schema,n=this.bdModaFormlRef.current.state.formData;r.properties.external_user_groups.items.splice(e,1),n.external_user_groups.splice(e,1),this.setState({form:yC(yC({},a),{},{form_schema:r})}),this.bdModaFormlRef.current.updateStateFormData({formData:n})}},{key:"render",value:function(){var e=this,t=a.getMeta(this.isDataFabricView),r=this.getK8sClusterTableSettings(),o=this.state,i=o.modalData,s=void 0===i?{}:i,c=o.form,l=o.k8ClustersDataFetched,u=o.k8sHostsDataFetched,p=o.tenantDataFetched,d=o.submitDisabled,f=l&&u&&p,m=c.form_id,h=void 0===m?"":m,b=c.Title,v=void 0===b?"":b,y=c.formMsg,g=void 0===y?{}:y,_=c.form_schema,S=void 0===_?{}:_,k=c.callBack,O=void 0===k?null:k,E=c.validate,j=void 0===E?null:E,D=c.method_actions,C=void 0===D?[{method:w.method.POST,action:""}]:D,T=c.preProcessData,P=void 0===T?null:T,A=c.variant,R=void 0===A?"default":A;return n.a.createElement("div",{className:"ManageK8sClustersPage"},n.a.createElement(Al.a,{title:t.title,description:t.description,link:t.link,meta:t.meta}),n.a.createElement(Nt,{title:t.pageTitle}),f?n.a.createElement(sa,r):n.a.createElement(ls,null),n.a.createElement(no,{ref:this.k8sDialog}),n.a.createElement(In,bC({ref:this.bdModalChildRef},s,{footerCloseBtn:!0,onModalClose:function(){return e.setState({modalData:{}})}}),s.content),n.a.createElement(Jn,{form_id:h,Title:v,name:g.name||"",description:g.description||"",formData:{},form_schema:S,callBack:O,preProcessData:P,success_ms:!0,g:g.successMessage||"",failure_msg:g.failureMessage||"",validate:j,variant:R,method_actions:C,submitDisabled:d,ref:this.bdModaFormlRef}))}}]),a}(r.Component);DC(TC,"propTypes",{classes:u.a.object.isRequired,dispatch:u.a.func.isRequired,k8sclusters:u.a.array,k8shosts:u.a.array,role_name:u.a.string,k8sAdminRole:u.a.string,clusterAdminByClusterId:u.a.object,location:u.a.object,k8s_versions:u.a.array,hasTenantStorageSet:u.a.bool});var PC=d()(he()((function(e){return{bold:{fontFamily:"MetricHPE-Web-Bold"},link:{color:e.palette.primary.main,cursor:"pointer",textDecoration:"none"},wrapText:{wordBreak:"break-all"},dataTitle:{display:"flex",justifyContent:"space-between",alignItems:"center"},logDataContainer:{padding:"1rem"},CreateCluster:{marginLeft:e.spacing.unit},preserveWhitespace:e.bdMixins.PreserveWhitespace}}),{name:"App"}),Object(s.b)((function(e){var t=e.stats_data,a=void 0===t?{}:t,r=e.page_data,n=(r=void 0===r?{}:r).tenant_list_v1,o=void 0===n?{}:n,i=r.k8scluster_list,s=void 0===i?{}:i,c=r.role_list,l=void 0===c?{}:c,u=r.k8shost_list,p=void 0===u?{}:u,d=f.a.fetchSafeFromObject({path:["_embedded","tenants"],obj:o,default_value:[]}),m=f.a.fetchSafeFromObject({path:["_embedded","roles"],obj:l,default_value:[]}),h=f.a.fetchSafeFromObject({path:["_embedded","k8sclusters"],obj:s,default_value:[]}),b=f.a.fetchSafeFromObject({path:["_embedded","k8shosts"],obj:p,default_value:[]}),v=f.a.fetchSafeFromObject({path:["g_install","bdshared_storage_localfstype"],obj:a,default_value:""}),y=f.a.fetchSafeFromObjectArray({arr:m,path:["label","name"],match:"K8S Admin",get:["_links","self","href"],default_value:""}),g=d.reduce((function(e,t){if("k8s_admin"===t.tenant_type){var a=t.k8s_cluster,r=t._links,n=t.label,o=t.external_user_groups,i=f.a.fetchSafeFromObject({path:["self","href"],obj:r,default:""});e[a]=yC(yC({tenant_id:i},n),{},{external_user_groups:o})}return e}),{});return{k8s_versions:f.a.fetchSafeFromObject({path:["g_config_data","k8s_versions"],obj:a,default_value:[]}),k8sAdminRole:y,clusterAdminByClusterId:g,k8sclusters:h,k8shosts:b,hasTenantStorageSet:!!v}})))(TC),AC=function(e,t){var a="",r={},n=e.k8s_upgrade_version,o=void 0===n?"":n,i=e.worker_upgrade_percent,s=void 0===i?20:i,c=e.retry_hosts,l=void 0===c?[]:c;return r=t.retryUpgrade?{k8s_upgrade_retry:{retry_hosts:l,worker_upgrade_percent:s}}:{k8s_upgrade:{k8s_upgrade_version:o,worker_upgrade_percent:s}},f.a.isEmptyObject(r)||(a={operation:"reconfigure",change_spec:r,reason:t.retryUpgrade?"Retry kubernetes upgrade":"Kubernetes upgrade"}),a},RC=function(e){var t=e.external_user_groups;return{external_user_groups:(void 0===t?[]:t).filter((function(e){return e.group}))}};function NC(e){return(NC="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function FC(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function xC(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?FC(Object(a),!0).forEach((function(t){qC(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):FC(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function MC(e,t){for(var a=0;a<t.length;a++){var r=t[a];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function IC(e,t,a){return t&&MC(e.prototype,t),a&&MC(e,a),e}function UC(e,t){return(UC=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function LC(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=KC(e);if(t){var n=KC(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return BC(this,a)}}function BC(e,t){return!t||"object"!==NC(t)&&"function"!=typeof t?HC(e):t}function HC(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function KC(e){return(KC=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function qC(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}var VC=er({path:["hostAddTooltipMsg"]}),GC=$l.getHostFormSchema(),zC=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&UC(e,t)}(a,e);var t=LC(a);function a(e){var r;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,a),(r=t.call(this,e)).CancelToken=T.a.CancelToken,r.source=null,r.hostUpdates={},r.dataUpdates={},r.fetchK8sHosts=r.fetchK8sHosts.bind(HC(r)),r.fetchK8sClusters=r.fetchK8sClusters.bind(HC(r)),r.submitRESTAPI=r.submitRESTAPI.bind(HC(r)),r.submitForm=r.submitForm.bind(HC(r)),r.validateForm=r.validateForm.bind(HC(r)),r.onFormChange=r.onFormChange.bind(HC(r)),r.onChangeKeyFile=r.onChangeKeyFile.bind(HC(r)),r.fetchHostsTags=r.fetchHostsTags.bind(HC(r)),r.onAddTagClick=r.onAddTagClick.bind(HC(r)),r.onDropTagClick=r.onDropTagClick.bind(HC(r)),r.bdFormRef=n.a.createRef(),r.updateDiskSelection=r.updateDiskSelection.bind(HC(r)),r.processDisksData=r.processDisksData.bind(HC(r)),r.updateHostData=r.updateHostData.bind(HC(r)),r.state={submitted:0,formSchema:GC,disks_selection:{},hostsTagsFetched:!1,hostsDataFetched:!1,clusterDataFetched:!1,tagItemSchema:{},tagItemDefaultData:{},tagOptions:[],tagValuesByID:{},updateKey:0},r.form={formData:{}},r}return IC(a,null,[{key:"getMeta",value:function(){return{title:"".concat(w.APP_TITLE.CP," | Hosts Page"),link:[{rel:"canonical",href:"".concat(w.serverUrl).concat(w.views.k8sHosts.url)}],meta:[{charset:"utf-8"},{name:"description",content:"Kubernetes Hosts"}]}}}]),IC(a,[{key:"componentDidMount",value:function(){this.fetchK8sHosts(),this.fetchK8sClusters(),this.fetchHostsTags()}},{key:"componentWillUnmount",value:function(){for(var e in this.dataUpdates)this.dataUpdates[e].cancel("component unmounted");for(var t in this.hostUpdates)this.hostUpdates[t].cancel("component unmounted")}},{key:"fetchK8sClusters",value:function(){var e=this,t=this.props.dispatch;this.dataUpdates.k8sClusters=this.CancelToken.source(),t(Q(xC(xC({},oe.K8SCLUSTER_DATA()),{},{cancelToken:this.dataUpdates.k8sClusters.token}))).then((function(){e.setState({clusterDataFetched:!0}),delete e.dataUpdates.k8sClusters}))}},{key:"fetchK8sHosts",value:function(e){var t=this,a=this.props.dispatch;this.dataUpdates.k8sHosts=this.CancelToken.source(),a(Q(xC(xC({},oe.K8SHOST_DATA),{},{cancelToken:this.dataUpdates.k8sHosts.token,retry:e}))).then((function(){t.setState({hostsDataFetched:!0}),delete t.dataUpdates.k8sHosts}))}},{key:"updateHostData",value:function(e,t,a){var r=this,n=this.props.dispatch;if(!this.hostUpdates[e]){this.hostUpdates[e]={source:this.CancelToken.source()};var o=f.a.fetchSafeFromObject({path:[e,"source","token"],obj:this.hostUpdates}),i=oe.UPDATE_K8SHOST_DATA_ITEM(e,o);n(Z(i)).then((function(){delete r.hostUpdates[e],Object.keys(r.hostUpdates).length||r.setState({updateKey:r.state.updateKey+1});var n=r.props.k8sHosts.find((function(t){return f.a.fetchSafeFromObject({path:w.pathToID,obj:t})===e}));n&&(r.processDisksData(e,n),t&&t(e,n,a))}))}}},{key:"fetchHostsTags",value:function(){var e=this;(0,this.props.dispatch)(Q(oe.HOSTSTAGS)).then((function(){var t=e.props.page_data,a=e.state.formSchema,r=f.a.fetchSafeFromObject({path:["hosts_tags","_embedded","tags"],obj:t,default_value:[]}),n=Ll(r),o=Ul(r),i=o.length?o[0].enum[0]:"",s=o.length?Hl(o,i,n):{},c=o.length?{tag_id:"",tag_value:""}:{};a.properties.tags=o.length?{type:"array",title:"Tags",description:VC.tags("kubernetes"),items:[s],canAdd:!0,addItemTitle:"Tag",onAddClick:e.onAddTagClick,onDropClick:e.onDropTagClick}:{type:"object",help:'Tags must be configured prior to adding them for kubernetes host(s). Click "Manage Tags" above to add tags'},e.setState({formSchema:a,tagItemSchema:s,tagItemDefaultData:c,tagOptions:o,tagValuesByID:n,hostsTagsFetched:!0})}))}},{key:"onAddTagClick",value:function(){var e=f.a.fetchSafeFromObject({path:["current","state","formData"],obj:this.bdFormRef,default_value:{}}),t=this.state,a=t.formSchema,r=t.tagItemSchema,n=t.tagItemDefaultData;a.properties.tags.items.push(r),e.tags.push(n),this.form.formData=e,this.setState({formSchema:a})}},{key:"onDropTagClick",value:function(e){var t=f.a.fetchSafeFromObject({path:["current","state","formData"],obj:this.bdFormRef,default_value:{}}),a=this.state.formSchema;a.properties.tags.items.splice(e,1),t.tags.splice(e,1),this.form.formData=t,this.setState({formSchema:a})}},{key:"validateForm",value:function(e,t){var a=e.worker_ip,r=e.cred_type,n=e.ssh_cred_type,o=e.tags;if(a){var i=Ml(a),s=$l.isDublicateHost(this.props.k8sHosts,a);i||t.worker_ip.addError(er({path:["HostAddValidation","worker_ip","valid"]})),s&&t.worker_ip.addError(er({path:["HostAddValidation","worker_ip","duplicate"]}))}else t.worker_ip.addError(er({path:["HostAddValidation","worker_ip","required"]}));return this.props.isAgentBased||("Password Access"===r?n.password||t.ssh_cred_type.password.addError(er({path:["HostAddValidation","password","required"]})):n.ssh_key_data||t.ssh_cred_type.ssh_key_data.addError(er({path:["HostAddValidation","ssh_key_data","required"]}))),o&&o.length&&(o.some((function(e){return e.tag_value&&!Fl.tag_value.test(e.tag_value)?(t.tags.addError(er({path:["HostAddValidation","tags","invalid_character"]})),!0):e.tag_id&&!e.tag_value?(t.tags.addError(er({path:["HostAddValidation","tags","value_required"]})),!0):void 0})),Il(o)&&t.tags.addError(er({path:["HostAddValidation","tags","duplicate"]}))),t}},{key:"onChangeKeyFile",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=this.form.formData,a=e.filesInfo,r=void 0===a?[]:a,n=e.values,o=void 0===n?[]:n,i=f.a.fetchSafeFromObject({path:[0,"content"],obj:r,default_value:""}),s=o[0]||"";t.ssh_cred_type.ssh_key_data=s,this.form.formData=t,this.setState({ssh_key_data:i})}},{key:"onFormChange",value:function(e){var t=e.formData,a=this.state.formSchema,r=document.activeElement,n=xl(r);if(n)if(n.endsWith("_cred_type")){var o=$l.getHostCredentialSchema(t,a,this.onChangeKeyFile);this.form.formData=t,this.setState({formSchema:o})}else if(n.endsWith("_tag_id")){var i=this.state.tagValuesByID;this.form.formData=t;var s=n.split("_tag_id")[0].split("_").pop(),c=f.a.fetchSafeFromObject({path:["tags",s,"tag_id"],obj:t,default_value:""});a.properties.tags.items[s].properties.tag_value.suggestions=i[c]||[],this.setState({formSchema:a})}this.form.formData=t}},{key:"submitRESTAPI",value:function(e,t){var a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],r=this;R({method:w.method.POST,apiurl:w.apiurl.K8SHOST,data:{ipaddr:e,credentials:t,tags:a}}).then((function(){_n({msg:"Successfully added host ".concat(e),variant:"success"})})).catch((function(t){var a=r.state.workerFailed;a--,r.setState({workerFailed:a});var o=f.a.parseAxiosError({error:t}),i=n.a.createElement("div",null,n.a.createElement(st.a,{variant:"caption"},"Failed to add ( ",e," )"),n.a.createElement(st.a,{variant:"caption"},o));_n({msg:i,variant:"error"})})).then((function(){var e=r.state,t=e.submitted,a=e.workerFailed,n=e.tagItemSchema,o=e.formSchema;if(t--,r.setState({submitted:t}),!t){r.fetchK8sHosts(5e3),a||(r.form.formData={},f.a.isEmptyObject(n)||(o.properties.tags.items=[n],r.setState({formSchema:o})))}}))}},{key:"submitForm",value:function(e){var t=e.formData,a=e.errors,r=this.state.ssh_key_data;if(!a.length){var n=t.worker_ip,o=t.cred_type,i=t.ssh_cred_type,s=t.tags,c=$l.getIpListFromIpRange(n);this.setState({submitted:c.length,workerFailed:0});var l=void 0;this.props.isAgentBased||(l={type:"Password Access"===o?"password_access":"ssh_key_access",password:i.password,ssh_key_data:r,ssh_key_passphrase:i.ssh_key_passphrase});for(var u=s.length?s.filter((function(e){return e.tag_id&&e.tag_value})):[],p=0;p<c.length;p++)this.submitRESTAPI(c[p],l,u)}}},{key:"updateDiskSelection",value:function(e){var t=this.state.disks_selection,a=void 0===t?{}:t;e.length&&e.map((function(e){var t,r=e.data,n=void 0===r?[]:r,o=e.node,i=void 0===o?"":o,s=e.title,c=void 0===s?"":s,l=n.length?n.reduce((function(e,t){return e.push({Name:t.value,SizeBytes:t.diskSize}),e}),[]):[];a[i][(t=c,"Ephemeral"===t?"ephemeral_disks":"Persistent"===t?"persistent_disks":"unselected_disks")]=l})),this.setState({disks_selection:a})}},{key:"processDisksData",value:function(e,t){var a=this.state.disks_selection,r=void 0===a?{}:a;if(["storage_pending","keys_error","storage_error"].includes(t.status)||Object.keys(t).includes("sysinfo")){var n=t.hostname,o=void 0===n?"":n,i=t.sysinfo,s=(i=void 0===i?{}:i).storage,c=void 0===s?[]:s,l=w.settings.B_to_GB,u=$l.processHostDisks(c,l),p=u.available_disks,d=void 0===p?[]:p,f=u.unselected_disks,m=void 0===f?[]:f,h=$l.makeDefaultDiskSelection(d,this.props.isMaprInstallation),b=h.ephemeral_disks,v=void 0===b?[]:b,y=h.persistent_disks,g=void 0===y?[]:y;r[e]={path:e,hostname:o,ephemeral_disks:v,persistent_disks:g,unselected_disks:m,available_disks:d},this.setState({disks_selection:r})}}},{key:"render",value:function(){var e=a.getMeta(),t=this.state,r=t.formSchema,o=t.submitted,i=t.disks_selection,s=void 0===i?{}:i,c=t.tagItemSchema,l=t.tagItemDefaultData,u=t.tagOptions,p=t.tagValuesByID,d=t.hostsTagsFetched,m=t.hostsDataFetched,h=t.clusterDataFetched,b=t.updateKey,v=this.props,y=v.stats_data,g=v.page_data,_=v.isMaprInstallation,S=v.isAgentBased,k=v.k8sHosts,O=v.userName,E=y.session_data,j=(E=void 0===E?{}:E).role_name,D=void 0===j?"":j,w=f.a.fetchSafeFromObject({path:["k8scluster_list","_embedded","k8sclusters"],obj:g,default_value:[]}),C=f.a.fetchSafeFromObject({path:["hosts_tags","_embedded","tags"],obj:g,default_value:[]});return S?(delete r.properties.username,delete r.properties.cred_type,delete r.properties.ssh_cred_type):r.properties.username.default=O,n.a.createElement("div",{className:"K8sHostsAddPage"},n.a.createElement(Al.a,{title:e.title,description:e.description,link:e.link,meta:e.meta}),n.a.createElement(Nt,{title:"Kubernetes Hosts Installation",subComponent:_u}),O?n.a.createElement(En,{form_schema:r,formData:this.form.formData,form_id:"k8shost-add",submitter:this.submitForm,onChange:this.onFormChange,validate:0===o?this.validateForm:null,nodeRef:this.bdFormRef}):n.a.createElement(st.a,{variant:"caption"},"...loading"),n.a.createElement(Nt,{title:"Kubernetes Host(s) Status",variant:"secondary"}),h&&m?n.a.createElement(KD,{k8sHosts:k,disks_selection:s,k8sClusters:w,tagsInfo:{hostsTagsFetched:d,tagItemSchema:c,tagItemDefaultData:l,tagOptions:u,tagValuesByID:p},hostsTags:C,fetchK8sHosts:this.fetchK8sHosts,updateDiskSelection:this.updateDiskSelection,role_name:D,isMaprInstallation:_,page_name:"K8sHostPage",updateHostData:this.updateHostData,updateKey:b}):n.a.createElement(ls,null))}}]),a}(r.Component);qC(zC,"propTypes",{dispatch:u.a.func.isRequired,page_data:u.a.object,stats_data:u.a.object,k8sHosts:u.a.array,isMaprInstallation:u.a.bool,isAgentBased:u.a.bool,userName:u.a.string});var WC=Object(s.b)((function(e){var t=e.stats_data,a=void 0===t?{}:t,r=e.page_data,n=void 0===r?{}:r;return{stats_data:a,page_data:n,k8sHosts:f.a.fetchSafeFromObject({path:["k8shost_list","_embedded","k8shosts"],obj:n,default_value:[]}),isMaprInstallation:"mapr"===f.a.fetchSafeFromObject({path:["g_install","bdshared_storage_localfstype"],obj:a,default_value:!1}),isAgentBased:"true"===f.a.fetchSafeFromObject({path:["g_config_data_v1","objects","bdshared_install_agent"],obj:a,default_value:""}),userName:f.a.fetchSafeFromObject({path:["g_config_data_v1","objects","bds_global_user"],obj:a,default_value:""})}}))(zC);function JC(e){return(JC="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function YC(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function $C(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?YC(Object(a),!0).forEach((function(t){rT(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):YC(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function QC(e,t){for(var a=0;a<t.length;a++){var r=t[a];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function ZC(e,t){return(ZC=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function XC(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=aT(e);if(t){var n=aT(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return eT(this,a)}}function eT(e,t){return!t||"object"!==JC(t)&&"function"!=typeof t?tT(e):t}function tT(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function aT(e){return(aT=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function rT(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}var nT=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&ZC(e,t)}(i,e);var t,a,r,o=XC(i);function i(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),rT(tT(t=o.call(this,e)),"timeout",null),rT(tT(t),"updateActionStatus",(function(e,t){var a=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return function(r){var n=$C($C({},r.actionStatus[e]),{},rT({},t,a));return"isDeleting"===e&&!1===a&&delete n[t],{actionStatus:rT({},e,$C({},n))}}})),t.state={tenatsDataFetched:!1,actionStatus:{isDeleting:{label:"Deleting..."}}},t.k8sTenantOpDiologue=n.a.createRef(),t.tenantActionCallBack=t.tenantActionCallBack.bind(tT(t)),t.fetchTenantData=t.fetchTenantData.bind(tT(t)),t.handleRedirect=t.handleRedirect.bind(tT(t)),t.nameColumnRenderer=t.nameColumnRenderer.bind(tT(t)),t.detailColumnRenderer=t.detailColumnRenderer.bind(tT(t)),t.actionColumnRenderer=t.actionColumnRenderer.bind(tT(t)),t}return t=i,r=[{key:"getMeta",value:function(e){return{title:"Kubernetes Tenants",link:[{rel:"canonical",href:"".concat(w.serverUrl).concat(e?w.views.k8sTenants.url:w.views.k8sTenantList.url)}],meta:[{charset:"utf-8"},{name:"description",content:"Kubernetes Tenants"}]}}}],(a=[{key:"componentDidMount",value:function(){(0,this.props.dispatch)(Q(oe.K8SCLUSTER_DATA())),this.fetchTenantData()}},{key:"componentWillUnmount",value:function(){clearTimeout(this.timeout)}},{key:"fetchTenantData",value:function(){var e=this,t=this,a=this.props.dispatch;a(Q(oe.TENANT_DATA)),a(Q(oe.TENANT_DATA_V1)).then((function(){e.props.refreshDataRequired&&(e.timeout=setTimeout((function(){t.fetchTenantData()}),3e4)),e.setState({tenatsDataFetched:!0})}))}},{key:"handleRedirect",value:function(e){this.props.history.push(e)}},{key:"nameColumnRenderer",value:function(e){var t=this.props,a=t.isSiteAdmin,r=t.classes,o=a?"Click to enter tenant view as Admin":"",i=JSON.parse(e),s=i.tenant_name,c=i.status,l=i.status_info,u=void 0===l?o:l,p=i.tenant_id,d=i.actionStatus,f=w.views.k8sActingTenant.makeUrl({id:p}),m=a?n.a.createElement("span",{className:r.link,onClick:function(){window.location.href=f}},s):s;if(d)return n.a.createElement(st.a,{variant:"body2",className:se()(r.error,{blinking:!!d})},s);switch(c){case"ready":return u?n.a.createElement(ka,{title:u,variant:"primary"},m):n.a.createElement(st.a,{variant:"body2"},m);case"initialized":return u?n.a.createElement(ka,{title:u,variant:"warning"},m):n.a.createElement(st.a,{variant:"body2"},s);case"creating":return n.a.createElement(st.a,{variant:"body2",className:se()(r.warning,"blinking")},s);case"warning":return u?n.a.createElement(ka,{title:u,variant:"warning"},n.a.createElement("span",{className:se()(r.link,r.warning)},s)):n.a.createElement(st.a,{variant:"body2",className:r.warning},s);case"error":return u?n.a.createElement(ka,{title:u,variant:"error"},n.a.createElement("span",{className:se()(r.link,r.error)},s)):n.a.createElement(st.a,{variant:"body2",className:r.error},s);default:return n.a.createElement(st.a,{variant:"body2"},s)}}},{key:"detailColumnRenderer",value:function(e){var t=JSON.parse(e),a=t.quota_support,r=t.quota,o=t.namespace,i=t.isAimlProject,s=[],c=iT({quota_support:a}),l=i&&n.a.createElement(st.a,{variant:"body1"},"AI/ML Project: True");return c.map((function(e,t){var a=e.id,o=r[a];o="number"==typeof o?"".concat(e.convert_gb?f.a.convert2gb(o):o," ").concat(e.unit?e.unit:""):"No Quota",(e.usage_support||"No Quota"!==o)&&s.push(n.a.createElement(st.a,{key:t,variant:"body1"},e.label,": ",o))})),n.a.createElement(n.a.Fragment,null,n.a.createElement(st.a,{variant:"body1"},"Namespace: ",o),s,l)}},{key:"actionColumnRenderer",value:function(e){var t=this,a=this.props.isSiteAdmin,r=JSON.parse(e),o=r.tenant_id,i=r.tenant_name,s=r.external_user_groups,c=r.actionStatus,l=sw.getK8sTenantsActionButtons({tenant_data:r,isSiteAdmin:a});return n.a.createElement("div",{className:"row-action-btns"},c&&n.a.createElement(st.a,{variant:"body2"},c),!c&&l.map((function(e){var r=e.action,c=e.icon,l=e.title,u=e.variant;return"UserList"===r?n.a.createElement(ka,{title:l,variant:u,key:c},n.a.createElement("span",{className:se()("icon","icon-rect-link",c),onClick:function(){a?window.location.href=w.views.tenantUserList.makeUserListUrl({id:o}):t.handleRedirect(w.views.k8sTenantUsers.makeTenantUserUrl({tenant_id:o,tenant_name:i}))}})):"Edit"===r?n.a.createElement(ka,{title:l,variant:u,key:c},n.a.createElement("span",{className:se()("icon","icon-rect-link",c),onClick:function(){window.location.href=w.views.createTenant.makeEditUrl({id:o})}})):"Delete"===r?n.a.createElement(ka,{title:l,variant:u,key:c},n.a.createElement("span",{className:se()("icon","icon-rect-link",c),onClick:function(){var e={callback:sw.deleteSelectedTenant,context:{tenant_id:o,tenant_name:i,callback:t.tenantActionCallBack},title:"",description:"Confirm deletion. This action cannot be undone"};t.k8sTenantOpDiologue.current.handleOpen(e)}})):"UserGroupUpdate"===r?n.a.createElement(ka,{title:l,variant:u,key:c},n.a.createElement("span",{className:se()("icon","icon-rect-link",c),onClick:function(){t.setFormAndOpenModal({tenant_id:o,external_user_groups:s})}})):void 0})))}},{key:"getTableContents",value:function(){var e=this,t=this.props,a=t.classes,r=t.isSiteAdmin,o=t.k8sTenants,i=t.clusterNames,s=t.k8sTenantsV2ById;return{columns:[{name:"Tenant Name",options:{filter:!0,customBodyRender:this.nameColumnRenderer}},{name:"Tenant Description",options:{filter:!0}},{name:"Cluster",options:{filter:!0}},{name:"Details",options:{filter:!0,customBodyRender:this.detailColumnRenderer}},{name:"Actions",options:{filter:!1,sort:!1,customBodyRender:this.actionColumnRenderer}}],data:o.reduce((function(t,a){var r=a.label,n=(r=void 0===r?{}:r).name,o=void 0===n?"":n,c=r.description,l=void 0===c?"":c,u=a.features,p=(u=void 0===u?{}:u).kubernetese_access,d=void 0===p||p,m=u.ml_project,h=void 0!==m&&m,b=a.status,v=void 0===b?"":b,y=a.status_info,g=void 0===y?"":y,_=a.tenant_type,S=void 0===_?"":_,k=a.external_user_groups,O=void 0===k?[]:k,E=a.namespace,j=void 0===E?"":E,D=a.quota,w=void 0===D?{}:D,C=a.k8s_cluster,T=void 0===C?"":C,P=f.a.fetchSafeFromObject({path:["_links","self","href"],obj:a,default_value:""}),A=P.split("/").pop(),R=s[A]?s[A].quota_support:{},N=f.a.fetchSafeFromObject({path:["actionStatus","isDeleting",P],obj:e.state,default_value:!1}),F=N?f.a.fetchSafeFromObject({path:["actionStatus","isDeleting","label"],obj:e.state,default_value:""}):"",x=d&&h;return t.push([JSON.stringify({tenant_name:o,status:v,status_info:g,tenant_id:P,actionStatus:F,isDeletingTenant:N}),l,i[T]||"",JSON.stringify({quota_support:R,quota:w,namespace:j,isAimlProject:x}),JSON.stringify({tenant_id:P,tenant_name:o,status:v,tenant_type:S,external_user_groups:O,actionStatus:F})]),t}),[]),options:{customToolbar:function(){return n.a.createElement("div",{className:"tableActionButtons"},r?n.a.createElement(Ue.a,{variant:"contained",color:"primary",className:a.clusterCreateBtn,onClick:function(){location.href=w.views.createTenant.url}},"Create"):"")},customToolbarSelect:function(t){var a=e.props.k8sTenants;return n.a.createElement("div",{className:"tableActionButtonsSelected"},n.a.createElement(Ue.a,{variant:"contained",color:"secondary",onClick:function(){var r={callback:sw.deleteSelectedTenantList,context:{selected_rows:t,tenants:a,callback:e.tenantActionCallBack},title:"",description:"Confirm deletion. This action cannot be undone"};e.k8sTenantOpDiologue.current.handleOpen(r)}},"Delete"))},selectableRows:r?"multiple":"none",isRowSelectable:function(e,t){if(t){var a=JSON.parse(t[0]),r=a.isDeletingTenant,n=a.status;return!r&&["error","ready","warning"].includes(n)}return!1}}}}},{key:"tenantActionCallBack",value:function(e){var t=e.action,a=e.tenant_id;switch(t){case"deleting":this.setState(this.updateActionStatus("isDeleting",a,!0));break;case"refresh":this.setState(this.updateActionStatus("isDeleting",a,!1)),this.fetchTenantData();break;case"reset":this.setState(this.updateActionStatus("isDeleting",a,!1))}}},{key:"render",value:function(){var e=this.state.tenatsDataFetched,t=this.props.isSiteAdmin,a=i.getMeta(t),r=e?this.getTableContents():{};return n.a.createElement("div",{className:"K8sTenantsTable"},n.a.createElement(Al.a,{title:a.title,description:a.description,link:a.link,meta:a.meta}),n.a.createElement(Nt,{title:"Kubernetes Tenants"}),e?n.a.createElement(sa,r):n.a.createElement(ls,null),n.a.createElement(no,{ref:this.k8sTenantOpDiologue}))}}])&&QC(t.prototype,a),r&&QC(t,r),i}(r.Component);rT(nT,"propTypes",{classes:u.a.object.isRequired,dispatch:u.a.func.isRequired,tenant_list:u.a.object,isSiteAdmin:u.a.bool,history:u.a.object,k8sTenants:u.a.array,refreshDataRequired:u.a.bool,clusterNames:u.a.object,k8sTenantsV2ById:u.a.object});var oT=d()(he()((function(e){return{link:{color:e.palette.primary.main,cursor:"pointer",textDecoration:"none"},error:{color:e.palette.error.main},warning:{color:e.palette.warning.main},primary:{color:e.palette.primary.main}}}),{name:"App"}),Object(s.b)((function(e){var t=e.stats_data,a=void 0===t?{}:t,r=e.page_data,n=(r=void 0===r?{}:r).tenant_list,o=void 0===n?{}:n,i=r.tenant_list_v1,s=void 0===i?{}:i,c=r.k8scluster_list,l=void 0===c?{}:c,u=a.session_data,p=(u=void 0===u?{}:u).role_name,d=void 0===p?"":p,m=u.current_tenant_data,h=(m=void 0===m?{}:m).k8s_cluster,b=void 0===h?"":h,v="Site Admin"===d,y=f.a.fetchSafeFromObject({path:["_embedded","tenants"],obj:s,default_value:[]}),g=f.a.fetchSafeFromObject({path:["_embedded","tenants"],obj:o,default_value:[]}),_=f.a.fetchSafeFromObject({path:["_embedded","k8sclusters"],obj:l,default_value:[]}),S=[],k=!1;y.map((function(e){sw.getStatusesToLiveupdateK8sTenant().includes(e.status)&&(k=!0),"k8s"!==e.tenant_type||!v&&e.k8s_cluster!==b||S.push(e)}));var O=_.reduce((function(e,t){var a=f.a.fetchSafeFromObject({path:["_links","self","href"],obj:t,default_value:""}),r=f.a.fetchSafeFromObject({path:["label","name"],obj:t,default_value:""}),n=!0===f.a.fetchSafeFromObject({path:["imported"],obj:t,default_value:!1});if(a&&r){var o=r;if(n){var i=f.a.fetchSafeFromObject({path:["type"],obj:t,default_value:""}),s=f.a.fetchSafeFromObject({path:[i],obj:tE.importedClusterTypesMap,default_value:"-"});o+=" (Imported ".concat(s," Cluster)")}e[a]=o}return e}),{}),E=g.reduce((function(e,t){return e[f.a.fetchSafeFromObject({path:["_links","self","href"],obj:t,default_value:""}).split("/").pop()]=t,e}),{});return{isSiteAdmin:v,k8sTenants:S,refreshDataRequired:k,clusterNames:O,k8sTenantsV2ById:E}})))(nT),iT=function(e){var t=e.quota_support,a=t.cores,r=void 0!==a&&a,n=t.memory_gb,o=void 0!==n&&n,i=t.gpus,s=void 0!==i&&i,c=t.disk_gb,l=void 0!==c&&c,u=t.tenant_storage_gb,p=void 0!==u&&u,d=t.persistent_storage_size_gb,f=void 0!==d&&d,m=[];return r&&m.push({id:"cores",label:"Cores",convert_gb:!1,usage_support:!0,unit:""}),o&&m.push({id:"memory",label:"Memory",convert_gb:!0,usage_support:!0,unit:"GB"}),l&&m.push({id:"disk",label:"Ephemeral Storage",convert_gb:!0,usage_support:!0,unit:"GB"}),s&&m.push({id:"gpus",label:"GPU Devices",convert_gb:!1,usage_support:!0,unit:""}),f&&m.push({id:"persistent",label:"Persistent Storage",convert_gb:!0,usage_support:!0,unit:"GB"}),p&&m.push({id:"tenant_storage",label:"Tenant Storage Quota",convert_gb:!1,usage_support:!1,unit:"GB"}),m};function sT(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function cT(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?sT(Object(a),!0).forEach((function(t){lT(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):sT(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function lT(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}var uT="k8sApps",pT="k8sTrainings",dT="k8sDeployments",fT="k8sNotebooks",mT={requests:{memory:"4Gi",cpu:"2"},limits:{memory:"4Gi",cpu:"2"}},hT={storage:{size:"50Gi"}},bT=function(e,t){var a=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(f.a.isEmptyObject(e))return"";var r=e.apiVersion,n=void 0===r?"":r,o=e.metadata,i=(o=void 0===o?{}:o).name,s=void 0===i?"":i,c=o.namespace,l=void 0===c?"":c,u=e.spec,p=(u=void 0===u?{}:u).defaultPersistDirs,d=void 0===p?[]:p,m=u.roles,h=void 0===m?[]:m,b=h.map((function(e){var t=f.a.deepClone(mT),r={},n=e.minResources,o=void 0===n?{}:n,i=e.persistDirs&&0===e.persistDirs.length,s=e.persistDirs&&e.persistDirs.length>0;return i||!s&&!d.length||a&&(r=f.a.deepClone(hT)),f.a.isEmptyObject(o)||Object.keys(o).map((function(e){t.requests[e]="".concat(o[e]),t.limits[e]="".concat(o[e])})),cT({id:e.id,members:parseInt(e.cardinality.replace(/\+/,""),10),resources:t},r)})),v=s+"-instance",y={apiVersion:n,kind:t,metadata:{name:v,namespace:l},spec:{app:s,appCatalog:"local",___connections:{___secrets:[{__comment:"some secrets"}],___configmaps:[{__comment:"some configmaps"}],___clusters:[{__comment:"some clusters"}]},roles:b}},g=f.a.bdJson2Yaml(y);return g},vT=function e(t){return new Promise((function(a){var r=t.props.stats_data,n=void 0===r?{}:r,o=f.a.fetchSafeFromObject({path:["session_data","current_tenant_data"],obj:n,default_value:{}}),i=o.namespace,s=void 0===i?"":i,c=o.k8s_auth_port,l=void 0===c?"":c;s&&l?t.setState({namespace:s,port:l},(function(){a()})):setTimeout((function(){e(t)}),100)}))},yT=function(e){var t={apiVersion:"kubedirector.hpe.com/v1beta1",kind:e,metadata:{name:"cluster_name"},spec:{app:"app_name",appCatalog:"local",roles:[{id:"role_id",members:1,resources:mT}]}};return f.a.bdJson2Yaml(t)},gT=function(e){var t=e.classes,a=e.appData,r=e.source,o=e.onShowDetailClick;return n.a.createElement(Hp.a,{className:t.tile,key:a.metadata.uid},n.a.createElement(qp.a,{className:t.tileBrand},n.a.createElement("span",{className:t.textLogo},a.spec.label.name.substring(0,1)),n.a.createElement("div",{className:t.tileInfo},n.a.createElement(st.a,{variant:"caption",component:"h3",className:t.name},a.spec.label.name),n.a.createElement(st.a,{className:t.moreInfo,onClick:function(){return o(a)}},"More info ",n.a.createElement("span",{className:"icon icon-chevron-right"})))),n.a.createElement(db.a,{className:t.actions},n.a.createElement(lo.a,{className:t.link,to:w.views.k8sLaunchApp.makeLaunchUrl({id:a.metadata.selfLink,kind:"KubeDirectorCluster",source:r})},n.a.createElement(Ue.a,{variant:"contained",color:"primary"},n.a.createElement("span",{className:"icon icon-rocket"}),"Launch"))))},_T=gT;function ST(e){return(ST="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function kT(e){return function(e){if(Array.isArray(e))return OT(e)}(e)||function(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||function(e,t){if(!e)return;if("string"==typeof e)return OT(e,t);var a=Object.prototype.toString.call(e).slice(8,-1);"Object"===a&&e.constructor&&(a=e.constructor.name);if("Map"===a||"Set"===a)return Array.from(e);if("Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a))return OT(e,t)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function OT(e,t){(null==t||t>e.length)&&(t=e.length);for(var a=0,r=new Array(t);a<t;a++)r[a]=e[a];return r}function ET(e,t){for(var a=0;a<t.length;a++){var r=t[a];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function jT(e,t){return(jT=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function DT(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=TT(e);if(t){var n=TT(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return wT(this,a)}}function wT(e,t){return!t||"object"!==ST(t)&&"function"!=typeof t?CT(e):t}function CT(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function TT(e){return(TT=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function PT(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}gT.propTypes={classes:u.a.object.isRequired,appData:u.a.object.isRequired,source:u.a.string.isRequired,onShowDetailClick:u.a.func.isRequired};var AT=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&jT(e,t)}(i,e);var t,a,r,o=DT(i);function i(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),PT(CT(t=o.call(this,e)),"deleteSelectedClusterList",(function(e){var a=e.selected_rows,r=t.props.clusters;a.data.map((function(e){var a=e.dataIndex,n=r[a].metadata,o=(n=void 0===n?{}:n).name,i=void 0===o?"":o,s=n.selfLink,c=void 0===s?"":s;t.deleteClusterOperation({id:c,name:i})}))})),t.getMemberStateDetails=t.getMemberStateDetails.bind(CT(t)),t.deleteSelectedClusterList=t.deleteSelectedClusterList.bind(CT(t)),t.deleteClusterOperation=t.deleteClusterOperation.bind(CT(t)),t.clusterPowerOpDialog=n.a.createRef(),t}return t=i,(a=[{key:"getMemberStateDetails",value:function(e){if(!e)return[];var t={membersRestarting:{title:"Members Restarting",description:"Members are in the process of coming back up and possibly getting their app config/setup refreshed.",status:"warning"},membersWaiting:{title:"Members Waiting",description:"Member containers are waiting for some condition (other than persistent storage setup) before they can start running.",status:"warning"},configErrors:{title:"Config Error",description:"One or more members are in the config-error state.",status:"error"},membershipChanging:{title:"Membership Changing",description:"Members are in the process of being added to or removed from the cluster.",status:"warning"},membersInitializing:{title:"Members Initializing",description:"Members are waiting on persistent storage setup. This may take a while if large quantities of data must be initially copied to a PV.",status:"warning"},membersDown:{title:"Members Down",description:"Member containers are in a terminated or unresponsive state or just plain missing.",status:"warning"}};return Object.keys(e).reduce((function(a,r){return!0===e[r]?[].concat(kT(a),[t[r]]):a}),[])}},{key:"deleteClusterOperation",value:function(e){var t=e.id,a=e.name,r=this.props,n=r.port,o=void 0===n?"":n,i=r.type,s=void 0===i?"":i,c=r.fetchClusterData;R({method:w.method.DELETE,apiurl:t,port:o}).then((function(){c(),_n({msg:"Successfully started deleting ".concat(s," cluster ( ").concat(a," )"),variant:"success"})})).catch((function(){_n({msg:"Failed to delete the ".concat(s," cluster ").concat(a),variant:"error"})}))}},{key:"getClusterTableSettings",value:function(){var e=this,t=this.props,a=t.clusters,r=t.classes,o=t.type;return{columns:[{name:"Name",options:{filter:!0}},{name:"Created At",options:{filter:!0}},{name:"Role Configurations",options:{filter:!0,customBodyRender:function(e){var t=JSON.parse(e);return n.a.createElement(Ia,null,t.map((function(e,t){return n.a.createElement("div",{className:r.role,key:t},n.a.createElement(St.Typography,null,e.id," (",e.members.length,")"))})))}}},{name:"Status",options:{filter:!0,customBodyRender:function(e){return n.a.createElement(Qa,{status:e,title:e})}}},{name:"Member Status",options:{filter:!0,customBodyRender:function(t){var a=JSON.parse(t);return e.getMemberStateDetails(a).map((function(e,t){return n.a.createElement("div",{className:r.memberStatus,key:f.a.uniqueKey("".concat(e.title,"-").concat(t))},n.a.createElement(Qa,{title:e.title,status:e.status,tooltip:e.description}))}))}}},{name:"Actions",options:{filter:!0,customBodyRender:function(t){var a=JSON.parse(t),r=a.id,o=void 0===r?"":r,i=a.name,s=void 0===i?"":i,c=a.type,l=void 0===c?"":c;return n.a.createElement("div",{className:"row-action-btns"},n.a.createElement(ka,{title:"Delete",variant:"error"},n.a.createElement("span",{className:se()("icon","icon-rect-link","icon-trash2"),onClick:function(){var t={callback:e.deleteClusterOperation,context:{id:o,name:s},title:"Delete ".concat(l," running application '").concat(s,"'"),description:"Confirm deletion. This action cannot be undone."};e.clusterPowerOpDialog.current.handleOpen(t)}})))}}}],data:a.reduce((function(e,t){var a=t.status,r=(a=void 0===a?{}:a).memberStateRollup,n=void 0===r?{}:r,i=a.state,s=void 0===i?"":i,c=a.roles,l=void 0===c?[]:c,u=t.metadata,p=(u=void 0===u?{}:u).name,d=void 0===p?"":p,f=u.creationTimestamp,m=void 0===f?"":f,h=u.selfLink,b=void 0===h?"":h;return e.push([d,Fc()(m).format(w.settings.time_format),JSON.stringify(l),s||"unknown",JSON.stringify(n),JSON.stringify({id:b,name:d,type:o})]),e}),[]),options:{customToolbarSelect:function(t){return n.a.createElement("div",{className:"tableActionButtonsSelected"},n.a.createElement(Ue.a,{variant:"contained",color:"secondary",onClick:function(){var a={callback:e.deleteSelectedClusterList,context:{selected_rows:t},title:"Delete selected ".concat(o," running application(s)"),description:"Confirm deletion. This action cannot be undone."};e.clusterPowerOpDialog.current.handleOpen(a)}},"Delete"))}}}}},{key:"render",value:function(){var e=this.getClusterTableSettings(),t=this.props,a=t.type,r=void 0===a?"":a,o=t.classes;return n.a.createElement("div",{className:o.clusterTableContainer},n.a.createElement(St.Typography,{variant:"h2"},r," Running Applications"),n.a.createElement(sa,e),n.a.createElement(no,{ref:this.clusterPowerOpDialog}))}}])&&ET(t.prototype,a),r&&ET(t,r),i}(r.Component);PT(AT,"propTypes",{classes:u.a.object.isRequired,clusters:u.a.array,type:u.a.string,port:u.a.number,fetchClusterData:u.a.func});var RT=he()((function(e){return{clusterTableContainer:{marginTop:4*e.spacing.unit},memberStatus:{lineHeight:1.5}}}))(AT),NT=function(e){return{appsContainer:{minHeight:196,position:"relative"},appTiles:{display:"flex",flexFlow:"wrap",opacity:0,transition:"opacity 0.25s linear"},appTilesReady:{opacity:1},tile:{width:"calc(100% + ".concat(e.spacing.unit,"px)"),maxWidth:225,minWidth:200,position:"relative",margin:1.5*e.spacing.unit,padding:"".concat(e.spacing.unit,"px 0 ").concat(2*e.spacing.unit,"px"),borderRadius:"1rem !important",boxShadow:"".concat(e.shadows[5]," !important"),left:-e.spacing.unit},banner:{position:"absolute",top:0,right:.75*e.spacing.unit,color:e.palette.gray700},tileBrand:{position:"relative",height:120,padding:"0 ".concat(.5*e.spacing.unit,"px"),textAlign:"center"},logo:{width:"100%",display:"block",height:78,position:"relative",overflow:"hidden",whiteSpace:"nowrap",backgroundRepeat:"no-repeat",backgroundPosition:"center center",backgroundSize:200,transition:"transform 0.5s linear"},textLogo:{fontSize:72,textTransform:"capitalize",fontWeight:"bold",color:e.palette.primary.main},tileInfo:{position:"absolute",bottom:0,width:"100%",marginLeft:-e.spacing.unit},moreInfo:{cursor:"pointer","& .icon":{color:e.typography.fontColor,verticalAlign:"middle"}},name:{fontSize:e.typography.fontSizeMedium,fontFamily:e.typography.fontFamilyBold,lineHeight:1,padding:"0 ".concat(2*e.spacing.unit,"px"),whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"},actions:{padding:0,justifyContent:"center",marginTop:.5*e.spacing.unit},detail:{alignItems:"center"},img:{textAlign:"center"},link:{textDecoration:"none"},message:{fontSize:e.typography.fontSizeMedium}}};function FT(e){return(FT="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function xT(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function MT(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?xT(Object(a),!0).forEach((function(t){qT(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):xT(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function IT(e,t){for(var a=0;a<t.length;a++){var r=t[a];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function UT(e,t){return(UT=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function LT(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=KT(e);if(t){var n=KT(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return BT(this,a)}}function BT(e,t){return!t||"object"!==FT(t)&&"function"!=typeof t?HT(e):t}function HT(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function KT(e){return(KT=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function qT(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}var VT=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&UT(e,t)}(i,e);var t,a,r,o=LT(i);function i(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),qT(HT(t=o.call(this,e)),"CancelToken",T.a.CancelToken),qT(HT(t),"source",null),qT(HT(t),"timeout",null),qT(HT(t),"timeoutKDApps",null),t.state={selected_app:{},isClusterDataLoaded:!1,isKDAppsLoaded:!1},t.appsByView=f.a.deepClone(e.appsByView),t.showAppDetail=t.showAppDetail.bind(HT(t)),t.fetchKDClusters=t.fetchKDClusters.bind(HT(t)),t.bdModalChildRef=n.a.createRef(),t}return t=i,(a=[{key:"componentDidMount",value:function(){var e=this;vT(this).then((function(){return e.getKDApps()}))}},{key:"componentDidUpdate",value:function(e){if(e.viewName!==this.props.viewName){var t=this.props.viewName,a=this.appsByView[t].refetchData;this.verifyClusterFetch({refetch:a,viewName:t})}}},{key:"componentWillUnmount",value:function(){clearTimeout(this.timeout),clearTimeout(this.timeoutKDApps),this.source&&this.source.cancel("Component unmounted")}},{key:"verifyClusterFetch",value:function(e){var t=this,a=e.refetch,r=void 0!==a&&a,n=e.viewName;this.timeout&&(clearTimeout(this.timeout),this.timeout=null),r&&n&&(this.timeout=setTimeout((function(){t.fetchKDClusters()}),15e3))}},{key:"getKDApps",value:function(){var e=this;this.props.loadedKDApps?(this.appsByView=f.a.deepClone(this.props.appsByView),this.setState({isKDAppsLoaded:!0}),this.fetchKDClusters()):this.timeoutKDApps=setTimeout((function(){e.getKDApps()}),100)}},{key:"fetchKDClusters",value:function(){var e=this,t=this.state,a=t.namespace,r=t.port,n=this.props.dispatch;this.source=this.CancelToken.source(),n(Q(MT(MT({},oe.K8S_KD_CLUSTERS_DATA({namespace:a,port:r})),{},{cancelToken:this.source.token}))).then((function(){return e.setKDClusterDataByView()}))}},{key:"setKDClusterDataByView",value:function(){var e=this,t=this.props,a=t.k8s_kd_clusters_list,r=t.viewName;this.appsByView[r].refetchData&&Object.keys(this.appsByView).forEach((function(t){return e.updateDataForView({path:[t,"clusterData"],reset:!0})})),a.forEach((function(t){for(var a=f.a.fetchSafeFromObject({path:["spec","app"],obj:t,default_value:""}),r=f.a.fetchSafeFromObject({path:["status","state"],obj:t,default_value:""}),n=f.a.fetchSafeFromObject({path:["metadata","labels","kubedirector.hpe.com/createdBy"],obj:t,default_value:""}),o=0,i=Object.keys(e.appsByView);o<i.length;o++){var s=i[o],c=e.appsByView[s].appData.find((function(e){return e.metadata.name===a}));if(c&&!f.a.isEmptyObject(c)){if(!e.isClusterByCurrentUser({viewName:s,createdById:n}))break;e.updateDataForView({path:[s,"clusterData"],value:t}),"creating"===r&&e.updateDataForView({path:[s,"refetchData"],value:!0});break}}}));var n=this.appsByView[r].refetchData;n&&this.verifyClusterFetch({refetch:n,viewName:r}),this.setState({isClusterDataLoaded:!0})}},{key:"showAppDetail",value:function(e){var t=this;this.setState({selected_app:e},(function(){t.bdModalChildRef.current.handleOpen()}))}},{key:"updateDataForView",value:function(e){var t=e.path,a=e.value,r=e.reset,n=void 0!==r&&r;f.a.setObjectProperty({path:t,value:a,reset:n,schema:this.appsByView})}},{key:"isClusterByCurrentUser",value:function(e){var t=e.viewName,a=e.createdById,r=this.props.currentUserId,n=void 0===r?"":r;return!qT({},fT,fT)[t]||a===n}},{key:"render",value:function(){var e=this,t=this.props,a=t.classes,r=t.viewName,o=this.state,i=o.selected_app,s=void 0===i?{}:i,c=o.port,l=o.isKDAppsLoaded,u=s.spec,p=(u=void 0===u?{}:u).label,d=(p=void 0===p?{}:p).name,m=void 0===d?"":d,h=p.description,b=void 0===h?"":h,v=u.version,y=void 0===v?"":v,g=u.distroID,_=void 0===g?"":g,S=this.appsByView[r],k=l&&!S.appData.length,O=!l;return n.a.createElement(n.a.Fragment,null,n.a.createElement("section",{className:a.appsContainer},n.a.createElement("div",{className:"".concat(a.appTiles," ").concat(!O&&a.appTilesReady)},S.appData.map((function(t){return n.a.createElement(_T,{key:f.a.uniqueKey(t.metadata.name),classes:a,appData:t,source:r,onShowDetailClick:e.showAppDetail})})),k&&n.a.createElement(st.a,{variant:"h6",className:a.message},"No matching applications found")),O&&n.a.createElement(ls,null)),c?n.a.createElement(RT,{clusters:S.clusterData,type:"KubeDirector",fetchClusterData:this.fetchKDClusters,port:c}):n.a.createElement(ls,null),n.a.createElement(In,{Title:n.a.createElement(st.a,{variant:"h2"},"App Details"),name:"App detail",description:"Modal to display KubeDirector app details",ref:this.bdModalChildRef,footerCloseBtn:!0,onModalClose:function(){return e.setState({selected_app:{}})}},n.a.createElement(bc.a,{container:!0,className:a.detail,spacing:16},n.a.createElement(bc.a,{xs:5,item:!0,className:a.img},n.a.createElement("span",{className:a.textLogo},m.substring(0,1)),n.a.createElement(st.a,{variant:"caption",component:"h3",className:a.name},m)),n.a.createElement(bc.a,{xs:7,item:!0,className:a.info},n.a.createElement(st.a,{variant:"caption"},b),n.a.createElement(st.a,{variant:"caption"},"Image Version: ",y),n.a.createElement(st.a,{variant:"caption"},"Distro Id: ",_)))))}}])&&IT(t.prototype,a),r&&IT(t,r),i}(r.Component);qT(VT,"propTypes",{classes:u.a.object,dispatch:u.a.func.isRequired,stats_data:u.a.object.isRequired,k8s_kd_clusters_list:u.a.arrayOf(u.a.shape({})),currentUserId:u.a.string.isRequired,viewName:u.a.string.isRequired,loadedKDApps:u.a.bool.isRequired,appsByView:u.a.shape({viewName:u.a.shape({appData:u.a.array.isRequired,clusterData:u.a.array.isRequired,serviceEndpointsData:u.a.array,refetchData:u.a.bool.isRequired})}).isRequired});var GT=d()(he()(NT,{name:"KubeDirectorApps"}),Object(s.b)((function(e){var t=e.page_data,a=void 0===t?{}:t,r=e.stats_data,n=void 0===r?{}:r,o=f.a.fetchSafeFromObject({path:["k8s_kd_clusters_list","items"],obj:a,default_value:[]}),i=f.a.fetchSafeFromObject({path:["session_data","user"],obj:n,default_value:""});return{stats_data:n,k8s_kd_clusters_list:o,currentUserId:i=i.split("/").pop()}})))(VT);function zT(e){return(zT="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function WT(e,t){for(var a=0;a<t.length;a++){var r=t[a];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function JT(e,t){return(JT=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function YT(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=ZT(e);if(t){var n=ZT(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return $T(this,a)}}function $T(e,t){return!t||"object"!==zT(t)&&"function"!=typeof t?QT(e):t}function QT(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function ZT(e){return(ZT=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function XT(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}var eP=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&JT(e,t)}(i,e);var t,a,r,o=YT(i);function i(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),(t=o.call(this,e)).fetchFsMountData=t.fetchFsMountData.bind(QT(t)),t.fetchDataSource=t.fetchDataSource.bind(QT(t)),t.autoSelectFsMountData=t.autoSelectFsMountData.bind(QT(t)),t.handleDropdownSelection=t.handleDropdownSelection.bind(QT(t)),t.setSelectedFileTree=t.setSelectedFileTree.bind(QT(t)),t.validateExtension=t.validateExtension.bind(QT(t)),t.state={formLoaded:!1,fetchingDataSource:!1,fsMount:{index:0,href:"",name:""},selectedFileTree:{path:"",isValidExtention:!1}},t}return t=i,(a=[{key:"componentDidMount",value:function(){this.fetchFsMountData({source_type:"all"})}},{key:"autoSelectFsMountData",value:function(){var e=this.props.fs_mount_data;if(e.length>0){var t=e[0].href,a=e[0].name;this.setState({formLoaded:!0,fetchingDataSource:!0,fsMount:{index:0,href:t,name:a}}),this.fetchDataSource({href:t})}else this.setState({formLoaded:!0})}},{key:"fetchFsMountData",value:function(){var e=this;(0,this.props.dispatch)(Q(oe.FSMOUNT_DATA)).then((function(){return e.autoSelectFsMountData()}))}},{key:"fetchDataSource",value:function(e){var t=this,a=e.href;(0,this.props.dispatch)(Q({apiUrl:a,propVal:"data_source"})).then((function(){return t.setState({fetchingDataSource:!1})}))}},{key:"handleDropdownSelection",value:function(e){var t=this.props.fs_mount_data,a=e.target.value,r=t[a].href,n=t[a].name;r&&r.length>0&&(this.setState({formLoaded:!0,fetchingDataSource:!0,fsMount:{index:a,href:r,name:n}}),this.fetchDataSource({href:r}))}},{key:"setSelectedFileTree",value:function(e){var t=e.path,a=this.validateExtension({path:t});this.setState({selectedFileTree:{path:t,isValidExtention:a}})}},{key:"validateExtension",value:function(e){var t=e.path.split(".").pop();return["yaml"].includes(t)}},{key:"render",value:function(){var e=this.props,t=e.classes,a=e.fs_mount_data,r=e.data_source_data,o=e.disableDataSourceBrowse,i=this.state,s=i.formLoaded,c=i.fetchingDataSource,l=i.fsMount,u=i.selectedFileTree,p=l.href,d=r.name,m=r.type,h=r.isKerberized,b=r.isLocal,v=r.isReadOnly,y=f.a.encodeSpecialCharacters(u.path),g=s&&0===this.state.fsMount.href.length,_=!c&&p.length&&"fsMount".length&&r.name,S=a.map((function(e,t){return n.a.createElement(lt.a,{value:t,key:e.name},e.name)}));return n.a.createElement("div",null,n.a.createElement(St.FormControl,{component:"fieldset",className:t.formControl},n.a.createElement(St.FormControlLabel,{label:"Select FsMount:",labelPlacement:"start",classes:{labelPlacementStart:t.labelPlacementStart},control:n.a.createElement(qr.a,{value:this.state.fsMount.index,onChange:this.handleDropdownSelection,name:"fsMount",className:t.select,disabled:g,displayEmpty:!0,MenuProps:{classes:{paper:t.selectMenuList}}},g&&n.a.createElement(lt.a,{value:""},"Not available"),S)})),!g&&n.a.createElement("section",{className:t.fileTreeContainer},_?n.a.createElement(pi,{source:p,source_type:"fsMount",path:"/",useFolderActions:!0,name:d,type:m,isKerberized:h,is_local:b,isReadOnly:v,browseDisabled:o,onClick:this.setSelectedFileTree,selectedPathActionElement:n.a.createElement(lo.a,{disabled:!u.isValidExtention,to:w.views.k8sLaunchApp.makeLaunchUrl({mount_name:l.name,path:y,kind:"custom"}),className:se()(t.inherit,XT({},"".concat(t.disabled),!u.isValidExtention))},n.a.createElement(Ue.a,{variant:"contained",color:"primary",className:t.inherit,disabled:!u.isValidExtention},"Open"))}):n.a.createElement(ls,null)))}}])&&WT(t.prototype,a),r&&WT(t,r),i}(r.Component);XT(eP,"propTypes",{classes:u.a.object,dispatch:u.a.func.isRequired,fs_mount_data:u.a.arrayOf(u.a.shape({name:u.a.string,href:u.a.string})).isRequired,data_source_data:u.a.shape({name:u.a.string,type:u.a.string,isKerberized:u.a.bool,isLocal:u.a.bool,isReadOnly:u.a.bool}).isRequired,disableDataSourceBrowse:u.a.bool});var tP=d()(he()((function(e){return{formControl:{width:"auto",marginBottom:2*e.spacing.unit},labelPlacementStart:{marginLeft:0},select:{margin:e.spacing.unit,minWidth:250,maxWidth:260,color:e.palette.gray700,fontWeight:300,fontSize:e.typography.fontSize},selectMenuList:{border:e.border,transformOrigin:"0 !important",transform:"scale(1, 1) translateZ(0px) translateY(40px) !important"},fileTreeContainer:{position:"relative"},launchButton:{position:"absolute",right:0},inherit:{height:"inherit",textDecoration:"none"},disabled:{pointerEvents:"none"},warning:{background:e.palette.error.main,color:e.palette.white,width:"fit-content",padding:e.spacing.unit}}}),{name:"CustomApps"}),Object(s.b)((function(e){var t=e.stats_data,a=void 0===t?{}:t,r=e.page_data,n=void 0===r?{}:r,o=n.data_source,i=void 0===o?{}:o;return{fs_mount_data:f.a.fetchSafeFromObject({path:["fsMount_list","_embedded","filesystems"],obj:n,default_value:[]}).map((function(e){var t=f.a.fetchSafeFromObject({path:["_embedded","mountspec"],obj:e,default_value:{}}),a=t.mount_name,r=void 0===a?"":a,n=t._links,o=(n=void 0===n?{}:n).tenant_filesystem,i=(o=void 0===o?{}:o).href;return{sourceType:"fsMount",name:r,href:void 0===i?"":i}})),data_source_data:function(e){var t=a.g_install,r=void 0===t?{}:t,n=f.a.fetchSafeFromObject({path:["_embedded","mountspec","mount_name"],obj:e,default_value:""}),o=f.a.fetchSafeFromObject({path:["_embedded","mountspec","type"],obj:e,default_value:""}),i=f.a.fetchSafeFromObject({path:["_embedded","endpoint","kdc_data"],obj:e,default_value:{}});return{name:n,type:o,isKerberized:"hdfs"===o&&!f.a.isEmptyObject(i),isLocal:Ub.isDataSourceLocal({data_source:e,g_install:r}),isReadOnly:f.a.fetchSafeFromObject({path:["_embedded","mountspec","read_only"],obj:e,default_value:!1})}}(i)}})))(eP);function aP(e){return(aP="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function rP(e){return function(e){if(Array.isArray(e))return nP(e)}(e)||function(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||function(e,t){if(!e)return;if("string"==typeof e)return nP(e,t);var a=Object.prototype.toString.call(e).slice(8,-1);"Object"===a&&e.constructor&&(a=e.constructor.name);if("Map"===a||"Set"===a)return Array.from(e);if("Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a))return nP(e,t)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function nP(e,t){(null==t||t>e.length)&&(t=e.length);for(var a=0,r=new Array(t);a<t;a++)r[a]=e[a];return r}function oP(e,t){for(var a=0;a<t.length;a++){var r=t[a];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function iP(e,t,a){return t&&oP(e.prototype,t),a&&oP(e,a),e}function sP(e,t){return(sP=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function cP(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=pP(e);if(t){var n=pP(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return lP(this,a)}}function lP(e,t){return!t||"object"!==aP(t)&&"function"!=typeof t?uP(e):t}function uP(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function pP(e){return(pP=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function dP(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}var fP=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&sP(e,t)}(a,e);var t=cP(a);function a(e){var r;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,a),dP(uP(r=t.call(this,e)),"timeoutKDApps",null),r.fetchAppsServiceEndpoints=r.fetchAppsServiceEndpoints.bind(uP(r)),r.createDetailsBody=r.createDetailsBody.bind(uP(r)),r.createCustomGatewayMappingsHeader=r.createCustomGatewayMappingsHeader.bind(uP(r)),r.createGatewayMappingsBody=r.createGatewayMappingsBody.bind(uP(r)),r.createCustomTableBody=r.createCustomTableBody.bind(uP(r)),r.state={isServiceEndpointDataLoaded:!1,isKDAppsLoaded:!1},r.appsByView=f.a.deepClone(e.appsByView),r}return iP(a,null,[{key:"getMeta",value:function(){return{title:"".concat(w.APP_TITLE.CP," | Kubernetes Service Endpoints Page"),link:[{rel:"canonical",href:"".concat(w.serverUrl).concat(w.views.k8sAppsService.url)}],meta:[{charset:"utf-8"},{name:"description",content:"Kubernetes Application Service Endpoints"}]}}}]),iP(a,[{key:"componentDidMount",value:function(){var e=this;vT(this).then((function(){return e.fetchAppsServiceEndpoints()}))}},{key:"componentWillUnmount",value:function(){clearTimeout(this.timeoutKDApps)}},{key:"fetchAppsServiceEndpoints",value:function(){var e=this,t=this.props.dispatch,a=this.state,r=a.namespace,n=a.port;t(Q(oe.K8S_SERVICES({namespace:r,port:n}))).then((function(){return e.getKDApps()}))}},{key:"getKDApps",value:function(){var e=this;this.props.loadedKDApps?(this.appsByView=f.a.deepClone(this.props.appsByView),this.setServiceEndpointsByView()):this.timeoutKDApps=setTimeout((function(){e.getKDApps()}),100)}},{key:"setServiceEndpointsByView",value:function(){var e=this;this.props.k8s_services_list.forEach((function(t){var a=f.a.fetchSafeFromObject({path:["metadata","labels","kubedirector.hpe.com/kdapp"],obj:t,default_data:""}),r=f.a.fetchSafeFromObject({path:["spec"],obj:t,default_data:{}});if(r&&r.type&&["NodePort","LoadBalancer"].includes(r.type)){for(var n=!1,o=0,i=Object.keys(e.appsByView);o<i.length;o++){var s=i[o],c=e.appsByView[s].appData.find((function(e){return e.metadata.name===a})),l=f.a.fetchSafeFromObject({path:["metadata","labels","kubedirector.hpe.com/createdBy"],obj:t,default_value:""});if(c&&!f.a.isEmptyObject(c)){e.isServiceEndpointsByCurrentUser({viewName:s,createdById:l}),e.updateDataForView({path:[s,"serviceEndpointsData"],value:t}),n=!0;break}}n||e.updateDataForView({path:[uT,"serviceEndpointsData"],value:t})}})),this.setState({isServiceEndpointDataLoaded:!0})}},{key:"updateDataForView",value:function(e){var t=e.path,a=e.value;f.a.setObjectProperty({path:t,value:a,schema:this.appsByView})}},{key:"isServiceEndpointsByCurrentUser",value:function(e){var t=e.viewName,a=e.createdById,r=this.props.currentUserId,n=void 0===r?"":r;return!dP({},fT,fT)[t]||a===n}},{key:"createCustomTableBody",value:function(e,t){return n.a.createElement(n.a.Fragment,null,n.a.createElement("table",{className:t.table,cellPadding:"5"},n.a.createElement("tbody",null,e)))}},{key:"createDetailsBody",value:function(e){var t=this.props.classes;return JSON.parse(e).detailsMappings.map((function(e,a){var r=e.authToken,o=void 0===r?"":r,i=o?n.a.createElement(ka,{title:"Click to copy auth token",variant:"success"},n.a.createElement(st.a,{key:f.a.uniqueKey(a),className:t.link,onClick:function(){f.a.copyToClipboard(o)?_n({msg:"Auth token copied to clipboard",variant:"success"}):_n({msg:"Failed to copy auth token",variant:"error"})}},"Copy Auth Token")):"";return n.a.createElement(n.a.Fragment,null,!o&&n.a.createElement(st.a,{key:f.a.uniqueKey(a),className:se()(dP({},"".concat(t.defaultLeftPadding),e.pad))},e.label,": ",e.value),i)}))}},{key:"createGatewayMappingsBody",value:function(e){var t=this.props.classes,a=JSON.parse(e).gatewayMappings.map((function(e){var a=[];return a="LoadBalancer"!==e.serviceType||e.service?null!==e.protocol?n.a.createElement("a",{className:t.link,href:"".concat(e.protocol,"//").concat(e.service),target:"_blank",rel:"noopener noreferrer"},e.service):e.service:e.externalIpList.length?e.externalIpList.forEach((function(r){var o=null!==e.protocol?n.a.createElement("div",null,n.a.createElement(ka,{title:"Access to LoadBalancer ports from this web browser depends on network connectivity.",variant:"success"},n.a.createElement("a",{className:t.link,href:"".concat(e.protocol,"//").concat(r,":").concat(e.port),target:"_blank",rel:"noopener noreferrer"},"".concat(r,":").concat(e.port)))):n.a.createElement("div",null,"".concat(r,":").concat(e.port)," ");a.push(o)})):"not available",[{value:n.a.createElement(st.a,{className:se()(dP({},"".concat(t.gray500),!e.name))},e.name||"Name unavailable"),width:"25%"},{value:e.port,width:"15%"},{value:a,width:"60%"}]}));return n.a.createElement(qs,{data:a})}},{key:"createCustomGatewayMappingsHeader",value:function(){return n.a.createElement(qs,{headerData:[[{value:"Services",width:"25%"},{value:"Ports",width:"15%"},{value:"Access Points",width:"60%"}]]})}},{key:"getAppsServiceTableSettings",value:function(e){var t=this,a=this.appsByView[e].serviceEndpointsData;return{columns:[{name:"Name",options:{filter:!0}},{name:"Details",options:{filter:!0,customBodyRender:function(e){return t.createDetailsBody(e)}}},{name:this.createCustomGatewayMappingsHeader(),options:{filter:!0,customBodyRender:function(e){return t.createGatewayMappingsBody(e)}}},{name:"Service Type",options:{filter:!0}}],data:a.reduce((function(e,t){var a=f.a.fetchSafeFromObject({path:["metadata","labels"],obj:t,default_data:{}}),r=f.a.fetchSafeFromObject({path:["metadata","annotations"],obj:t,default_data:{}}),n=f.a.fetchSafeFromObject({path:["metadata","name"],obj:t,default_data:{}}),o=f.a.fetchSafeFromObject({path:["spec","ports"],obj:t,default_data:{}}),i=f.a.fetchSafeFromObject({path:["kubedirector.hpe.com/kdcluster"],obj:a,default_data:""}),s=f.a.fetchSafeFromObject({path:["spec","type"],obj:t,default_data:{}}),c=f.a.fetchSafeFromObject({path:["status","loadBalancer"],obj:t,default_data:{}}),l=[];"LoadBalancer"!==s||f.a.isEmptyObject(c)||c.ingress&&c.ingress.forEach((function(e){return l.push(e.ip)}));var u=[];if(i){u.push({label:"KubeDirectorCluster ID",value:i});var p=f.a.fetchSafeFromObject({path:["kubedirector.hpe.com/kdapp"],obj:a,default_data:""});if(p){u.push({label:"KubeDirectorApp",value:""});var d=p;"system"===f.a.fetchSafeFromObject({path:["kubedirector.hpe.com/appCatalog"],obj:a,default_data:""})&&(d+=" (system catalog)"),u.push({label:"ID",value:d,pad:!0});var m=f.a.fetchSafeFromObject({path:["kubedirector.hpe.com/kdapp-prettyName"],obj:r,default_data:""});m&&u.push({label:"Name",value:m,pad:!0})}var h=f.a.fetchSafeFromObject({path:["kubedirector.hpe.com/role"],obj:a,default_data:""});h&&u.push({label:"Role",value:h});var b=f.a.fetchSafeFromObject({path:["kubedirector.hpe.com/kd-auth-token"],obj:r,default_data:"test"});b&&u.push({authToken:b})}var v=o.reduce((function(e,t){var a=f.a.fetchSafeFromObject({path:["hpecp-internal-gateway/".concat(t.port)],obj:r,default_data:""}),n=t.port,o=void 0===n?"":n,c=t.name,u=void 0===c?"":c,p=u,d=null;if(u.startsWith("http-")?(d="".concat(window.location.protocol),p.length>5&&(p=p.substring(5))):u.startsWith("https-")?(d="https:",p.length>6&&(p=p.substring(6))):i&&(p=p.substring(p.indexOf("-")+1)),o){var m={port:o,name:p,service:a,protocol:d,externalIpList:l,serviceType:s};return[].concat(rP(e),[m])}return e}),[]),y=[n,u=JSON.stringify({detailsMappings:u}),v=JSON.stringify({gatewayMappings:v}),s];return[].concat(rP(e),[y])}),[]),options:{selectableRows:"none"}}}},{key:"render",value:function(){var e=this.props.viewName,t=!this.state.isServiceEndpointDataLoaded,a=this.getAppsServiceTableSettings(e);return n.a.createElement("div",{className:"K8sAppsServiceEndpoints"},n.a.createElement(sa,a),t&&n.a.createElement(ls,null))}}]),a}(r.Component);dP(fP,"propTypes",{classes:u.a.object,dispatch:u.a.func.isRequired,stats_data:u.a.object.isRequired,k8s_services_list:u.a.arrayOf(u.a.shape({})).isRequired,currentUserId:u.a.string.isRequired,viewName:u.a.string.isRequired,loadedKDApps:u.a.bool.isRequired,appsByView:u.a.shape({viewName:u.a.shape({appData:u.a.array.isRequired,clusterData:u.a.array,serviceEndpointsData:u.a.array.isRequired,refetchData:u.a.bool})}).isRequired});var mP,hP=d()(he()((function(e){return{table:{borderCollapse:"collapse",width:"100%"},td:{borderBottom:"1px solid ".concat(e.palette.gray300),width:"50%"},zeroBottomBorder:{borderBottom:"none"},link:{color:e.palette.primary.main,cursor:"pointer",textDecoration:"none"},gray500:{color:e.palette.gray500},defaultLeftPadding:{paddingLeft:2*e.spacing.unit}}}),{name:"K8sAppsServiceEndpoints"}),Object(s.b)((function(e){var t=e.page_data,a=void 0===t?{}:t,r=e.stats_data,n=void 0===r?{}:r,o=f.a.fetchSafeFromObject({path:["k8s_services_list","items"],obj:a,default_data:[]})||[],i=f.a.fetchSafeFromObject({path:["session_data","user"],obj:n,default_value:""});return{stats_data:n,k8s_services_list:o,currentUserId:i=i.split("/").pop()}})))(fP);function bP(e){return(bP="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function vP(e){return function(e){if(Array.isArray(e))return yP(e)}(e)||function(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||function(e,t){if(!e)return;if("string"==typeof e)return yP(e,t);var a=Object.prototype.toString.call(e).slice(8,-1);"Object"===a&&e.constructor&&(a=e.constructor.name);if("Map"===a||"Set"===a)return Array.from(e);if("Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a))return yP(e,t)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function yP(e,t){(null==t||t>e.length)&&(t=e.length);for(var a=0,r=new Array(t);a<t;a++)r[a]=e[a];return r}function gP(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function _P(e,t){for(var a=0;a<t.length;a++){var r=t[a];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function SP(e,t,a){return t&&_P(e.prototype,t),a&&_P(e,a),e}function kP(e,t){return(kP=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function OP(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=DP(e);if(t){var n=DP(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return EP(this,a)}}function EP(e,t){return!t||"object"!==bP(t)&&"function"!=typeof t?jP(e):t}function jP(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function DP(e){return(DP=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function wP(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}var CP="Deployment",TP="Notebook",PP=(wP(mP={},"Training",pT),wP(mP,CP,dT),wP(mP,TP,fT),mP),AP=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&kP(e,t)}(a,e);var t=OP(a);function a(e){var r,n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,a),(n=t.call(this,e)).appsByView=(wP(r={},uT,{appData:[],clusterData:[],serviceEndpointsData:[],refetchData:!1}),wP(r,pT,{appData:[],clusterData:[],serviceEndpointsData:[],refetchData:!1}),wP(r,dT,{appData:[],clusterData:[],serviceEndpointsData:[],refetchData:!1}),wP(r,fT,{appData:[],clusterData:[],serviceEndpointsData:[],refetchData:!1}),r),n.state={isKDAppsLoaded:!1},n.fetchKDApps=n.fetchKDApps.bind(jP(n)),n.fetchCurrentCluster=n.fetchCurrentCluster.bind(jP(n)),n}return SP(a,null,[{key:"getMeta",value:function(){return{title:"".concat(w.APP_TITLE.CP," | Application Page"),link:[{rel:"canonical",href:"".concat(w.serverUrl).concat(w.views.k8sApps.url)}],meta:[{charset:"utf-8"},{name:"description",content:"Manage Kubernetes Applications"}]}}}]),SP(a,[{key:"componentDidMount",value:function(){var e=this;vT(this).then((function(){return e.fetchKDApps()})),this.fetchCurrentCluster()}},{key:"fetchKDApps",value:function(){var e=this,t=this.state,a=t.namespace,r=t.port;(0,this.props.dispatch)(Q(oe.K8S_KD_APPS_DATA({namespace:a,port:r}))).then((function(){return e.setKDAppsDataByView()}))}},{key:"fetchCurrentCluster",value:function(){var e=this.props,t=e.dispatch,a=e.current_tenant_data,r=(a=void 0===a?{}:a).k8s_cluster,n=void 0===r?"":r;""!==n&&t(Q(function(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?gP(Object(a),!0).forEach((function(t){wP(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):gP(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}({},oe.CURRENT_K8SCLUSTER_DATA(n))))}},{key:"setKDAppsDataByView",value:function(){var e=this;this.props.k8s_kd_apps_list.forEach((function(t){var a="",r=f.a.fetchSafeFromObject({path:["spec","label","AIML_category"],obj:t,default_value:""});a=r&&PP[r]?PP[r]:uT,e.updateDataForView({path:[a,"appData"],value:t})})),this.setState({isKDAppsLoaded:!0})}},{key:"updateDataForView",value:function(e){var t=e.path,a=e.value;f.a.setObjectProperty({path:t,value:a,schema:this.appsByView})}},{key:"getTabsByView",value:function(e){var t,a=this.props,r=a.isImportedCluster,o=a.disableDataSourceBrowse,i={kubeDirectorApps:n.a.createElement(GT,{viewName:e,appsByView:this.appsByView,loadedKDApps:this.state.isKDAppsLoaded}),serviceEndpoints:n.a.createElement(hP,{viewName:e,appsByView:this.appsByView,loadedKDApps:this.state.isKDAppsLoaded}),customApps:n.a.createElement(tP,{disableDataSourceBrowse:o})};return(t={},wP(t,uT,{title:"Kubernetes Applications",tabs:[{label:"KubeDirector",key:"kubedirector",component:i.kubeDirectorApps}].concat(vP(r?[]:[{label:"Kubectl",key:"kubectl",component:i.customApps}]),[{label:"Service Endpoints",key:"serviceEndpoints",component:i.serviceEndpoints}])}),wP(t,pT,{title:"Training Clusters",tabs:[{label:"Applications",key:"kubedirector",component:i.kubeDirectorApps},{label:"Training Endpoints",key:"serviceEndpoints",component:i.serviceEndpoints}]}),wP(t,dT,{title:"Deployment Clusters",tabs:[{label:"Applications",key:"kubedirector",component:i.kubeDirectorApps},{label:"Deployment Endpoints",key:"serviceEndpoints",component:i.serviceEndpoints}]}),wP(t,fT,{title:"Notebooks",tabs:[{label:"Applications",key:"kubedirector",component:i.kubeDirectorApps},{label:"Notebook Endpoints",key:"serviceEndpoints",component:i.serviceEndpoints}]}),t)[e]}},{key:"render",value:function(){var e=a.getMeta(),t=this.props,r=t.location,o=t.viewName,i=this.getTabsByView(o),s=i.title,c=i.tabs,l=i.tabs.map((function(e){return e.component||""}));return n.a.createElement("div",{className:"K8sAppsPage"},n.a.createElement(Al.a,{title:e.title,description:e.description,link:e.link,meta:e.meta}),n.a.createElement(Nt,{title:s}),n.a.createElement(_o,{tabs:c,tabContents:l,location:r}))}}]),a}(r.Component);wP(AP,"propTypes",{stats_data:u.a.object.isRequired,k8s_kd_apps_list:u.a.arrayOf(u.a.shape({})).isRequired,location:u.a.object.isRequired,viewName:u.a.oneOf([uT,pT,dT,fT]).isRequired,dispatch:u.a.func.isRequired,isImportedCluster:u.a.bool,current_tenant_data:u.a.object,disableDataSourceBrowse:u.a.bool});var RP=d()(he()(NT,{name:"K8sAppsPage"}),Object(s.b)((function(e){var t=e.page_data,a=void 0===t?{}:t,r=e.stats_data,n=void 0===r?{}:r,o=n.session_data,i=(o=void 0===o?{}:o).current_tenant_data,s=void 0===i?{}:i,c=o.disableDataSourceBrowse,l=void 0===c||c;return{stats_data:n,k8s_kd_apps_list:f.a.fetchSafeFromObject({path:["k8s_kd_apps_list","items"],obj:a,default_value:[]}),current_tenant_data:s,isImportedCluster:!0===f.a.fetchSafeFromObject({path:["current_k8scluster_data","imported"],obj:a,default_value:!1}),disableDataSourceBrowse:l}})))(AP),NP=a(709),FP=a.n(NP);a(1418),a(1419),a(1420);function xP(e){return(xP="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function MP(e,t){for(var a=0;a<t.length;a++){var r=t[a];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function IP(e,t,a){return t&&MP(e.prototype,t),a&&MP(e,a),e}function UP(e,t){return(UP=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function LP(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=KP(e);if(t){var n=KP(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return BP(this,a)}}function BP(e,t){return!t||"object"!==xP(t)&&"function"!=typeof t?HP(e):t}function HP(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function KP(e){return(KP=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function qP(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}var VP=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&UP(e,t)}(a,e);var t=LP(a);function a(e){var r,o;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,a),(o=t.call(this,e)).KUBECTL_ACTIONS={APPLY:"apply",CREATE:"create",DELETE:"delete",CANCEL:"cancel"},o.pageTitleByViewSource=(qP(r={},uT,"Kubernetes Application"),qP(r,pT,"Training Cluster"),qP(r,dT,"Deployment"),qP(r,fT,"Notebook"),r);var i=o.props.location,s=lf.a.parse(i.search),c=s.id,l=void 0===c?"":c,u=s.kind,p=void 0===u?"KubeDirectorCluster":u,d=s.mount_name,f=void 0===d?"":d,m=s.path,h=void 0===m?"":m,b=s.source,v=void 0===b?"k8sApps":b;return o.state={id:l,kind:p,mount_name:f,path:h,source:v,data:"...loading",disabled:!0,dataLoaded:!1},o.fetchSelectedAppData=o.fetchSelectedAppData.bind(HP(o)),o.onChange=o.onChange.bind(HP(o)),o.launchApp=o.launchApp.bind(HP(o)),o.createActionButtonTypes=o.createActionButtonTypes.bind(HP(o)),o.fetchCustomAppData=o.fetchCustomAppData.bind(HP(o)),o.launchKubeCtlAction=o.launchKubeCtlAction.bind(HP(o)),o.postKubeCtlActionApi=o.postKubeCtlActionApi.bind(HP(o)),o.bdDialogChildRef=n.a.createRef(),o}return IP(a,null,[{key:"getMeta",value:function(){return{title:"".concat(w.APP_TITLE.CP," | Kubernetes Application Launch Page"),link:[{rel:"canonical",href:"".concat(w.serverUrl).concat(w.views.k8sLaunchApp.url)}],meta:[{charset:"utf-8"},{name:"description",content:"Launch Kubernetes Applications"}]}}}]),IP(a,[{key:"componentDidMount",value:function(){if("custom"===this.state.kind)this.fetchCustomAppData();else{var e=this;vT(e).then((function(){e.fetchSelectedAppData()}))}}},{key:"componentWillUnmount",value:function(){var e=this.props.dispatch;["k8s_kd_app_data"].map((function(t){return e($(t))}))}},{key:"fetchCustomAppData",value:function(){var e=this,t=this.state,a=t.mount_name,r=t.path,o=this.props.current_tenant_data,i=(o=void 0===o?{}:o).k8sClusterId,s=void 0===i?"":i,c=o.tenantHref,l={mount_name:a,tenant_href:void 0===c?"":c,cluster_href:s,path:f.a.encodeSpecialCharacters(r)};R({method:w.method.POST,op:"get_kubectl_file_data",data:l}).then((function(t){return e.setState({data:t.data,disabled:!1,dataLoaded:!0})})).catch((function(t){var a=f.a.fetchSafeFromObject({path:["response","data","message"],obj:t,default_value:""}),r=n.a.createElement(ns,{errors:["Failed to load KubeDirector application.",a]});e.setState({data:"",disabled:!1,dataLoaded:!0}),_n({msg:r,variant:"error"})}))}},{key:"fetchSelectedAppData",value:function(){var e=this,t=this.state,a=t.id,r=t.kind,n=t.port,o=this.props,i=o.page_data,s=(i=void 0===i?{}:i).k8s_kd_apps_list,c=void 0===s?{}:s,l=o.isMaprInstallation,u=void 0!==l&&l,p={};a&&r?(!f.a.isEmptyObject(c)&&c.items.length&&(p=f.a.fetchSafeFromObjectArray({arr:c.items,path:["metadata","selfLink"],match:a,default_value:{}})),f.a.isEmptyObject(p)?(0,this.props.dispatch)(Q(oe.K8S_KD_APP_DATA({apiUrl:a,port:n}))).then((function(){var t=e.props,a=t.page_data,n=(a=void 0===a?{}:a).k8s_kd_app_data,o=void 0===n?{}:n,i=t.isMaprInstallation,s=void 0!==i&&i;e.setState({data:bT(o,r,s),disabled:!1,dataLoaded:!0})})):e.setState({data:bT(p,r,u),disabled:!1,dataLoaded:!0})):this.setState({data:yT(r),disabled:!1,dataLoaded:!0})}},{key:"onChange",value:function(e){this.setState({data:e})}},{key:"launchApp",value:function(){var e=this,t=this.state,a=t.data,r=t.namespace,o=t.port,i=t.source,s=f.a.yaml2json(a),c=s._y2j_status;if("error"===(void 0===c?"success":c)){var l=n.a.createElement(ns,{errors:["Failed to parse yaml to json.","".concat(s.name,": ").concat(s.message)]});_n({msg:l,variant:"error"})}else{var u=s.metadata,p=(u=void 0===u?{}:u).name,d=void 0===p?"":p;this.updateConnectionsData(s),this.addCreatedByLabel(s),R({method:w.method.POST,apiurl:w.apiurl.K8S_KD_CLUSTERS(r),data:s,port:o}).then((function(){_n({msg:"Successfully started KubeDirector application ".concat(d),variant:"success"}),f.a.redirectTo({context:e.props,location:"".concat(w.views[i].url,"#kubedirector")})})).catch((function(e){var t=f.a.fetchSafeFromObject({path:["response","data","message"],obj:e,default_value:""}),a=n.a.createElement(ns,{errors:["Failed to start KubeDirector application ".concat(d),t]});_n({msg:a,variant:"error"})}))}}},{key:"updateConnectionsData",value:function(e){e.spec.hasOwnProperty("connections")&&(f.a.fetchSafeFromObject({path:["spec","connections"],obj:e,default_value:null})||f.a.setObjectProperty({path:["spec","connections"],value:{},schema:e}))}},{key:"addCreatedByLabel",value:function(e){var t=this.props.stats_data,a=f.a.fetchSafeFromObject({path:["session_data","user"],obj:t,default_value:""});a=a.split("/").pop(),e.metadata.hasOwnProperty("labels")||f.a.setObjectProperty({path:["metadata","labels"],value:{},schema:e}),f.a.setObjectProperty({path:["metadata","labels","kubedirector.hpe.com/createdBy"],value:a,schema:e})}},{key:"launchKubeCtlAction",value:function(e){var t=this.KUBECTL_ACTIONS,a=t.APPLY,r=t.CREATE,o=t.DELETE,i=t.CANCEL,s=this.state.data,c=void 0===s?"":s,l=(f.a.yaml2json(c)||{}).metadata,u=(l=void 0===l?{}:l).name,p=void 0===u?"":u;switch(e){case a:case r:this.postKubeCtlActionApi({action:e,name:p});break;case o:this.bdDialogChildRef.current.handleOpen({callback:this.postKubeCtlActionApi,context:{action:e,name:p},title:er({path:["kubeCtl","deleteTitle"]}),description:n.a.createElement(st.a,{variant:"caption"},"Kubectl application: ",p)});break;case i:f.a.redirectTo({context:this.props,location:"".concat(w.views.k8sApps.url,"#custom")});break;default:_n({msg:'Invalid action "'.concat(e,'" for Kubectl application ').concat(p),variant:"error"})}}},{key:"postKubeCtlActionApi",value:function(e){var t=this,a=e.action,r=e.name,o=this.state.data,i=void 0===o?"":o,s=this.props.current_tenant_data,c=(s=void 0===s?{}:s).k8sClusterId,l=void 0===c?"":c,u={kubectl_op:"".concat(a),cluster_href:l,payload:i};R({method:w.method.POST,timeout:w.settings.long_timeout,op:"kubectl_action",data:u}).then((function(){_n({msg:"Successfully started Kubectl ".concat(a," operation for application ").concat(r),variant:"success"}),f.a.redirectTo({context:t.props,location:"".concat(w.views.k8sApps.url,"#custom")})})).catch((function(e){var t=f.a.fetchSafeFromObject({path:["response","data","message"],obj:e,default_value:""}),o=n.a.createElement(ns,{errors:["Failed to ".concat(a," Kubectl application ").concat(r),t]});_n({msg:o,variant:"error"})}))}},{key:"createActionButtonTypes",value:function(){var e=this,t=this.KUBECTL_ACTIONS,a=t.APPLY,r=t.CREATE,n=t.DELETE,o=t.CANCEL;return[{text:"Submit",type:"submit",color:"primary",for:"KubeDirectorCluster",onClickHandler:function(){return e.launchApp()}},{text:"Apply",type:a,color:"primary",for:"custom",onClickHandler:function(){return e.launchKubeCtlAction(a)}},{text:"Create",type:r,color:"primary",for:"custom",onClickHandler:function(){return e.launchKubeCtlAction(r)}},{text:"Delete",type:n,color:"secondary",for:"custom",onClickHandler:function(){return e.launchKubeCtlAction(n)}},{text:"Cancel",type:o,color:"default",for:"custom",onClickHandler:function(){return e.launchKubeCtlAction(o)}}]}},{key:"render",value:function(){var e=this.props,t=e.classes,r=e.isSiteLocked,o=a.getMeta(),i=this.state,s=i.disabled,c=i.data,l=i.kind,u=i.source,p=i.dataLoaded,d=this.KUBECTL_ACTIONS.CANCEL,f=this.createActionButtonTypes();return n.a.createElement("div",{className:"LaunchK8sAppPage"},n.a.createElement(Al.a,{title:o.title,description:o.description,link:o.link,meta:o.meta}),n.a.createElement(Nt,{title:"Launch ".concat(this.pageTitleByViewSource[u])}),p?n.a.createElement("div",{className:t.editorBlock},n.a.createElement(st.a,null,"Edit your Yaml and hit submit to launch app"),n.a.createElement(FP.a,{placeholder:"Edit your Yaml and hit submit to launch app",mode:"sass",theme:"github",name:"yamlEditor",className:t.aceEditor,onChange:this.onChange,fontSize:14,showPrintMargin:!1,showGutter:!0,highlightActiveLine:!0,readOnly:s,value:c,width:"100%",height:"70vh",focus:!0,setOptions:{enableBasicAutocompletion:!1,enableLiveAutocompletion:!1,enableSnippets:!1,showLineNumbers:!0,tabSize:2}}),n.a.createElement("div",{className:t.actionButtons},f.map((function(e){return e.for===l&&n.a.createElement(Ue.a,{key:e.text,variant:"contained",color:e.color,disabled:(r||s||!c||!c.length)&&e.type!==d,onClick:e.onClickHandler},e.text)})))):n.a.createElement(ls,null),n.a.createElement(no,{ref:this.bdDialogChildRef}))}}]),a}(r.Component);qP(VP,"propTypes",{classes:u.a.object.isRequired,dispatch:u.a.func.isRequired,location:u.a.object,stats_data:u.a.object,page_data:u.a.object,isSiteLocked:u.a.bool,current_tenant_data:u.a.shape({k8sClusterId:u.a.string,tenantHref:u.a.string}).isRequired,isMaprInstallation:u.a.bool});var GP=d()(he()((function(e){return{aceEditor:{border:"1px solid ".concat(e.palette.gray300),minHeight:600,marginTop:2*e.spacing.unit,marginBottom:2*e.spacing.unit},actionButtons:{"& > *":{marginRight:e.spacing.unit}}}}),{name:"LaunchK8sAppPage"}),Object(s.b)((function(e){var t=e.page_data,a=void 0===t?{}:t,r=e.stats_data,n=void 0===r?{}:r,o=n.session_data,i=void 0===o?{}:o,s=n.lock_data,c=(s=void 0===s?{}:s).locked;return{page_data:a,stats_data:n,isSiteLocked:void 0!==c&&c,current_tenant_data:function(e){var t=e.current_tenant_data,a=void 0===t?{}:t;return{k8sClusterId:f.a.fetchSafeFromObject({path:["k8s_cluster"],obj:a,default_value:""}),tenantHref:f.a.fetchSafeFromObject({path:["_links","self","href"],obj:a,default_value:""})}}(i),isMaprInstallation:"mapr"===f.a.fetchSafeFromObject({path:["g_install","bdshared_storage_localfstype"],obj:n,default_value:""})}})))(VP);function zP(e){return(zP="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function WP(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function JP(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?WP(Object(a),!0).forEach((function(t){aA(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):WP(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function YP(e,t){for(var a=0;a<t.length;a++){var r=t[a];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function $P(e,t,a){return t&&YP(e.prototype,t),a&&YP(e,a),e}function QP(e,t){return(QP=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function ZP(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=tA(e);if(t){var n=tA(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return XP(this,a)}}function XP(e,t){return!t||"object"!==zP(t)&&"function"!=typeof t?eA(e):t}function eA(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function tA(e){return(tA=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function aA(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}var rA=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&QP(e,t)}(a,e);var t=ZP(a);function a(e){var r;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,a),(r=t.call(this,e)).state={sourceControlFetching:!0},r.dataUpdates={},r.CancelToken=T.a.CancelToken,r.fetchSourceControlData=r.fetchSourceControlData.bind(eA(r)),r.getTableSettings=r.getTableSettings.bind(eA(r)),r.getUserNameById=r.getUserNameById.bind(eA(r)),r.deleteSourceControl=r.deleteSourceControl.bind(eA(r)),r.deleteSourceControlList=r.deleteSourceControlList.bind(eA(r)),r.bdDeleteDialog=n.a.createRef(),r}return $P(a,null,[{key:"getMeta",value:function(){return{title:"".concat(w.APP_TITLE.CP," | Mange Source Control Page"),link:[{rel:"canonical",href:"".concat(w.serverUrl).concat(w.views.managek8sSourceControl.url)}],meta:[{charset:"utf-8"},{name:"description",content:"Manage Github and Bitbucket repo for tenant"}]}}}]),$P(a,[{key:"componentDidMount",value:function(){var e=this,t=this.props,a=t.dispatch,r=t.currentTenantHref,n=t.role_name;this.fetchSourceControlData(),n===w.ROLE_NAME.ADMIN?(this.dataUpdates.tenantUsers=this.CancelToken.source(),a(Q(JP(JP({},oe.TENANT_USER_DATA(r)),{},{cancelToken:this.dataUpdates.tenantUsers.token}))).then((function(){delete e.dataUpdates.tenantUsers,e.setState({usersDataFetched:!0})}))):this.setState({usersDataFetched:!0})}},{key:"componentWillUnmount",value:function(){var e=this;Object.keys(this.dataUpdates).map((function(t){e.dataUpdates[t].cancel("component unmounted")}))}},{key:"fetchSourceControlData",value:function(){var e=this,t=this.props,a=t.dispatch,r=t.namespace,n=t.port,o=t.currentUserId,i={"kubedirector.hpe.com/cmType":"source-control"};"Member"===t.role_name&&(i.createdByUser=o),this.dataUpdates.sourceControl=this.CancelToken.source(),a(Q(JP(JP({},oe.K8S_CONFIG_MAP({namespace:r,port:n,propVal:"k8s_source_controls",params:i})),{},{cancelToken:this.dataUpdates.sourceControl.token}))).then((function(){delete e.dataUpdates.sourceControl,e.setState({sourceControlFetching:!1})}))}},{key:"getUserNameById",value:function(e){var t=this.props.userDict;return t[e]?t[e].name:"Userinfo not avaiable"}},{key:"deleteSourceControl",value:function(e){var t=this,a=this.props.port;R({apiurl:e,method:w.method.DELETE,timeout:w.settings.long_timeout,port:a}).then((function(){_n({msg:'Successfully deleted source control "'.concat(name,'"'),variant:"success"}),t.fetchSourceControlData()})).catch((function(e){var t=f.a.fetchSafeFromObject({path:["response","data","message"],obj:e,default_value:""}),a=n.a.createElement(ns,{errors:['Failed to delete source control "'.concat(name,'"'),t]});_n({msg:a,variant:"error"})}))}},{key:"deleteSourceControlList",value:function(e){var t=this;e.selected_rows.data.map((function(e){var a=e.rowData,r=JSON.parse(a.pop()).selfLink;t.deleteSourceControl(r)}))}},{key:"getTableSettings",value:function(){var e=this,t=this.props,a=t.source_controls,r=t.role_name,o=t.currentUserId;return{columns:[{name:"Name",options:{filter:!0}},{name:"Description",options:{filter:!0}},{name:"Repo Type",options:{filter:!0}},{name:"Parent Configuration",options:{filter:!0}},{name:"Created By",options:{filter:!0,display:r===w.ROLE_NAME.ADMIN}},{name:"Repo Url",options:{filter:!0}},{name:"Actions",options:{filter:!0,customBodyRender:function(t){var a=JSON.parse(t),r=a.selfLink,i=a.createdByUser;return n.a.createElement("div",{className:"row-action-btns"},n.a.createElement(ka,{title:"Delete",variant:"error"},n.a.createElement("span",{className:"icon icon-rect-link icon-trash2",onClick:function(){var t={callback:e.deleteSourceControl,context:r,title:"Delete selected Source Control",description:"Confirm Deletion. This action cannot be undone"};e.bdDeleteDialog.current.handleOpen(t)}})),i===o&&n.a.createElement(ka,{title:"Edit",variant:"primary"},n.a.createElement(lo.a,{to:w.views.k8sCreateEditSourceControl.editUrl(r.split("/").pop())},n.a.createElement("span",{className:"icon icon-rect-link icon-pencil3"}))))}}}],data:a.map((function(t){var a=t.metadata,r=(a=void 0===a?{}:a).name,n=void 0===r?"":r,o=a.labels,i=(o=void 0===o?{}:o).createdByRole,s=void 0===i?"":i,c=o.createdByUser,l=void 0===c?"":c,u=o.parentConfiguration,p=void 0===u?"":u,d=a.selfLink,f=void 0===d?"":d,m=t.data,h=(m=void 0===m?{}:m).description,b=void 0===h?"":h,v=m.type,y=void 0===v?"":v,g=m["repo-url"],_=void 0===g?"":g,S=e.getUserNameById(l);return[n,b,y,s===w.ROLE_NAME.ADMIN?"N/A":p,S,_,JSON.stringify({selfLink:f,createdByUser:l})]})),options:{customToolbar:function(){return n.a.createElement("div",{className:"tableActionButtons"},n.a.createElement(Ue.a,{variant:"contained",color:"primary",component:lo.a,to:w.views.k8sCreateEditSourceControl.url},"Create"))},customToolbarSelect:function(t){return n.a.createElement("div",{className:"tableActionButtonsSelected"},n.a.createElement(Ue.a,{variant:"contained",color:"secondary",onClick:function(){var a={callback:e.deleteSourceControlList,context:{selected_rows:t},title:"Delete selected Source Control(s)",description:"Confirm Deletion. This action cannot be undone"};e.bdDeleteDialog.current.handleOpen(a)}},"Delete"))}}}}},{key:"render",value:function(){var e=a.getMeta(),t=this.getTableSettings();return n.a.createElement("div",{className:"ManageK8sSourceControlPage"},n.a.createElement(Al.a,{title:e.title,description:e.description,link:e.link,meta:e.meta}),n.a.createElement(Nt,{title:"Source Controls"}),n.a.createElement(sa,t),n.a.createElement(no,{ref:this.bdDeleteDialog}))}}]),a}(r.Component);aA(rA,"propTypes",{dispatch:u.a.func.isRequired,namespace:u.a.string,port:u.a.number,currentUserId:u.a.string,currentTenantHref:u.a.string,role_name:u.a.string,source_controls:u.a.array,userDict:u.a.object,cluster_href:u.a.string});var nA=Object(s.b)((function(e){var t,a=e.stats_data,r=(a=void 0===a?{}:a).session_data,n=(r=void 0===r?"":r).role_name,o=void 0===n?"":n,i=r.user,s=void 0===i?"":i,c=r.user_name,l=void 0===c?"":c,u=r.tenant,p=void 0===u?"":u,d=r.current_tenant_data,m=void 0===d?{}:d,h=e.page_data,b=(h=void 0===h?{}:h).k8s_source_controls,v=(b=void 0===b?{}:b).items,y=void 0===v?[]:v,g=h.tenant_users,_=void 0===g?{}:g,S=m.namespace,k=void 0===S?"":S,O=m.k8s_auth_port,E=void 0===O?0:O,j=m.k8s_cluster,D=void 0===j?"":j,C=f.a.fetchSafeFromObject({path:["_embedded","users"],obj:_,default_value:[]}),T=o===w.ROLE_NAME.ADMIN?C.reduce((function(e,t){var a=f.a.fetchSafeFromObject({path:w.pathToID,obj:t,default_value:""}),r=f.a.fetchSafeFromObject({path:["_embedded","label","name"],obj:t,default_value:""}),n=a.split("/").pop();return e[n]={id:n,href:a,name:r},e}),{}):aA({},t=s.split("/").pop(),{id:t,href:s,name:l});return{namespace:k,port:E,source_controls:y,currentUserId:s.split("/").pop(),currentTenantHref:p,userDict:T,cluster_href:D}}))(rA);function oA(e){return(oA="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function iA(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var a=[],r=!0,n=!1,o=void 0;try{for(var i,s=e[Symbol.iterator]();!(r=(i=s.next()).done)&&(a.push(i.value),!t||a.length!==t);r=!0);}catch(c){n=!0,o=c}finally{try{r||null==s.return||s.return()}finally{if(n)throw o}}return a}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return sA(e,t);var a=Object.prototype.toString.call(e).slice(8,-1);"Object"===a&&e.constructor&&(a=e.constructor.name);if("Map"===a||"Set"===a)return Array.from(e);if("Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a))return sA(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function sA(e,t){(null==t||t>e.length)&&(t=e.length);for(var a=0,r=new Array(t);a<t;a++)r[a]=e[a];return r}function cA(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function lA(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?cA(Object(a),!0).forEach((function(t){vA(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):cA(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function uA(e,t){for(var a=0;a<t.length;a++){var r=t[a];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function pA(e,t,a){return t&&uA(e.prototype,t),a&&uA(e,a),e}function dA(e,t){return(dA=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function fA(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=bA(e);if(t){var n=bA(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return mA(this,a)}}function mA(e,t){return!t||"object"!==oA(t)&&"function"!=typeof t?hA(e):t}function hA(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function bA(e){return(bA=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function vA(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}var yA=er({path:["k8sCreateEditSourceControl"]}),gA=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&dA(e,t)}(a,e);var t=fA(a);function a(e){var r;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,a),r=t.call(this,e);var o=e.location,i=e.namespace,s=e.role_name,c=e.currentUserId,l=lf.a.parse(o.search).name,u=void 0===l?"":l;return r.isEdit=!!u,r.currentSourceControlName=u,r.sourceControlDict={},r.state={currentSourceControlName:u,sourceControlDataFetched:!1,currentConfigDataFetched:!1,formSchema:SA(r.isEdit,c,s,i),submitted:!1,formData:{}},r.dataUpdates={},r.CancelToken=T.a.CancelToken,r.submitForm=r.submitForm.bind(hA(r)),r.validateForm=r.validateForm.bind(hA(r)),r.onChangeForm=r.onChangeForm.bind(hA(r)),r.updateFormData=r.updateFormData.bind(hA(r)),r.onSourceControlFetched=r.onSourceControlFetched.bind(hA(r)),r.bdFormRef=n.a.createRef(),r}return pA(a,null,[{key:"getMeta",value:function(e){var t="".concat(e?"Edit":"Create"," Source Control");return{title:"".concat(w.APP_TITLE.CP," | ").concat(t),link:[{rel:"canonical",href:"".concat(w.serverUrl).concat(w.views.k8sCreateEditSourceControl.url)}],meta:[{charset:"utf-8"},{name:"description",content:"Form to create and edit source control"}],pageTitle:t}}}]),pA(a,[{key:"componentDidMount",value:function(){var e=this,t=this.props,a=t.role_name,r=t.dispatch,n=t.namespace,o=t.port;if(a===w.ROLE_NAME.MEMBER){var i={"kubedirector.hpe.com/cmType":"source-control",createdByRole:w.ROLE_NAME.ADMIN};this.dataUpdates.sourceControl=this.CancelToken.source(),r(Q(lA(lA({},oe.K8S_CONFIG_MAP({namespace:n,port:o,propVal:"k8s_global_source_controls",params:i})),{},{cancelToken:this.dataUpdates.sourceControl.token}))).then((function(){delete e.dataUpdates.sourceControl,e.setState({sourceControlDataFetched:!0},e.onSourceControlFetched)}))}this.isEdit&&(this.dataUpdates.currentSourceControl=this.CancelToken.source(),r(Q(lA(lA({},oe.CURRENT_K8S_CONFIG_MAP({namespace:n,port:o,name:this.currentSourceControlName})),{},{cancelToken:this.dataUpdates.currentSourceControl.token}))).then((function(){delete e.dataUpdates.currentSourceControl,e.setState({currentConfigDataFetched:!0},(function(){return e.updateFormData(!0)}))})))}},{key:"componentWillUnmount",value:function(){var e=this;Object.keys(this.dataUpdates).map((function(t){e.dataUpdates[t].cancel("component unmounted")}))}},{key:"onSourceControlFetched",value:function(){var e=this,t=this.props.source_controls,a=void 0===t?[]:t,r=this.state.formSchema;if(a.length){var n=a.reduce((function(e,t){var a=t.metadata,r=(a=void 0===a?{}:a).name,n=void 0===r?"":r,o=t.data,i=void 0===o?{}:o,s={},c=["type","auth-type","repo-url","proxy-protocol","proxy-hostname","proxy-port"];return Object.entries(i).map((function(e){var t=iA(e,2),a=t[0],r=t[1];s[a]=c.includes(a)?r:""})),e[n]={data:s},e}),{}),o=Object.keys(n).map((function(e){return{type:"string",enum:[e],title:e}})),i=f.a.deepClone(r);f.a.fetchSafeFromObject({path:["properties","metadata","properties","labels","properties"],obj:i,default_value:{}}).parentConfiguration={type:"string",title:yA.metadataParentConfigurationTitle,description:yA.metadataParentConfigurationDescription,default:Object.keys(n)[0],bd_required:!0,bd_disabled:this.isEdit,oneOf:o},this.sourceControlDict=n,this.setState({formSchema:i},(function(){return e.updateFormData(!0)}))}}},{key:"updateFormData",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=this.props,a=t.role_name,r=void 0===a?"":a,n=t.current_config_map,o=r===w.ROLE_NAME.MEMBER,i={};i=f.a.fetchSafeFromObject({path:["current","state","formData"],obj:this.bdFormRef,default_value:{}});var s=f.a.deepClone(i),c="";if(o){var l=this.isEdit?n:s;c=f.a.fetchSafeFromObject({path:["metadata","labels","parentConfiguration"],obj:l,default_value:""})}var u=this.isEdit?this.props.current_config_map:this.sourceControlDict[c],p=u.metadata,d=(p=void 0===p?{}:p).name,m=void 0===d?s.metadata.name||"":d,h=p.label,b=(h=void 0===h?{}:h).parentConfiguration,v=void 0===b?c:b,y=u.data,g=void 0===y?{}:y;s.metadata.name=m,o&&(s.metadata.labels.parentConfiguration=v),Object.entries(g).map((function(t){var a=iA(t,2),r=a[0],n=a[1];"description"===r?s.metadata.description=n:["token","password"].includes(r)?s.data[r]=e?"":n:s.data[r]=n})),this.setState({formData:s})}},{key:"validateForm",value:function(e,t){var a=this.props.role_name===w.ROLE_NAME.MEMBER,r=e.metadata.name,n=void 0===r?"":r,o=e.data,i=o["auth-type"],s=void 0===i?"":i,c=o["repo-url"],l=void 0===c?"":c,u=o["proxy-hostname"],p=void 0===u?"":u,d=o["proxy-port"],f=void 0===d?"":d,m=o.branch,h=void 0===m?"":m,b=o.username,v=void 0===b?"":b,y=o.email,g=void 0===y?"":y,_=o.token,S=void 0===_?"":_,k=o.password,O=void 0===k?"":k;return Fl.k8s_label.test(n)||t.metadata.name.addError(yA.metadataNameError),Fl.git_repo.test(l)||t.data["repo-url"].addError(yA.dataRepoUrlError),(a||g)&&(Fl.email_address.test(g)||t.data.email.addError(yA.dataEmailError)),!p||Fl.fqdn.test(p)||Fl.ip.test(p)||t.data["proxy-host"].addError(yA.dataProxyHostError),f&&!Fl.port.test(f)&&t.data["proxy-port"].addError(yA.dataProxyPortError),a&&(h||t.data.branch.addError(yA.dataBranchError),v||t.data.username.addError(yA.dataUsernameError),"token"===s?S||t.data.token.addError(yA.dataTokenError):O||t.data.password.addError(yA.dataPasswordError)),t}},{key:"submitForm",value:function(e){var t=this,a=this.props,r=a.cluster_href,o=a.current_config_map,i=e.formData,s=e.errors,c=f.a.fetchSafeFromObject({path:["metadata","name"],obj:i,default_value:""});if(!s.length){this.setState({submitted:!0,formData:i});var l=f.a.deepClone(i),u=f.a.fetchSafeFromObject({path:["metadata","description"],obj:l,default_value:""});if(delete l.metadata.description,l.data.description=u,this.isEdit&&f.a.isEqual(l.data,o.data))return _n({msg:"Nothing to update",variant:"success"}),this.setState({submitted:!1}),!1;R({method:w.method.POST,op:"kubectl_action",timeout:w.settings.long_timeout,data:{kubectl_op:this.isEdit?w.method.APPLY:w.method.CREATE,cluster_href:r,payload:JSON.stringify(l)}}).then((function(){_n({msg:"Successfully ".concat(t.isEdit?"updated":"created",' source control "').concat(c,'"'),variant:"success"}),f.a.redirectTo({context:t.props,location:w.views.managek8sSourceControl.url})})).catch((function(e){var a=f.a.fetchSafeFromObject({path:["response","data","message"],obj:e,default_value:""}),r=n.a.createElement(ns,{errors:["Failed to ".concat(t.isEdit?"update":"create",' source control "').concat(c,'"'),a]});_n({msg:r,variant:"error"}),t.setState({submitted:!1})}))}}},{key:"onChangeForm",value:function(e){var t=this.props.role_name,a=void 0===t?"":t;if(!this.isEdit&&a===w.ROLE_NAME.MEMBER){var r=document.activeElement,n=xl(r);if(n){var o=e.formData;n.endsWith("parentConfiguration")&&this.setState({formData:o},this.updateFormData)}}}},{key:"render",value:function(){var e=a.getMeta(this.isEdit),t=this.props,r=t.role_name,o=t.source_controls,i=this.state,s=i.formSchema,c=i.formData,l=i.submitted,u=i.sourceControlDataFetched,p=i.currentConfigDataFetched,d=r===w.ROLE_NAME.MEMBER,f=this.isEdit&&!p||d&&!u,m=!f&&d&&!o.length;return n.a.createElement("div",{className:"K8sCreateEditSourceControlPage"},n.a.createElement(Al.a,{title:e.title,description:e.description,link:e.link,meta:e.meta}),n.a.createElement(Nt,{title:e.pageTitle}),f||l&&n.a.createElement(ls,{status:f?"Fetching data":"Submiting form"}),m&&n.a.createElement(St.Typography,{color:"error"},yA.globalSourceControlsMissing),n.a.createElement(En,{form_schema:s,ui_schema:{},formData:c,form_id:"createEditSourceControl",submitter:this.submitForm,onChange:this.onChangeForm,validate:l||f?null:this.validateForm,submitDisabled:l||f||m,nodeRef:this.bdFormRef}))}}]),a}(r.Component);vA(gA,"propTypes",{dispatch:u.a.func.isRequired,location:u.a.object,namespace:u.a.string,port:u.a.number,currentUserId:u.a.string,currentTenantHref:u.a.string,role_name:u.a.string,source_controls:u.a.array,current_config_map:u.a.object,cluster_href:u.a.string});var _A=Object(s.b)((function(e){var t=e.stats_data,a=(t=void 0===t?{}:t).session_data,r=(a=void 0===a?"":a).user,n=void 0===r?"":r,o=a.current_tenant_data,i=void 0===o?{}:o,s=e.page_data,c=(s=void 0===s?{}:s).k8s_global_source_controls,l=(c=void 0===c?{}:c).items,u=void 0===l?[]:l,p=s.current_config_map,d=void 0===p?{}:p,f=i.namespace,m=void 0===f?"":f,h=i.k8s_auth_port,b=void 0===h?0:h,v=i.k8s_cluster,y=void 0===v?"":v;return{namespace:m,port:b,source_controls:u,current_config_map:d,currentUserId:n.split("/").pop(),cluster_href:y}}))(gA),SA=function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"",r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"",n=a===w.ROLE_NAME.MEMBER;return{type:"object",properties:{apiVersion:{type:"string",default:"v1",hidden:!0},kind:{type:"string",default:"ConfigMap",hidden:!0},metadata:{type:"object",title:"Label",properties:{namespace:{type:"string",default:r,hidden:!0},name:{type:"string",title:yA.metadataNameTitle,description:yA.metadataNameDescription,default:"",bd_required:!0,bd_disabled:e},description:{type:"string",title:yA.metadataDescriptionTitle,description:yA.metadataDescriptionDescription,default:""},labels:{type:"object",properties:{"kubedirector.hpe.com/cmType":{type:"string",default:"source-control",hidden:!0},createdByUser:{type:"string",default:t,hidden:!0},createdByRole:{type:"string",default:a,hidden:!0}}}}},data:{type:"object",title:"Source Control Configuration",properties:{type:{type:"string",title:yA.dataTypeTitle,description:yA.dataTypeDescription,default:"github",bd_required:!0,bd_disabled:n,oneOf:[{type:"string",enum:["github"],title:"Github"},{type:"string",enum:["bitbucket"],title:"Bitbucket"}]},"repo-url":{type:"string",title:yA.dataRepoUrlTitle,description:yA.dataRepoUrlDescripton,bd_required:!0,bd_disabled:n,default:"",placeholder:"https://source-control.com/your/repo.git"},"auth-type":{type:"string",title:yA.dataAuthTypeTitle,description:yA.dataAuthTypeDescription,default:"token",bd_required:!0,bd_disabled:n,oneOf:[{type:"string",enum:["token"],title:"Token"},{type:"string",enum:["password"],title:"Password"}]},branch:{type:"string",title:yA.dataBranchTitle,description:yA.dataBranchDescription,bd_required:n,default:"",placeholder:"main"},"working-directory":{type:"string",title:yA.dataWorkingDirectoryTitle,description:yA.dataWorkingDirectoryDescription},"proxy-protocol":{type:"string",title:yA.dataProxyProtocolTitle,description:yA.dataProxyProtocolDescription,placeholder:"https",bd_disabled:n},"proxy-hostname":{type:"string",title:yA.dataProxyHostnameTitle,description:yA.dataProxyHostnameDescription,placeholder:"hostname.com",bd_disabled:n},"proxy-port":{type:"string",title:yA.dataProxyPortTitle,description:yA.dataProxyPortDescription,placeholder:"00",bd_disabled:n},username:{type:"string",title:yA.dataUsernameTitle,description:yA.dataUsernameDescription,bd_required:n},email:{type:"string",title:yA.dataEmailTitle,description:yA.dataEmailDescription,bd_required:n}},dependencies:{"auth-type":{oneOf:[{properties:{"auth-type":{enum:["token"]},token:{type:"string",title:yA.dataTokenTitle,description:yA.dataTokenDescription,bd_widget:"password",bd_required:n}}},{properties:{"auth-type":{enum:["password"]},password:{type:"string",title:yA.dataPasswordTitle,description:yA.dataPasswordDescription,bd_widget:"password",bd_required:n}}}]}}}}}};function kA(e){return(kA="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function OA(){return(OA=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var r in a)Object.prototype.hasOwnProperty.call(a,r)&&(e[r]=a[r])}return e}).apply(this,arguments)}function EA(e){return function(e){if(Array.isArray(e))return jA(e)}(e)||function(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||function(e,t){if(!e)return;if("string"==typeof e)return jA(e,t);var a=Object.prototype.toString.call(e).slice(8,-1);"Object"===a&&e.constructor&&(a=e.constructor.name);if("Map"===a||"Set"===a)return Array.from(e);if("Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a))return jA(e,t)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function jA(e,t){(null==t||t>e.length)&&(t=e.length);for(var a=0,r=new Array(t);a<t;a++)r[a]=e[a];return r}function DA(e,t){for(var a=0;a<t.length;a++){var r=t[a];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function wA(e,t){return(wA=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function CA(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=AA(e);if(t){var n=AA(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return TA(this,a)}}function TA(e,t){return!t||"object"!==kA(t)&&"function"!=typeof t?PA(e):t}function PA(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function AA(e){return(AA=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function RA(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}var NA={tenant:"*",pod:"*",time_range:"hour",agg_type:"total_avg"},FA=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&wA(e,t)}(i,e);var t,a,r,o=CA(i);function i(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),(t=o.call(this,e)).CancelToken=T.a.CancelToken,t.dataUpdates={},t.timeouts={},t.state={applicable_namespaces:[],applicable_metrics:[],applicable_graphs:[],grid:0,data:{},loading:!1,selection:NA,selectors:{tenant:[],pod:[]}},t.updateMetricDescriptors=t.updateMetricDescriptors.bind(PA(t)),t.handleChangeSelection=t.handleChangeSelection.bind(PA(t)),t.fetchChartsData=t.fetchChartsData.bind(PA(t)),t.cleanData=t.cleanData.bind(PA(t)),t.filterData=t.filterData.bind(PA(t)),t.setApplicableSelectorList=t.setApplicableSelectorList.bind(PA(t)),t}return t=i,(a=[{key:"componentDidMount",value:function(){var e=this.props.podsDataFetching;this.updateMetricDescriptors(),!e&&this.setApplicableSelectorList()}},{key:"componentWillUnmount",value:function(){Object.values(this.timeouts).forEach((function(e){clearTimeout(e)})),Object.values(this.dataUpdates).forEach((function(e){e.cancel("component unmounted")}))}},{key:"componentDidUpdate",value:function(e){var t=this.props.tenantPodList;f.a.isEqual(t,e.tenantPodList)||this.setApplicableSelectorList()}},{key:"updateMetricDescriptors",value:function(){var e=this,t=this.props,a=t.metricParamsFetched,r=t.metrics_params,n=t.role_name,o=t.is_site_admin_view;if(a){var i=w.applicable_graphs({graph:"k8s-tenant"});!o&&["Admin","Member"].includes(n)&&(i.splice(i.indexOf("cpu_usage_node_pct_per_pod"),1),i.splice(i.indexOf("mem_usage_node_pct"),1));var s=4===i.length?6:4,c=Sd({graph:"k8s-tenant",metrics_params:r,applicable_graphs:i});this.setState({grid:s,applicable_graphs:i,applicable_metrics:c},(function(){e.fetchChartsData("load")}))}else this.timeouts.metric=setTimeout(this.updateMetricDescriptors,500)}},{key:"handleChangeSelection",value:function(e,t){var a=this,r=this.state.selection,n=f.a.deepClone(r);if(n[t]=e,"cluster"===t&&(n.pod="*"),"tenant"===t&&(n.pod="*",n.cluster="*",n.agg_type="total_avg"),"pod"===t)switch(e){case"top_cpu_nanocores_pods":case"top_cpu_limit_pods":case"top_memory_usage_pods":case"top_memory_limit_pods":n.agg_type=e,n.pod="*";break;case"*":n.agg_type="total_avg",n.pod="*";break;default:n.agg_type="pod",n.pod=e}this.setState({selection:n},(function(){a.setApplicableSelectorList(),a.fetchChartsData("load")}))}},{key:"cleanData",value:function(){var e=this.state,t=e.applicable_metrics,a=e.raw_data,r=e.selection,n=this.props.tenantPodList,o=yd({raw_data:a,applicable_metrics:t,tenantPodList:n,selection:r});this.setState({data:o})}},{key:"fetchChartsData",value:function(e){var t=this;e&&this.setState({loading:!0}),clearTimeout(this.timeouts.chart);var a=this.props,r=a.k8sTenants,n=a.hasPods,o=a.podsDataFetching,i=this.state,s=i.selection,c=i.applicable_metrics,l=i.kubedirector;if(r.length&&!o&&n){this.dataUpdates.monitoring=this.CancelToken.source();var u=Od,p={applicable_metrics:c,kubedirector:l,k8sTenants:r,selection:s},d=this.dataUpdates.monitoring.token;_d({cancelToken:d,inBuckets:[],queryFun:u,queryParams:p}).then((function(a){if(a.length>0){delete t.dataUpdates.monitoring;var r=a;t.setState({raw_data:r},(function(){t.cleanData(),e&&t.setState({loading:!1})})),t.timeouts.chart=setTimeout(t.fetchChartsData,6e4)}else e&&t.setState({loading:!1})}),(function(e){T.a.isCancel(e)?f.a.bdLog(e):t.timeouts.chart=setTimeout(t.fetchChartsData,6e4)}))}else this.timeouts.chart=setTimeout(this.fetchChartsData,6e4)}},{key:"filterData",value:function(e){var t=this.state,a=t.data,r=t.selection,n=r.pod,o=r.tenant,i=f.a.fetchSafeFromObject({path:[e],obj:a,default_value:{}});return"*"!==n?RA({},n,i[n]):"*"!==o?RA({},o,i[o]):i}},{key:"setApplicableSelectorList",value:function(){var e=this.state.selection,t=this.props,a=t.tenantPodList,r=t.k8sTenantNamespaceNameDict,n=t.k8sTenants,o=e.tenant,i={tenant:[],pod:[]};for(var s in a){var c,l=a[s],u=r[s];i.tenant.push({title:u,val:s}),"*"!==o&&o!==s||(c=i.pod).push.apply(c,EA(l))}this.setState({selectors:i}),"total_avg"===e.agg_type&&"*"===o&&n.length>10&&(e.agg_type="total_avg_all_tenants",this.setState({selection:e}))}},{key:"render",value:function(){var e=this,t=this.props,a=t.classes,r=t.role_name,o=t.hasPods,i=t.podsDataFetching,s=this.state,c=s.applicable_graphs,l=s.applicable_metrics,u=s.grid,p=s.selection,d=s.selectors,f=s.loading,m=p.tenant,h=p.pod,b=p.time_range;return n.a.createElement("div",{className:a.monitoring},o?n.a.createElement(n.a.Fragment,null,n.a.createElement("div",{className:a.chartContainer},n.a.createElement("div",{className:a.chartSelectors},r===w.ROLE_NAME.K8S_ADMIN&&n.a.createElement(Hr.a,{className:a.selectWrapper},n.a.createElement(nc,{value:m,onChange:this.handleChangeSelection,name:"tenant",className:a.select,items:[{val:"*",title:"All Tenants (aggregated)"}].concat(EA(d.tenant))})),!(r===w.ROLE_NAME.K8S_ADMIN&&"*"===m)&&n.a.createElement(Hr.a,{className:a.selectWrapper},n.a.createElement(nc,{value:h,onChange:this.handleChangeSelection,name:"pod",className:a.select,items:[{val:"*",title:"All Pods (aggregated)"}].concat(EA(d.pod.map((function(e){return{val:e,title:e}}))))})),n.a.createElement(Hr.a,{className:a.selectWrapper},n.a.createElement(nc,{value:b,onChange:this.handleChangeSelection,name:"time_range",className:a.select,items:EA(w.TIME_RANGES)}))),c.length?n.a.createElement(bc.a,{className:a.charts,container:!0,spacing:16},c.map((function(t){return n.a.createElement(Nd,OA({type:"cluster_chart"},l.find((function(e){return e.id===t})),{props_data:e.filterData(t),grid:u,key:t,updateData:!1,renderer:"area",showLoading:f}))}))):n.a.createElement(ls,{center:!0,status:"Genereting metric params"}))):n.a.createElement(n.a.Fragment,null,i?n.a.createElement(ls,{center:!0,status:"Fetching pods data"}):n.a.createElement(Hp.a,{className:a.well},n.a.createElement(qp.a,null,n.a.createElement(st.a,{variant:"body1"},"Charts will be available once pods are created.")))))}}])&&DA(t.prototype,a),r&&DA(t,r),i}(r.Component);RA(FA,"propTypes",{classes:u.a.object,role_name:u.a.string,current_tenant_data:u.a.object,k8sTenants:u.a.array,metrics_params:u.a.object,metricParamsFetched:u.a.bool,is_site_admin_view:u.a.bool,podsDataFetching:u.a.bool,tenantPodList:u.a.object,k8sTenantNamespaceNameDict:u.a.object,hasPods:u.a.bool});var xA=he()(yp)(FA);function MA(e){return(MA="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function IA(e,t){for(var a=0;a<t.length;a++){var r=t[a];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function UA(e,t){return(UA=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function LA(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=KA(e);if(t){var n=KA(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return BA(this,a)}}function BA(e,t){return!t||"object"!==MA(t)&&"function"!=typeof t?HA(e):t}function HA(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function KA(e){return(KA=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var qA=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&UA(e,t)}(i,e);var t,a,r,o=LA(i);function i(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),(t=o.call(this,e)).downloadKubectlPlugin=t.downloadKubectlPlugin.bind(HA(t)),t.downloadKubectlBinary=t.downloadKubectlBinary.bind(HA(t)),t.downloadKubectlBinaryHelper=t.downloadKubectlBinaryHelper.bind(HA(t)),t.downloadKubeconfig=t.downloadKubeconfig.bind(HA(t)),t.getMenuListItem=t.getMenuListItem.bind(HA(t)),t.getMenuList=t.getMenuList.bind(HA(t)),t}return t=i,(a=[{key:"componentDidMount",value:function(){}},{key:"downloadKubectlPlugin",value:function(e){w.kubectlPluginsDownload(e),_n({msg:"HPE Kubectl Plugin downloaded successfully",variant:"success"})}},{key:"downloadKubectlBinary",value:function(e){var t=e.operatingSystem,a=e.k8s_version;w.kubectlDownload(t,a),_n({msg:"Kubectl downloaded successfully",variant:"success"})}},{key:"downloadKubectlBinaryHelper",value:function(e){var t=this,a=this.props.k8s_version;if(a)this.downloadKubectlBinary({operatingSystem:e,k8s_version:"v".concat(a)});else{var r=this.props.port;R({apiurl:w.apiurl.K8S_VERSION,port:r}).then((function(a){if(a.data){var r=f.a.fetchSafeFromObject({path:["data","gitVersion"],obj:a,default_value:""});t.downloadKubectlBinary({operatingSystem:e,k8s_version:r})}})).catch((function(){_n({msg:"Failed to get Kubernetes version",variant:"error"})}))}}},{key:"downloadKubeconfig",value:function(){var e=this.props.tenant,t=void 0===e?"":e;sw.downloadKubeconfig(t)}},{key:"getMenuListItem",value:function(e,t){return{icon:"icon-download2",label:e,onClick:t}}},{key:"getMenuList",value:function(e){return[this.getMenuListItem("Download for Windows",(function(){return e("Windows")})),this.getMenuListItem("Download for MacOS",(function(){return e("MacOS")})),this.getMenuListItem("Download for Linux",(function(){return e("Linux")}))]}},{key:"render",value:function(){var e=this.props.classes,t=this.getMenuList(this.downloadKubectlPlugin),a=this.getMenuList(this.downloadKubectlBinaryHelper);return n.a.createElement("div",{className:e.actionBtns},n.a.createElement("div",{className:e.downloadBtns},n.a.createElement(_t,{variant:"contained",color:"primary",title:"Download HPE Kubectl Plugin",menuList:t})),n.a.createElement("div",{className:e.downloadBtns},n.a.createElement(_t,{variant:"contained",color:"primary",title:"Download Kubectl",menuList:a})),n.a.createElement(Ue.a,{variant:"contained",color:"primary",className:e.downloadBtns,onClick:this.downloadKubeconfig},n.a.createElement("span",{className:"icon icon-download2"}),"Download Kubeconfig"))}}])&&IA(t.prototype,a),r&&IA(t,r),i}(r.Component);!function(e,t,a){t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a}(qA,"propTypes",{classes:u.a.object.isRequired,tenant:u.a.string,k8s_version:u.a.string,port:u.a.oneOfType([u.a.string,u.a.number])});var VA=he()((function(){return{downloadBtns:{marginLeft:"1em"},actionBtns:{display:"flex",justifyContent:"flex-end"}}}))(qA);function GA(e){return(GA="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function zA(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function WA(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?zA(Object(a),!0).forEach((function(t){tR(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):zA(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function JA(e,t){for(var a=0;a<t.length;a++){var r=t[a];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function YA(e,t,a){return t&&JA(e.prototype,t),a&&JA(e,a),e}function $A(e,t){return($A=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function QA(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=eR(e);if(t){var n=eR(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return ZA(this,a)}}function ZA(e,t){return!t||"object"!==GA(t)&&"function"!=typeof t?XA(e):t}function XA(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function eR(e){return(eR=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function tR(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}var aR=[{label:"Usage",key:"usage"},{label:"Monitoring",key:"monitoing"}],rR=[w.ROLE_NAME.ADMIN,w.ROLE_NAME.MEMBER],nR=w.settings.MB_to_GB,oR=w.RESOURCE_TYPES,iR=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&$A(e,t)}(a,e);var t=QA(a);function a(e){var r;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,a),(r=t.call(this,e)).CancelToken=T.a.CancelToken,r.dataUpdates={},r.fetchData=r.fetchData.bind(XA(r)),r.parsePodsData=r.parsePodsData.bind(XA(r)),r.state={tenantsDataFetched:!1,k8sCurrentClusterDataFetched:!1,k8sHostsFetched:!1,metricParamsFetched:!1,podsDataFetching:!0,hasPods:!1},r}return YA(a,null,[{key:"getMeta",value:function(){return{title:"".concat(w.APP_TITLE.CP," | Tenant Dashboard"),link:[{rel:"canonical",href:"".concat(w.serverUrl).concat(w.views.k8sTenantDashboard.url)}],meta:[{charset:"utf-8"},{name:"description",content:"Kubernetes tenant dashboard reporting of general usages."}]}}}]),YA(a,[{key:"componentDidMount",value:function(){var e=this,t=this.props.role_name;this.fetchData([{name:"metricParams"}]),t===w.ROLE_NAME.K8S_ADMIN?this.fetchData([{name:"tenants",callBack:function(){e.fetchData([{name:"pods"}])}},{name:"k8sHosts"},{name:"k8sCurrentCluster"}]):this.fetchData([{name:"pods"}])}},{key:"componentWillUnmount",value:function(){Object.values(this.dataUpdates).forEach((function(e){e.cancel("component unmounted")}))}},{key:"fetchData",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],a=this.props,r=a.dispatch,n=a.metrics_params,o=a.current_tenant_data.k8s_cluster,i=void 0===o?"":o;t.forEach((function(t){var a=t.name,o=void 0===a?"":a,s=t.callBack,c=void 0===s?null:s;e.dataUpdates[t]=e.CancelToken.source();var l=e.dataUpdates[t].token;switch(o){case"tenants":r(Q(WA(WA({},oe.TENANT_DATA),{},{cancelToken:l}))).then((function(){delete e.dataUpdates[t],e.setState({tenantsDataFetched:!0},(function(){c&&c()}))}));break;case"k8sHosts":r(Q(WA(WA({},oe.K8SHOST_DATA),{},{cancelToken:l}))).then((function(){delete e.dataUpdates[t],e.setState({k8sHostsFetched:!0},(function(){c&&c()}))}));break;case"k8sCurrentCluster":r(Q(WA(WA({},oe.CURRENT_K8SCLUSTER_DATA("".concat(i,"?stats"))),{},{cancelToken:l}))).then((function(){delete e.dataUpdates[t],e.setState({k8sCurrentClusterDataFetched:!0},(function(){c&&c()}))}));break;case"metricParams":f.a.isEmptyObject(n)?r(Q(WA(WA({},oe.METRICS_PARAM_DATA),{},{cancelToken:l}))).then((function(){delete e.dataUpdates[t],e.setState({metricParamsFetched:!0},(function(){c&&c()}))})):(delete e.dataUpdates[t],e.setState({metricParamsFetched:!0},(function(){c&&c()})));break;case"pods":var u=e.props.k8sTenantsById;for(var p in delete e.dataUpdates[t],u){var d=u[p],m=d.namespace,h=void 0===m?"":m,b=d.port,v=void 0===b?"":b;if(h&&("number"===f.a.guessType(v)||v)){var y="".concat(t,"_").concat(h);e.dataUpdates[y]=e.CancelToken.source(),l=e.dataUpdates[y].token,r(X(oe.K8S_PODS_DATA({namespace:h,propVal:"tenantPodList",port:v,params:{fieldSelector:"status.phase=Running"},cancelToken:l,respDataParser:e.parsePodsData,updateProps:{collecterKey:h}})))}}}}))}},{key:"parsePodsData",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=this.state.hasPods,a=e.items,r=void 0===a?[]:a,n=f.a.fetchSafeFromObject({path:["metadata","continue"],obj:e,default_value:""}),o=r.map((function(e){return f.a.fetchSafeFromObject({path:["metadata","name"],obj:e,default_value:""})})).filter((function(e){return!!e})),i=t||!!o.length;return n?n="&continue=".concat(n):this.setState({podsDataFetching:!1,hasPods:i}),{data:o,nextToken:n}}},{key:"render",value:function(){var e=this,t=a.getMeta(),r=this.props,o=r.role_name,i=r.current_tenant_data,s=r.k8sTenantsById,c=r.clusterNames,l=r.metrics_params,u=r.location,p=r.k8s_version,d=r.port,m=r.k8shosts,h=r.is_site_admin_view,b=void 0!==h&&h,v=r.hostClusterDict,y=r.tenantPodList,g=r.k8sTenantNamespaceNameDict,_=r.total_quota,S=r.hasTenantStorageSet,k=this.state,O=k.tenantsDataFetched,E=k.metricParamsFetched,j=k.k8sHostsFetched,D=k.k8sCurrentClusterDataFetched,w=k.podsDataFetching,C=k.hasPods,T="K8S Admin"===o,P=f.a.fetchSafeFromObject({path:["label","name"],obj:i,default_value:""}),A=Object.values(s),R=n.a.createElement(xA,{is_site_admin_view:b,role_name:o,current_tenant_data:i,k8sTenants:A,metrics_params:l,metricParamsFetched:E,podsDataFetching:w,tenantPodList:y,k8sTenantNamespaceNameDict:g,hasPods:C}),N=T?aR.map((function(t){return n.a.createElement("div",{key:t.key},"usage"===t.key?j&&O&&D?n.a.createElement(XO,{k8shosts:m,role_name:o,k8sTenantsById:s,clusterNames:c,fetchData:e.fetchData,hostClusterDict:v,total_quota:_,hasTenantStorageSet:S}):n.a.createElement(ls,null):"","monitoing"===t.key?O?R:n.a.createElement(ls,null):"")})):[];return n.a.createElement("div",{className:"K8sTenantDashboardPage"},n.a.createElement(Al.a,{title:t.title,description:t.description,link:t.link,meta:t.meta}),n.a.createElement(Nt,{title:"Dashboard"}),n.a.createElement(VA,{tenant:P,k8s_version:p,port:d}),T?n.a.createElement(_o,{tabs:aR,tabContents:N,location:u}):R)}}]),a}(r.Component);tR(iR,"propTypes",{dispatch:u.a.func.isRequired,role_name:u.a.string,current_tenant_data:u.a.object,k8sTenantsById:u.a.object,clusterNames:u.a.object,metrics_params:u.a.object,location:u.a.object,port:u.a.oneOfType([u.a.string,u.a.number]),k8s_version:u.a.string,k8shosts:u.a.array,is_site_admin_view:u.a.bool,hostClusterDict:u.a.object,tenantPodList:u.a.object,k8sTenantNamespaceNameDict:u.a.object,total_quota:u.a.object,hasTenantStorageSet:u.a.bool});var sR=Object(s.b)((function(e){var t,a=e.stats_data,r=void 0===a?{}:a,n=e.page_data,o=(n=void 0===n?{}:n).k8shost_list,i=void 0===o?{}:o,s=n.metrics_params,c=void 0===s?{}:s,l=n.current_k8scluster_data,u=void 0===l?{}:l,p=n.tenant_list,d=void 0===p?{}:p,m=n.tenantPodList,h=void 0===m?{}:m,b=r.session_data,v=(b=void 0===b?{}:b).role_name,y=void 0===v?"":v,g=b.current_tenant_data,_=void 0===g?{}:g,S=b.is_site_admin_view,k=void 0!==S&&S,O=_.k8s_cluster,E=void 0===O?"":O,j=_.k8s_auth_port,D=void 0===j?"":j,C=f.a.fetchSafeFromObject({path:["g_install","bdshared_storage_localfstype"],obj:r,default_value:""}),T=f.a.fetchSafeFromObject({path:["g_config_data_v1","objects","total_tenant_storage"],obj:r,default_value:0})*nR,P=u.k8s_version,A=void 0===P?"":P,R=u.imported,N=void 0!==R&&R,F=u.type,x=void 0===F?"":F,M=u.label,I=(M=void 0===M?{}:M).name,U=void 0===I?"":I,L=u.cluster_quota,B=(L=void 0===L?{}:L).cores,H=void 0===B?0:B,K=L.memory_gb,q=void 0===K?0:K,V=L.gpus,G=void 0===V?0:V,z=L.ephemeral_storage_size_gb,W=void 0===z?0:z,J=L.persistent_storage_size_gb,Y=void 0===J?0:J,$=U;if(!0===N){var Q=f.a.fetchSafeFromObject({path:[x],obj:tE.importedClusterTypesMap,default_value:""});$+=" (Imported ".concat(Q," Cluster)")}var Z=tR({},E,$),X=(tR(t={},oR.CPU.ID,H),tR(t,oR.MEMORY.ID,q*nR),tR(t,oR.GPU.ID,G),tR(t,oR.EPHEMERAL.ID,W*nR),tR(t,oR.PERSISTENT.ID,Y*nR),tR(t,oR.TENANT_STORAGE.ID,T),t),ee=f.a.fetchSafeFromObject({path:["_embedded","k8shosts"],obj:i,default_value:[]}),te=f.a.fetchSafeFromObject({path:["_embedded","tenants"],obj:d,default_value:[]}),ae={},re={},ne=k||rR.includes(y)?function(){var e=_.label,t=void 0===e?{}:e,a=_.namespace,r=void 0===a?"":a,n=_.k8s_auth_port,o=void 0===n?"":n,i=_.quota,s=void 0===i?{}:i,c=_.gpu_usage_supported,l=void 0!==c&&c,u=_.persistent_supported,p=void 0!==u&&u,d=_.tenant_storage_quota_supported,m=void 0!==d&&d,h=f.a.fetchSafeFromObject({path:w.pathToID,obj:_,default_value:""}),b=t.name||"";return re[r]=b,tR({},h,{id:h,name:b,namespace:r,quota:s,quota_support:{cores:!0,memory:!0,ephemeral_storage:!0,gpus:l,persistent_storage:p,tenant_storage:m},port:o})}():te.reduce((function(e,t){var a=f.a.fetchSafeFromObject({path:["features","kubernetes_access"],obj:t,default_value:!1}),r=f.a.fetchSafeFromObject({path:["tenant_enclosed_properties","k8s_cluster"],obj:t,default_value:""});if(a&&"k8s"===t.tenant_type&&E===r){var n=t._links,o=void 0===n?{}:n,i=t.label,s=void 0===i?{}:i,c=t.tenant_enclosed_properties,l=(c=void 0===c?{}:c).namespace,u=void 0===l?"":l,p=c.k8s_auth_port,d=void 0===p?"":p,m=c.k8s_cluster,h=void 0===m?"":m,b=t.quota,v=void 0===b?{}:b,y=t.quota_support,g=(y=void 0===y?{}:y).disk_gb,_=void 0===g||g,S=y.gpus,k=void 0===S||S,O=y.persistent_storage_size_gb,j=void 0===O||O,D=y.tenant_storage_gb,w=void 0===D||D;if(u&&d){var C=f.a.fetchSafeFromObject({path:["self","href"],obj:o,default_value:""}),T=s.name||"";e[C]={id:C,name:T,namespace:u,quota:v,quota_support:{cores:!0,memory:!0,ephemeral_storage:_,gpus:k,persistent_storage:j,tenant_storage:w},port:d,cluster:h,cluster_quota:X},re[u]=T}}return e}),{});return ee.forEach((function(e){var t=e.hostname,a=e.cluster_id,r=void 0===a?"":a;ae[t]=r})),{role_name:y,current_tenant_data:_,k8sTenantsById:ne,clusterNames:Z,metrics_params:c,port:D,k8s_version:A,k8shosts:ee,is_site_admin_view:k,hostClusterDict:ae,tenantPodList:h,k8sTenantNamespaceNameDict:re,total_quota:X,hasTenantStorageSet:!!C}}))(iR);function cR(e,t){if(null==e)return{};var a,r,n=function(e,t){if(null==e)return{};var a,r,n={},o=Object.keys(e);for(r=0;r<o.length;r++)a=o[r],t.indexOf(a)>=0||(n[a]=e[a]);return n}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(r=0;r<o.length;r++)a=o[r],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(n[a]=e[a])}return n}function lR(e){return(lR="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function uR(){return(uR=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var r in a)Object.prototype.hasOwnProperty.call(a,r)&&(e[r]=a[r])}return e}).apply(this,arguments)}function pR(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function dR(e,t){for(var a=0;a<t.length;a++){var r=t[a];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function fR(e,t){return(fR=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function mR(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=bR(e);if(t){var n=bR(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return hR(this,a)}}function hR(e,t){return!t||"object"!==lR(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function bR(e){return(bR=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var vR=w.views,yR=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&fR(e,t)}(i,e);var t,a,r,o=mR(i);function i(){return pR(this,i),o.apply(this,arguments)}return t=i,(a=[{key:"render",value:function(){var e=this.props,t=e.role_name,a=void 0===t?"":t,r=e.tenant_type,o=void 0===r?"":r,i=e.tenant_features,s=i.ml_project,c=void 0===s?"":s,l=i.kubernetes_access,u=void 0===l?"":l,p=u?"k8sDataSource":"dataSource",d=u?"k8sCreateEditDataSource":"createEditDataSource",f=u?"k8sTenantUsers":"projectUsers",m="K8S Admin"===a?"k8sAdminClusterDashboard":"k8sClusterDashboard",h="K8S Admin"===a?"k8sTenantList":"k8sTenants";return n.a.createElement("div",null,a?n.a.createElement(wl.a,null,n.a.createElement(_R,uR({exact:!0,path:vR.hosts.url,component:xu,roles:vR.hosts.roles,tenant_types:vR.hosts.tenant_types},{ml_project:c,kubernetes_access:u,role_name:a,tenant_type:o})),n.a.createElement(_R,uR({exact:!0,path:vR.tags.url,component:up,roles:vR.tags.roles,tenant_types:vR.tags.tenant_types},{ml_project:c,kubernetes_access:u,role_name:a,tenant_type:o})),n.a.createElement(_R,uR({exact:!0,path:vR.infosight.url,component:$u,roles:vR.infosight.roles,tenant_types:vR.infosight.tenant_types},{ml_project:c,kubernetes_access:u,role_name:a,tenant_type:o})),n.a.createElement(_R,uR({exact:!0,path:vR.aimlDashboard.url,component:of,roles:vR.aimlDashboard.roles,tenant_types:vR.aimlDashboard.tenant_types},{ml_project:c,kubernetes_access:u,role_name:a,tenant_type:o})),n.a.createElement(_R,uR({exact:!0,path:vR[f].url,component:gf,roles:vR[f].roles},{ml_project:c,kubernetes_access:u},{tenant_types:vR[f].tenant_types},{ml_project:c,kubernetes_access:u,role_name:a,tenant_type:o})),n.a.createElement(_R,uR({exact:!0,path:vR.assignAimlUser.url,component:Gk,roles:vR.assignAimlUser.roles,tenant_types:vR.assignAimlUser.tenant_types},{ml_project:c,kubernetes_access:u,role_name:a,tenant_type:o})),n.a.createElement(_R,uR({path:vR.projectRepo.url,component:eg,roles:vR.projectRepo.roles,tenant_types:vR.projectRepo.tenant_types},{ml_project:c,kubernetes_access:u,role_name:a,tenant_type:o})),n.a.createElement(_R,uR({exact:!0,path:vR.sourceControl.url,component:Ig,roles:vR.sourceControl.roles,tenant_types:vR.sourceControl.tenant_types},{ml_project:c,kubernetes_access:u,role_name:a,tenant_type:o})),n.a.createElement(_R,uR({exact:!0,path:vR.models.url,component:Ey,roles:vR.models.roles,tenant_types:vR.models.tenant_types},{ml_project:c,kubernetes_access:u,role_name:a,tenant_type:o})),n.a.createElement(_R,uR({path:vR.createEditModel.url,component:Ky,roles:vR.createEditModel.roles,tenant_types:vR.createEditModel.tenant_types},{ml_project:c,kubernetes_access:u,role_name:a,tenant_type:o})),n.a.createElement(_R,uR({exact:!0,path:vR.trainings.url,component:fg,roles:vR.trainings.roles,tenant_types:vR.trainings.tenant_types},{ml_project:c,kubernetes_access:u,role_name:a,tenant_type:o})),n.a.createElement(_R,uR({path:vR.createEditTraining.url,component:Og,roles:vR.createEditTraining.roles,tenant_types:vR.createEditTraining.tenant_types},{ml_project:c,kubernetes_access:u,role_name:a,tenant_type:o})),n.a.createElement(_R,uR({exact:!0,path:vR.notebooks.url,component:Zm,roles:vR.notebooks.roles,tenant_types:vR.notebooks.tenant_types},{ml_project:c,kubernetes_access:u,role_name:a,tenant_type:o})),n.a.createElement(_R,uR({path:vR.createEditNotebook.url,component:Hh,roles:vR.createEditNotebook.roles,tenant_types:vR.createEditNotebook.tenant_types},{ml_project:c,kubernetes_access:u,role_name:a,tenant_type:o})),n.a.createElement(_R,uR({exact:!0,path:vR.deployments.url,component:eb,roles:vR.deployments.roles,tenant_types:vR.deployments.tenant_types},{ml_project:c,kubernetes_access:u,role_name:a,tenant_type:o})),n.a.createElement(_R,uR({path:vR.createEditDeployment.url,component:ub,roles:vR.createEditDeployment.roles,tenant_types:vR.createEditDeployment.tenant_types},{ml_project:c,kubernetes_access:u,role_name:a,tenant_type:o})),n.a.createElement(_R,uR({exact:!0,path:vR.aimlClusterDashboard.url,component:VS,roles:vR.aimlClusterDashboard.roles,tenant_types:vR.aimlClusterDashboard.tenant_types},{ml_project:c,kubernetes_access:u,role_name:a,tenant_type:o})),n.a.createElement(_R,uR({exact:!0,path:vR.manageDataSources.url,component:fv,roles:vR.manageDataSources.roles,tenant_types:vR.manageDataSources.tenant_types},{ml_project:c,kubernetes_access:u,role_name:a,tenant_type:o})),n.a.createElement(_R,uR({path:vR[p].url,component:zv,roles:vR[p].roles,tenant_types:vR[p].tenant_types},{ml_project:c,kubernetes_access:u,role_name:a,tenant_type:o})),n.a.createElement(_R,uR({path:vR[d].url,component:py,roles:vR[d].roles,tenant_types:vR[d].tenant_types},{ml_project:c,kubernetes_access:u,role_name:a,tenant_type:o})),n.a.createElement(_R,uR({exact:!0,path:vR.flavors.url,component:xf,roles:vR.flavors.roles,tenant_types:vR.flavors.tenant_types},{ml_project:c,kubernetes_access:u,role_name:a,tenant_type:o})),n.a.createElement(_R,uR({exact:!0,path:vR.aimlApps.url,component:xb,roles:vR.aimlApps.roles,tenant_types:vR.aimlApps.tenant_types},{ml_project:c,kubernetes_access:u,role_name:a,tenant_type:o})),n.a.createElement(_R,uR({exact:!0,path:vR.k8sDashboard.url,component:vE,roles:vR.k8sDashboard.roles,tenant_types:vR.k8sDashboard.tenant_types},{ml_project:c,kubernetes_access:u,role_name:a,tenant_type:o})),n.a.createElement(_R,uR({exact:!0,path:vR.k8sHosts.url,component:WC,roles:vR.k8sHosts.roles,tenant_types:vR.k8sHosts.tenant_types},{ml_project:c,kubernetes_access:u,role_name:a,tenant_type:o})),n.a.createElement(_R,uR({exact:!0,path:vR.managek8sClusters.url,component:PC,roles:vR.managek8sClusters.roles,tenant_types:vR.managek8sClusters.tenant_types},{ml_project:c,kubernetes_access:u,role_name:a,tenant_type:o})),n.a.createElement(_R,uR({path:vR.k8sCreateCluster.url,component:yD,roles:vR.k8sCreateCluster.roles,tenant_types:vR.k8sCreateCluster.tenant_types},{ml_project:c,kubernetes_access:u,role_name:a,tenant_type:o})),n.a.createElement(_R,uR({path:vR[m].url,component:Pw,roles:vR[m].roles,tenant_types:vR[m].tenant_types},{ml_project:c,kubernetes_access:u,role_name:a,tenant_type:o})),n.a.createElement(_R,uR({path:vR.k8sImportCluster.url,component:pC,roles:vR.k8sImportCluster.roles,tenant_types:vR.k8sImportCluster.tenant_types},{ml_project:c,kubernetes_access:u,role_name:a,tenant_type:o})),n.a.createElement(_R,uR({exact:!0,path:vR[h].url,component:oT,roles:vR[h].roles,tenant_types:vR[h].tenant_types},{ml_project:c,kubernetes_access:u,role_name:a,tenant_type:o})),n.a.createElement(_R,uR({exact:!0,path:vR.k8sClusterAdminUsers.url,component:gf,roles:vR.k8sClusterAdminUsers.roles,tenant_types:vR.k8sClusterAdminUsers.tenant_types},{ml_project:c,kubernetes_access:u,role_name:a,tenant_type:o})),n.a.createElement(_R,uR({exact:!0,path:vR.k8sTenantDashboard.url,component:sR,roles:vR.k8sTenantDashboard.roles,tenant_types:vR.k8sTenantDashboard.tenant_types},{ml_project:c,kubernetes_access:u,role_name:a,tenant_type:o})),n.a.createElement(_R,uR({exact:!0,path:vR.k8sApps.url,viewName:vR.k8sApps.viewName,component:RP,roles:vR.k8sApps.roles,tenant_types:vR.k8sApps.tenant_types},{ml_project:c,kubernetes_access:u,role_name:a,tenant_type:o})),n.a.createElement(_R,uR({path:vR.k8sLaunchApp.url,component:GP,roles:vR.k8sLaunchApp.roles,tenant_types:vR.k8sLaunchApp.tenant_types},{ml_project:c,kubernetes_access:u,role_name:a,tenant_type:o})),n.a.createElement(_R,uR({exact:!0,path:vR.managek8sDataTaps.url,component:Dv,roles:vR.managek8sDataTaps.roles,tenant_types:vR.managek8sDataTaps.tenant_types},{ml_project:c,kubernetes_access:u,role_name:a,tenant_type:o})),n.a.createElement(_R,uR({exact:!0,path:vR.managek8sFsMounts.url,component:Mv,roles:vR.managek8sFsMounts.roles,tenant_types:vR.managek8sFsMounts.tenant_types},{ml_project:c,kubernetes_access:u,role_name:a,tenant_type:o})),n.a.createElement(_R,uR({exact:!0,path:vR.assignK8sUser.url,component:Gk,roles:vR.assignK8sUser.roles,tenant_types:vR.assignK8sUser.tenant_types},{ml_project:c,kubernetes_access:u,role_name:a,tenant_type:o})),n.a.createElement(_R,uR({exact:!0,path:vR.k8sProjectRepo.url,component:eg,roles:vR.k8sProjectRepo.roles,tenant_types:vR.k8sProjectRepo.tenant_types},{ml_project:c,kubernetes_access:u,role_name:a,tenant_type:o})),n.a.createElement(_R,uR({exact:!0,path:vR.managek8sSourceControl.url,component:nA,roles:vR.managek8sSourceControl.roles,tenant_types:vR.managek8sSourceControl.tenant_types},{ml_project:c,kubernetes_access:u,role_name:a,tenant_type:o})),n.a.createElement(_R,uR({exact:!0,path:vR.k8sCreateEditSourceControl.url,component:_A,roles:vR.k8sCreateEditSourceControl.roles,tenant_types:vR.k8sCreateEditSourceControl.tenant_types},{ml_project:c,kubernetes_access:u,role_name:a,tenant_type:o})),n.a.createElement(_R,uR({exact:!0,path:vR.k8sModels.url,component:Ey,roles:vR.k8sModels.roles,tenant_types:vR.k8sModels.tenant_types},{ml_project:c,kubernetes_access:u,role_name:a,tenant_type:o})),n.a.createElement(_R,uR({exact:!0,path:vR.k8sTrainings.url,viewName:vR.k8sTrainings.viewName,component:RP,roles:vR.k8sTrainings.roles,tenant_types:vR.k8sTrainings.tenant_types},{ml_project:c,kubernetes_access:u,role_name:a,tenant_type:o})),n.a.createElement(_R,uR({exact:!0,path:vR.k8sDeployments.url,viewName:vR.k8sDeployments.viewName,component:RP,roles:vR.k8sDeployments.roles,tenant_types:vR.k8sDeployments.tenant_types},{ml_project:c,kubernetes_access:u,role_name:a,tenant_type:o})),n.a.createElement(_R,uR({exact:!0,path:vR.k8sNotebooks.url,viewName:vR.k8sNotebooks.viewName,component:RP,roles:vR.k8sNotebooks.roles,tenant_types:vR.k8sNotebooks.tenant_types},{ml_project:c,kubernetes_access:u,role_name:a,tenant_type:o})),n.a.createElement(_R,uR({path:vR.manageDataFabricClusters.url,component:PC,roles:vR.manageDataFabricClusters.roles,tenant_types:vR.manageDataFabricClusters.tenant_types},{ml_project:c,kubernetes_access:u,role_name:a,tenant_type:o})),n.a.createElement(_R,uR({path:vR.createDataFabricCluster.url,component:yD,roles:vR.createDataFabricCluster.roles,tenant_types:vR.createDataFabricCluster.tenant_types},{ml_project:c,kubernetes_access:u,role_name:a,tenant_type:o})),"Site Admin"===a?n.a.createElement(Cl.a,{to:vR.k8sDashboard.url}):u?n.a.createElement(Cl.a,{to:vR.k8sTenantDashboard.url}):n.a.createElement(Cl.a,{to:vR.dashboard.url})):n.a.createElement(ls,null))}}])&&dR(t.prototype,a),r&&dR(t,r),i}(r.Component);!function(e,t,a){t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a}(yR,"propTypes",{role_name:u.a.string,tenant_type:u.a.string,tenant_features:u.a.object});var gR=yR,_R=function(e){var t=e.component,a=e.viewName,r=e.role_name,o=e.roles,i=e.tenant_type,s=e.tenant_types,c=e.kubernetes_access,l=e.ml_project,u=cR(e,["component","viewName","role_name","roles","tenant_type","tenant_types","kubernetes_access","ml_project"]);return n.a.createElement(Tl.a,uR({},u,{render:function(e){return o.includes(r)&&("Site Admin"===r||s.includes(i)||l||c)?n.a.createElement(t,uR({},e,{role_name:r,kubernetes_access:c,ml_project:l,tenant_type:i,viewName:a})):"Site Admin"===r?n.a.createElement(Cl.a,{to:vR.k8sDashboard.url}):c?n.a.createElement(Cl.a,{to:vR.k8sTenantDashboard.url}):n.a.createElement(Cl.a,{to:vR.dashboard.url})}}))};_R.propTypes={component:u.a.func,viewName:u.a.string,role_name:u.a.string,roles:u.a.array,tenant_type:u.a.string,tenant_types:u.a.array,kubernetes_access:u.a.bool,ml_project:u.a.bool};var SR=w.settings.webapp.navbar.height,kR=function(){return{root:{display:"flex",fontFamily:Ls.a.typography.fontFamily,fontSize:Ls.a.typography.fontSize,fontWeight:Ls.a.typography.fontWeightRegular},appBar:{zIndex:Ls.a.zIndex.drawer+1,background:Ls.a.palette.white,borderBottom:"1px solid ".concat(Ls.a.palette.gray300)},hide:{display:"none"},content:{position:"relative",flexGrow:1,padding:3*Ls.a.spacing.unit,paddingTop:SR+32,paddingBottom:6*Ls.a.spacing.unit,borderLeft:"1px solid ".concat(Ls.a.palette.gray300),background:Ls.a.palette.white,display:"flex",flexFlow:"column",justifyContent:"space-between"},sessionTimeoutAlert:{padding:"0 1rem"},sessionTimeoutActionBtn:{display:"flex",width:"100%",justifyContent:"flex-end",padding:"1rem",marginTop:"1rem",borderTop:"1px solid #DBDBDB"}}},OR=a(256),ER=a(710),jR=a(711);function DR(e){return(DR="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function wR(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function CR(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?wR(Object(a),!0).forEach((function(t){xR(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):wR(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function TR(e,t){for(var a=0;a<t.length;a++){var r=t[a];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function PR(e,t){return(PR=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function AR(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=FR(e);if(t){var n=FR(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return RR(this,a)}}function RR(e,t){return!t||"object"!==DR(t)&&"function"!=typeof t?NR(e):t}function NR(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function FR(e){return(FR=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function xR(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}var MR={SM:{title:"Small",val:13},MD:{title:"Regular",val:15},LG:{title:"Large",val:18},XL:{title:"Extra Large",val:22}},IR="collapsed",UR="open",LR="full",BR="Failed to configure terminal",HR=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&PR(e,t)}(i,e);var t,a,r,o=AR(i);function i(e){var t,a;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),(t=o.call(this,e)).state={windowState:IR,currentWebterm:null,webtermStageTitle:"Fetching terminal information for the user",webtermStageState:"not-setup",deleteButton:!1,terminationOriginated:!1,validWebterm:!1,currentLockdownState:!1,webTermsFetched:!1,fontSize:(a=window.localStorage.getItem("webTermFont")||MR.MD.val,window.localStorage.setItem("webTermFont",a),parseInt(a,10))},t.CancelToken=T.a.CancelToken,t.source=null,t.timeout=null,t.connecttimeout=null,t.term=null,t.timer=null,t.resizeTimer=null,t.createWebterm=t.createWebterm.bind(NR(t)),t.terminateWebterm=t.terminateWebterm.bind(NR(t)),t.wsConnect=t.wsConnect.bind(NR(t)),t.onResize=t.onResize.bind(NR(t)),t.connectTerm=t.connectTerm.bind(NR(t)),t.fetchCurrentWebterm=t.fetchCurrentWebterm.bind(NR(t)),t.updateWindowState=t.updateWindowState.bind(NR(t)),t.getDimensions=t.getDimensions.bind(NR(t)),t.handleFontChange=t.handleFontChange.bind(NR(t)),t.terminateDialog=n.a.createRef(),t.invokeOnResizeEnd=function(){clearTimeout(t.resizeTimer),t.resizeTimer=setTimeout(t.onResize,500)},t}return t=i,(a=[{key:"componentDidMount",value:function(){this.fetchCurrentWebterm(),window.addEventListener("resize",this.invokeOnResizeEnd)}},{key:"componentDidUpdate",value:function(e){this.props.isSiteLocked!==f.a.fetchSafeFromObject({path:["isSiteLocked"],obj:e,default_value:!1})&&this.fetchCurrentWebterm()}},{key:"componentWillUnmount",value:function(){this.socket&&1===this.socket.readyState&&this.socket.close(),this.setState({terminationOriginated:!1}),clearTimeout(this.timeout),clearTimeout(this.connecttimeout),this.source.cancel("Component unmounted"),window.removeEventListener("resize",this.invokeOnResizeEnd)}},{key:"updateWindowState",value:function(e){var t=this;this.setState({windowState:e},(function(){setTimeout(t.onResize,100)}))}},{key:"onResize",value:function(){if(!this.term)return!1;var e=this.getDimensions(),t=e.cols,a=e.rows;for(this.term.resize(t,a);t.length<3;)t="0".concat(t);for(;a.length<3;)a="0".concat(a);this.socket&&1===this.socket.readyState&&this.socket.send("ESCAPED|-- RESIZE:".concat(t,";").concat(t))}},{key:"getDimensions",value:function(){var e=this.state,t=e.windowState,a=e.fontSize;if(!this.term||t===IR)return{rows:"24",cols:"80"};var r=function(e){switch(e){case MR.SM.val:return{w:7.775,h:16.125};case MR.MD.val:return{w:8.886,h:17.207};case MR.LG.val:return{w:10.55,h:20};case MR.XL.val:return{w:12.776,h:26.13};default:return{w:8,h:16}}}(a),n=r.w,o=r.h,i=document.querySelector("#web-term").offsetHeight-10,s=document.querySelector("#web-term").offsetWidth-25,c=Math.floor(s/n);return{rows:Math.floor(i/o).toString(),cols:c.toString()}}},{key:"handleFontChange",value:function(e){var t=this;window.localStorage.setItem("webTermFont",e),this.setState({fontSize:e},(function(){t.term.setOption("fontSize",e),t.onResize()}))}},{key:"fetchCurrentWebterm",value:function(){var e=this;this.source=this.CancelToken.source();var t=this,a=this.props,r=a.dispatch,o=a.user;if(a.isSiteLocked)return clearTimeout(this.connecttimeout),this.setState({webtermStageTitle:"Access to terminal is restricted. Site lockdown is in effect.",webtermStageState:"access_restricted",validWebterm:!1,deleteButton:!1}),!1;r(Q(CR(CR({},oe.CURRENT_WEBTERM(o)),{},{cancelToken:this.source.token}))).then((function(){var e=t.state.terminationOriginated,a=t.props.webterm;if(f.a.isEmptyObject(a)){var r=e?"Terminal is terminated":"Terminal not initialized for the user";t.setState({webtermStageTitle:r,webtermStageState:"not-setup",deleteButton:!1,webTermsFetched:!0,terminationOriginated:!1})}else{var n=f.a.fetchSafeFromObject({path:["_embedded","status"],obj:a,default_value:""});t.setState({currentWebterm:a,webTermsFetched:!0},(function(){switch(n){case"creating":case"updating":t.setState({webtermStageTitle:"Waiting for terminal to be ready",webtermStageState:"configuring",deleteButton:!0}),clearTimeout(t.timeout),t.timeout=setTimeout(t.fetchCurrentWebterm,5e3);break;case"running":t.setState({validWebterm:!0,webtermStageTitle:"Connecting to the terminal",deleteButton:!0},(function(){t.connectTerm()}));break;case"deleting":t.setState({webtermStageTitle:"Terminating the terminal",terminationOriginated:!1}),clearTimeout(t.timeout),t.timeout=setTimeout(t.fetchCurrentWebterm,5e3);break;case"error":t.setState({webtermStageTitle:BR,webtermStageState:"error",deleteButton:!0})}}))}})).catch((function(t){var a=["Failed to fetch terminal information for the user",f.a.parseAxiosError({error:t})];_n({msg:n.a.createElement(ns,{errors:a}),variant:"error"}),e.setState({webtermStageTitle:BR,webtermStageState:"error",deleteButton:!1,webTermsFetched:!0})}))}},{key:"createWebterm",value:function(){var e=this;this.source=this.CancelToken.source();var t=this;R({method:w.method.POST,apiurl:w.apiurl.WEBTERMS,cancelToken:this.source.token}).then((function(){t.setState({webtermStageTitle:"Configuring terminal for the user",webtermStageState:"configuring",deleteButton:!1},(function(){t.timeout=setTimeout(t.fetchCurrentWebterm,5e3)}))})).catch((function(t){var a=["Failed to create terminal for the user",f.a.parseAxiosError({error:t})];_n({msg:n.a.createElement(ns,{errors:a}),variant:"error"}),e.setState({webtermStageTitle:BR,webtermStageState:"error",deleteButton:!1})}))}},{key:"terminateWebterm",value:function(){var e=this,t=this.state.currentWebterm,a=f.a.fetchSafeFromObject({path:["_links","self","href"],obj:t,default_value:""});this.setState({terminationOriginated:!0},(function(){R({apiurl:a,method:w.method.DELETE}).then((function(){e.setState({webtermStageTitle:"Terminating the terminal",webtermStageState:"unconfiguring",validWebterm:!1,deleteButton:!1},(function(){e.timeout=setTimeout(e.fetchCurrentWebterm,5e3)}))})).catch((function(){_n({msg:"Failed to terminate terminal",variant:"error"}),e.setState({webtermStageTitle:BR,webtermStageState:"error",deleteButton:!0})}))}))}},{key:"connectTerm",value:function(){OR.Terminal.applyAddon(ER),OR.Terminal.applyAddon(jR),this.term=new OR.Terminal({cursorBlink:!0,fontSize:this.state.fontSize}),this.term.open(document.getElementById("web-term")),this.term.focus(),this.wsConnect(),this.onResize()}},{key:"tryAgain",value:function(){clearTimeout(this.connecttimeout),this.connecttimeout=setTimeout(this.wsConnect,15e3)}},{key:"wsConnect",value:function(){var e=this,t=this,a=this.state,r=a.currentWebterm;if(a.validWebterm){var n=f.a.fetchSafeFromObject({path:["_embedded","service_endpoint"],obj:r,default_value:""}),o=f.a.fetchSafeFromObject({path:["_embedded","webterm_uiauth_token"],obj:r,default_value:""}),i="".concat("https:"===window.location.protocol?"wss":"ws","://").concat(n,"/?token=").concat(o),s=n.includes(":")?n.split(":")[0]:n;R({op:w.op.DNS_LOOKUP,data:{hostname:s}}).then((function(a){if(a.data.dns_lookup)try{e.socket=new WebSocket(i),e.socket.onopen=function(){t.setState({validWebterm:!0,webtermStageTitle:"Connected to terminal",webtermStageState:"ready",deleteButton:!0}),e.term.attach(e.socket),e.socket.send("\n")},e.socket.onclose=function(){e.term.writeln("Server closed")},e.socket.onerror=function(){e.term.writeln("Server connection error"),t.setState({validWebterm:!0,webtermStageTitle:"Connecting to the terminal",webtermStageState:"configuring",deleteButton:!0}),e.tryAgain()}}catch(r){e.term.writeln("Server connection error. trying again"),e.tryAgain()}else e.terminateWebterm(),_n({msg:"Terminal hostname could not be reached.",variant:"error"})}))}}},{key:"render",value:function(){var e=this,t=this.props.classes,a=this.state,r=a.webtermStageTitle,o=a.webtermStageState,i=a.validWebterm,s=a.deleteButton,c=a.windowState,l=a.webTermsFetched,u=a.fontSize;return n.a.createElement("div",{id:"_webtermWindow",className:t.webtermWindow},n.a.createElement("div",{className:se()(t.webtermStatus)},n.a.createElement(Ue.a,{variant:"outlined",color:"secondary",size:"small",onClick:function(){return e.updateWindowState(c===IR?UR:IR)},disabled:!i,className:t.iconBtn},n.a.createElement("span",{className:se()("icon",xR({"icon-plus":c===IR,"icon-minus":c!==IR},t.disabled,!i))})),l&&"not-setup"===o?n.a.createElement(n.a.Fragment,null,n.a.createElement(Qa,{title:r,status:"disabled",size:"small"}),n.a.createElement(Ue.a,{variant:"contained",color:"primary",onClick:this.createWebterm},"Initialize")):n.a.createElement(Qa,{title:r,status:o,size:"small"}),s&&n.a.createElement(Ue.a,{variant:"contained",color:"secondary",onClick:function(){var t={callback:e.terminateWebterm,title:"Terminate the terminal.",description:"Confirm Termination. This action cannot be undone"};e.terminateDialog.current.handleOpen(t)}},"Terminate"),i&&n.a.createElement("div",{className:t.secondaryActions},c!==IR&&n.a.createElement(n.a.Fragment,null,"Aa",n.a.createElement(nc,{value:u,onChange:this.handleFontChange,name:"fontSize",className:t.fontSelect,items:Object.values(MR)})),n.a.createElement(Ue.a,{variant:"outlined",color:"secondary",size:"small",onClick:function(){return e.updateWindowState(c!==LR?LR:IR)},className:t.iconBtn},n.a.createElement("span",{className:se()("icon",xR({"icon-expand":c!==LR,"icon-contract":c===LR},t.disabled,!i))})))),i?n.a.createElement("div",{id:"web-term",className:se()(t.webterm,xR({},t.hidden,c===IR),xR({},t.webtermOpen,c===UR),xR({},t.webtermFull,c===LR))}):"",n.a.createElement(no,{ref:this.terminateDialog}))}}])&&TR(t.prototype,a),r&&TR(t,r),i}(n.a.Component);xR(HR,"propTypes",{classes:u.a.object.isRequired,dispatch:u.a.func.isRequired,user:u.a.string,webterm:u.a.object,location:u.a.object,isSiteLocked:u.a.bool});var KR=he()((function(e){var t;return{webtermWindow:(t={height:"auto",transition:"height .2s linear",position:"fixed",left:w.settings.webapp.sidebar.expanded.width,bottom:0,width:"calc(100% - ".concat(w.settings.webapp.sidebar.expanded.width,"px)"),zIndex:120},xR(t,e.breakpoints.down("sm"),{width:"calc(100% - ".concat(w.settings.webapp.sidebar.collapsed.width,"px)"),left:w.settings.webapp.sidebar.collapsed.width}),xR(t,"borderBottom","2px solid ".concat(e.palette.white)),xR(t,"borderRight","2px solid ".concat(e.palette.white)),t),webterm:{background:"rgb(0,0,0)"},webtermOpen:{height:"50vh"},webtermFull:{height:"calc(100vh - 120px)"},webtermStatus:{display:"flex",justifyContent:"flex-start",padding:"".concat(e.spacing.unit,"px ").concat(3*e.spacing.unit,"px"),background:e.palette.gray200,alignItems:"center","& > *":{marginRight:2*e.spacing.unit}},hidden:{display:"none"},disabled:{color:e.palette.gray500},iconBtn:{width:3*e.spacing.unit,height:3*e.spacing.unit},secondaryActions:{marginLeft:"auto",marginRight:0,display:"flex",alignItems:"center"},fontSelect:{margin:"0 ".concat(e.spacing.unit,"px 0 ").concat(.5*e.spacing.unit,"px"),width:120}}}))(HR);function qR(e){return(qR="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function VR(){return(VR=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var r in a)Object.prototype.hasOwnProperty.call(a,r)&&(e[r]=a[r])}return e}).apply(this,arguments)}function GR(e,t){for(var a=0;a<t.length;a++){var r=t[a];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function zR(e,t){return(zR=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function WR(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=$R(e);if(t){var n=$R(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return JR(this,a)}}function JR(e,t){return!t||"object"!==qR(t)&&"function"!=typeof t?YR(e):t}function YR(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function $R(e){return($R=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function QR(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}var ZR=w.views,XR=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&zR(e,t)}(i,e);var t,a,r,o=WR(i);function i(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),QR(YR(t=o.call(this,e)),"timeRemainingInterval",null),QR(YR(t),"idleTimeout",null),t.checkIdleTimeOut=t.checkIdleTimeOut.bind(YR(t)),t.getDurationForIdleTimeOut=t.getDurationForIdleTimeOut.bind(YR(t)),t.timeRemainingCounter=t.timeRemainingCounter.bind(YR(t)),t.resetLastActivity=t.resetLastActivity.bind(YR(t)),t.invokeTimeoutWarningModal=t.invokeTimeoutWarningModal.bind(YR(t)),t.onModalClose=t.onModalClose.bind(YR(t)),t.invokeEventListners=t.invokeEventListners.bind(YR(t)),t.bindHandleClose=t.bindHandleClose.bind(YR(t)),t.resetStore=t.resetStore.bind(YR(t)),t.bdModalIdleTimeWarningChildRef=n.a.createRef(),t.state={showSessionWarningModal:3e4,timeoutInterval:6e4,modalShown:!1,sessionWarningModalData:{},counter:""},t}return t=i,(a=[{key:"componentDidMount",value:function(){(0,this.props.dispatch)((function(e){return e(x(I(U),I(L),I(B),I(H),I(K),I(q),I(V),I(G)))})),this.resetLastActivity(!0)}},{key:"componentWillUnmount",value:function(){clearTimeout(this.idleTimeout),clearTimeout(this.timeRemainingInterval)}},{key:"resetStore",value:function(){var e=this.props.dispatch;e({type:"RESET_STATS_DATA"}),e({type:"RESET_PAGE_DATA"})}},{key:"bindHandleClose",value:function(){return this.bdModalIdleTimeWarningChildRef.current.handleClose()}},{key:"invokeTimeoutWarningModal",value:function(){var e=this,t={Title:n.a.createElement(St.Typography,{variant:"h2"},"Session Timeout Warning"),name:"Idle timeout warning modal",description:"Modal to display idle timeout warning"};this.setState({sessionWarningModalData:t},(function(){e.bdModalIdleTimeWarningChildRef.current.handleOpen()}))}},{key:"invokeEventListners",value:function(){document.addEventListener("click",this.resetLastActivity,!1),document.addEventListener("keyup",this.resetLastActivity,!1),document.addEventListener("touchend",this.resetLastActivity,!1)}},{key:"onModalClose",value:function(){this.setState({modalShown:!1}),this.resetLastActivity()}},{key:"getDurationForIdleTimeOut",value:function(){var e=(new Date).getTime(),t=localStorage.getItem("lastActivity")||e;return 18e5-((new Date).getTime()-t)}},{key:"resetLastActivity",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=this,a=this.props.role_name;if(a){if("Site Admin"!==a){var r=this.state.modalShown;if(r)return;clearTimeout(this.timeRemainingInterval);var n=(new Date).getTime();localStorage.setItem("lastActivity",n),this.checkIdleTimeOut(),e&&this.invokeEventListners()}}else setTimeout((function(){t.resetLastActivity(e)}),100)}},{key:"timeRemainingCounter",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:30;this.setState({counter:e});var t=this.state.showSessionWarningModal,a=this.getDurationForIdleTimeOut();clearTimeout(this.timeRemainingInterval);var r=this;a>t?this.resetLastActivity():this.timeRemainingInterval=setTimeout((function(){e<1?window.location.href=ZR.logout.url:r.timeRemainingCounter(e?e-1:0)}),1e3)}},{key:"checkIdleTimeOut",value:function(){clearTimeout(this.idleTimeout);var e=this.state.showSessionWarningModal,t=this.getDurationForIdleTimeOut();if(t<e)this.setState({modalShown:!0}),this.timeRemainingCounter(Math.floor(t/1e3)),this.invokeTimeoutWarningModal();else{var a=this.state.timeoutInterval;t<6e4&&(a=5e3),this.idleTimeout=setTimeout(this.checkIdleTimeOut,a)}}},{key:"render",value:function(){var e=fe()(Ls.a),t=this.props,a=t.stats_data,r=t.classes,o=t.location,i=t.dispatch,s=t.webterm,c=t.isSiteLocked,l=t.user,u=a.session_data,p=(u=void 0===u?{}:u).role_name,d=void 0===p?"":p,f=u.tenant,m=void 0===f?"":f,h=u.current_tenant_data,b=(h=void 0===h?{}:h).features,v=void 0===b?{}:b,y=h.tenant_type,g=void 0===y?"":y,_=a.g_config_data,S=(_=void 0===_?{}:_).support_exthosts,k=void 0===S||S,O=a.g_stats,E=(O=void 0===O?{}:O).objects,j=void 0===E?{}:E,D=this.state,w=D.sessionWarningModalData,C=D.counter,T="Your session is about to expire due to prolonged inactivity. Please click button below to stay signed in or you'll be redirected to the login page. Time remaining: ".concat(C," s"),P=v.kubernetes_access,A=void 0!==P&&P,R=v.ml_project,N=void 0!==R&&R,F=n.a.createElement("div",{className:r.sessionTimeoutAlert},n.a.createElement(St.Typography,{variant:"caption"},T));return n.a.createElement(pe.a,{theme:e},n.a.createElement(le.a,null),n.a.createElement("div",{className:se()("app-frame",r.root)},n.a.createElement(ve.a,{className:r.appBar,position:"absolute"},n.a.createElement(Dl,VR({},a,{location:o,dispatch:i,resetStore:this.resetStore}))),n.a.createElement(uc,{kubernetes_access:A,ml_project:N,role_name:d,tenant_type:g,statsNumbers:j,tenant:m,support_exthosts:k,location:o}),n.a.createElement("main",{className:se()("main-content",r.content)},n.a.createElement(gR,{role_name:d,tenant_type:g,tenant_features:v}),A&&["Admin","Member","K8S Admin"].includes(d)?n.a.createElement(KR,{dispatch:i,user:l,webterm:s,location:o,isSiteLocked:c}):"",n.a.createElement(In,VR({},w,{ref:this.bdModalIdleTimeWarningChildRef,onModalClose:this.onModalClose}),F,n.a.createElement("div",{className:r.sessionTimeoutActionBtn},n.a.createElement(Ue.a,{variant:"contained",color:"primary",onClick:this.bindHandleClose},"Keep session alive")))),n.a.createElement(ua,null)))}}])&&GR(t.prototype,a),r&&GR(t,r),i}(r.Component);QR(XR,"propTypes",{classes:u.a.object.isRequired,dispatch:u.a.func.isRequired,stats_data:u.a.object,webterm:u.a.object,location:u.a.object,isSiteLocked:u.a.bool,user:u.a.string,role_name:u.a.string});var eN=Object(c.a)(d()(he()(kR,{name:"App"}),Object(s.b)((function(e){var t=e.stats_data,a=void 0===t?{}:t,r=e.page_data,n=void 0===r?{}:r,o=a.session_data,i=(o=void 0===o?{}:o).user,s=void 0===i?"":i,c=o.tenant,l=void 0===c?"":c,u=o.role_name,p=void 0===u?"":u,d=a.lock_data,m=(d=void 0===d?{}:d).locked,h=void 0!==m&&m,b=w.apiurl.TENANT+l.split("/").pop();return{stats_data:a,webterm:f.a.fetchSafeFromObject({path:["current_webterm","_embedded","webterms"],obj:n,default_value:[]}).find((function(e){var t=e._links;return t.user.href===s&&t.tenant.href===b}))||{},isSiteLocked:h,user:s,role_name:p}})))(XR)),tN=a(111),aN=a(713);a(1457);function rN(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function nN(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?rN(Object(a),!0).forEach((function(t){oN(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):rN(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function oN(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function iN(e){return function(e){if(Array.isArray(e))return sN(e)}(e)||function(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||function(e,t){if(!e)return;if("string"==typeof e)return sN(e,t);var a=Object.prototype.toString.call(e).slice(8,-1);"Object"===a&&e.constructor&&(a=e.constructor.name);if("Map"===a||"Set"===a)return Array.from(e);if("Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a))return sN(e,t)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function sN(e,t){(null==t||t>e.length)&&(t=e.length);for(var a=0,r=new Array(t);a<t;a++)r[a]=e[a];return r}function cN(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function lN(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?cN(Object(a),!0).forEach((function(t){uN(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):cN(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function uN(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}var pN=Object(tN.c)({stats_data:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0,a=t.type,r=t.propVal,n=t.payload,o=a.split(":")[0];switch(o){case"RECEIVE_STATS_DATA":return f.a.isEqual(n,e[r])?e:nN(nN({},e),{},oN({},r,n));case"REQUEST_STATS_DATA":return e[r]||{};case"DELETE_STATS_DATA":return delete e[r],e;case"RESET_STATS_DATA":return{};default:return e}},page_data:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0,a=t.type,r=t.propVal,n=t.payload,o=t.updateProps,i=void 0===o?{}:o,s=a.split(":")[0];switch(s){case"RECEIVE_PAGE_DATA":var c=i.pathToID,l=void 0===c?[]:c,u=i.pathToItems,p=void 0===u?[]:u,d=i.composite,m=void 0!==d&&d,h=i.reset,b=void 0===h||h,v=i.collecterKey,y=void 0===v?"":v;if(m){var g;if(b||!e[r]){var _=y&&e[r]?f.a.deepClone(e[r]):{};g=y?lN(lN({},_),{},uN({},y,n)):n}else{var S,k;if(g=f.a.deepClone(e[r]),y)g[y]||(g[y]=[]),(S=g[y]).push.apply(S,iN(n));else(k=g).push.apply(k,iN(n))}return lN(lN({},e),{},uN({},r,g))}if((l.length||p.length)&&e[r]){var O=f.a.fetchSafeFromObject({path:p,obj:n,default_value:[]});if(O.length){var E=f.a.deepClone(e[r]),j=f.a.fetchSafeFromObject({path:p,obj:E,default_value:[]});O.forEach((function(e,t){var a=f.a.fetchSafeFromObject({path:l,obj:e,default_value:{}}),r={};j.some((function(e,t){if(a===f.a.fetchSafeFromObject({path:l,obj:e,default_value:{}}))return r=f.a.deepClone(e),j.splice(t,1),!0})),O[t]=lN(lN({},r),e)}))}}return lN(lN({},e),{},uN({},r,n));case"UPDATE_PAGE_DATA_ITEM":var D,w=i.pathToID,C=void 0===w?[]:w,T=i.pathToItems,P=void 0===T?[]:T,A=i.update,R=void 0===A?[]:A,N=i.id,F=f.a.fetchSafeFromObject({path:[r].concat(iN(P)),obj:e,default_value:[]});if(F.length)F.some((function(e,t){if(N===f.a.fetchSafeFromObject({path:C,obj:e})){var a=iN(R);if(a.length){var r=e,o=a.pop();a.length&&(r=f.a.fetchSafeFromObject({path:a,obj:e})),r&&o&&(r[o]=n)}return D=t,!0}})),R.length||"number"!==f.a.guessType(D)||(F[D]=n);return e;case"DELETE_PAGE_DATA_ITEM":var x=i.pathToID,M=void 0===x?[]:x,I=i.pathToItems,U=void 0===I?[]:I,L=i.id,B=f.a.fetchSafeFromObject({path:[r].concat(iN(U)),obj:e,default_value:[]});if(B.length){var H=B.findIndex((function(e){return L===f.a.fetchSafeFromObject({path:M,obj:e})}));B.splice(H,1)}return e;case"REQUEST_PAGE_DATA":return e[r]||{};case"DELETE_PAGE_DATA":return delete e[r],e;case"RESET_PAGE_DATA":return{};default:return e}}}),dN=window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__||tN.d,fN=[F,aN.a];var mN=window.__PRELOADED_STATE__||{},hN=Object(tN.e)(pN,mN,dN(tN.a.apply(void 0,fN)));Object(o.render)(n.a.createElement(s.a,{store:hN},n.a.createElement(i.a,null,n.a.createElement(eN,null))),document.getElementById("bdsApp"))},2:function(e,t,a){"use strict";var r=a(700),n=a.n(r),o=a(701),i=a.n(o);function s(e){return function(e){if(Array.isArray(e))return c(e)}(e)||function(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||function(e,t){if(!e)return;if("string"==typeof e)return c(e,t);var a=Object.prototype.toString.call(e).slice(8,-1);"Object"===a&&e.constructor&&(a=e.constructor.name);if("Map"===a||"Set"===a)return Array.from(e);if("Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a))return c(e,t)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function c(e,t){(null==t||t>e.length)&&(t=e.length);for(var a=0,r=new Array(t);a<t;a++)r[a]=e[a];return r}function l(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function u(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?l(Object(a),!0).forEach((function(t){p(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):l(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function p(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function d(e){return(d="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var f=function(e){var t=e.path,a=void 0===t?[]:t,r=e.obj,n=void 0===r?{}:r,o=e.default_value,i=a.reduce((function(e,t){return e&&void 0!==e[t]?e[t]:null}),n);return null==i&&"undefined"!==o&&(i=o),i},m=function(e){return Array.isArray(e)?"array":"string"==typeof e?"string":null===e?"null":"boolean"==typeof e?"boolean":Number(e)===e?"number":"object"===d(e)?"object":"string"},h=function(e){0},b=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";if(!e||"string"!=typeof e)return null;try{return JSON.parse(e)}catch(t){return null}},v=function(e,t,a,r){var n=a?b(e.data[t]):e.data[t];return r.length&&"object"===m(n)?f({path:r,obj:n,default_value:""}):n},y=function e(t){var a=Array.isArray(t)?[]:{};for(var r in t)null!==t[r]&&"object"===d(t[r])?a[r]=e(t[r]):a[r]=t[r];return a},g=function(e){var t=e.path,a=void 0===t?[]:t,r=e.value,n=e.reset,o=void 0!==n&&n,i=e.schema;a.reduce((function(e,t,n){if(!e)return e;if(n===a.length-1){switch(m(e[t])){case"array":o?e[t]=[]:e[t].push(r);break;default:e[t]=r}return e}return e[t]}),i)},_={fetchSafeFromObjectArray:function(e){var t,a=e.arr,r=void 0===a?[]:a,n=e.path,o=void 0===n?[]:n,i=e.match,s=void 0===i?"":i,c=e.get,l=void 0===c?[]:c,u=e.default_value;return r.length&&o.length&&s?(r.some((function(e){if(f({path:o,obj:e})===s)return t=l.length?f({path:l,obj:e}):e,!0})),null==t&&"undefined"!==u&&(t=u),t):u},fetchSafeFromObject:f,isEmptyObject:function(e){return 0===Object.keys(e).length},getColorList:function(e,t){var a=[],r=["#2AD2C9","#614767","#FF8D6D","#FFCA58","#425563","#5F7A76","#80746E","#767676"];if("mono"===e)return["#7D7D7D","#ACACAC","#C1C1C1","#D8D8D8","#ECECEC","#F2F2F2"];if(t)for(var n=0,o=.8/Math.floor(e),i=0;i<e;i++){var s=S(n,t);a.push(s),n+=o}else if(e<9)for(var c=0;c<e;c++)a.push(r[c]);else!function(){for(var t=0,n=0,o=.8/Math.floor(e/6);t<e;)r.map((function(e){var r=S(n,e);a.push(r),t++})),n+=o}();return a},emptyNode:function(e){for(;e.firstChild;)e.removeChild(e.firstChild)},isEqual:function e(t,a){var r=Object.prototype.toString.call(t);if(r!==Object.prototype.toString.call(a))return!1;if(!["[object Array]","[object Object]"].includes(r))return t===a;var n="[object Array]"===r?t.length:Object.keys(t).length;if(n!==("[object Array]"===r?a.length:Object.keys(a).length))return!1;var o=function(t,a){var r=Object.prototype.toString.call(t);if(["[object Array]","[object Object]"].includes(r)){if(!e(t,a))return!1}else{if(r!==Object.prototype.toString.call(a))return!1;if("[object Function]"===r){if(t.toString()!==a.toString())return!1}else if(t!==a)return!1}};if("[object Array]"===r){for(var i=0;i<n;i++)if(!1===o(t[i],a[i]))return!1}else for(var s in t)if(t.hasOwnProperty(s)&&!1===o(t[s],a[s]))return!1;return!0},bdsSanitize:function(e,t){var a=e,r="encode"===t?0:1,n="encode"===t?1:0;return[["&","&amp;"],["'","&#39;"],['"',"&quot;"],[">","&gt;"],["<","&lt;"]].map((function(t){var o=new RegExp(t[r],"g");a=e.replace(o,t[n])})),a},getSearchParams:function(e){var t=e.location,a={},r=t.search,n=void 0===r?"":r;return n.length&&n.substring(1).split("&").map((function(e){var t=e.split("=");a[t[0]]=t[1]})),a},parseAxiosError:function(e){var t=e.error;try{var a=t,r=JSON.parse(JSON.stringify(a));if(r.response){var n=r.response,o=n.data,i=n.status,s="Got an error while performing the operation";switch(i){case 304:s="Not Modified.";break;case 401:s="Unauthorized access. Check your credentials and try again.";break;case 403:s="Forbidden request.";break;case 404:s="Requested resource is not found.";break;case 405:s="Requested resource is not allowed.";break;case 408:s="You will be redirected to login screen.";break;case 409:s="The request could not be completed due to a conflict."}return"".concat(s,"\nAdditional details: ").concat(o)}return r.request?"Request Error: ".concat(JSON.stringify(r.request)):r.message?r.message:a.message?a.message:a}catch(c){return t}},isHttpStatusOk:function(e){return e>=200&&e<=207},capitalize:function(e){return e.charAt(0).toUpperCase()+e.slice(1)},guessType:m,convertToHHMMSS:function(e){var t=parseInt(e,10),a=Math.floor(t/3600),r=Math.floor((t-3600*a)/60),n=t-3600*a-60*r;return"".concat(a?"".concat(a<10?0:"").concat(a,":"):"").concat(r?"".concat(r<10?0:"").concat(r):"00",":").concat(n<10?0:"").concat(n)},convert2gb:function(e,t){return t&&e%1024?(e/1024).toFixed(t):Math.round(e/1024)},copyToClipboard:function(e){if(e&&void 0!==e){var t=document.createElement("textarea");return t.innerText=e,document.body.appendChild(t),t.select(),document.execCommand("copy"),t.remove(),!0}return!1},bdLog:h,bdSort:function(e,t){var a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"asc";if(!Array.isArray(e))return h(),[];if(!e.length)return[];var r=y(e),n=r.sort((function(e,r){var n=t?f({path:t,obj:e,default_value:""}):e,o=t?f({path:t,obj:r,default_value:""}):r,i=n.toLowerCase(),s=o.toLowerCase();return i<s?"asc"===a?-1:1:i>s?"asc"===a?1:-1:0}));return n},cleanString:function(e){return e.replace(/[^A-Z0-9]+/gi,"_")},yaml2json:function(e){try{return n.a.safeLoad(e)}catch(t){return u(u({},t),{},{_y2j_status:"error"})}},bdJson2Yaml:function(e){var t="",a={undefined:function(){return"null"},null:function(){return"null"},number:function(e){return e},boolean:function(e){return e?"true":"false"},string:function(e){var a;return e.length<=60&&-1===e.indexOf("\n")?JSON.stringify(e):(t=t.replace(/$/,"  "),a=i()(e,{indent:t,trim:!0,width:60}),t=t.replace(/ {2}/,""),a)},array:function(e){var r=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],o="";return 0===e.length?o+="[]":(t=r?t.replace(/$/,"  "):t,e.forEach((function(e){var r=a[m(e)];r&&(o+=n?"\n".concat(t,"#- ").concat(r(e)):"\n".concat(t,"- ").concat(r(e)))})),t=r?t.replace(/ {2}/,""):t,o)},object:function(e){var r=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n="";return 0===Object.keys(e).length?n+="{}":(t=r?t.replace(/$/,"  "):t,Object.keys(e).forEach((function(r){var o=e[r],i=a[m(o)];if(void 0!==o&&i)if(r.startsWith("___")){var s=r.split("___").pop();n+="\n".concat(t,"#").concat(s,": ").concat(i(o,!0,!0))}else n+="__comment"===r?"\n".concat(t,"#").concat(i(o)):"\n".concat(t).concat(r,": ").concat(i(o))})),t=r?t.replace(/ {2}/,""):t,n)}};return"---"+a[m(e)](e,!1)+"\n"},orderBy:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0;if(!Array.isArray(e)&&!e.length)return t;var a="object"===d(t)&&t instanceof Object&&!(t instanceof Array),r=Array.isArray(t),n={},o={object:function(){return e.forEach((function(e){t[e]&&(n[e]=t[e])})),Object.assign(n,t)},array:function(){return t.reduce((function(t,a){if(e.includes(a)){var r=t.filter((function(e){return e!==a}));return[a].concat(s(r))}return t}),t)}};return r?o.array():a?o.object():t},encodeSpecialCharacters:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";if(!e||"string"!=typeof e)return e;var t={specialCharacters:/[;,?:@&=+$# ]/g,listSpecialCharacters:function(e){return e.match(this.specialCharacters)||[]},listUniqueSpecialCharacters:function(e){return s(new Set(e))},encodeString:function(e,t){var a=e.slice();return t.forEach((function(e){var t=encodeURIComponent(e);a=a.split(e).join(t)})),a}},a=t.listSpecialCharacters(e),r=t.listUniqueSpecialCharacters(a),n=t.encodeString(e,r);return n},buildQueryParamsString:function(e){var t=e.baseUrl,a=e.params,r=!t||"string"!=typeof t,n=!a||"object"!==d(a);if(r||n)return"";var o=Object.keys(a).reduce((function(e,t){return a[t]?[].concat(s(e),["".concat(encodeURIComponent(t),"=").concat(encodeURIComponent(a[t]))]):e}),[]).join("&");return"".concat(t,"?").concat(o)},safeJsonParse:b,sortTableColumn:function(e){var t=e.data,a=e.colIndex,r=e.order,n=e.parse,o=void 0!==n&&n,i=e.sortBy,s=void 0===i?[]:i;return t.sort((function(e,t){return(v(e,a,o,s)<v(t,a,o,s)?-1:1)*("asc"===r?1:-1)}))},redirectTo:function(e){var t=e.context,a=void 0===t?"undefined":t,r=e.location,n=void 0===r?"":r;"undefined"!==a&&a.hasOwnProperty("history")&&n&&"string"==typeof n&&a.history.push(n)},uniqueKey:function(e){return"".concat(e,"_").concat((new Date).getTime())},deepClone:y,setObjectProperty:g,getClientOS:function(){return-1!==navigator.platform.indexOf("Win")?"Windows":-1!==navigator.platform.indexOf("Mac")?"MacOS":-1!==navigator.platform.indexOf("Linux")?"Linux":"Unknown OS"},convertValidDnsName:function(e){var t=e.toLowerCase().replace(/[^a-zA-Z0-9-]+/g,"-");return(t=(t=t.replace(/-{2,}/g,"-")).replace(/(^-+)|(-+$)/g,"")).length>63&&(t=t.substring(0,32)),t},roundNumber:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;return Number(e)===e?e%1==0?e:Number(Number.parseFloat(e).toFixed(t)):NaN},isOddNumber:function(e){return e%2==1},cloneWithDataReset:function(e,t){var a=y(e);t.length&&("object"===m(a)?Object.values(a):a).map((function(e){t.map((function(t){var a=t.resourcePath,r=t.resetValue;g({path:a,value:r,schema:e})}))}));return a},downloadOrSaveData:function(e,t,a){if(window.navigator.msSaveOrOpenBlob){var r=new Blob([e],{type:"".concat(a,";charset=utf-8")});window.navigator.msSaveOrOpenBlob(r,t)}else{var n="data:".concat(a,";charset=utf-8,").concat(escape(e)),o=document.createElement("a");o.href=n,o.style="visibility:hidden",o.download=t,document.body.appendChild(o),o.click(),document.body.removeChild(o)}}};t.a=_;var S=function(e,t,a){if("number"!=typeof e||e<-1||e>1||"string"!=typeof t||"r"!==t[0]&&"#"!==t[0]||"string"!=typeof a&&void 0!==a)return null;var r=function(e){var t=e,a=t.length,r=new Object;if(a>9){if((t=t.split(",")).length<3||t.length>4)return null;r[0]=n(t[0].slice(4)),r[1]=n(t[1]),r[2]=n(t[2]),r[3]=t[3]?parseFloat(t[3]):-1}else{if(8===a||6===a||a<4)return null;a<6&&(t="#"+t[1]+t[1]+t[2]+t[2]+t[3]+t[3]+(a>4?t[4]+""+t[4]:"")),t=n(t.slice(1),16),r[0]=t>>16&255,r[1]=t>>8&255,r[2]=255&t,r[3]=9===a||5===a?o((t>>24&255)/255*1e4)/1e4:-1}return r},n=parseInt,o=Math.round,i=t.length>9;i="string"==typeof a?a.length>9||"c"===a&&!i:i;var s=e<0,c=s?-1*e:e,l=a&&"c"!==a?a:s?"#000000":"#FFFFFF",u=r(t),p=r(l);return u&&p?i?"rgb("+o((p[0]-u[0])*c+u[0])+","+o((p[1]-u[1])*c+u[1])+","+o((p[2]-u[2])*c+u[2])+(u[3]<0&&p[3]<0?")":","+(u[3]>-1&&p[3]>-1?o(1e4*((p[3]-u[3])*c+u[3]))/1e4:p[3]<0?u[3]:p[3])+")"):"#"+(4294967296+16777216*(u[3]>-1&&p[3]>-1?o(255*((p[3]-u[3])*c+u[3])):p[3]>-1?o(255*p[3]):u[3]>-1?o(255*u[3]):255)+65536*o((p[0]-u[0])*c+u[0])+256*o((p[1]-u[1])*c+u[1])+o((p[2]-u[2])*c+u[2])).toString(16).slice(u[3]>-1||p[3]>-1?1:3):null}},30:function(e,t,a){"use strict";var r=a(34);t.a=function(e){var t=e||r.a;return{root:{width:"100%",maxWidth:t.spacing.formWidth,"& .control-group-block":{display:"flex","& .input-group,":{width:"auto",flexGrow:1},"& .input-group:not(.hidden) + .input-group":{marginLeft:t.spacing.unit}}},full:{maxWidth:"100%"},fullWidth:{width:"100%"},modal:{maxWidth:"100%","& >:first-child":{padding:2*t.spacing.unit}},title:{background:t.palette.white},footer:{padding:"".concat(2*t.spacing.unit,"px ").concat(t.spacing.unit,"px"),textAlign:"right"},formAction:{width:"75%",textAlign:"left",float:"right"},modalFooter:{borderTop:"1px solid ".concat(t.palette.gray300),backgroundColor:t.palette.white,marginTop:2*t.spacing.unit,padding:2*t.spacing.unit},inputGroup:{display:"flex",flexGrow:1,marginBottom:t.spacing.unit},labelGroup:{width:"25%",flexShrink:0,paddingRight:t.spacing.unit,display:"flex",justifyContent:"flex-end"},label:{paddingRight:.5*t.spacing.unit,textAlign:"right"},labelIcon:{color:t.palette.gray600,lineHeight:"1.75",cursor:"pointer"},moreIcon:{paddingRight:.5*t.spacing.unit},formControl:{display:"flex",padding:"0 ".concat(.5*t.spacing.unit,"px"),position:"relative"},errorsContainer:{flexDirection:"column"},control:{width:"100%"},append:{display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center",border:t.border,borderLeft:0},formBlock:{display:"block",width:"100%",position:"relative"},hasTitle:{border:"1px solid ".concat(t.palette.gray500),padding:"".concat(2*t.spacing.unit,"px ").concat(t.spacing.unit,"px 0"),marginTop:2*t.spacing.unit,marginBottom:t.spacing.unit},formBlockTitle:{padding:"0 ".concat(t.spacing.unit,"px"),background:t.palette.white,position:"absolute",top:"-.75rem"},groupBlock:{display:"flex",flexFlow:"row wrap",justifyContent:"space-between"},controlGroup:{flexGrow:1},objectGroup:{display:"block",width:"100%"},objectBlock:{display:"flex",flexGrow:1,marginBottom:0,width:"auto"},arrayBlock:{display:"flex",flexGrow:1,marginBottom:0,width:"auto"},arrayItem:{display:"flex"},newRow:{flexBasis:"100%"},listGroup:{},help:{"&:not($helpWarning):not($helpError):not($helpInfo) *":{color:"".concat(t.typography.fontColor," !important")}},helpWarning:{color:t.palette.warning.dark},helpError:{color:t.palette.error.main},helpInfo:{color:t.palette.info.main},hasErrors:{"& *":{color:"".concat(t.palette.error.main," !important"),borderColor:"".concat(t.palette.error.main," !important")},"& button":{"& span":{color:"".concat(t.palette.white," !important")}}},selectMenuList:{border:t.border,transformOrigin:"0 !important",transform:"scale(1, 1) translateZ(0px) translateY(40px) !important"},inputGroupFile:{},buttonLabel:{display:"flex",margin:0},fileInput:{display:"none"},filesInfo:{marginTop:.5*t.spacing.unit,border:"1px solid ".concat(t.palette.gray500)},hidden:{display:"none"},browser:{padding:0,margin:0},fileBrowser:{border:"1px solid ".concat(t.palette.gray500),left:"".concat(t.spacing.unit,"px !important"),top:"0 !important",minWidth:20*t.spacing.unit,width:"max-content",position:"relative",overflow:"auto","&:before":{content:"''",width:t.spacing.unit,height:t.spacing.unit,background:t.palette.white,position:"absolute",top:t.spacing.unit,left:-5,transform:"rotateZ(-45deg)",borderLeft:"1px solid ".concat(t.palette.gray500),borderTop:"1px solid ".concat(t.palette.gray500)}},collapseBtn:{position:"absolute",top:-t.spacing.unit,right:-t.spacing.unit,background:t.palette.white,fontSize:t.typography.fontSize,color:t.palette.gray700,cursor:"pointer"},collapsible:{overflow:"hidden",transition:"max-height 600ms ease-out",maxHeight:1e3},collapsed:{maxHeight:0},btnDisabled:{pointerEvents:"none",cursor:"not-allowed",background:t.palette.gray400},link:{cursor:"pointer"},addOnBtnOutlined:{background:"transparent !important",minWidth:"auto",border:"1px solid ".concat(t.palette.gray500),height:4*t.spacing.unit,borderRadius:"0 !important"},suggestions:{position:"absolute",width:"100%",background:t.palette.white,border:"1px solid ".concat(t.palette.gray500),padding:0,top:4*t.spacing.unit,left:"50%",transform:"translateX(-50%)",zIndex:1001},suggestionItemWrapper:{width:"100%",cursor:"pointer",padding:0},suggestionItem:{width:"100%",padding:t.spacing.unit}}}},34:function(e,t,a){"use strict";var r=a(61);function n(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var a=[],r=!0,n=!1,o=void 0;try{for(var i,s=e[Symbol.iterator]();!(r=(i=s.next()).done)&&(a.push(i.value),!t||a.length!==t);r=!0);}catch(c){n=!0,o=c}finally{try{r||null==s.return||s.return()}finally{if(n)throw o}}return a}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return o(e,t);var a=Object.prototype.toString.call(e).slice(8,-1);"Object"===a&&e.constructor&&(a=e.constructor.name);if("Map"===a||"Set"===a)return Array.from(e);if("Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a))return o(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function o(e,t){(null==t||t>e.length)&&(t=e.length);for(var a=0,r=new Array(t);a<t;a++)r[a]=e[a];return r}var i={Link:{color:r.a.bdPalette.primary.main,cursor:"pointer",textDecoration:"none"},Hidden:{display:"none"},PreserveWhitespace:{whiteSpace:"pre-wrap"},Pointer:{cursor:"pointer"},rgba:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,a=e.match(/\w\w/g).map((function(e){return parseInt(e,16)})),r=n(a,3),o=r[0],i=r[1],s=r[2];return"rgba(".concat(o,",").concat(i,",").concat(s,",").concat(t,")")}};function s(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function c(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?s(Object(a),!0).forEach((function(t){l(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):s(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function l(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}var u=r.a.bdPalette,p=r.a.fontFamily,d=r.a.unit,f=r.a.fontSize,m=r.a.fontWeight,h=r.a.fontColor,b=r.a.border,v=r.a.inputHeight,y={bdMixins:c({},i),palette:c(c({},u),{},{primary1Color:u.error.main,primary2Color:u.primary.light,accent1Color:u.secondary.main,accent2Color:u.secondary.light,primary3Color:u.primary.xLight,accent3Color:u.secondary.xLight,textColor:h,secondaryTextColor:u.gray600,borderColor:u.gray500,disabledColor:u.gray200,pickerHeaderColor:u.primary.main,shadowColor:u.white}),appBar:{height:72,padding:d},badge:{primaryColor:u.primary.main,secondaryColor:u.secondary.main,fontWeight:300},bottomNavigation:{selectedColor:u.primary.main,unselectedColor:h,height:4*d,selectedFontSize:f,unselectedFontSize:f},button:{height:4*d,iconButtonSize:3*d},card:{titleColor:h,subtitleColor:h},checkbox:{checkedColor:u.primary.main,requiredColor:h},chip:{textColor:h},datePicker:{color:u.primary.main,selectColor:u.primary.main},dialog:{titleFontSize:1.25*f},flatButton:{primaryTextColor:u.primary.main,secondaryTextColor:u.primary.light,fontSize:f,fontWeight:m},floatingActionButton:{buttonSize:3*d,miniSize:3*d,color:u.gray500},icon:{backgroundColor:u.primary.main},menuSubheader:{textColor:u.gray600},radioButton:{checkedColor:u.secondary.main,requiredColor:u.gray600},raisedButton:{primaryColor:u.secondary.main,secondaryColor:u.secondary.light,fontSize:f,fontWeight:m},refreshIndicator:{loadingStrokeColor:u.gray600},ripple:{color:h},shape:{borderRadius:0},slider:{trackColor:u.gray100,selectionColor:u.secondary.main,rippleColor:u.secondary.main},snackbar:{actionColor:h,backgroundColor:u.white,textColor:h},subheader:{fontWeight:m},stepper:{iconColor:u.gray600,hoveredIconColor:u.secondary.main,textColor:h},tableFooter:{textColor:u.gray600,borderColor:u.white},tableHeaderColumn:{textColor:u.gray600,height:3*d,spacing:d},tableRow:{hoverColor:u.gray300,stripeColor:u.gray200},tableRowColumn:{spacing:d},tabs:{backgroundColor:u.grey500,textColor:u.white,selectedTextColor:u.secondary.main},textField:{errorColor:u.error.main},timePicker:{accentColor:u.secondary.main,headerColor:u.gray600,selectColor:u.secondary.main},toggle:{thumbOnColor:u.secondary.main,thumbOffColor:u.gray500,thumbRequiredColor:u.gray600,trackOnColor:u.secondary.light,trackOffColor:u.gray300,trackDisabledColor:u.gray200,thumbDisabledColor:u.gray300},toolbar:{hoverColor:u.secondary.main,height:6.5*d,backgroundColor:u.white,iconColor:h},border:b,typography:{useNextVariants:!0,fontFamily:p,fontFamilyLight:"MetricHPE-Web-Light",fontFamilyRegular:"MetricHPE-Web-Regular",fontFamilySemiBold:"MetricHPE-Web-Semibold",fontFamilyMedium:"MetricHPE-Web-Medium",fontFamilyBold:"MetricHPE-Web-Bold",fontFamilySecondary:"HPESimpleWeb-Light",fontSize:f,fontSizeSmall:.875*f,fontSizeMedium:1.125*f,fontSizeMLarge:1.25*f,fontSizeLarge:1.5*f,fontSizeXLarge:2*f,fontWeightLight:200,fontWeightRegular:m,fontWeightMedium:400,fontColor:h,h1:{color:h,fontFamily:p,fontWeight:m,fontSize:2*f},h2:{color:h,fontFamily:p,fontWeight:m,fontSize:1.75*f},h3:{color:h,fontFamily:p,fontWeight:m,fontSize:1.5*f},h4:{color:h,fontFamily:p,fontWeight:m,fontSize:1.35*f},h5:{color:h,fontFamily:p,fontWeight:m,fontSize:1.25*f},h6:{color:h,fontFamily:p,fontWeight:m,fontSize:f},body1:{color:h,fontFamily:p,fontWeight:m,fontSize:f,lineHeight:1.5},body2:{color:h,fontFamily:p,fontWeight:m,fontSize:f,lineHeight:1.25},caption:{color:h,fontFamily:p,fontWeight:m,fontSize:f}},spacing:{unit:d,desktopDropDownMenuFontSize:2*d,desktopDropDownMenuItemHeight:4*d,desktopDrawerMenuItemHeight:5*d,desktopSubheaderHeight:3.5*d,desktopToolbarHeight:6*d,desktopGutter:1.5*d,desktopGutterMore:2*d,desktopGutterLess:d,desktopGutterMini:.5*d,desktopKeylineIncrement:32,formWidth:900,sidebarWidth:192,sidebarExpandedWidth:192,sidebarCollapsedWidth:128},zIndex:{mobileStepper:1e3,appBar:1100,drawer:1200,sidebarPointer:1201,sidebarFloatingTitle:1202,modal:1300,snackbar:1400,tooltip:1500},variants:{primary:{backgroundColor:u.primary.main,color:u.white},success:{backgroundColor:u.success.main,color:u.white},warning:{backgroundColor:u.warning.main,color:h},error:{backgroundColor:u.error.main,color:u.white},info:{backgroundColor:u.info.main,color:h},disabled:{backgroundColor:u.gray300,color:u.gray700}},overrides:{MuiPaper:{root:{boxShadow:"none !important"},rounded:{borderRadius:"0 !important"}},MuiMenuItem:{root:{padding:"".concat(.5*d,"px ").concat(d,"px")}},MuiButton:{root:{padding:"".concat(.5*d,"px ").concat(d,"px"),minHeight:24,color:h},label:{lineHeight:1,textTransform:"none",fontSize:.875*f},contained:{color:h},containedPrimary:{backgroundColor:u.primary.main,"&:hover, &:focus":{backgroundColor:u.primary.dark},color:"".concat(u.white," !important"),"& .icon":{color:u.white}},containedSecondary:{backgroundColor:u.error.main,"&:hover, &:focus":{backgroundColor:u.error.dark},color:"".concat(u.white," !important"),"& .icon":{color:u.white}},sizeSmall:{padding:0,minWidth:3*d,minHeight:2*d-1}},MuiInput:{underline:{"&::before":{borderWidth:"0 !important",borderBottomColor:"".concat(u.gray900," !important")},"&::after":{borderWidth:"0 !important",borderBottomColor:"".concat(u.primary.main," !important")}}},MuiInputBase:{root:{"&$disabled":{backgroundColor:"".concat(u.gray200," !important"),cursor:"not-allowed"}},input:{fontSize:f,fontWeight:m,color:h,height:v,lineHeight:v},inputType:{height:v,lineHeight:v},multiline:{padding:"".concat(.6*d,"px ").concat(d,"px !important")}},MuiInputLabel:{formControl:{left:".75rem"}},MuiPrivateTextarea:{textarea:{lineHeight:"1.25 !important"}},MuiOutlinedInput:{root:{"&:hover":{"&:not($disabled):not($error):not($focused)":{"& $notchedOutline":{borderColor:u.gray500}}},"&$disabled":{"& $notchedOutline":{borderColor:u.gray300}},"&$focused":{"& $notchedOutline":{borderWidth:1,borderColor:u.gray500}}},input:{padding:"0 ".concat(d,"px")}},MuiPrivateNotchedOutline:{root:{borderColor:u.gray500}},MuiTableCell:{root:{padding:"".concat(.5*d,"px ").concat(d,"px"),color:h,fontSize:f},body:{color:h,fontSize:f,borderBottomColor:u.gray300},head:{color:h,paddingTop:.5*d,paddingBottom:.5*d,fontSize:f,backgroundColor:u.gray200},paddingCheckbox:{"&:not(th)":{paddingTop:.75*d}}},MuiTableRow:{root:{verticalAlign:"top",lineHeight:"1.1"},head:{height:2*d,verticalAlign:"center"},footer:{height:4*d}},MUIDataTableHeadCell:{fixedHeaderCommon:{backgroundColor:u.gray200},data:{display:"inline"},sortAction:{height:"auto",display:"inline",width:"100%",lineHeight:"1"}},MuiTableSortLabel:{root:{display:"none"},active:{display:"inline-flex"},icon:{marginRight:0,marginLeft:2*d,width:4*d,height:2*d}},MUIDataTableBodyCell:{root:{maxWidth:"30vw","& .row-action-btns":{paddingTop:.5*d}}},MUIDataTableSelectCell:{root:{padding:"5px ".concat(d,"px"),textAlign:"center",width:2*d,boxSizing:"content-box","& svg":{width:2*d,height:2*d}},checkboxRoot:{padding:0},fixedHeaderCommon:{backgroundColor:"transparent"},headerCell:{backgroundColor:u.gray200}},MUIDataTableToolbar:{root:{padding:"".concat(.25*d,"px"),minHeight:"auto",justifyContent:"flex-end"},left:{flex:"0 0 auto",textAlign:"right"},actions:{flex:"0 0 auto",padding:"2px 0",marginBottom:"5px","& .tableActionButtons":{display:"inline-flex",alignItems:"center","& > *:not(:first-child)":{marginLeft:d}}},iconActive:{display:"none"},icon:{padding:.5*d,marginRight:.5*d}},MUIDataTableSearch:{main:{justifyContent:"flex-end",alignItems:"center"},clearIcon:{padding:.5*d,marginRight:.5*d,height:4*d},searchIcon:{marginTop:0}},MUIDataTableToolbarSelect:{root:{margin:0,padding:0,minHeight:6*d,height:6*d,alignItems:"center","& .tableActionButtonsSelected":{display:"inline-flex","& >*":{marginLeft:d}}},title:{paddingLeft:2*d,position:"relative",transform:"none"}},MUIDataTablePagination:{root:{padding:"0 !important"},toolbar:{height:4*d,minHeight:4*d,margin:"".concat(.5*d,"px 0")}},MuiTablePagination:{menuItem:{padding:"".concat(d,"px !important"),fontSize:f,color:h,textAlign:"center"},selectIcon:{top:"calc(50% - 12px)",right:2}},MUIDataTableFilterList:{chip:{fontSize:.75*f,color:h,height:3*d}},MuiChip:{deleteIcon:{width:1.5*d,height:1.5*d}},MuiExpansionPanel:{root:{background:"none",border:0,"&::before":{content:"none"}},expanded:{marginTop:0}},MuiExpansionPanelSummary:{root:{padding:0,minHeight:"auto !important",width:"max-content"},content:{margin:"0 !important","& > :last-child":{paddingRight:6*d}},expandIcon:{fontSize:f}},MuiExpansionPanelDetails:{root:{padding:0,display:"block"}},MuiTooltip:{tooltip:{maxWidth:40*d,top:d,position:"relative",backgroundColor:u.primary.main,"& *":{color:u.white},"[variant=primary] &":{backgroundColor:u.primary.main},"[variant=secondary] &":{backgroundColor:u.secondary.main},"[variant=info] &":{backgroundColor:u.info.main,"& *":{color:h}},"[variant=success] &":{backgroundColor:u.success.main},"[variant=warning] &":{backgroundColor:u.warning.main,"& *":{color:h}},"[variant=error] &":{backgroundColor:u.error.main},"[variant=default] &":{backgroundColor:u.gray600}},tooltipPlacementLeft:{left:3*d,top:0}},MuiTabs:{root:{marginBottom:2*d,minHeight:4*d,padding:0},indicator:{}},MuiTab:{root:{color:h,borderBottom:"2px solid",borderBottomColor:u.gray700,fontSize:"".concat(1.125*f,"px !important"),minHeight:4*d,minWidth:"".concat(8*d,"px !important"),padding:0,marginRight:1.5*d,marginBottom:0,fontFamily:"MetricHPE-Web-Regular","&$selected":{borderBottomColor:u.white,fontFamily:"MetricHPE-Web-Semibold",color:u.primary.main}},textColorInherit:{color:h,opacity:1},labelContainer:{padding:"0 ".concat(d,"px ").concat(2*d,"px !important"),textAlign:"left"},label:{textTransform:"none"}},MuiPrivateTabIndicator:{colorPrimary:{backgroundColor:u.primary.main}},MuiIconButton:{root:{"&.action-btn":{padding:.5*d,fontSize:".8rem",borderRadius:2,marginRight:4,background:u.gray300,"&:hover":{background:"".concat(u.primary.main," !important"),borderColor:"".concat(u.primary.main," !important"),"&.error":{background:"".concat(u.error.main," !important"),borderColor:"".concat(u.error.main," !important"),"& .icon":{color:u.white}}},"& .icon":{color:h},"&:disabled":{background:"".concat(u.gray200," !important"),cursor:"not-allowed","& .icon":{color:"".concat(u.gray500," !important")}}}}},MuiBackdrop:{root:{transition:"non !important"}},MuiDialog:{container:{alignItems:"flex-start"},paper:{margin:0,marginTop:6.5*d,minWidth:"50%"}},MuiDialogTitle:{root:{borderBottom:"1px solid ".concat(u.gray200)}},MuiDialogContent:{root:{padding:2*d,fontFamily:p,fontSize:f,fontWeight:m,color:h}},MuiDialogActions:{root:{borderTop:"1px solid ".concat(u.gray200),margin:0,padding:2*d,justifyContent:"space-between"}},MuiCheckbox:{root:{padding:0}},MuiRadio:{colorPrimary:{"&$checked":{color:u.primary.main}},colorSecondary:{"&$checked":{color:u.primary.main}}},MuiFormControl:{root:{width:"100%"}},MuiFormControlLabel:{root:{marginLeft:0}},MuiSelect:{root:{"&$disabled":{color:u.gray500,cursor:"not-allowed"}},selectMenu:{boxSizing:"border-box",height:v,lineHeight:v,whiteSpace:"normal",padding:0,paddingLeft:d,paddingRight:3*d,wordBreak:"break-all",border:"1px solid ".concat(u.gray500),"&:hover, &:focus":{background:"transparent"},"&$disabled":{borderColor:u.gray300}},icon:{right:8}},MuiSwitch:{root:{width:5.5*d},switchBase:{height:4.5*d},icon:{left:1.25*-d,position:"relative"}},MuiStepConnector:{root:{maxWidth:60}},MuiListItem:{root:{"&$selected":{backgroundColor:"".concat(u.active.light),"&:focus":{backgroundColor:"".concat(u.active.light)},"&:hover":{backgroundColor:"".concat(u.active.light)}}},button:{"&:hover":{backgroundColor:"none"}}},MuiStepper:{root:{paddingLeft:0,paddingRight:0}}},shadows:["none","0px 1px 3px 0px rgba(0,0,0,0.1),0px 1px 1px 0px rgba(0,0,0,0.07),0px 2px 1px -1px rgba(0,0,0,0.06)","0px 1px 5px 0px rgba(0,0,0,0.1),0px 2px 2px 0px rgba(0,0,0,0.07),0px 3px 1px -2px rgba(0,0,0,0.06)","0px 1px 8px 0px rgba(0,0,0,0.1),0px 3px 4px 0px rgba(0,0,0,0.07),0px 3px 3px -2px rgba(0,0,0,0.06)","0px 2px 4px -1px rgba(0,0,0,0.1),0px 4px 5px 0px rgba(0,0,0,0.07),0px 1px 10px 0px rgba(0,0,0,0.06)","0px 3px 5px -1px rgba(0,0,0,0.1),0px 5px 8px 0px rgba(0,0,0,0.07),0px 1px 14px 0px rgba(0,0,0,0.06)","0px 3px 5px -1px rgba(0,0,0,0.1),0px 6px 10px 0px rgba(0,0,0,0.07),0px 1px 18px 0px rgba(0,0,0,0.06)","0px 4px 5px -2px rgba(0,0,0,0.1),0px 7px 10px 1px rgba(0,0,0,0.07),0px 2px 16px 1px rgba(0,0,0,0.06)","0px 5px 5px -3px rgba(0,0,0,0.1),0px 8px 10px 1px rgba(0,0,0,0.07),0px 3px 14px 2px rgba(0,0,0,0.06)","0px 5px 6px -3px rgba(0,0,0,0.1),0px 9px 12px 1px rgba(0,0,0,0.07),0px 3px 16px 2px rgba(0,0,0,0.06)","0px 6px 6px -3px rgba(0,0,0,0.1),0px 10px 14px 1px rgba(0,0,0,0.07),0px 4px 18px 3px rgba(0,0,0,0.06)","0px 6px 7px -4px rgba(0,0,0,0.1),0px 11px 15px 1px rgba(0,0,0,0.07),0px 4px 20px 3px rgba(0,0,0,0.06)","0px 7px 8px -4px rgba(0,0,0,0.1),0px 12px 17px 2px rgba(0,0,0,0.07),0px 5px 22px 4px rgba(0,0,0,0.06)","0px 7px 8px -4px rgba(0,0,0,0.1),0px 13px 19px 2px rgba(0,0,0,0.07),0px 5px 24px 4px rgba(0,0,0,0.06)","0px 7px 9px -4px rgba(0,0,0,0.1),0px 14px 21px 2px rgba(0,0,0,0.07),0px 5px 26px 4px rgba(0,0,0,0.06)","0px 8px 9px -5px rgba(0,0,0,0.1),0px 15px 22px 2px rgba(0,0,0,0.07),0px 6px 28px 5px rgba(0,0,0,0.06)","0px 8px 10px -5px rgba(0,0,0,0.1),0px 16px 24px 2px rgba(0,0,0,0.07),0px 6px 30px 5px rgba(0,0,0,0.06)","0px 8px 11px -5px rgba(0,0,0,0.1),0px 17px 26px 2px rgba(0,0,0,0.07),0px 6px 32px 5px rgba(0,0,0,0.06)","0px 9px 11px -5px rgba(0,0,0,0.1),0px 18px 28px 2px rgba(0,0,0,0.07),0px 7px 34px 6px rgba(0,0,0,0.06)","0px 9px 12px -6px rgba(0,0,0,0.1),0px 19px 29px 2px rgba(0,0,0,0.07),0px 7px 36px 6px rgba(0,0,0,0.06)","0px 10px 13px -6px rgba(0,0,0,0.1),0px 20px 31px 3px rgba(0,0,0,0.07),0px 8px 38px 7px rgba(0,0,0,0.06)","0px 10px 13px -6px rgba(0,0,0,0.1),0px 21px 33px 3px rgba(0,0,0,0.07),0px 8px 40px 7px rgba(0,0,0,0.06)","0px 10px 14px -6px rgba(0,0,0,0.1),0px 22px 35px 3px rgba(0,0,0,0.07),0px 8px 42px 7px rgba(0,0,0,0.06)","0px 11px 14px -7px rgba(0,0,0,0.1),0px 23px 36px 3px rgba(0,0,0,0.07),0px 9px 44px 8px rgba(0,0,0,0.06)","0px 11px 15px -7px rgba(0,0,0,0.1),0px 24px 38px 3px rgba(0,0,0,0.07),0px 9px 46px 8px rgba(0,0,0,0.06)"]};t.a=y},61:function(e,t,a){"use strict";t.a={bdPalette:{primary:{light:"#56DBB2",main:"#01A982",dark:"#007955",xLight:"#67FFE4"},secondary:{light:"#56B2E5",main:"#0083B3",dark:"#005683",xLight:"#63D9FF"},success:{light:"#56DBB2",main:"#01A982",dark:"#007955"},error:{light:"#FF7D7F",main:"#F04953",dark:"#B7002A"},warning:{light:"#FFFF77",main:"#FFD144",dark:"#C8A000"},info:{light:"#FFF",main:"#ECECEC",dark:"#9B9B9B"},active:{light:"#91FEE5"},white:"#FFF",gray100:"#F9F9F9",gray150:"#F2F2F2",gray200:"#ECECEC",gray300:"#D8D8D8",gray400:"#CCC",gray500:"#ACACAC",gray600:"#7D7D7D",gray700:"#666",gray800:"#333",gray900:"#222",black:"#000",hpeBlack:"#1F2532"},fontFamily:"'MetricHPE-Web-Regular', 'Roboto', 'Helvetica', 'Arial', 'sans-serif'",unit:8,fontSize:16,fontWeight:300,fontColor:"#333",border:"1px solid #DBDBDB",inputHeight:"2rem"}},702:function(e,t,a){"use strict";(function(e){var r=a(703),n=a.n(r).a.resolve(e,"../../");t.a={app_dir:n}}).call(this,"/")},706:function(e,t,a){"use strict";(function(e){var r=a(0),n=a.n(r),o=a(1),i=a.n(o),s=a(5),c=a.n(s),l=a(8),u=a.n(l),p=a(6),d=a.n(p),f=a(50),m=a.n(f),h=a(47),b=a.n(h),v=a(3),y=a.n(v),g=a(96),_=a.n(g),S=a(2),k=a(30);function O(e){return(O="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function E(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function j(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?E(Object(a),!0).forEach((function(t){R(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):E(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function D(e,t){for(var a=0;a<t.length;a++){var r=t[a];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function w(e,t){return(w=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function C(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,r=A(e);if(t){var n=A(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return T(this,a)}}function T(e,t){return!t||"object"!==O(t)&&"function"!=typeof t?P(e):t}function P(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function A(e){return(A=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function R(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}var N=function(e){var t=e.filesInfo,a=e.classes;return 0===t.length?null:n.a.createElement(m.a,{className:a.filesInfo,dense:!0},t.map((function(e,t){var a=e.name,r=e.size;return n.a.createElement(b.a,{key:t},n.a.createElement(y.a,null,a,", (",r," bytes)"))})))};N.propTypes={filesInfo:i.a.array,classes:i.a.object};var F=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&w(e,t)}(i,e);var t,a,r,o=C(i);function i(e){var t;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),R(P(t=o.call(this,e)),"onChange",(function(e){var a=t.props,r=a.multiple,n=a.onChange,o=a.schema,i=o.bdOnChange,s=void 0===i?null:i,c=o.read,l=void 0!==c&&c,u=a.id,p=P(t);t.processFiles(e.target.files,l).then((function(e){var t=e.map((function(e){return e.dataURL})),a={values:t,filesInfo:e};U(p,a,(function(){r?(n(a.values),s&&s({filesInfo:e,values:t,id:u})):(n(a.values[0]),s&&s({filesInfo:e,values:t,id:u}))}))}))}));var a,r=e.value,n=Array.isArray(r)?r:[r];return t.state={values:n,filesInfo:(a=n,a.filter((function(e){return e&&void 0!==e})).map((function(e){var t=M(e),a=t.blob;return{name:t.name,size:a.size,type:a.type}}))),placeholder:"",clear:!1},t.getDisplayLabel=t.getDisplayLabel.bind(P(t)),t.handleFileClear=t.handleFileClear.bind(P(t)),t.processFile=t.processFile.bind(P(t)),t.processFiles=t.processFiles.bind(P(t)),t}return t=i,(a=[{key:"componentDidMount",value:function(){var e=this.props.schema,t=void 0===e?{}:e,a=t.placeholder,r=void 0===a?"":a,n=t.clear,o=void 0!==n&&n;this.setState({placeholder:r,clear:o})}},{key:"shouldComponentUpdate",value:function(e,t){return I(this,e,t)}},{key:"getDisplayLabel",value:function(){var e=this.state,t=e.filesInfo,a=e.placeholder,r=void 0===a?"":a,n=t.length;return n&&(r=1===n?t[0].name:"".concat(n," files selected")),r}},{key:"handleFileClear",value:function(){var e=this.props,t=e.schema,a=(t=void 0===t?{}:t).bdOnChange,r=void 0===a?null:a,n=t.placeholder,o=void 0===n?"":n,i=e.id;document.querySelector("#".concat(i)).value="",this.setState({values:[],filesInfo:[],placeholder:o,clear:!1},(function(){r&&r({values:[],filesInfo:[],id:i})}))}},{key:"processFile",value:function(e){var t=this.props.schema.read,a=void 0!==t&&t,r=e.name,n=e.size,o=e.type;return new Promise((function(t,i){var s=new window.FileReader;s.onerror=i,s.onload=function(s){var c={dataURL:x(s.target.result,r),name:r,size:n,type:o};if(a){var l=new window.FileReader;l.onerror=i,l.onload=function(e){e.target.readyState===FileReader.DONE&&t(j(j({},c),{},{content:e.target.result}))},l.readAsBinaryString(e)}else t(c)},s.readAsDataURL(e)}))}},{key:"processFiles",value:function(e){return Promise.all([].map.call(e,this.processFile))}},{key:"render",value:function(){var e=this.props,t=e.classes,a=e.multiple,r=e.id,o=e.readonly,i=void 0!==o&&o,s=e.disabled,l=void 0!==s&&s,p=e.schema,d=this.state,f=d.filesInfo,m=d.clear,h=this.getDisplayLabel(),b=p.accept,v=void 0===b?"*":b,y=p.bd_disabled,g=p.ActionBtnLabel,S=void 0===g?"Browse":g;return n.a.createElement("div",{className:t.inputGroupFile},n.a.createElement("div",{className:t.formControl},n.a.createElement(_.a,{className:t.control,variant:"outlined",disabled:l||i||y,value:h}),f.length||m?n.a.createElement(u.a,{variant:"contained",color:"secondary",component:"span",className:t.button,disabled:l||i||y,onClick:this.handleFileClear},"Clear"):"",n.a.createElement("label",{htmlFor:r,className:t.buttonLabel},n.a.createElement(u.a,{htmlFor:r,color:"primary",variant:"contained",component:"span",className:c()(t.button,"file-browse"),disabled:l||i||y},S)),n.a.createElement("input",{accept:v,className:t.fileInput,id:r,multiple:a,type:"file",disabled:l||i||y,onChange:this.onChange,defaultValue:""})),n.a.createElement(N,{filesInfo:f,classes:t}))}}])&&D(t.prototype,a),r&&D(t,r),i}(r.Component);R(F,"propTypes",{classes:i.a.object,multiple:i.a.bool,value:i.a.oneOfType([i.a.string,i.a.arrayOf(i.a.string)]),autofocus:i.a.bool,onChange:i.a.func,id:i.a.string,readonly:i.a.bool,disabled:i.a.bool,schema:i.a.object,clear:i.a.bool,placeholder:i.a.string}),t.a=d()(k.a)(F);var x=function(e,t){return e.replace(";base64",";name=".concat(encodeURIComponent(t),";base64"))},M=function(e){var t,a=e.split(","),r=a[0].split(";"),n=r[0].replace("data:",""),o=r.filter((function(e){return"name"===e.split("=")[0]}));t=1!==o.length?"unknown":o[0].split("=")[1];for(var i=atob(a[1]),s=[],c=0;c<i.length;c++)s.push(i.charCodeAt(c));return{blob:new window.Blob([new Uint8Array(s)],{type:n}),name:t}},I=function(e,t,a){var r=e.props,n=e.state;return!S.a.isEqual(r,t)||!S.a.isEqual(n,a)},U=function(t,a,r){t.props.safeRenderCompletion?t.setState(a,r):(t.setState(a),e(r))}}).call(this,a(498).setImmediate)}});